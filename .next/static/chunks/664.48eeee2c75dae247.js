"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[664],{9664:function(e,o,t){t.r(o),t.d(o,{default:function(){return l}});var n=t(5893),i=t(7294);function l(e){let{deviceController:o,showVoiceFocus:t=!0,showOutputControl:l=!0,showLevelMeter:r=!0,style:d={}}=e,[a,c]=(0,i.useState)(!1),[s,u]=(0,i.useState)([]),[p,g]=(0,i.useState)([]),[x,h]=(0,i.useState)(""),[f,D]=(0,i.useState)(""),[v,m]=(0,i.useState)(0),[C,b]=(0,i.useState)(null),[A,y]=(0,i.useState)(null),[S,j]=(0,i.useState)(!1),k=(0,i.useRef)(null),w=(0,i.useRef)(null),F=(0,i.useRef)(null);(0,i.useEffect)(()=>(k.current=new(window.AudioContext||window.webkitAudioContext),()=>{k.current&&"closed"!==k.current.state&&k.current.close(),F.current&&cancelAnimationFrame(F.current)}),[]),(0,i.useEffect)(()=>{let e=setTimeout(async()=>{try{let e=o||window.__chimeDeviceController;if(e){console.log("StandaloneAudioControl: Loading devices with DeviceController...");let o=await e.listAudioInputDevices(),t=await e.listAudioOutputDevices();u(o),g(t),o.length>0&&!x&&h(o[0].deviceId),t.length>0&&!f&&D(t[0].deviceId),console.log("StandaloneAudioControl: Found devices:",{audioInputs:o.length,audioOutputs:t.length})}else{console.log("StandaloneAudioControl: Loading devices with navigator.mediaDevices...");let e=await navigator.mediaDevices.enumerateDevices(),o=e.filter(e=>"audioinput"===e.kind),t=e.filter(e=>"audiooutput"===e.kind);u(o),g(t),o.length>0&&!x&&h(o[0].deviceId),t.length>0&&!f&&D(t[0].deviceId),console.log("StandaloneAudioControl: Found devices (fallback):",{audioInputs:o.length,audioOutputs:t.length})}}catch(e){console.error("StandaloneAudioControl: Error loading devices:",e),y("Failed to load audio devices: ".concat(e))}},100);return()=>clearTimeout(e)},[o]);let I=async e=>{try{console.log("StandaloneAudioControl: Starting audio monitoring for device:",e),C&&C.getTracks().forEach(e=>e.stop());let o=await navigator.mediaDevices.getUserMedia({audio:{deviceId:e?{exact:e}:void 0},video:!1});if(b(o),y(null),k.current&&r){let e=k.current.createMediaStreamSource(o),t=k.current.createAnalyser();t.fftSize=256,t.smoothingTimeConstant=.8,e.connect(t),w.current=t;let n=new Uint8Array(t.frequencyBinCount),i=()=>{if(w.current&&!a){w.current.getByteFrequencyData(n);let e=n.reduce((e,o)=>e+o)/n.length;m(Math.floor(Math.min(e/128*100,100)))}else m(0);F.current=requestAnimationFrame(i)};i()}console.log("StandaloneAudioControl: Audio monitoring started successfully")}catch(e){console.error("StandaloneAudioControl: Error starting audio monitoring:",e),y("Failed to access microphone: ".concat(e))}},E=async e=>{console.log("StandaloneAudioControl: Changing audio device to:",e),h(e),a||await I(e)},R=e=>{console.log("StandaloneAudioControl: Changing output device to:",e),D(e)},z=async()=>{let e=!a;c(e),e?(C&&(C.getTracks().forEach(e=>e.stop()),b(null)),m(0),console.log("StandaloneAudioControl: Audio muted")):(x&&await I(x),console.log("StandaloneAudioControl: Audio unmuted"))};(0,i.useEffect)(()=>(!a&&x&&s.length>0&&I(x),()=>{C&&C.getTracks().forEach(e=>e.stop()),F.current&&cancelAnimationFrame(F.current)}),[x,s.length]);let M={display:"flex",flexDirection:"column",alignItems:"center",gap:"20px",padding:"25px",border:"1px solid #ddd",borderRadius:"10px",backgroundColor:"#f9f9f9",maxWidth:"600px",margin:"0 auto",...d},T=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{padding:"10px 15px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:"bold",backgroundColor:e?"#007bff":"#6c757d",color:"white",transition:"background-color 0.2s ease",minWidth:"100px"}},W={padding:"8px 12px",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"14px",backgroundColor:"white",minWidth:"200px"};return(0,n.jsxs)("div",{style:M,children:[(0,n.jsx)("h3",{style:{margin:"0",color:"#333",textAlign:"center"},children:"\uD83C\uDFA4 Standalone Audio Controls"}),A&&(0,n.jsxs)("div",{style:{padding:"10px 15px",backgroundColor:"#f8d7da",color:"#721c24",borderRadius:"5px",border:"1px solid #f5c6cb",fontSize:"14px",textAlign:"center"},children:["❌ ",A]}),r&&(0,n.jsxs)("div",{style:{width:"100%",textAlign:"center"},children:[(0,n.jsxs)("div",{style:{marginBottom:"10px",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[(0,n.jsx)("span",{style:{fontSize:"20px"},children:a?"\uD83D\uDD07":v>60?"\uD83D\uDD0A":v>30?"\uD83D\uDD09":v>5?"\uD83D\uDD08":"\uD83D\uDCE2"}),(0,n.jsxs)("span",{children:["Audio Level: ",v,"%"]})]}),(0,n.jsx)("div",{style:{width:"300px",height:"20px",backgroundColor:"#e9ecef",borderRadius:"10px",overflow:"hidden",border:"1px solid #adb5bd",position:"relative"},children:(0,n.jsx)("div",{style:{width:"".concat(v,"%"),height:"100%",backgroundColor:v>70?"#dc3545":v>30?"#ffc107":"#28a745",transition:"width 0.1s ease",borderRadius:"10px"}})}),(0,n.jsx)("div",{style:{marginTop:"8px",fontSize:"12px",color:"#666"},children:a?"\uD83D\uDD07 Microphone muted":v>5?"\uD83C\uDFB5 Audio detected":"\uD83D\uDCE2 Speak to test microphone"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"15px",alignItems:"center",flexWrap:"wrap",justifyContent:"center"},children:[(0,n.jsx)("button",{onClick:z,style:T(a),title:a?"Unmute microphone":"Mute microphone",children:a?"\uD83D\uDD07 Unmute":"\uD83C\uDFA4 Mute"}),t&&(0,n.jsx)("button",{onClick:()=>{j(!S),console.log("StandaloneAudioControl: Voice Focus toggled:",!S)},style:T(S),title:"Toggle noise suppression",children:S?"\uD83C\uDFAF VF ON":"\uD83C\uDFAF VF OFF"})]}),(0,n.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"15px"},children:[(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",color:"#555"},children:"\uD83C\uDFA4 Microphone Device:"}),(0,n.jsx)("select",{value:x,onChange:e=>E(e.target.value),style:W,children:s.map(e=>(0,n.jsx)("option",{value:e.deviceId,children:e.label||"Microphone ".concat(e.deviceId.slice(0,8),"...")},e.deviceId))}),(0,n.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginTop:"3px"},children:[s.length," microphone(s) available"]})]}),l&&(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",color:"#555"},children:"\uD83D\uDD0A Speaker Device:"}),(0,n.jsx)("select",{value:f,onChange:e=>R(e.target.value),style:W,children:p.map(e=>(0,n.jsx)("option",{value:e.deviceId,children:e.label||"Speaker ".concat(e.deviceId.slice(0,8),"...")},e.deviceId))}),(0,n.jsxs)("div",{style:{fontSize:"12px",color:"#666",marginTop:"3px"},children:[p.length," speaker(s) available"]})]})]}),(0,n.jsxs)("div",{style:{fontSize:"14px",color:a?"#dc3545":"#28a745",textAlign:"center",padding:"10px 15px",backgroundColor:a?"#f8d7da":"#d4edda",borderRadius:"5px",border:"1px solid ".concat(a?"#f5c6cb":"#c3e6cb"),maxWidth:"400px"},children:[a?"\uD83D\uDD07 Microphone is muted":"\uD83C\uDFA4 Microphone is active",t&&(S?" • \uD83C\uDFAF Noise suppression ON":" • \uD83C\uDFAF Noise suppression OFF")]}),(0,n.jsxs)("div",{style:{fontSize:"12px",color:"#666",textAlign:"center",maxWidth:"500px",lineHeight:"1.4",backgroundColor:"#f8f9fa",padding:"12px",borderRadius:"5px",border:"1px solid #e9ecef"},children:["\uD83D\uDCA1 ",(0,n.jsx)("strong",{children:"Features:"})," Real device selection and monitoring,",t&&" noise suppression toggle,",l&&" speaker output control,",r&&" live audio level meter,","direct browser API integration for immediate testing."]})]})}}}]);