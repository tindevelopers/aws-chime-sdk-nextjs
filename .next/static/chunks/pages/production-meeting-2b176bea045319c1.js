(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[542],{2281:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/production-meeting",function(){return n(8550)}])},2602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{default:function(){return s},noSSR:function(){return l}});let i=n(8754);n(5893),n(7294);let o=i._(n(5491));function r(e){return{default:(null==e?void 0:e.default)||e}}function l(e,t){return delete t.webpack,delete t.modules,e(t)}function s(e,t){let n=o.default,i={loading:e=>{let{error:t,isLoading:n,pastDelay:i}=e;return null}};e instanceof Promise?i.loader=()=>e:"function"==typeof e?i.loader=e:"object"==typeof e&&(i={...i,...e});let s=(i={...i,...t}).loader;return(i.loadableGenerated&&(i={...i,...i.loadableGenerated},delete i.loadableGenerated),"boolean"!=typeof i.ssr||i.ssr)?n({...i,loader:()=>null!=s?s().then(r):Promise.resolve(r(()=>null))}):(delete i.webpack,delete i.modules,l(n,i))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1159:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return i}});let i=n(8754)._(n(7294)).default.createContext(null)},5491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return p}});let i=n(8754)._(n(7294)),o=n(1159),r=[],l=[],s=!1;function a(e){let t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then(e=>(n.loading=!1,n.loaded=e,e)).catch(e=>{throw n.loading=!1,n.error=e,e}),n}class d{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function u(e){return function(e,t){let n=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),r=null;function a(){if(!r){let t=new d(e,n);r={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return r.promise()}if(!s){let e=n.webpack?n.webpack():n.modules;e&&l.push(t=>{for(let n of e)if(t.includes(n))return a()})}function u(e,t){!function(){a();let e=i.default.useContext(o.LoadableContext);e&&Array.isArray(n.modules)&&n.modules.forEach(t=>{e(t)})}();let l=i.default.useSyncExternalStore(r.subscribe,r.getCurrentValue,r.getCurrentValue);return i.default.useImperativeHandle(t,()=>({retry:r.retry}),[]),i.default.useMemo(()=>{var t;return l.loading||l.error?i.default.createElement(n.loading,{isLoading:l.loading,pastDelay:l.pastDelay,timedOut:l.timedOut,error:l.error,retry:r.retry}):l.loaded?i.default.createElement((t=l.loaded)&&t.default?t.default:t,e):null},[e,l])}return u.preload=()=>a(),u.displayName="LoadableComponent",i.default.forwardRef(u)}(a,e)}function c(e,t){let n=[];for(;e.length;){let i=e.pop();n.push(i(t))}return Promise.all(n).then(()=>{if(e.length)return c(e,t)})}u.preloadAll=()=>new Promise((e,t)=>{c(r).then(e,t)}),u.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let n=()=>(s=!0,t());c(l,e).then(n,n)})),window.__NEXT_PRELOADREADY=u.preloadReady;let p=u},8550:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var i=n(5893),o=n(7294),r=n(1163),l=n(5152),s=n.n(l),a=n(6730);let d=s()(()=>Promise.resolve(u),{ssr:!1,loading:()=>(0,i.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:"Loading meeting..."})});function u(){let e=(0,r.useRouter)(),t=(0,a.fjl)(),[l,s]=(0,o.useState)(null),[d,u]=(0,o.useState)(!1),[c,p]=(0,o.useState)(!1),[f,g]=(0,o.useState)(!1),[x,h]=(0,o.useState)(!1),[y,m]=(0,o.useState)(null),{muted:b}=(0,a.HI)(),{isVideoEnabled:j}=(0,a.Onx)(),_=(0,a.EJc)().isLocalUserSharing||!1,{tiles:v}=(0,a.akC)(),D=(0,a.dpf)();(0,o.useEffect)(()=>{let e=localStorage.getItem("chime-setup-data");if(e)try{let t=JSON.parse(e);s(t)}catch(e){console.error("Failed to parse setup data:",e),m("Invalid setup data. Please run device setup first.")}else m("No setup data found. Please complete device setup first.")},[]),(0,o.useEffect)(()=>{!l||c||d||C()},[l,c,d]),(0,o.useEffect)(()=>{D===a.ytK.Succeeded?(p(!0),u(!1)):D===a.ytK.Failed&&(m("Failed to join meeting. Please check your connection and try again."),u(!1))},[D]);let C=async()=>{if(l){u(!0),m(null);try{console.log("ProductionMeeting: Joining meeting with setup data:",l),console.log("ProductionMeeting: Using meetingId:",l.meetingId,"userName:",l.userName);let e=await fetch("/api/join",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:l.meetingId,attendeeName:l.userName,region:"us-east-1"})});if(!e.ok){let t=await e.text();throw console.error("ProductionMeeting: API Error Response:",t),Error("Failed to join meeting: ".concat(e.status," ").concat(e.statusText," - ").concat(t))}let i=await e.json();console.log("ProductionMeeting: Creating meeting session configuration...");let o=new(await Promise.resolve().then(n.t.bind(n,3204,23))).MeetingSessionConfiguration(i.JoinInfo.Meeting,i.JoinInfo.Attendee);console.log("ProductionMeeting: Joining meeting session..."),await t.join(o),console.log("ProductionMeeting: Starting audio and video..."),await t.start(),p(!0),sessionStorage.setItem("chime-meeting-data",JSON.stringify({Meeting:i.JoinInfo.Meeting,Attendee:i.JoinInfo.Attendee,setupData:l})),console.log("ProductionMeeting: Successfully joined meeting")}catch(e){console.error("ProductionMeeting: Failed to join meeting:",e),m("Failed to join meeting: ".concat(e.message)),u(!1)}}},S=async()=>{try{await t.leave(),localStorage.removeItem("chime-setup-data"),e.push("/")}catch(e){console.error("Failed to leave meeting:",e)}},w={minHeight:"100vh",backgroundColor:"#f8f9fa",color:"#212529",fontFamily:"system-ui"},k=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{padding:"10px 15px",borderRadius:"6px",border:"none",backgroundColor:e?"#007bff":"#6c757d",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"bold",transition:"background-color 0.2s ease"}};return y?(0,i.jsx)("div",{style:w,children:(0,i.jsxs)("div",{style:{backgroundColor:"#dc3545",color:"white",padding:"20px",borderRadius:"8px",margin:"20px",textAlign:"center"},children:[(0,i.jsx)("h2",{children:"❌ Meeting Error"}),(0,i.jsx)("p",{children:y}),(0,i.jsx)("button",{onClick:()=>e.push("/setup"),style:k(),children:"\uD83D\uDD27 Run Device Setup"}),(0,i.jsx)("button",{onClick:()=>e.push("/"),style:{...k(),marginLeft:"10px"},children:"\uD83C\uDFE0 Home"})]})}):l?(0,i.jsxs)("div",{style:w,children:[(0,i.jsxs)("div",{style:{backgroundColor:"#232f3e",padding:"15px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 10px rgba(0,0,0,0.3)"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("h1",{style:{margin:0,fontSize:"24px"},children:["\uD83D\uDCF9 ",l.meetingId]}),(0,i.jsxs)("div",{style:{fontSize:"14px",opacity:.8},children:[l.userName," • ",c?"".concat(v.length+1," participants"):"Joining..."]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,i.jsx)("button",{onClick:()=>g(!f),style:k(f),children:"\uD83D\uDC65 Roster"}),(0,i.jsx)("button",{onClick:()=>h(!x),style:k(x),children:"\uD83D\uDCAC Chat"}),(0,i.jsx)("button",{onClick:S,style:{...k(),backgroundColor:"#dc3545"},children:"\uD83D\uDEAA Leave"})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:f||x?"1fr 300px":"1fr",height:"calc(100vh - 140px)",gap:"10px",padding:"10px"},children:[(0,i.jsx)("div",{style:{backgroundColor:"#ffffff",borderRadius:"10px",overflow:"hidden",position:"relative",border:"1px solid #dee2e6",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:d?(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",flexDirection:"column",gap:"20px"},children:[(0,i.jsx)("div",{style:{fontSize:"60px"},children:"⏳"}),(0,i.jsx)("div",{style:{fontSize:"24px"},children:"Joining Meeting..."}),(0,i.jsx)("div",{style:{fontSize:"16px",opacity:.7},children:"Setting up audio and video connections"})]}):c?(0,i.jsx)(a.MB9,{layout:"featured",noRemoteVideoView:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",flexDirection:"column",color:"#6c757d"},children:[(0,i.jsx)("div",{style:{fontSize:"60px",marginBottom:"20px"},children:"\uD83D\uDC64"}),(0,i.jsx)("div",{style:{fontSize:"24px"},children:"Waiting for participants..."}),(0,i.jsxs)("div",{style:{fontSize:"16px",marginTop:"10px"},children:["Share the meeting ID: ",(0,i.jsx)("strong",{children:l.meetingId})]})]})}):(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:(0,i.jsx)("div",{style:{fontSize:"24px"},children:"Preparing meeting..."})})}),(f||x)&&(0,i.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:"10px",padding:"20px",overflowY:"auto",border:"1px solid #dee2e6",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:[f&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{style:{marginTop:0,color:"#212529"},children:"\uD83D\uDC65 Participants"}),(0,i.jsx)(a.ZLk,{})]}),x&&(0,i.jsxs)("div",{style:{marginTop:f?"30px":"0"},children:[(0,i.jsx)("h3",{style:{marginTop:0,color:"#212529"},children:"\uD83D\uDCAC Chat"}),(0,i.jsx)("div",{style:{color:"#6c757d",textAlign:"center",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:"\uD83D\uDCAC Chat feature ready for Component Library integration"})]})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:"15px 20px",display:"flex",justifyContent:"center",gap:"15px",alignItems:"center",borderTop:"1px solid #dee2e6",boxShadow:"0 -2px 10px rgba(0,0,0,0.1)"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"15px",alignItems:"center",padding:"10px 20px",backgroundColor:"white",borderRadius:"8px",border:"1px solid #dee2e6",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,i.jsx)(a._nn,{}),(0,i.jsx)(a.Zr5,{}),(0,i.jsx)(a.Eid,{}),(0,i.jsx)(a.aUr,{}),(0,i.jsx)(a.jSZ,{})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center",marginLeft:"20px",fontSize:"14px",padding:"8px 16px",backgroundColor:"white",borderRadius:"6px",border:"1px solid #dee2e6"},children:[(0,i.jsxs)("span",{style:{color:b?"#dc3545":"#28a745",display:"flex",alignItems:"center",gap:"4px"},children:[b?"\uD83D\uDD07":"\uD83C\uDFA4",(0,i.jsx)("span",{style:{fontSize:"12px",color:"#6c757d"},children:b?"Muted":"Live"})]}),(0,i.jsxs)("span",{style:{color:j?"#28a745":"#dc3545",display:"flex",alignItems:"center",gap:"4px"},children:[j?"\uD83D\uDCF9":"\uD83D\uDCF9\uD83D\uDEAB",(0,i.jsx)("span",{style:{fontSize:"12px",color:"#6c757d"},children:j?"Video":"No Video"})]}),_&&(0,i.jsxs)("span",{style:{color:"#007bff",display:"flex",alignItems:"center",gap:"4px"},children:["\uD83D\uDDA5️ ",(0,i.jsx)("span",{style:{fontSize:"12px",color:"#6c757d"},children:"Sharing"})]})]})]})]}):(0,i.jsx)("div",{style:w,children:(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px"},children:[(0,i.jsx)("div",{style:{fontSize:"40px",marginBottom:"15px"},children:"⏳"}),(0,i.jsx)("div",{children:"Loading setup data..."})]})})}function c(){return(0,i.jsx)(a.lUb,{children:(0,i.jsx)(d,{})})}},5152:function(e,t,n){e.exports=n(2602)},1163:function(e,t,n){e.exports=n(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=2281)}),_N_E=e.O()}]);