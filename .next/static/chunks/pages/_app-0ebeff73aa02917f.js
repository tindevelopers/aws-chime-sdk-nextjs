(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6117:function(e,t,i){"use strict";let r,n;i.r(t),i.d(t,{$Command:function(){return nQ},AllowNotifications:function(){return oA},AssociateChannelFlowCommand:function(){return dI},BadRequestException:function(){return oP},BatchChannelMembershipsFilterSensitiveLog:function(){return oY},BatchCreateChannelMembershipCommand:function(){return dE},BatchCreateChannelMembershipResponseFilterSensitiveLog:function(){return o0},ChannelAssociatedWithFlowSummaryFilterSensitiveLog:function(){return o2},ChannelBanFilterSensitiveLog:function(){return o3},ChannelBanSummaryFilterSensitiveLog:function(){return o5},ChannelFilterSensitiveLog:function(){return o1},ChannelFlowCallbackCommand:function(){return dA},ChannelFlowCallbackRequestFilterSensitiveLog:function(){return se},ChannelFlowFilterSensitiveLog:function(){return o6},ChannelFlowSummaryFilterSensitiveLog:function(){return st},ChannelMembershipFilterSensitiveLog:function(){return si},ChannelMembershipForAppInstanceUserSummaryFilterSensitiveLog:function(){return sn},ChannelMembershipPreferencesFilterSensitiveLog:function(){return ss},ChannelMembershipSummaryFilterSensitiveLog:function(){return sa},ChannelMembershipType:function(){return oM},ChannelMessageCallbackFilterSensitiveLog:function(){return o9},ChannelMessageFilterSensitiveLog:function(){return sl},ChannelMessagePersistenceType:function(){return oW},ChannelMessageStatus:function(){return oG},ChannelMessageSummaryFilterSensitiveLog:function(){return sd},ChannelMessageType:function(){return oK},ChannelMode:function(){return oU},ChannelModeratedByAppInstanceUserSummaryFilterSensitiveLog:function(){return sc},ChannelModeratorFilterSensitiveLog:function(){return su},ChannelModeratorSummaryFilterSensitiveLog:function(){return sh},ChannelPrivacy:function(){return oj},ChannelSummaryFilterSensitiveLog:function(){return sr},ChimeSDKMessaging:function(){return cf},ChimeSDKMessagingClient:function(){return ny},ChimeSDKMessagingServiceException:function(){return oI},ConflictException:function(){return o_},CreateChannelBanCommand:function(){return dM},CreateChannelBanResponseFilterSensitiveLog:function(){return sm},CreateChannelCommand:function(){return dO},CreateChannelFlowCommand:function(){return dP},CreateChannelFlowRequestFilterSensitiveLog:function(){return sg},CreateChannelMembershipCommand:function(){return d_},CreateChannelMembershipResponseFilterSensitiveLog:function(){return sv},CreateChannelModeratorCommand:function(){return dx},CreateChannelModeratorResponseFilterSensitiveLog:function(){return sb},CreateChannelRequestFilterSensitiveLog:function(){return sp},DeleteChannelBanCommand:function(){return dR},DeleteChannelCommand:function(){return dD},DeleteChannelFlowCommand:function(){return dN},DeleteChannelMembershipCommand:function(){return dL},DeleteChannelMessageCommand:function(){return dF},DeleteChannelModeratorCommand:function(){return dV},DeleteMessagingStreamingConfigurationsCommand:function(){return dB},DescribeChannelBanCommand:function(){return dU},DescribeChannelBanResponseFilterSensitiveLog:function(){return sS},DescribeChannelCommand:function(){return dj},DescribeChannelFlowCommand:function(){return d$},DescribeChannelFlowResponseFilterSensitiveLog:function(){return sw},DescribeChannelMembershipCommand:function(){return dz},DescribeChannelMembershipForAppInstanceUserCommand:function(){return dH},DescribeChannelMembershipForAppInstanceUserResponseFilterSensitiveLog:function(){return sk},DescribeChannelMembershipResponseFilterSensitiveLog:function(){return sC},DescribeChannelModeratedByAppInstanceUserCommand:function(){return dW},DescribeChannelModeratedByAppInstanceUserResponseFilterSensitiveLog:function(){return sT},DescribeChannelModeratorCommand:function(){return dG},DescribeChannelModeratorResponseFilterSensitiveLog:function(){return sI},DescribeChannelResponseFilterSensitiveLog:function(){return sy},DisassociateChannelFlowCommand:function(){return dK},ErrorCode:function(){return oO},ExpirationCriterion:function(){return oB},FallbackAction:function(){return oz},ForbiddenException:function(){return ox},GetChannelMembershipPreferencesCommand:function(){return dq},GetChannelMembershipPreferencesResponseFilterSensitiveLog:function(){return sE},GetChannelMessageCommand:function(){return dJ},GetChannelMessageResponseFilterSensitiveLog:function(){return sA},GetChannelMessageStatusCommand:function(){return dQ},GetMessagingSessionEndpointCommand:function(){return dZ},GetMessagingStreamingConfigurationsCommand:function(){return dX},IdentityFilterSensitiveLog:function(){return oX},InvocationType:function(){return o$},ListChannelBansCommand:function(){return dY},ListChannelBansRequestFilterSensitiveLog:function(){return sM},ListChannelBansResponseFilterSensitiveLog:function(){return sO},ListChannelFlowsCommand:function(){return d0},ListChannelFlowsRequestFilterSensitiveLog:function(){return sP},ListChannelFlowsResponseFilterSensitiveLog:function(){return s_},ListChannelMembershipsCommand:function(){return d1},ListChannelMembershipsForAppInstanceUserCommand:function(){return d2},ListChannelMembershipsForAppInstanceUserRequestFilterSensitiveLog:function(){return sD},ListChannelMembershipsForAppInstanceUserResponseFilterSensitiveLog:function(){return sN},ListChannelMembershipsRequestFilterSensitiveLog:function(){return sx},ListChannelMembershipsResponseFilterSensitiveLog:function(){return sR},ListChannelMessagesCommand:function(){return d3},ListChannelMessagesRequestFilterSensitiveLog:function(){return sL},ListChannelMessagesResponseFilterSensitiveLog:function(){return sF},ListChannelModeratorsCommand:function(){return d5},ListChannelModeratorsRequestFilterSensitiveLog:function(){return sV},ListChannelModeratorsResponseFilterSensitiveLog:function(){return sB},ListChannelsAssociatedWithChannelFlowCommand:function(){return d4},ListChannelsAssociatedWithChannelFlowRequestFilterSensitiveLog:function(){return s$},ListChannelsAssociatedWithChannelFlowResponseFilterSensitiveLog:function(){return sz},ListChannelsCommand:function(){return d6},ListChannelsModeratedByAppInstanceUserCommand:function(){return d8},ListChannelsModeratedByAppInstanceUserRequestFilterSensitiveLog:function(){return sH},ListChannelsModeratedByAppInstanceUserResponseFilterSensitiveLog:function(){return sW},ListChannelsRequestFilterSensitiveLog:function(){return sU},ListChannelsResponseFilterSensitiveLog:function(){return sj},ListSubChannelsCommand:function(){return d7},ListSubChannelsRequestFilterSensitiveLog:function(){return sG},ListSubChannelsResponseFilterSensitiveLog:function(){return sK},ListTagsForResourceCommand:function(){return d9},ListTagsForResourceResponseFilterSensitiveLog:function(){return sq},MessageAttributeValueFilterSensitiveLog:function(){return o8},MessagingDataType:function(){return oq},NotFoundException:function(){return oR},ProcessorFilterSensitiveLog:function(){return o4},PushNotificationConfigurationFilterSensitiveLog:function(){return o7},PushNotificationPreferencesFilterSensitiveLog:function(){return so},PushNotificationType:function(){return oH},PutChannelExpirationSettingsCommand:function(){return ce},PutChannelMembershipPreferencesCommand:function(){return ct},PutChannelMembershipPreferencesRequestFilterSensitiveLog:function(){return sJ},PutChannelMembershipPreferencesResponseFilterSensitiveLog:function(){return sQ},PutMessagingStreamingConfigurationsCommand:function(){return ci},RedactChannelMessageCommand:function(){return cr},ResourceLimitExceededException:function(){return oV},SearchChannelsCommand:function(){return cn},SearchChannelsRequestFilterSensitiveLog:function(){return sZ},SearchChannelsResponseFilterSensitiveLog:function(){return sX},SearchFieldKey:function(){return oQ},SearchFieldOperator:function(){return oZ},SendChannelMessageCommand:function(){return co},SendChannelMessageRequestFilterSensitiveLog:function(){return sY},ServiceFailureException:function(){return oD},ServiceUnavailableException:function(){return oN},SortOrder:function(){return oJ},TagFilterSensitiveLog:function(){return sf},TagResourceCommand:function(){return cs},TagResourceRequestFilterSensitiveLog:function(){return s0},ThrottledClientException:function(){return oL},UnauthorizedClientException:function(){return oF},UntagResourceCommand:function(){return ca},UntagResourceRequestFilterSensitiveLog:function(){return s1},UpdateChannelCommand:function(){return cl},UpdateChannelFlowCommand:function(){return cd},UpdateChannelFlowRequestFilterSensitiveLog:function(){return s3},UpdateChannelMessageCommand:function(){return cc},UpdateChannelMessageRequestFilterSensitiveLog:function(){return s5},UpdateChannelReadMarkerCommand:function(){return cu},UpdateChannelRequestFilterSensitiveLog:function(){return s2},__Client:function(){return tg},paginateListChannelBans:function(){return cv},paginateListChannelFlows:function(){return cb},paginateListChannelMemberships:function(){return cS},paginateListChannelMembershipsForAppInstanceUser:function(){return cy},paginateListChannelMessages:function(){return cw},paginateListChannelModerators:function(){return cC},paginateListChannels:function(){return cI},paginateListChannelsAssociatedWithChannelFlow:function(){return ck},paginateListChannelsModeratedByAppInstanceUser:function(){return cT},paginateListSubChannels:function(){return cE},paginateSearchChannels:function(){return cA}});class o{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?":"!==e.protocol.slice(-1)?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?"/"!==e.path.charAt(0)?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){let t=new o({...e,headers:{...e.headers}});return t.query&&(t.query=s(t.query)),t}static isInstance(e){if(!e)return!1;let t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&"object"==typeof t.query&&"object"==typeof t.headers}clone(){return o.clone(this)}}function s(e){return Object.keys(e).reduce((t,i)=>{let r=e[i];return{...t,[i]:Array.isArray(r)?[...r]:r}},{})}function a(e){return e}let l=e=>t=>async i=>{if(!o.isInstance(i.request))return t(i);let{request:r}=i,{handlerProtocol:n=""}=e.requestHandler.metadata||{};if(n.indexOf("h2")>=0&&!r.headers[":authority"])delete r.headers.host,r.headers[":authority"]=r.hostname+(r.port?":"+r.port:"");else if(!r.headers.host){let e=r.hostname;null!=r.port&&(e+=`:${r.port}`),r.headers.host=e}return t(i)},d={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},c=e=>({applyToStack:t=>{t.add(l(e),d)}}),u=()=>(e,t)=>async i=>{try{let r=await e(i),{clientName:n,commandName:o,logger:s,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:l,overrideOutputFilterSensitiveLog:d}=a,c=l??t.inputFilterSensitiveLog,u=d??t.outputFilterSensitiveLog,{$metadata:h,...f}=r.output;return s?.info?.({clientName:n,commandName:o,input:c(i.input),output:u(f),metadata:h}),r}catch(l){let{clientName:e,commandName:r,logger:n,dynamoDbDocumentClientOptions:o={}}=t,{overrideInputFilterSensitiveLog:s}=o,a=s??t.inputFilterSensitiveLog;throw n?.error?.({clientName:e,commandName:r,input:a(i.input),error:l,metadata:l.$metadata}),l}},h={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},f=e=>({applyToStack:e=>{e.add(u(),h)}});var p,m,g,v,b,y=i(3454);let S="X-Amzn-Trace-Id",w="AWS_LAMBDA_FUNCTION_NAME",C="_X_AMZN_TRACE_ID",k=e=>t=>async i=>{let{request:r}=i;if(!o.isInstance(r)||"node"!==e.runtime)return t(i);let n=Object.keys(r.headers??{}).find(e=>e.toLowerCase()===S.toLowerCase())??S;if(r.headers.hasOwnProperty(n))return t(i);let s=y.env[w],a=y.env[C],l=e=>"string"==typeof e&&e.length>0;return l(s)&&l(a)&&(r.headers[S]=a),t({...i,request:r})},T={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},I=e=>({applyToStack:t=>{t.add(k(e),T)}}),E=e=>{if("function"==typeof e)return e;let t=Promise.resolve(e);return()=>t},A=void 0;function M(e){return void 0===e||"string"==typeof e&&e.length<=50}function O(e){let t=E(e.userAgentAppId??A),{customUserAgent:i}=e;return Object.assign(e,{customUserAgent:"string"==typeof i?[[i]]:i,userAgentAppId:async()=>{let i=await t();if(!M(i)){let t=e.logger?.constructor?.name!=="NoOpLogger"&&e.logger?e.logger:console;"string"!=typeof i?t?.warn("userAgentAppId must be a string or undefined."):i.length>50&&t?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return i}})}let P={},_=RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),x=(e,t=!1)=>{if(!t)return _.test(e);for(let t of e.split("."))if(!x(t))return!1;return!0},R=RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),D=e=>R.test(e)||e.startsWith("[")&&e.endsWith("]"),N=(e,t=!1)=>{if(t){for(let t of e.split("."))if(!N(t))return!1;return!0}return!(!x(e)||e.length<3||e.length>63||e!==e.toLowerCase()||D(e))},L=":",F="/",V=e=>{let t=e.split(L);if(t.length<6)return null;let[i,r,n,o,s,...a]=t;return"arn"!==i||""===r||""===n||""===a.join(L)?null:{partition:r,service:n,region:o,accountId:s,resourceId:a.map(e=>e.split(F)).flat()}},B=JSON.parse('{"partitions":[{"id":"aws","outputs":{"dnsSuffix":"amazonaws.com","dualStackDnsSuffix":"api.aws","implicitGlobalRegion":"us-east-1","name":"aws","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^(us|eu|ap|sa|ca|me|af|il|mx)\\\\-\\\\w+\\\\-\\\\d+$","regions":{"af-south-1":{"description":"Africa (Cape Town)"},"ap-east-1":{"description":"Asia Pacific (Hong Kong)"},"ap-east-2":{"description":"Asia Pacific (Taipei)"},"ap-northeast-1":{"description":"Asia Pacific (Tokyo)"},"ap-northeast-2":{"description":"Asia Pacific (Seoul)"},"ap-northeast-3":{"description":"Asia Pacific (Osaka)"},"ap-south-1":{"description":"Asia Pacific (Mumbai)"},"ap-south-2":{"description":"Asia Pacific (Hyderabad)"},"ap-southeast-1":{"description":"Asia Pacific (Singapore)"},"ap-southeast-2":{"description":"Asia Pacific (Sydney)"},"ap-southeast-3":{"description":"Asia Pacific (Jakarta)"},"ap-southeast-4":{"description":"Asia Pacific (Melbourne)"},"ap-southeast-5":{"description":"Asia Pacific (Malaysia)"},"ap-southeast-6":{"description":"Asia Pacific (New Zealand)"},"ap-southeast-7":{"description":"Asia Pacific (Thailand)"},"aws-global":{"description":"aws global region"},"ca-central-1":{"description":"Canada (Central)"},"ca-west-1":{"description":"Canada West (Calgary)"},"eu-central-1":{"description":"Europe (Frankfurt)"},"eu-central-2":{"description":"Europe (Zurich)"},"eu-north-1":{"description":"Europe (Stockholm)"},"eu-south-1":{"description":"Europe (Milan)"},"eu-south-2":{"description":"Europe (Spain)"},"eu-west-1":{"description":"Europe (Ireland)"},"eu-west-2":{"description":"Europe (London)"},"eu-west-3":{"description":"Europe (Paris)"},"il-central-1":{"description":"Israel (Tel Aviv)"},"me-central-1":{"description":"Middle East (UAE)"},"me-south-1":{"description":"Middle East (Bahrain)"},"mx-central-1":{"description":"Mexico (Central)"},"sa-east-1":{"description":"South America (Sao Paulo)"},"us-east-1":{"description":"US East (N. Virginia)"},"us-east-2":{"description":"US East (Ohio)"},"us-west-1":{"description":"US West (N. California)"},"us-west-2":{"description":"US West (Oregon)"}}},{"id":"aws-cn","outputs":{"dnsSuffix":"amazonaws.com.cn","dualStackDnsSuffix":"api.amazonwebservices.com.cn","implicitGlobalRegion":"cn-northwest-1","name":"aws-cn","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^cn\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-cn-global":{"description":"aws-cn global region"},"cn-north-1":{"description":"China (Beijing)"},"cn-northwest-1":{"description":"China (Ningxia)"}}},{"id":"aws-eusc","outputs":{"dnsSuffix":"amazonaws.eu","dualStackDnsSuffix":"api.amazonwebservices.eu","implicitGlobalRegion":"eusc-de-east-1","name":"aws-eusc","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^eusc\\\\-(de)\\\\-\\\\w+\\\\-\\\\d+$","regions":{"eusc-de-east-1":{"description":"EU (Germany)"}}},{"id":"aws-iso","outputs":{"dnsSuffix":"c2s.ic.gov","dualStackDnsSuffix":"api.aws.ic.gov","implicitGlobalRegion":"us-iso-east-1","name":"aws-iso","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-iso\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-global":{"description":"aws-iso global region"},"us-iso-east-1":{"description":"US ISO East"},"us-iso-west-1":{"description":"US ISO WEST"}}},{"id":"aws-iso-b","outputs":{"dnsSuffix":"sc2s.sgov.gov","dualStackDnsSuffix":"api.aws.scloud","implicitGlobalRegion":"us-isob-east-1","name":"aws-iso-b","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-isob\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-b-global":{"description":"aws-iso-b global region"},"us-isob-east-1":{"description":"US ISOB East (Ohio)"}}},{"id":"aws-iso-e","outputs":{"dnsSuffix":"cloud.adc-e.uk","dualStackDnsSuffix":"api.cloud-aws.adc-e.uk","implicitGlobalRegion":"eu-isoe-west-1","name":"aws-iso-e","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^eu\\\\-isoe\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-e-global":{"description":"aws-iso-e global region"},"eu-isoe-west-1":{"description":"EU ISOE West"}}},{"id":"aws-iso-f","outputs":{"dnsSuffix":"csp.hci.ic.gov","dualStackDnsSuffix":"api.aws.hci.ic.gov","implicitGlobalRegion":"us-isof-south-1","name":"aws-iso-f","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-isof\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-f-global":{"description":"aws-iso-f global region"},"us-isof-east-1":{"description":"US ISOF EAST"},"us-isof-south-1":{"description":"US ISOF SOUTH"}}},{"id":"aws-us-gov","outputs":{"dnsSuffix":"amazonaws.com","dualStackDnsSuffix":"api.aws","implicitGlobalRegion":"us-gov-west-1","name":"aws-us-gov","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^us\\\\-gov\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-us-gov-global":{"description":"aws-us-gov global region"},"us-gov-east-1":{"description":"AWS GovCloud (US-East)"},"us-gov-west-1":{"description":"AWS GovCloud (US-West)"}}}],"version":"1.1"}'),U="",j=()=>U,$={isVirtualHostableS3Bucket:N,parseArn:V,partition:e=>{let{partitions:t}=B;for(let i of t){let{regions:t,outputs:r}=i;for(let[i,n]of Object.entries(t))if(i===e)return{...r,...n}}for(let i of t){let{regionRegex:t,outputs:r}=i;if(new RegExp(t).test(e))return{...r}}let i=t.find(e=>"aws"===e.id);if(!i)throw Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...i.outputs}}};function z(e,t,i){e.__aws_sdk_context?e.__aws_sdk_context.features||(e.__aws_sdk_context.features={}):e.__aws_sdk_context={features:{}},e.__aws_sdk_context.features[t]=i}P.aws=$;let H=/\d{12}\.ddb/;async function W(e,t,i){let r=i.request;if(r?.headers?.["smithy-protocol"]==="rpc-v2-cbor"&&z(e,"PROTOCOL_RPC_V2_CBOR","M"),"function"==typeof t.retryStrategy){let i=await t.retryStrategy();"function"==typeof i.acquireInitialRetryToken?i.constructor?.name?.includes("Adaptive")?z(e,"RETRY_MODE_ADAPTIVE","F"):z(e,"RETRY_MODE_STANDARD","E"):z(e,"RETRY_MODE_LEGACY","D")}if("function"==typeof t.accountIdEndpointMode){let i=e.endpointV2;switch(String(i?.url?.hostname).match(H)&&z(e,"ACCOUNT_ID_ENDPOINT","O"),await t.accountIdEndpointMode?.()){case"disabled":z(e,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":z(e,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":z(e,"ACCOUNT_ID_MODE_REQUIRED","R")}}let n=e.__smithy_context?.selectedHttpAuthScheme?.identity;if(n?.$source){let t=n;for(let[i,r]of(t.accountId&&z(e,"RESOLVED_ACCOUNT_ID","T"),Object.entries(t.$source??{})))z(e,i,r)}}let G="user-agent",K="x-amz-user-agent",q=" ",J="/",Q=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,Z=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,X="-",Y=1024;function ee(e){let t="";for(let i in e){let r=e[i];if(t.length+r.length+1<=Y){t.length?t+=","+r:t+=r;continue}break}return t}let et=e=>(t,i)=>async r=>{let{request:n}=r;if(!o.isInstance(n))return t(r);let{headers:s}=n,a=i?.userAgent?.map(ei)||[],l=(await e.defaultUserAgentProvider()).map(ei);await W(i,e,r);let d=i;l.push(`m/${ee(Object.assign({},i.__smithy_context?.features,d.__aws_sdk_context?.features))}`);let c=e?.customUserAgent?.map(ei)||[],u=await e.userAgentAppId();u&&l.push(ei([`app/${u}`]));let h=j(),f=(h?[h]:[]).concat([...l,...a,...c]).join(q),p=[...l.filter(e=>e.startsWith("aws-sdk-")),...c].join(q);return"browser"!==e.runtime?(p&&(s[K]=s[K]?`${s[G]} ${p}`:p),s[G]=f):s[K]=f,t({...r,request:n})},ei=e=>{let t=e[0].split(J).map(e=>e.replace(Q,X)).join(J),i=e[1]?.replace(Z,X),r=t.indexOf(J),n=t.substring(0,r),o=t.substring(r+1);return"api"===n&&(o=o.toLowerCase()),[n,o,i].filter(e=>e&&e.length>0).reduce((e,t,i)=>{switch(i){case 0:return t;case 1:return`${e}/${t}`;default:return`${e}#${t}`}},"")},er={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},en=e=>({applyToStack:t=>{t.add(et(e),er)}}),eo=e=>"string"==typeof e&&(e.startsWith("fips-")||e.endsWith("-fips")),es=e=>eo(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e,ea=e=>{let{region:t,useFipsEndpoint:i}=e;if(!t)throw Error("Region is missing");return Object.assign(e,{region:async()=>"string"==typeof t?es(t):es(await t()),useFipsEndpoint:async()=>!!eo("string"==typeof t?t:await t())||("function"!=typeof i?Promise.resolve(!!i):i())})},el="__smithy_context",ed=e=>e[el]||(e[el]={}),ec=(e,t)=>{if(!t||0===t.length)return e;let i=[];for(let r of t)for(let t of e)t.schemeId.split("#")[1]===r&&i.push(t);for(let t of e)i.find(({schemeId:e})=>e===t.schemeId)||i.push(t);return i};function eu(e){let t=new Map;for(let i of e)t.set(i.schemeId,i);return t}let eh=(e,t)=>(i,r)=>async n=>{let o=ec(e.httpAuthSchemeProvider(await t.httpAuthSchemeParametersProvider(e,r,n.input)),e.authSchemePreference?await e.authSchemePreference():[]),s=eu(e.httpAuthSchemes),a=ed(r),l=[];for(let i of o){let n=s.get(i.schemeId);if(!n){l.push(`HttpAuthScheme \`${i.schemeId}\` was not enabled for this service.`);continue}let o=n.identityProvider(await t.identityProviderConfigProvider(e));if(!o){l.push(`HttpAuthScheme \`${i.schemeId}\` did not have an IdentityProvider configured.`);continue}let{identityProperties:d={},signingProperties:c={}}=i.propertiesExtractor?.(e,r)||{};i.identityProperties=Object.assign(i.identityProperties||{},d),i.signingProperties=Object.assign(i.signingProperties||{},c),a.selectedHttpAuthScheme={httpAuthOption:i,identity:await o(i.identityProperties),signer:n.signer};break}if(!a.selectedHttpAuthScheme)throw Error(l.join("\n"));return i(n)},ef={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},ep=(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:i})=>({applyToStack:r=>{r.addRelativeTo(eh(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:i}),ef)}});class em{constructor(e){for(let[t,i]of(this.authSchemes=new Map,Object.entries(e)))void 0!==i&&this.authSchemes.set(t,i)}getIdentityProvider(e){return this.authSchemes.get(e)}}let eg=e=>e=>{throw e},ev=(e,t)=>{},eb=e=>(e,t)=>async i=>{if(!o.isInstance(i.request))return e(i);let r=ed(t).selectedHttpAuthScheme;if(!r)throw Error("No HttpAuthScheme was selected: unable to sign request");let{httpAuthOption:{signingProperties:n={}},identity:s,signer:a}=r,l=await e({...i,request:await a.sign(i.request,s,n)}).catch((a.errorHandler||eg)(n));return(a.successHandler||ev)(l.response,n),l},ey={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},eS=e=>({applyToStack:t=>{t.addRelativeTo(eb(e),ey)}}),ew="content-length";function eC(e){return t=>async i=>{let r=i.request;if(o.isInstance(r)){let{body:t,headers:i}=r;if(t&&-1===Object.keys(i).map(e=>e.toLowerCase()).indexOf(ew))try{let i=e(t);r.headers={...r.headers,[ew]:String(i)}}catch(e){}}return t({...i,request:r})}}let ek={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},eT=e=>({applyToStack:t=>{t.add(eC(e.bodyLengthChecker),ek)}}),eI=e=>{if("function"==typeof e)return e;let t=Promise.resolve(e);return()=>t},eE=async e=>void 0;function eA(e){let t={};if(e=e.replace(/^\?/,""))for(let i of e.split("&")){let[e,r=null]=i.split("=");e=decodeURIComponent(e),r&&(r=decodeURIComponent(r)),e in t?Array.isArray(t[e])?t[e].push(r):t[e]=[t[e],r]:t[e]=r}return t}let eM=e=>{let t;if("string"==typeof e)return eM(new URL(e));let{hostname:i,pathname:r,port:n,protocol:o,search:s}=e;return s&&(t=eA(s)),{hostname:i,port:n?parseInt(n):void 0,protocol:o,path:r,query:t}},eO=e=>"object"==typeof e?"url"in e?eM(e.url):e:eM(e),eP=e=>{let t;let i=e.tls??!0,{endpoint:r,useDualstackEndpoint:n,useFipsEndpoint:o}=e,s=Object.assign(e,{endpoint:null!=r?async()=>eO(await eI(r)()):void 0,tls:i,isCustomEndpoint:!!r,useDualstackEndpoint:eI(n??!1),useFipsEndpoint:eI(o??!1)});return s.serviceConfiguredEndpoint=async()=>(e.serviceId&&!t&&(t=eE(e.serviceId)),t),s};!function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"}(p||(p={}));let e_=3,ex=p.STANDARD,eR=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],eD=["TimeoutError","RequestTimeout","RequestTimeoutException"],eN=[500,502,503,504],eL=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],eF=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],eV=e=>e.$metadata?.clockSkewCorrected,eB=e=>{let t=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return!!(e&&e instanceof TypeError)&&t.has(e.message)},eU=e=>e.$metadata?.httpStatusCode===429||eR.includes(e.name)||e.$retryable?.throttling==!0,ej=(e,t=0)=>eV(e)||eD.includes(e.name)||eL.includes(e?.code||"")||eF.includes(e?.code||"")||eN.includes(e.$metadata?.httpStatusCode||0)||eB(e)||void 0!==e.cause&&t<=10&&ej(e.cause,t+1),e$=e=>{if(e.$metadata?.httpStatusCode!==void 0){let t=e.$metadata.httpStatusCode;if(500<=t&&t<=599&&!ej(e))return!0}return!1};class ez{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=e?.beta??.7,this.minCapacity=e?.minCapacity??1,this.minFillRate=e?.minFillRate??.5,this.scaleConstant=e?.scaleConstant??.4,this.smooth=e?.smooth??.8;let t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){let t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(e=>ez.setTimeoutFn(e,t))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){let e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}let t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),eU(e)){let e=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=e,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(e),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());let i=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(i)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){let e=Math.floor(2*this.getCurrentTimeInSeconds())/2;if(this.requestCount++,e>this.lastTxRateBucket){let t=this.requestCount/(e-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(t*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=e}}getPrecise(e){return parseFloat(e.toFixed(8))}}ez.setTimeoutFn=setTimeout;let eH=100,eW=2e4,eG=500,eK=500,eq=5,eJ=10,eQ=1,eZ="amz-sdk-invocation-id",eX="amz-sdk-request",eY=()=>{let e=eH;return{computeNextBackoffDelay:t=>Math.floor(Math.min(eW,Math.random()*2**t*e)),setDelayBase:t=>{e=t}}},e0=({retryDelay:e,retryCount:t,retryCost:i})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(eW,e),getRetryCost:()=>i});class e1{constructor(e){this.maxAttempts=e,this.mode=p.STANDARD,this.capacity=eK,this.retryBackoffStrategy=eY(),this.maxAttemptsProvider="function"==typeof e?e:async()=>e}async acquireInitialRetryToken(e){return e0({retryDelay:eH,retryCount:0})}async refreshRetryTokenForRetry(e,t){let i=await this.getMaxAttempts();if(this.shouldRetry(e,t,i)){let i=t.errorType;this.retryBackoffStrategy.setDelayBase("THROTTLING"===i?eG:eH);let r=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),n=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,r):r,o=this.getCapacityCost(i);return this.capacity-=o,e0({retryDelay:n,retryCount:e.getRetryCount()+1,retryCost:o})}throw Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(eK,this.capacity+(e.getRetryCost()??eQ))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch(e){return console.warn(`Max attempts provider could not resolve. Using default of ${e_}`),e_}}shouldRetry(e,t,i){return e.getRetryCount()+1<i&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return"TRANSIENT"===e?eJ:eq}isRetryableError(e){return"THROTTLING"===e||"TRANSIENT"===e}}class e2{constructor(e,t){this.maxAttemptsProvider=e,this.mode=p.ADAPTIVE;let{rateLimiter:i}=t??{};this.rateLimiter=i??new ez,this.standardRetryStrategy=new e1(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}let e3=e=>{let{retryStrategy:t,retryMode:i,maxAttempts:r}=e,n=eI(r??e_);return Object.assign(e,{maxAttempts:n,retryStrategy:async()=>t||(await eI(i)()===p.ADAPTIVE?new e2(n):new e1(n))})};class e5{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;let t=e;return"number"==typeof t.statusCode&&"object"==typeof t.headers}}class e4{trace(){}debug(){}info(){}warn(){}error(){}}var e6={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let e8=new Uint8Array(16);function e7(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(e8)}let e9=[];for(let e=0;e<256;++e)e9.push((e+256).toString(16).slice(1));function te(e,t=0){return e9[e[t+0]]+e9[e[t+1]]+e9[e[t+2]]+e9[e[t+3]]+"-"+e9[e[t+4]]+e9[e[t+5]]+"-"+e9[e[t+6]]+e9[e[t+7]]+"-"+e9[e[t+8]]+e9[e[t+9]]+"-"+e9[e[t+10]]+e9[e[t+11]]+e9[e[t+12]]+e9[e[t+13]]+e9[e[t+14]]+e9[e[t+15]]}var tt=function(e,t,i){if(e6.randomUUID&&!t&&!e)return e6.randomUUID();let r=(e=e||{}).random||(e.rng||e7)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){i=i||0;for(let e=0;e<16;++e)t[i+e]=r[e];return t}return te(r)};let ti=e=>e?.body instanceof ReadableStream,tr=e=>e instanceof Error?e:e instanceof Object?Object.assign(Error(),e):"string"==typeof e?Error(e):Error(`AWS SDK error wrapper for ${e}`),tn=e=>(t,i)=>async r=>{let n=await e.retryStrategy(),s=await e.maxAttempts();if(!to(n))return n?.mode&&(i.userAgent=[...i.userAgent||[],["cfg/retry-mode",n.mode]]),n.retry(t,r);{let e=await n.acquireInitialRetryToken(i.partition_id),a=Error(),l=0,d=0,{request:c}=r,u=o.isInstance(c);for(u&&(c.headers[eZ]=tt());;)try{u&&(c.headers[eX]=`attempt=${l+1}; max=${s}`);let{response:i,output:o}=await t(r);return n.recordSuccess(e),o.$metadata.attempts=l+1,o.$metadata.totalRetryDelay=d,{response:i,output:o}}catch(o){let t=ts(o);if(a=tr(o),u&&ti(c))throw(i.logger instanceof e4?console:i.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{e=await n.refreshRetryTokenForRetry(e,t)}catch(e){throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=l+1,a.$metadata.totalRetryDelay=d,a}l=e.getRetryCount();let r=e.getRetryDelay();d+=r,await new Promise(e=>setTimeout(e,r))}}},to=e=>void 0!==e.acquireInitialRetryToken&&void 0!==e.refreshRetryTokenForRetry&&void 0!==e.recordSuccess,ts=e=>{let t={error:e,errorType:ta(e)},i=tc(e.$response);return i&&(t.retryAfterHint=i),t},ta=e=>eU(e)?"THROTTLING":ej(e)?"TRANSIENT":e$(e)?"SERVER_ERROR":"CLIENT_ERROR",tl={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},td=e=>({applyToStack:t=>{t.add(tn(e),tl)}}),tc=e=>{if(!e5.isInstance(e))return;let t=Object.keys(e.headers).find(e=>"retry-after"===e.toLowerCase());if(!t)return;let i=e.headers[t],r=Number(i);return new Date(Number.isNaN(r)?i:1e3*r)},tu=(e,t)=>{let i=[];if(e&&i.push(e),t)for(let e of t)i.push(e);return i},th=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,tf=()=>{let e=[],t=[],i=!1,r=new Set,n=e=>e.sort((e,t)=>tp[t.step]-tp[e.step]||tm[t.priority||"normal"]-tm[e.priority||"normal"]),o=i=>{let n=!1,o=e=>{let t=tu(e.name,e.aliases);if(t.includes(i)){for(let e of(n=!0,t))r.delete(e);return!1}return!0};return e=e.filter(o),t=t.filter(o),n},s=i=>{let n=!1,o=e=>{if(e.middleware===i){for(let t of(n=!0,tu(e.name,e.aliases)))r.delete(t);return!1}return!0};return e=e.filter(o),t=t.filter(o),n},a=i=>(e.forEach(e=>{i.add(e.middleware,{...e})}),t.forEach(e=>{i.addRelativeTo(e.middleware,{...e})}),i.identifyOnResolve?.(c.identifyOnResolve()),i),l=e=>{let t=[];return e.before.forEach(e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...l(e))}),t.push(e),e.after.reverse().forEach(e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...l(e))}),t},d=(i=!1)=>{let r=[],o=[],s={};return e.forEach(e=>{let t={...e,before:[],after:[]};for(let e of tu(t.name,t.aliases))s[e]=t;r.push(t)}),t.forEach(e=>{let t={...e,before:[],after:[]};for(let e of tu(t.name,t.aliases))s[e]=t;o.push(t)}),o.forEach(e=>{if(e.toMiddleware){let t=s[e.toMiddleware];if(void 0===t){if(i)return;throw Error(`${e.toMiddleware} is not found when adding ${th(e.name,e.aliases)} middleware ${e.relation} ${e.toMiddleware}`)}"after"===e.relation&&t.after.push(e),"before"===e.relation&&t.before.push(e)}}),n(r).map(l).reduce((e,t)=>(e.push(...t),e),[])},c={add:(t,i={})=>{let{name:n,override:o,aliases:s}=i,a={step:"initialize",priority:"normal",middleware:t,...i},l=tu(n,s);if(l.length>0){if(l.some(e=>r.has(e))){if(!o)throw Error(`Duplicate middleware name '${th(n,s)}'`);for(let t of l){let i=e.findIndex(e=>e.name===t||e.aliases?.some(e=>e===t));if(-1===i)continue;let r=e[i];if(r.step!==a.step||a.priority!==r.priority)throw Error(`"${th(r.name,r.aliases)}" middleware with ${r.priority} priority in ${r.step} step cannot be overridden by "${th(n,s)}" middleware with ${a.priority} priority in ${a.step} step.`);e.splice(i,1)}}for(let e of l)r.add(e)}e.push(a)},addRelativeTo:(e,i)=>{let{name:n,override:o,aliases:s}=i,a={middleware:e,...i},l=tu(n,s);if(l.length>0){if(l.some(e=>r.has(e))){if(!o)throw Error(`Duplicate middleware name '${th(n,s)}'`);for(let e of l){let i=t.findIndex(t=>t.name===e||t.aliases?.some(t=>t===e));if(-1===i)continue;let r=t[i];if(r.toMiddleware!==a.toMiddleware||r.relation!==a.relation)throw Error(`"${th(r.name,r.aliases)}" middleware ${r.relation} "${r.toMiddleware}" middleware cannot be overridden by "${th(n,s)}" middleware ${a.relation} "${a.toMiddleware}" middleware.`);t.splice(i,1)}}for(let e of l)r.add(e)}t.push(a)},clone:()=>a(tf()),use:e=>{e.applyToStack(c)},remove:e=>"string"==typeof e?o(e):s(e),removeByTag:i=>{let n=!1,o=e=>{let{tags:t,name:o,aliases:s}=e;if(t&&t.includes(i)){for(let e of tu(o,s))r.delete(e);return n=!0,!1}return!0};return e=e.filter(o),t=t.filter(o),n},concat:e=>{let t=a(tf());return t.use(e),t.identifyOnResolve(i||t.identifyOnResolve()||(e.identifyOnResolve?.()??!1)),t},applyToStack:a,identify:()=>d(!0).map(e=>{let t=e.step??e.relation+" "+e.toMiddleware;return th(e.name,e.aliases)+" - "+t}),identifyOnResolve:e=>("boolean"==typeof e&&(i=e),i),resolve:(e,t)=>{for(let i of d().map(e=>e.middleware).reverse())e=i(e,t);return i&&console.log(c.identify()),e}};return c},tp={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},tm={high:3,normal:2,low:1};class tg{constructor(e){this.config=e,this.middlewareStack=tf()}send(e,t,i){let r;let n="function"!=typeof t?t:void 0,o="function"==typeof t?t:i;if(void 0===n&&!0===this.config.cacheMiddleware){this.handlers||(this.handlers=new WeakMap);let t=this.handlers;t.has(e.constructor)?r=t.get(e.constructor):(r=e.resolveMiddleware(this.middlewareStack,this.config,n),t.set(e.constructor,r))}else delete this.handlers,r=e.resolveMiddleware(this.middlewareStack,this.config,n);if(!o)return r(e).then(e=>e.output);r(e).then(e=>o(null,e.output),e=>o(e)).catch(()=>{})}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}function tv(e,t,i){return e.$source||(e.$source={}),e.$source[t]=i,e}let tb=(n=3e5,e=>ty(e)&&e.expiration.getTime()-Date.now()<n),ty=e=>void 0!==e.expiration,tS=(e,t,i)=>{let r,n,o;if(void 0===e)return;let s="function"!=typeof e?async()=>Promise.resolve(e):e,a=!1,l=async e=>{n||(n=s(e));try{r=await n,o=!0,a=!1}finally{n=void 0}return r};return void 0===t?async e=>((!o||e?.forceRefresh)&&(r=await l(e)),r):async e=>((!o||e?.forceRefresh)&&(r=await l(e)),a||(i(r)?t(r)&&await l(e):a=!0),r)},tw={},tC={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),tw[e]=t,tC[t]=e}function tk(e){if(e.length%2!=0)throw Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2){let r=e.slice(i,i+2).toLowerCase();if(r in tC)t[i/2]=tC[r];else throw Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return t}function tT(e){let t="";for(let i=0;i<e.byteLength;i++)t+=tw[e[i]];return t}let tI=e=>new TextEncoder().encode(e),tE=e=>"string"==typeof e?tI(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e),tA="X-Amz-Algorithm",tM="X-Amz-Credential",tO="X-Amz-Date",tP="X-Amz-SignedHeaders",t_="X-Amz-Expires",tx="X-Amz-Signature",tR="X-Amz-Security-Token",tD="authorization",tN=tO.toLowerCase(),tL=[tD,tN,"date"],tF=tx.toLowerCase(),tV="x-amz-content-sha256",tB=tR.toLowerCase(),tU={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},tj=/^proxy-/,t$=/^sec-/,tz="AWS4-HMAC-SHA256",tH="AWS4-HMAC-SHA256-PAYLOAD",tW="UNSIGNED-PAYLOAD",tG=50,tK="aws4_request",tq=604800,tJ={},tQ=[],tZ=(e,t,i)=>`${e}/${t}/${i}/${tK}`,tX=async(e,t,i,r,n)=>{let o=await tY(e,t.secretAccessKey,t.accessKeyId),s=`${i}:${r}:${n}:${tT(o)}:${t.sessionToken}`;if(s in tJ)return tJ[s];for(tQ.push(s);tQ.length>tG;)delete tJ[tQ.shift()];let a=`AWS4${t.secretAccessKey}`;for(let t of[i,r,n,tK])a=await tY(e,a,t);return tJ[s]=a},tY=(e,t,i)=>{let r=new e(t);return r.update(tE(i)),r.digest()},t0=({headers:e},t,i)=>{let r={};for(let n of Object.keys(e).sort()){if(void 0==e[n])continue;let o=n.toLowerCase();(!(o in tU||t?.has(o)||tj.test(o)||t$.test(o))||i&&(!i||i.has(o)))&&(r[o]=e[n].trim().replace(/\s+/g," "))}return r},t1=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),t2=async({headers:e,body:t},i)=>{for(let t of Object.keys(e))if(t.toLowerCase()===tV)return e[t];if(void 0==t)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if("string"==typeof t||ArrayBuffer.isView(t)||t1(t)){let e=new i;return e.update(tE(t)),tT(await e.digest())}return tW};class t3{format(e){let t=[];for(let i of Object.keys(e)){let r=tI(i);t.push(Uint8Array.from([r.byteLength]),r,this.formatHeaderValue(e[i]))}let i=new Uint8Array(t.reduce((e,t)=>e+t.byteLength,0)),r=0;for(let e of t)i.set(e,r),r+=e.byteLength;return i}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":let t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":let i=new DataView(new ArrayBuffer(5));return i.setUint8(0,4),i.setInt32(1,e.value,!1),new Uint8Array(i.buffer);case"long":let r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":let n=new DataView(new ArrayBuffer(3+e.value.byteLength));n.setUint8(0,6),n.setUint16(1,e.value.byteLength,!1);let o=new Uint8Array(n.buffer);return o.set(e.value,3),o;case"string":let s=tI(e.value),a=new DataView(new ArrayBuffer(3+s.byteLength));a.setUint8(0,7),a.setUint16(1,s.byteLength,!1);let l=new Uint8Array(a.buffer);return l.set(s,3),l;case"timestamp":let d=new Uint8Array(9);return d[0]=8,d.set(t4.fromNumber(e.value.valueOf()).bytes,1),d;case"uuid":if(!t5.test(e.value))throw Error(`Invalid UUID received: ${e.value}`);let c=new Uint8Array(17);return c[0]=9,c.set(tk(e.value.replace(/\-/g,"")),1),c}}}!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(m||(m={}));let t5=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class t4{constructor(e){if(this.bytes=e,8!==e.byteLength)throw Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>0x7fffffffffffffff||e<-0x8000000000000000)throw Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);let t=new Uint8Array(8);for(let i=7,r=Math.abs(Math.round(e));i>-1&&r>0;i--,r/=256)t[i]=r;return e<0&&t6(t),new t4(t)}valueOf(){let e=this.bytes.slice(0),t=128&e[0];return t&&t6(e),parseInt(tT(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function t6(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,0===e[t]);t--);}let t8=(e,t)=>{for(let i of(e=e.toLowerCase(),Object.keys(t)))if(e===i.toLowerCase())return!0;return!1},t7=(e,t={})=>{let{headers:i,query:r={}}=o.clone(e);for(let e of Object.keys(i)){let n=e.toLowerCase();("x-amz-"===n.slice(0,6)&&!t.unhoistableHeaders?.has(n)||t.hoistableHeaders?.has(n))&&(r[e]=i[e],delete i[e])}return{...e,headers:i,query:r}},t9=e=>{for(let t of Object.keys((e=o.clone(e)).headers))tL.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e},ie=e=>encodeURIComponent(e).replace(/[!'()*]/g,it),it=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,ii=({query:e={}})=>{let t=[],i={};for(let r of Object.keys(e)){if(r.toLowerCase()===tF)continue;let n=ie(r);t.push(n);let o=e[r];"string"==typeof o?i[n]=`${n}=${ie(o)}`:Array.isArray(o)&&(i[n]=o.slice(0).reduce((e,t)=>e.concat([`${n}=${ie(t)}`]),[]).sort().join("&"))}return t.sort().map(e=>i[e]).filter(e=>e).join("&")},ir=e=>io(e).toISOString().replace(/\.\d{3}Z$/,"Z"),io=e=>"number"==typeof e?new Date(1e3*e):"string"==typeof e?new Date(Number(e)?1e3*Number(e):e):e;class is{constructor({applyChecksum:e,credentials:t,region:i,service:r,sha256:n,uriEscapePath:o=!0}){this.service=r,this.sha256=n,this.uriEscapePath=o,this.applyChecksum="boolean"!=typeof e||e,this.regionProvider=eI(i),this.credentialProvider=eI(t)}createCanonicalRequest(e,t,i){let r=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${ii(e)}
${r.map(e=>`${e}:${t[e]}`).join("\n")}

${r.join(";")}
${i}`}async createStringToSign(e,t,i,r){let n=new this.sha256;n.update(tE(i));let o=await n.digest();return`${r}
${e}
${t}
${tT(o)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){let t=[];for(let i of e.split("/"))i?.length!==0&&"."!==i&&(".."===i?t.pop():t.push(i));return ie(`${e?.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&e?.endsWith("/")?"/":""}`).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if("object"!=typeof e||"string"!=typeof e.accessKeyId||"string"!=typeof e.secretAccessKey)throw Error("Resolved credential object is not valid")}formatDate(e){let t=ir(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class ia extends is{constructor({applyChecksum:e,credentials:t,region:i,service:r,sha256:n,uriEscapePath:o=!0}){super({applyChecksum:e,credentials:t,region:i,service:r,sha256:n,uriEscapePath:o}),this.headerFormatter=new t3}async presign(e,t={}){let{signingDate:i=new Date,expiresIn:r=3600,unsignableHeaders:n,unhoistableHeaders:o,signableHeaders:s,hoistableHeaders:a,signingRegion:l,signingService:d}=t,c=await this.credentialProvider();this.validateResolvedCredentials(c);let u=l??await this.regionProvider(),{longDate:h,shortDate:f}=this.formatDate(i);if(r>tq)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");let p=tZ(f,u,d??this.service),m=t7(t9(e),{unhoistableHeaders:o,hoistableHeaders:a});c.sessionToken&&(m.query[tR]=c.sessionToken),m.query[tA]=tz,m.query[tM]=`${c.accessKeyId}/${p}`,m.query[tO]=h,m.query[t_]=r.toString(10);let g=t0(m,n,s);return m.query[tP]=this.getCanonicalHeaderList(g),m.query[tx]=await this.getSignature(h,p,this.getSigningKey(c,u,f,d),this.createCanonicalRequest(m,g,await t2(e,this.sha256))),m}async sign(e,t){return"string"==typeof e?this.signString(e,t):e.headers&&e.payload?this.signEvent(e,t):e.message?this.signMessage(e,t):this.signRequest(e,t)}async signEvent({headers:e,payload:t},{signingDate:i=new Date,priorSignature:r,signingRegion:n,signingService:o}){let s=n??await this.regionProvider(),{shortDate:a,longDate:l}=this.formatDate(i),d=tZ(a,s,o??this.service),c=await t2({headers:{},body:t},this.sha256),u=new this.sha256;u.update(e);let h=[tH,l,d,r,tT(await u.digest()),c].join("\n");return this.signString(h,{signingDate:i,signingRegion:s,signingService:o})}async signMessage(e,{signingDate:t=new Date,signingRegion:i,signingService:r}){return this.signEvent({headers:this.headerFormatter.format(e.message.headers),payload:e.message.body},{signingDate:t,signingRegion:i,signingService:r,priorSignature:e.priorSignature}).then(t=>({message:e.message,signature:t}))}async signString(e,{signingDate:t=new Date,signingRegion:i,signingService:r}={}){let n=await this.credentialProvider();this.validateResolvedCredentials(n);let o=i??await this.regionProvider(),{shortDate:s}=this.formatDate(t),a=new this.sha256(await this.getSigningKey(n,o,s,r));return a.update(tE(e)),tT(await a.digest())}async signRequest(e,{signingDate:t=new Date,signableHeaders:i,unsignableHeaders:r,signingRegion:n,signingService:o}={}){let s=await this.credentialProvider();this.validateResolvedCredentials(s);let a=n??await this.regionProvider(),l=t9(e),{longDate:d,shortDate:c}=this.formatDate(t),u=tZ(c,a,o??this.service);l.headers[tN]=d,s.sessionToken&&(l.headers[tB]=s.sessionToken);let h=await t2(l,this.sha256);!t8(tV,l.headers)&&this.applyChecksum&&(l.headers[tV]=h);let f=t0(l,r,i),p=await this.getSignature(d,u,this.getSigningKey(s,a,c,o),this.createCanonicalRequest(l,f,h));return l.headers[tD]=`${tz} Credential=${s.accessKeyId}/${u}, SignedHeaders=${this.getCanonicalHeaderList(f)}, Signature=${p}`,l}async getSignature(e,t,i,r){let n=await this.createStringToSign(e,t,r,tz),o=new this.sha256(await i);return o.update(tE(n)),tT(await o.digest())}getSigningKey(e,t,i,r){return tX(this.sha256,e,i,t,r||this.service)}}let il=e=>{let t,i,r=e.credentials,n=!!e.credentials;Object.defineProperty(e,"credentials",{set(i){i&&i!==r&&i!==t&&(n=!0);let o=id(e,{credentials:r=i,credentialDefaultProvider:e.credentialDefaultProvider}),s=ic(e,o);n&&!s.attributed?((t=async e=>s(e).then(e=>tv(e,"CREDENTIALS_CODE","e"))).memoized=s.memoized,t.configBound=s.configBound,t.attributed=!0):t=s},get:()=>t,enumerable:!0,configurable:!0}),e.credentials=r;let{signingEscapePath:o=!0,systemClockOffset:s=e.systemClockOffset||0,sha256:a}=e;return i=e.signer?E(e.signer):e.regionInfoProvider?()=>E(e.region)().then(async t=>[await e.regionInfoProvider(t,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},t]).then(([t,i])=>{let{signingRegion:r,signingService:n}=t;e.signingRegion=e.signingRegion||r||i,e.signingName=e.signingName||n||e.serviceId;let s={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:a,uriEscapePath:o};return new(e.signerConstructor||ia)(s)}):async t=>{let i=(t=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await E(e.region)(),properties:{}},t)).signingRegion,r=t.signingName;e.signingRegion=e.signingRegion||i,e.signingName=e.signingName||r||e.serviceId;let n={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:a,uriEscapePath:o};return new(e.signerConstructor||ia)(n)},Object.assign(e,{systemClockOffset:s,signingEscapePath:o,signer:i})};function id(e,{credentials:t,credentialDefaultProvider:i}){let r;return(r=t?t?.memoized?t:tS(t,tb,ty):i?E(i(Object.assign({},e,{parentClientConfig:e}))):async()=>{throw Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")}).memoized=!0,r}function ic(e,t){if(t.configBound)return t;let i=async i=>t({...i,callerClientConfig:e});return i.memoized=t.memoized,i.configBound=!0,i}let iu=async(e,t,i)=>({operation:ed(t).operation,region:await eI(e.region)()||(()=>{throw Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function ih(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"chime",region:e.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}let ip=e=>{let t=[];return e.operation,t.push(ih(e)),t},im=e=>Object.assign(il(e),{authSchemePreference:eI(e.authSchemePreference??[])}),ig=e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"chime"}),iv={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};var ib={i8:"3.883.0"};let iy=e=>new TextEncoder().encode(e);var iS=i(7224).Buffer,iw=void 0!==iS&&iS.from?function(e){return iS.from(e,"utf8")}:iy;function iC(e){return e instanceof Uint8Array?e:"string"==typeof e?iw(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function ik(e){return"string"==typeof e?0===e.length:0===e.byteLength}var iT={name:"SHA-256"},iI={name:"HMAC",hash:iT},iE=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);let iA={};function iM(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:iA}var iO=function(){function e(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return e.prototype.update=function(e){if(!ik(e)){var t=iC(e),i=new Uint8Array(this.toHash.byteLength+t.byteLength);i.set(this.toHash,0),i.set(t,this.toHash.byteLength),this.toHash=i}},e.prototype.digest=function(){var e=this;return this.key?this.key.then(function(t){return iM().crypto.subtle.sign(iI,t,e.toHash).then(function(e){return new Uint8Array(e)})}):ik(this.toHash)?Promise.resolve(iE):Promise.resolve().then(function(){return iM().crypto.subtle.digest(iT,e.toHash)}).then(function(e){return Promise.resolve(new Uint8Array(e))})},e.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&void 0!==this.secret&&(this.key=new Promise(function(t,i){iM().crypto.subtle.importKey("raw",iC(e.secret),iI,!1,["sign"]).then(t,i)}),this.key.catch(function(){}))},e}();function iP(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})}function i_(e,t){var i,r,n,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(e){return function(t){return l([e,t])}}function l(a){if(i)throw TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(i=1,r&&(n=2&a[0]?r.return:a[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,a[1])).done)return n;switch(r=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}"function"==typeof SuppressedError&&SuppressedError;var ix=64,iR=32,iD=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),iN=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],iL=9007199254740991,iF=function(){function e(){this.state=Int32Array.from(iN),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw Error("Attempted to update an already finished hash.");var t=0,i=e.byteLength;if(this.bytesHashed+=i,8*this.bytesHashed>iL)throw Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=e[t++],i--,this.bufferLength===ix&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(t.setUint8(this.bufferLength++,128),i%ix>=ix-8){for(var r=this.bufferLength;r<ix;r++)t.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(var r=this.bufferLength;r<ix-8;r++)t.setUint8(r,0);t.setUint32(ix-8,Math.floor(e/4294967296),!0),t.setUint32(ix-4,e),this.hashBuffer(),this.finished=!0}for(var n=new Uint8Array(iR),r=0;r<8;r++)n[4*r]=this.state[r]>>>24&255,n[4*r+1]=this.state[r]>>>16&255,n[4*r+2]=this.state[r]>>>8&255,n[4*r+3]=this.state[r]>>>0&255;return n},e.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,i=e.state,r=i[0],n=i[1],o=i[2],s=i[3],a=i[4],l=i[5],d=i[6],c=i[7],u=0;u<ix;u++){if(u<16)this.temp[u]=(255&t[4*u])<<24|(255&t[4*u+1])<<16|(255&t[4*u+2])<<8|255&t[4*u+3];else{var h=this.temp[u-2],f=(h>>>17|h<<15)^(h>>>19|h<<13)^h>>>10,p=((h=this.temp[u-15])>>>7|h<<25)^(h>>>18|h<<14)^h>>>3;this.temp[u]=(f+this.temp[u-7]|0)+(p+this.temp[u-16]|0)}var m=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&l^~a&d)|0)+(c+(iD[u]+this.temp[u]|0)|0)|0,g=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&n^r&o^n&o)|0;c=d,d=l,l=a,a=s+m|0,s=o,o=n,n=r,r=m+g|0}i[0]+=r,i[1]+=n,i[2]+=o,i[3]+=s,i[4]+=a,i[5]+=l,i[6]+=d,i[7]+=c},e}(),iV=function(){function e(e){this.secret=e,this.hash=new iF,this.reset()}return e.prototype.update=function(e){if(!ik(e)&&!this.error)try{this.hash.update(iC(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return iP(this,void 0,void 0,function(){return i_(this,function(e){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new iF,this.secret){this.outer=new iF;var e=iB(this.secret),t=new Uint8Array(ix);t.set(e);for(var i=0;i<ix;i++)e[i]^=54,t[i]^=92;this.hash.update(e),this.outer.update(t);for(var i=0;i<e.byteLength;i++)e[i]=0}},e}();function iB(e){var t=iC(e);if(t.byteLength>ix){var i=new iF;i.update(t),t=i.digest()}var r=new Uint8Array(ix);return r.set(t),r}var iU=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function ij(e){return!!i$(e)&&"object"==typeof e.crypto.subtle&&iz(e.crypto.subtle)}function i$(e){return"object"==typeof e&&"object"==typeof e.crypto&&"function"==typeof e.crypto.getRandomValues}function iz(e){return e&&iU.every(function(t){return"function"==typeof e[t]})}var iH=function(){function e(e){ij(iM())?this.hash=new iO(e):this.hash=new iV(e)}return e.prototype.update=function(e,t){this.hash.update(iC(e))},e.prototype.digest=function(){return this.hash.digest()},e.prototype.reset=function(){this.hash.reset()},e}(),iW=i(1206),iG=i.n(iW);let iK=({serviceId:e,clientVersion:t})=>async i=>{let r="undefined"!=typeof window&&window?.navigator?.userAgent?iG().parse(window.navigator.userAgent):void 0,n=[["aws-sdk-js",t],["ua","2.1"],[`os/${r?.os?.name||"other"}`,r?.os?.version],["lang/js"],["md/browser",`${r?.browser?.name??"unknown"}_${r?.browser?.version??"unknown"}`]];e&&n.push([`api/${e}`,t]);let o=await i?.userAgentAppId?.();return o&&n.push([`app/${o}`]),n};!function(e){e.ENV="env",e.CONFIG="shared config entry"}(g||(g={}));let iq=!1,iJ=!1;function iQ(e){let t=[];for(let i of Object.keys(e).sort()){let r=e[i];if(i=ie(i),Array.isArray(r))for(let e=0,n=r.length;e<n;e++)t.push(`${i}=${ie(r[e])}`);else{let e=i;(r||"string"==typeof r)&&(e+=`=${ie(r)}`),t.push(e)}}return t.join("&")}function iZ(e,t){return new Request(e,t)}function iX(e=0){return new Promise((t,i)=>{e&&setTimeout(()=>{let t=Error(`Request did not complete within ${e} ms`);t.name="TimeoutError",i(t)},e)})}let iY={supported:void 0};class i0{static create(e){return"function"==typeof e?.handle?e:new i0(e)}constructor(e){"function"==typeof e?this.configProvider=e().then(e=>e||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),void 0===iY.supported&&(iY.supported=!!("undefined"!=typeof Request&&"keepalive"in iZ("https://[::1]")))}destroy(){}async handle(e,{abortSignal:t,requestTimeout:i}={}){this.config||(this.config=await this.configProvider);let r=i??this.config.requestTimeout,n=!0===this.config.keepAlive,o=this.config.credentials;if(t?.aborted){let e=Error("Request aborted");return e.name="AbortError",Promise.reject(e)}let s=e.path,a=iQ(e.query||{});a&&(s+=`?${a}`),e.fragment&&(s+=`#${e.fragment}`);let l="";if(null!=e.username||null!=e.password){let t=e.username??"",i=e.password??"";l=`${t}:${i}@`}let{port:d,method:c}=e,u=`${e.protocol}//${l}${e.hostname}${d?`:${d}`:""}${s}`,h="GET"===c||"HEAD"===c?void 0:e.body,f={body:h,headers:new Headers(e.headers),method:c,credentials:o};this.config?.cache&&(f.cache=this.config.cache),h&&(f.duplex="half"),"undefined"!=typeof AbortController&&(f.signal=t),iY.supported&&(f.keepalive=n),"function"==typeof this.config.requestInit&&Object.assign(f,this.config.requestInit(e));let p=()=>{},m=[fetch(iZ(u,f)).then(e=>{let t=e.headers,i={};for(let e of t.entries())i[e[0]]=e[1];return void 0!=e.body?{response:new e5({headers:i,reason:e.statusText,statusCode:e.status,body:e.body})}:e.blob().then(t=>({response:new e5({headers:i,reason:e.statusText,statusCode:e.status,body:t})}))}),iX(r)];return t&&m.push(new Promise((e,i)=>{let r=()=>{let e=Error("Request aborted");e.name="AbortError",i(e)};if("function"==typeof t.addEventListener){let e=t;e.addEventListener("abort",r,{once:!0}),p=()=>e.removeEventListener("abort",r)}else t.onabort=r})),Promise.race(m).finally(p)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(i=>(i[e]=t,i))}httpHandlerConfigs(){return this.config??{}}}let i1={},i2=Array(64);for(let e=0,t=65,i=90;e+t<=i;e++){let i=String.fromCharCode(e+t);i1[i]=e,i2[e]=i}for(let e=0,t=97,i=122;e+t<=i;e++){let i=String.fromCharCode(e+t),r=e+26;i1[i]=r,i2[r]=i}for(let e=0;e<10;e++){i1[e.toString(10)]=e+52;let t=e.toString(10),i=e+52;i1[t]=i,i2[i]=t}i1["+"]=62,i2[62]="+",i1["/"]=63,i2[63]="/";let i3=6,i5=8,i4=63,i6=e=>{let t=e.length/4*3;"=="===e.slice(-2)?t-=2:"="===e.slice(-1)&&t--;let i=new ArrayBuffer(t),r=new DataView(i);for(let t=0;t<e.length;t+=4){let i=0,n=0;for(let r=t,o=t+3;r<=o;r++)if("="!==e[r]){if(!(e[r]in i1))throw TypeError(`Invalid character ${e[r]} in base64 string.`);i|=i1[e[r]]<<(o-r)*i3,n+=i3}else i>>=i3;let o=t/4*3;i>>=n%i5;let s=Math.floor(n/i5);for(let e=0;e<s;e++){let t=(s-e-1)*i5;r.setUint8(o+e,(i&255<<t)>>t)}}return new Uint8Array(i)},i8=async e=>"function"==typeof Blob&&e instanceof Blob||e.constructor?.name==="Blob"?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await e.arrayBuffer()):i7(e):i9(e);async function i7(e){return new Uint8Array(i6(await re(e)))}async function i9(e){let t=[],i=e.getReader(),r=!1,n=0;for(;!r;){let{done:e,value:o}=await i.read();o&&(t.push(o),n+=o.length),r=e}let o=new Uint8Array(n),s=0;for(let e of t)o.set(e,s),s+=e.length;return o}function re(e){return new Promise((t,i)=>{let r=new FileReader;r.onloadend=()=>{if(2!==r.readyState)return i(Error("Reader aborted too early"));let e=r.result??"",n=e.indexOf(","),o=n>-1?n+1:e.length;t(e.substring(o))},r.onabort=()=>i(Error("Read aborted")),r.onerror=()=>i(r.error),r.readAsDataURL(e)})}let rt=e=>()=>Promise.reject(e),ri="function"==typeof TextEncoder?new TextEncoder:null,rr=e=>{if("string"==typeof e){if(ri)return ri.encode(e).byteLength;let t=e.length;for(let i=t-1;i>=0;i--){let r=e.charCodeAt(i);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&i--}return t}if("number"==typeof e.byteLength)return e.byteLength;if("number"==typeof e.size)return e.size;throw Error(`Body Length computation failed for ${e}`)},rn=e=>new Date(Date.now()+e),ro=e=>e5.isInstance(e)?e.headers?.date??e.headers?.Date:void 0,rs=(e,t)=>Math.abs(rn(t).getTime()-e)>=3e5,ra=(e,t)=>{let i=Date.parse(e);return rs(i,t)?i-Date.now():t},rl=(e,t)=>{if(!t)throw Error(`Property \`${e}\` is not resolved for AWS SDK SigV4Auth`);return t},rd=async e=>{let t=rl("context",e.context),i=rl("config",e.config),r=t.endpointV2?.properties?.authSchemes?.[0],n=rl("signer",i.signer),o=await n(r);return{config:i,signer:o,signingRegion:e?.signingRegion,signingRegionSet:e?.signingRegionSet,signingName:e?.signingName}};class rc{async sign(e,t,i){if(!o.isInstance(e))throw Error("The request is not an instance of `HttpRequest` and cannot be signed");let r=await rd(i),{config:n,signer:s}=r,{signingRegion:a,signingName:l}=r,d=i.context;if(d?.authSchemes?.length){let[e,t]=d.authSchemes;e?.name==="sigv4a"&&t?.name==="sigv4"&&(a=t?.signingRegion??a,l=t?.signingName??l)}return await s.sign(e,{signingDate:rn(n.systemClockOffset),signingRegion:a,signingService:l})}errorHandler(e){return t=>{let i=t.ServerTime??ro(t.$response);if(i){let r=rl("config",e.config),n=r.systemClockOffset;r.systemClockOffset=ra(i,r.systemClockOffset),r.systemClockOffset!==n&&t.$metadata&&(t.$metadata.clockSkewCorrected=!0)}throw t}}successHandler(e,t){let i=ro(e);if(i){let e=rl("config",t.config);e.systemClockOffset=ra(i,e.systemClockOffset)}}}function ru(e){let t;let i="object"==typeof(t="string"==typeof e?tI(e):e)&&"number"==typeof t.length,r="object"==typeof t&&"number"==typeof t.byteOffset&&"number"==typeof t.byteLength;if(!i&&!r)throw Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let n="";for(let e=0;e<t.length;e+=3){let i=0,r=0;for(let n=e,o=Math.min(e+3,t.length);n<o;n++)i|=t[n]<<(o-n-1)*i5,r+=i5;let o=Math.ceil(r/i3);i<<=o*i3-r;for(let e=1;e<=o;e++){let t=(o-e)*i3;n+=i2[(i&i4<<t)>>t]}n+="==".slice(0,4-o)}return n}let rh=e=>{if("string"==typeof e)return e;if("object"!=typeof e||"number"!=typeof e.byteOffset||"number"!=typeof e.byteLength)throw Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(e)};class rf{constructor({size:e,params:t}){this.data=new Map,this.parameters=[],this.capacity=e??50,t&&(this.parameters=t)}get(e,t){let i=this.hash(e);if(!1===i)return t();if(!this.data.has(i)){if(this.data.size>this.capacity+10){let e=this.data.keys(),t=0;for(;;){let{value:i,done:r}=e.next();if(this.data.delete(i),r||++t>10)break}}this.data.set(i,t())}return this.data.get(i)}size(){return this.data.size}hash(e){let t="",{parameters:i}=this;if(0===i.length)return!1;for(let r of i){let i=String(e[r]??"");if(i.includes("|;"))return!1;t+=i+"|;"}return t}}let rp="endpoints";function rm(e){return"object"!=typeof e||null==e?e:"ref"in e?`$${rm(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(rm).join(", ")})`:JSON.stringify(e,null,2)}class rg extends Error{constructor(e){super(e),this.name="EndpointError"}}let rv=(e,t)=>e===t,rb=e=>{let t=e.split("."),i=[];for(let r of t){let t=r.indexOf("[");if(-1!==t){if(r.indexOf("]")!==r.length-1)throw new rg(`Path: '${e}' does not end with ']'`);let n=r.slice(t+1,-1);if(Number.isNaN(parseInt(n)))throw new rg(`Invalid array index: '${n}' in path: '${e}'`);0!==t&&i.push(r.slice(0,t)),i.push(n)}else i.push(r)}return i},ry=(e,t)=>rb(t).reduce((i,r)=>{if("object"!=typeof i)throw new rg(`Index '${r}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(i)?i[parseInt(r)]:i[r]},e),rS=e=>null!=e,rw=e=>!e;!function(e){e.HTTP="http",e.HTTPS="https"}(v||(v={}));let rC={[v.HTTP]:80,[v.HTTPS]:443},rk={booleanEquals:rv,getAttr:ry,isSet:rS,isValidHostLabel:x,not:rw,parseURL:e=>{let t=(()=>{try{if(e instanceof URL)return e;if("object"==typeof e&&"hostname"in e){let{hostname:t,port:i,protocol:r="",path:n="",query:o={}}=e,s=new URL(`${r}//${t}${i?`:${i}`:""}${n}`);return s.search=Object.entries(o).map(([e,t])=>`${e}=${t}`).join("&"),s}return new URL(e)}catch(e){return null}})();if(!t)return console.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;let i=t.href,{host:r,hostname:n,pathname:o,protocol:s,search:a}=t;if(a)return null;let l=s.slice(0,-1);if(!Object.values(v).includes(l))return null;let d=D(n),c=i.includes(`${r}:${rC[l]}`)||"string"==typeof e&&e.includes(`${r}:${rC[l]}`),u=`${r}${c?`:${rC[l]}`:""}`;return{scheme:l,authority:u,path:o,normalizedPath:o.endsWith("/")?o:`${o}/`,isIp:d}},stringEquals:(e,t)=>e===t,substring:(e,t,i,r)=>t>=i||e.length<i?null:r?e.substring(e.length-i,e.length-t):e.substring(t,i),uriEncode:e=>encodeURIComponent(e).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)},rT=(e,t)=>{let i=[],r={...t.endpointParams,...t.referenceRecord},n=0;for(;n<e.length;){let t=e.indexOf("{",n);if(-1===t){i.push(e.slice(n));break}i.push(e.slice(n,t));let o=e.indexOf("}",t);if(-1===o){i.push(e.slice(t));break}"{"===e[t+1]&&"}"===e[o+1]&&(i.push(e.slice(t+1,o)),n=o+2);let s=e.substring(t+1,o);if(s.includes("#")){let[e,t]=s.split("#");i.push(ry(r[e],t))}else i.push(r[s]);n=o+1}return i.join("")},rI=({ref:e},t)=>({...t.endpointParams,...t.referenceRecord})[e],rE=(e,t,i)=>{if("string"==typeof e)return rT(e,i);if(e.fn)return rA(e,i);if(e.ref)return rI(e,i);throw new rg(`'${t}': ${String(e)} is not a string, function or reference.`)},rA=({fn:e,argv:t},i)=>{let r=t.map(e=>["boolean","number"].includes(typeof e)?e:rE(e,"arg",i)),n=e.split(".");return n[0]in P&&null!=n[1]?P[n[0]][n[1]](...r):rk[e](...r)},rM=({assign:e,...t},i)=>{if(e&&e in i.referenceRecord)throw new rg(`'${e}' is already defined in Reference Record.`);let r=rA(t,i);return i.logger?.debug?.(`${rp} evaluateCondition: ${rm(t)} = ${rm(r)}`),{result:""===r||!!r,...null!=e&&{toAssign:{name:e,value:r}}}},rO=(e=[],t)=>{let i={};for(let r of e){let{result:e,toAssign:n}=rM(r,{...t,referenceRecord:{...t.referenceRecord,...i}});if(!e)return{result:e};n&&(i[n.name]=n.value,t.logger?.debug?.(`${rp} assign: ${n.name} := ${rm(n.value)}`))}return{result:!0,referenceRecord:i}},rP=(e,t)=>Object.entries(e).reduce((e,[i,r])=>({...e,[i]:r.map(e=>{let r=rE(e,"Header value entry",t);if("string"!=typeof r)throw new rg(`Header '${i}' value '${r}' is not a string`);return r})}),{}),r_=(e,t)=>{if(Array.isArray(e))return e.map(e=>r_(e,t));switch(typeof e){case"string":return rT(e,t);case"object":if(null===e)throw new rg(`Unexpected endpoint property: ${e}`);return rx(e,t);case"boolean":return e;default:throw new rg(`Unexpected endpoint property type: ${typeof e}`)}},rx=(e,t)=>Object.entries(e).reduce((e,[i,r])=>({...e,[i]:r_(r,t)}),{}),rR=(e,t)=>{let i=rE(e,"Endpoint URL",t);if("string"==typeof i)try{return new URL(i)}catch(e){throw console.error(`Failed to construct URL with ${i}`,e),e}throw new rg(`Endpoint URL must be a string, got ${typeof i}`)},rD=(e,t)=>{let{conditions:i,endpoint:r}=e,{result:n,referenceRecord:o}=rO(i,t);if(!n)return;let s={...t,referenceRecord:{...t.referenceRecord,...o}},{url:a,properties:l,headers:d}=r;return t.logger?.debug?.(`${rp} Resolving endpoint from template: ${rm(r)}`),{...void 0!=d&&{headers:rP(d,s)},...void 0!=l&&{properties:rx(l,s)},url:rR(a,s)}},rN=(e,t)=>{let{conditions:i,error:r}=e,{result:n,referenceRecord:o}=rO(i,t);if(n)throw new rg(rE(r,"Error",{...t,referenceRecord:{...t.referenceRecord,...o}}))},rL=(e,t)=>{let{conditions:i,rules:r}=e,{result:n,referenceRecord:o}=rO(i,t);if(n)return rF(r,{...t,referenceRecord:{...t.referenceRecord,...o}})},rF=(e,t)=>{for(let i of e)if("endpoint"===i.type){let e=rD(i,t);if(e)return e}else if("error"===i.type)rN(i,t);else if("tree"===i.type){let e=rL(i,t);if(e)return e}else throw new rg(`Unknown endpoint rule: ${i}`);throw new rg("Rules evaluation failed")},rV=(e,t)=>{let{endpointParams:i,logger:r}=t,{parameters:n,rules:o}=e;t.logger?.debug?.(`${rp} Initial EndpointParams: ${rm(i)}`);let s=Object.entries(n).filter(([,e])=>null!=e.default).map(([e,t])=>[e,t.default]);if(s.length>0)for(let[e,t]of s)i[e]=i[e]??t;for(let e of Object.entries(n).filter(([,e])=>e.required).map(([e])=>e))if(null==i[e])throw new rg(`Missing required parameter: '${e}'`);let a=rF(o,{endpointParams:i,logger:r,referenceRecord:{}});return t.logger?.debug?.(`${rp} Resolved endpoint: ${rm(a)}`),a},rB="required",rU="fn",rj="argv",r$="ref",rz="isSet",rH="booleanEquals",rW="error",rG="endpoint",rK="tree",rq="PartitionResult",rJ={[rB]:!1,type:"String"},rQ={[rB]:!0,default:!1,type:"Boolean"},rZ={[r$]:"Endpoint"},rX={[rU]:rH,[rj]:[{[r$]:"UseFIPS"},!0]},rY={[rU]:rH,[rj]:[{[r$]:"UseDualStack"},!0]},r0={},r1={[rU]:"getAttr",[rj]:[{[r$]:rq},"supportsFIPS"]},r2={[rU]:rH,[rj]:[!0,{[rU]:"getAttr",[rj]:[{[r$]:rq},"supportsDualStack"]}]},r3=[rX],r5=[rY],r4=[{[r$]:"Region"}],r6={version:"1.0",parameters:{Region:rJ,UseDualStack:rQ,UseFIPS:rQ,Endpoint:rJ},rules:[{conditions:[{[rU]:rz,[rj]:[rZ]}],rules:[{conditions:r3,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:rW},{conditions:r5,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:rW},{endpoint:{url:rZ,properties:r0,headers:r0},type:rG}],type:rK},{conditions:[{[rU]:rz,[rj]:r4}],rules:[{conditions:[{[rU]:"aws.partition",[rj]:r4,assign:rq}],rules:[{conditions:[rX,rY],rules:[{conditions:[{[rU]:rH,[rj]:[!0,r1]},r2],rules:[{endpoint:{url:"https://messaging-chime-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:r0,headers:r0},type:rG}],type:rK},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:rW}],type:rK},{conditions:r3,rules:[{conditions:[{[rU]:rH,[rj]:[r1,!0]}],rules:[{endpoint:{url:"https://messaging-chime-fips.{Region}.{PartitionResult#dnsSuffix}",properties:r0,headers:r0},type:rG}],type:rK},{error:"FIPS is enabled but this partition does not support FIPS",type:rW}],type:rK},{conditions:r5,rules:[{conditions:[r2],rules:[{endpoint:{url:"https://messaging-chime.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:r0,headers:r0},type:rG}],type:rK},{error:"DualStack is enabled but this partition does not support DualStack",type:rW}],type:rK},{endpoint:{url:"https://messaging-chime.{Region}.{PartitionResult#dnsSuffix}",properties:r0,headers:r0},type:rG}],type:rK}],type:rK},{error:"Invalid Configuration: Missing Region",type:rW}]},r8=new rf({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),r7=(e,t={})=>r8.get(e,()=>rV(r6,{endpointParams:e,logger:t.logger}));P.aws=$;let r9=e=>({apiVersion:"2021-05-15",base64Decoder:e?.base64Decoder??i6,base64Encoder:e?.base64Encoder??ru,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??r7,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??ip,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new rc}],logger:e?.logger??new e4,serviceId:e?.serviceId??"Chime SDK Messaging",urlParser:e?.urlParser??eM,utf8Decoder:e?.utf8Decoder??tI,utf8Encoder:e?.utf8Encoder??rh}),ne=e=>{switch(e){case"standard":case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},nt=(e,t,i)=>{let r,n,o;let s=!1,a=async()=>{n||(n=e());try{r=await n,o=!0,s=!1}finally{n=void 0}return r};return void 0===t?async e=>((!o||e?.forceRefresh)&&(r=await a()),r):async e=>((!o||e?.forceRefresh)&&(r=await a()),s||(i&&!i(r)?s=!0:t(r)&&await a()),r)},ni=["in-region","cross-region","mobile","standard","legacy"],nr=({defaultsMode:e}={})=>nt(async()=>{let t="function"==typeof e?await e():e;switch(t?.toLowerCase()){case"auto":return Promise.resolve(nn()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(t?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw Error(`Invalid parameter for "defaultsMode", expect ${ni.join(", ")}, got ${t}`)}}),nn=()=>{let e="undefined"!=typeof window&&window?.navigator?.userAgent?iG().parse(window.navigator.userAgent):void 0,t=e?.platform?.type;return"tablet"===t||"mobile"===t},no=e=>{let t=nr(e),i=()=>t().then(ne),r=r9(e);return{...r,...e,runtime:"browser",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??rr,credentialDefaultProvider:e?.credentialDefaultProvider??(e=>()=>Promise.reject(Error("Credential is missing"))),defaultUserAgentProvider:e?.defaultUserAgentProvider??iK({serviceId:r.serviceId,clientVersion:ib.i8}),maxAttempts:e?.maxAttempts??e_,region:e?.region??rt("Region is missing"),requestHandler:i0.create(e?.requestHandler??i),retryMode:e?.retryMode??(async()=>(await i()).retryMode||ex),sha256:e?.sha256??iH,streamCollector:e?.streamCollector??i8,useDualstackEndpoint:e?.useDualstackEndpoint??(()=>Promise.resolve(iq)),useFipsEndpoint:e?.useFipsEndpoint??(()=>Promise.resolve(iJ))}},ns=e=>({setRegion(t){e.region=t},region:()=>e.region}),na=e=>({region:e.region()}),nl=e=>({setHttpHandler(t){e.httpHandler=t},httpHandler:()=>e.httpHandler,updateHttpClientConfig(t,i){e.httpHandler?.updateHttpClientConfig(t,i)},httpHandlerConfigs:()=>e.httpHandler.httpHandlerConfigs()}),nd=e=>({httpHandler:e.httpHandler()});!function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"}(b||(b={}));let nc=e=>{let t=[];for(let i in b){let r=b[i];void 0!==e[r]&&t.push({algorithmId:()=>r,checksumConstructor:()=>e[r]})}return{addChecksumAlgorithm(e){t.push(e)},checksumAlgorithms:()=>t}},nu=e=>{let t={};return e.checksumAlgorithms().forEach(e=>{t[e.algorithmId()]=e.checksumConstructor()}),t},nh=e=>({setRetryStrategy(t){e.retryStrategy=t},retryStrategy:()=>e.retryStrategy}),nf=e=>{let t={};return t.retryStrategy=e.retryStrategy(),t},np=e=>Object.assign(nc(e),nh(e)),nm=e=>Object.assign(nu(e),nf(e)),ng=e=>{let t=e.httpAuthSchemes,i=e.httpAuthSchemeProvider,r=e.credentials;return{setHttpAuthScheme(e){let i=t.findIndex(t=>t.schemeId===e.schemeId);-1===i?t.push(e):t.splice(i,1,e)},httpAuthSchemes:()=>t,setHttpAuthSchemeProvider(e){i=e},httpAuthSchemeProvider:()=>i,setCredentials(e){r=e},credentials:()=>r}},nv=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()}),nb=(e,t)=>{let i=Object.assign(ns(e),np(e),nl(e),ng(e));return t.forEach(e=>e.configure(i)),Object.assign(e,na(i),nm(i),nd(i),nv(i))};class ny extends tg{config;constructor(...[e]){let t=no(e||{});super(t),this.initConfig=t;let i=nb(im(eP(a(ea(e3(O(ig(t))))))),e?.extensions||[]);this.config=i,this.middlewareStack.use(en(this.config)),this.middlewareStack.use(td(this.config)),this.middlewareStack.use(eT(this.config)),this.middlewareStack.use(c(this.config)),this.middlewareStack.use(f(this.config)),this.middlewareStack.use(I(this.config)),this.middlewareStack.use(ep(this.config,{httpAuthSchemeParametersProvider:iu,identityProviderConfigProvider:async e=>new em({"aws.auth#sigv4":e.credentials})})),this.middlewareStack.use(eS(this.config))}destroy(){super.destroy()}}let nS=(e,t)=>{for(let i of Object.keys(e)){let r=e[i],n=async function(e,t,i){let n=new r(e);if("function"==typeof t)this.send(n,t);else{if("function"!=typeof i)return this.send(n,t);if("object"!=typeof t)throw Error(`Expected http options but got ${typeof t}`);this.send(n,t||{},i)}},o=(i[0].toLowerCase()+i.slice(1)).replace(/Command$/,"");t.prototype[o]=n}},nw=(e,t)=>(i,r)=>async n=>{let{response:o}=await i(n);try{let i=await t(o,e);return{response:o,output:i}}catch(e){if(Object.defineProperty(e,"$response",{value:o}),!("$metadata"in e)){let t="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{e.message+="\n  "+t}catch(e){r.logger&&r.logger?.constructor?.name!=="NoOpLogger"?r.logger?.warn?.(t):console.warn(t)}void 0!==e.$responseBodyText&&e.$response&&(e.$response.body=e.$responseBodyText);try{if(e5.isInstance(o)){let{headers:t={}}=o,i=Object.entries(t);e.$metadata={httpStatusCode:o.statusCode,requestId:nC(/^x-[\w-]+-request-?id$/,i),extendedRequestId:nC(/^x-[\w-]+-id-2$/,i),cfId:nC(/^x-[\w-]+-cf-id$/,i)}}}catch(e){}}throw e}},nC=(e,t)=>(t.find(([t])=>t.match(e))||[void 0,void 0])[1],nk=(e,t)=>(i,r)=>async n=>{let o=e,s=r.endpointV2?.url&&o.urlParser?async()=>o.urlParser(r.endpointV2.url):o.endpoint;if(!s)throw Error("No valid endpoint provider available.");let a=await t(n.input,{...e,endpoint:s});return i({...n,request:a})},nT={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},nI={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function nE(e,t,i){return{applyToStack:r=>{r.add(nw(e,i),nT),r.add(nk(e,t),nI)}}}function nA(e,t,i){e.__smithy_context?e.__smithy_context.features||(e.__smithy_context.features={}):e.__smithy_context={features:{}},e.__smithy_context.features[t]=i}let nM=async e=>{let t=e?.Bucket||"";if("string"==typeof e.Bucket&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),nR(t)){if(!0===e.ForcePathStyle)throw Error("Path-style addressing cannot be used with ARN buckets")}else nx(t)&&(-1===t.indexOf(".")||String(e.Endpoint).startsWith("http:"))&&t.toLowerCase()===t&&!(t.length<3)||(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e},nO=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,nP=/(\d+\.){3}\d+/,n_=/\.\./,nx=e=>nO.test(e)&&!nP.test(e)&&!n_.test(e),nR=e=>{let[t,i,r,,,n]=e.split(":"),o="arn"===t&&e.split(":").length>=6,s=!!(o&&i&&r&&n);if(o&&!s)throw Error(`Invalid ARN: ${e} was an invalid ARN.`);return s},nD=(e,t,i)=>{let r=async()=>{let r=i[e]??i[t];return"function"==typeof r?r():r};return"credentialScope"===e||"CredentialScope"===t?async()=>{let e="function"==typeof i.credentials?await i.credentials():i.credentials;return e?.credentialScope??e?.CredentialScope}:"accountId"===e||"AccountId"===t?async()=>{let e="function"==typeof i.credentials?await i.credentials():i.credentials;return e?.accountId??e?.AccountId}:"endpoint"===e||"endpoint"===t?async()=>{if(!1===i.isCustomEndpoint)return;let e=await r();if(e&&"object"==typeof e){if("url"in e)return e.url.href;if("hostname"in e){let{protocol:t,hostname:i,port:r,path:n}=e;return`${t}//${i}${r?":"+r:""}${n}`}}return e}:r},nN=async(e,t,i,r)=>{if(!i.isCustomEndpoint){let e;(e=i.serviceConfiguredEndpoint?await i.serviceConfiguredEndpoint():await eE(i.serviceId))&&(i.endpoint=()=>Promise.resolve(eO(e)),i.isCustomEndpoint=!0)}let n=await nL(e,t,i);if("function"!=typeof i.endpointProvider)throw Error("config.endpointProvider is not set.");return i.endpointProvider(n,r)},nL=async(e,t,i)=>{let r={},n=t?.getEndpointParameterInstructions?.()||{};for(let[t,o]of Object.entries(n))switch(o.type){case"staticContextParams":r[t]=o.value;break;case"contextParams":r[t]=e[o.name];break;case"clientContextParams":case"builtInParams":r[t]=await nD(o.name,t,i)();break;case"operationContextParams":r[t]=o.get(e);break;default:throw Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(o))}return 0===Object.keys(n).length&&Object.assign(r,i),"s3"===String(i.serviceId).toLowerCase()&&await nM(r),r},nF=({config:e,instructions:t})=>(i,r)=>async n=>{e.isCustomEndpoint&&nA(r,"ENDPOINT_OVERRIDE","N");let o=await nN(n.input,{getEndpointParameterInstructions:()=>t},{...e},r);r.endpointV2=o,r.authSchemes=o.properties?.authSchemes;let s=r.authSchemes?.[0];if(s){r.signing_region=s.signingRegion,r.signing_service=s.signingName;let e=ed(r),t=e?.selectedHttpAuthScheme?.httpAuthOption;t&&(t.signingProperties=Object.assign(t.signingProperties||{},{signing_region:s.signingRegion,signingRegion:s.signingRegion,signing_service:s.signingName,signingName:s.signingName,signingRegionSet:s.signingRegionSet},s.properties))}return i({...n})},nV={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:nI.name},nB=(e,t)=>({applyToStack:i=>{i.addRelativeTo(nF({config:e,instructions:t}),nV)}}),nU=e=>"function"==typeof e?e():e;class nj{constructor(e,t){this.name=e,this.traits=t}}class n$ extends nj{constructor(e,t,i){super(e,t),this.name=e,this.traits=t,this.valueSchema=i,this.symbol=n$.symbol}static[Symbol.hasInstance](e){let t=n$.prototype.isPrototypeOf(e);return t||"object"!=typeof e||null===e?t:e.symbol===n$.symbol}}n$.symbol=Symbol.for("@smithy/core/schema::ListSchema");class nz extends nj{constructor(e,t,i,r){super(e,t),this.name=e,this.traits=t,this.keySchema=i,this.valueSchema=r,this.symbol=nz.symbol}static[Symbol.hasInstance](e){let t=nz.prototype.isPrototypeOf(e);return t||"object"!=typeof e||null===e?t:e.symbol===nz.symbol}}nz.symbol=Symbol.for("@smithy/core/schema::MapSchema");let nH={BLOB:21,STREAMING_BLOB:42,BOOLEAN:2,STRING:0,NUMERIC:1,BIG_INTEGER:17,BIG_DECIMAL:19,DOCUMENT:15,TIMESTAMP_DEFAULT:4,TIMESTAMP_DATE_TIME:5,TIMESTAMP_HTTP_DATE:6,TIMESTAMP_EPOCH_SECONDS:7,LIST_MODIFIER:64,MAP_MODIFIER:128};class nW extends nj{constructor(e,t,i){super(e,i),this.name=e,this.schemaRef=t,this.traits=i,this.symbol=nW.symbol}static[Symbol.hasInstance](e){let t=nW.prototype.isPrototypeOf(e);return t||"object"!=typeof e||null===e?t:e.symbol===nW.symbol}}nW.symbol=Symbol.for("@smithy/core/schema::SimpleSchema");class nG extends nj{constructor(e,t,i,r){super(e,t),this.name=e,this.traits=t,this.memberNames=i,this.memberList=r,this.symbol=nG.symbol,this.members={};for(let e=0;e<i.length;++e)this.members[i[e]]=Array.isArray(r[e])?r[e]:[r[e],0]}static[Symbol.hasInstance](e){let t=nG.prototype.isPrototypeOf(e);return t||"object"!=typeof e||null===e?t:e.symbol===nG.symbol}}nG.symbol=Symbol.for("@smithy/core/schema::StructureSchema");class nK{constructor(e,t){this.ref=e,this.memberName=t,this.symbol=nK.symbol;let i=[],r=e,n=e;for(this._isMemberSchema=!1;Array.isArray(r);)i.push(r[1]),n=nU(r=r[0]),this._isMemberSchema=!0;if(i.length>0){this.memberTraits={};for(let e=i.length-1;e>=0;--e){let t=i[e];Object.assign(this.memberTraits,nK.translateTraits(t))}}else this.memberTraits=0;if(n instanceof nK){this.name=n.name,this.traits=n.traits,this._isMemberSchema=n._isMemberSchema,this.schema=n.schema,this.memberTraits=Object.assign({},n.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.ref=n.ref,this.memberName=t??n.memberName;return}if(this.schema=nU(n),this.schema&&"object"==typeof this.schema?this.traits=this.schema?.traits??{}:this.traits=0,this.name=("object"==typeof this.schema?this.schema?.name:void 0)??this.memberName??this.getSchemaName(),this._isMemberSchema&&!t)throw Error(`@smithy/core/schema - NormalizedSchema member schema ${this.getName(!0)} must initialize with memberName argument.`)}static[Symbol.hasInstance](e){let t=nK.prototype.isPrototypeOf(e);return t||"object"!=typeof e||null===e?t:e.symbol===nK.symbol}static of(e,t){return e instanceof nK?e:new nK(e,t)}static translateTraits(e){if("object"==typeof e)return e;let t={};return(1&(e|=0))==1&&(t.httpLabel=1),(e>>1&1)==1&&(t.idempotent=1),(e>>2&1)==1&&(t.idempotencyToken=1),(e>>3&1)==1&&(t.sensitive=1),(e>>4&1)==1&&(t.httpPayload=1),(e>>5&1)==1&&(t.httpResponseCode=1),(e>>6&1)==1&&(t.httpQueryParams=1),t}static memberFrom(e,t){return e instanceof nK?(e.memberName=t,e._isMemberSchema=!0,e):new nK(e,t)}getSchema(){return this.schema instanceof nK?this.schema=this.schema.getSchema():this.schema instanceof nW?nU(this.schema.schemaRef):nU(this.schema)}getName(e=!1){return!e&&this.name&&this.name.includes("#")?this.name.split("#")[1]:this.name||void 0}getMemberName(){if(!this.isMemberSchema())throw Error(`@smithy/core/schema - cannot get member name on non-member schema: ${this.getName(!0)}`);return this.memberName}isMemberSchema(){return this._isMemberSchema}isUnitSchema(){return"unit"===this.getSchema()}isListSchema(){let e=this.getSchema();return"number"==typeof e?e>=nH.LIST_MODIFIER&&e<nH.MAP_MODIFIER:e instanceof n$}isMapSchema(){let e=this.getSchema();return"number"==typeof e?e>=nH.MAP_MODIFIER&&e<=255:e instanceof nz}isDocumentSchema(){return this.getSchema()===nH.DOCUMENT}isStructSchema(){let e=this.getSchema();return null!==e&&"object"==typeof e&&"members"in e||e instanceof nG}isBlobSchema(){return this.getSchema()===nH.BLOB||this.getSchema()===nH.STREAMING_BLOB}isTimestampSchema(){let e=this.getSchema();return"number"==typeof e&&e>=nH.TIMESTAMP_DEFAULT&&e<=nH.TIMESTAMP_EPOCH_SECONDS}isStringSchema(){return this.getSchema()===nH.STRING}isBooleanSchema(){return this.getSchema()===nH.BOOLEAN}isNumericSchema(){return this.getSchema()===nH.NUMERIC}isBigIntegerSchema(){return this.getSchema()===nH.BIG_INTEGER}isBigDecimalSchema(){return this.getSchema()===nH.BIG_DECIMAL}isStreaming(){return!!this.getMergedTraits().streaming||this.getSchema()===nH.STREAMING_BLOB}isIdempotencyToken(){return"number"==typeof this.traits?(4&this.traits)==4:"object"==typeof this.traits&&!!this.traits.idempotencyToken}getMergedTraits(){return this.normalizedTraits||(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()}),this.normalizedTraits}getMemberTraits(){return nK.translateTraits(this.memberTraits)}getOwnTraits(){return nK.translateTraits(this.traits)}getKeySchema(){if(this.isDocumentSchema())return nK.memberFrom([nH.DOCUMENT,0],"key");if(!this.isMapSchema())throw Error(`@smithy/core/schema - cannot get key schema for non-map schema: ${this.getName(!0)}`);let e=this.getSchema();return"number"==typeof e?nK.memberFrom([63&e,0],"key"):nK.memberFrom([e.keySchema,0],"key")}getValueSchema(){let e=this.getSchema();if("number"==typeof e){if(this.isMapSchema())return nK.memberFrom([63&e,0],"value");if(this.isListSchema())return nK.memberFrom([63&e,0],"member")}if(e&&"object"==typeof e){if(this.isStructSchema())throw Error(`cannot call getValueSchema() with StructureSchema ${this.getName(!0)}`);let t=e;if("valueSchema"in t){if(this.isMapSchema())return nK.memberFrom([t.valueSchema,0],"value");if(this.isListSchema())return nK.memberFrom([t.valueSchema,0],"member")}}if(this.isDocumentSchema())return nK.memberFrom([nH.DOCUMENT,0],"value");throw Error(`@smithy/core/schema - the schema ${this.getName(!0)} does not have a value member.`)}hasMemberSchema(e){return!!this.isStructSchema()&&e in this.getSchema().members}getMemberSchema(e){if(this.isStructSchema()){let t=this.getSchema();if(!(e in t.members))throw Error(`@smithy/core/schema - the schema ${this.getName(!0)} does not have a member with name=${e}.`);return nK.memberFrom(t.members[e],e)}if(this.isDocumentSchema())return nK.memberFrom([nH.DOCUMENT,0],e);throw Error(`@smithy/core/schema - the schema ${this.getName(!0)} does not have members.`)}getMemberSchemas(){let{schema:e}=this,t=e;if(!t||"object"!=typeof t)return{};if("members"in t){let e={};for(let i of t.memberNames)e[i]=this.getMemberSchema(i);return e}return{}}getEventStreamMember(){if(this.isStructSchema()){for(let[e,t]of this.structIterator())if(t.isStreaming()&&t.isStructSchema())return e}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw Error("@smithy/core/schema - cannot acquire structIterator on non-struct schema.");let e=this.getSchema();for(let t=0;t<e.memberNames.length;++t)yield[e.memberNames[t],nK.memberFrom([e.memberList[t],0],e.memberNames[t])]}getSchemaName(){let e=this.getSchema();if("number"==typeof e){let t=63&e,i=192&e,r=Object.entries(nH).find(([,e])=>e===t)?.[0]??"Unknown";switch(i){case nH.MAP_MODIFIER:return`${r}Map`;case nH.LIST_MODIFIER:return`${r}List`;case 0:return r}}return"Unknown"}}nK.symbol=Symbol.for("@smithy/core/schema::NormalizedSchema");let nq="***SensitiveInformation***";function nJ(e,t){if(null==t)return t;let i=nK.of(e);if(i.getMergedTraits().sensitive)return nq;if(i.isListSchema()){if(i.getValueSchema().getMergedTraits().sensitive)return nq}else if(i.isMapSchema()){if(i.getKeySchema().getMergedTraits().sensitive||i.getValueSchema().getMergedTraits().sensitive)return nq}else if(i.isStructSchema()&&"object"==typeof t){let e=t,r={};for(let[t,n]of i.structIterator())null!=e[t]&&(r[t]=nJ(n,e[t]));return r}return t}class nQ{constructor(){this.middlewareStack=tf()}static classBuilder(){return new nZ}resolveMiddlewareWithContext(e,t,i,{middlewareFn:r,clientName:n,commandName:o,inputFilterSensitiveLog:s,outputFilterSensitiveLog:a,smithyContext:l,additionalContext:d,CommandCtor:c}){for(let n of r.bind(this)(c,e,t,i))this.middlewareStack.use(n);let u=e.concat(this.middlewareStack),{logger:h}=t,f={logger:h,clientName:n,commandName:o,inputFilterSensitiveLog:s,outputFilterSensitiveLog:a,[el]:{commandInstance:this,...l},...d},{requestHandler:p}=t;return u.resolve(e=>p.handle(e.request,i||{}),f)}}class nZ{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=void 0,this._outputFilterSensitiveLog=void 0,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,i={}){return this._smithyContext={service:e,operation:t,...i},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=e=>e,t=e=>e){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){let e;let t=this;return e=class extends nQ{static getEndpointParameterInstructions(){return t._ep}constructor(...[e]){super(),this.serialize=t._serializer,this.deserialize=t._deserializer,this.input=e??{},t._init(this),this.schema=t._operationSchema}resolveMiddleware(i,r,n){return this.resolveMiddlewareWithContext(i,r,n,{CommandCtor:e,middlewareFn:t._middlewareFn,clientName:t._clientName,commandName:t._commandName,inputFilterSensitiveLog:t._inputFilterSensitiveLog??(t._operationSchema?nJ.bind(null,t._operationSchema.input):e=>e),outputFilterSensitiveLog:t._outputFilterSensitiveLog??(t._operationSchema?nJ.bind(null,t._operationSchema.output):e=>e),smithyContext:t._smithyContext,additionalContext:t._additionalContext})}}}}function nX(e,t="utf-8"){return"base64"===t?ru(e):rh(e)}function nY(e,t){return"base64"===t?n0.mutate(i6(e)):n0.mutate(tI(e))}class n0 extends Uint8Array{static fromString(e,t="utf-8"){if("string"==typeof e)return nY(e,t);throw Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,n0.prototype),e}transformToString(e="utf-8"){return nX(this,e)}}let n1=async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return n0.mutate(e);if(!e)return n0.mutate(new Uint8Array);let i=t.streamCollector(e);return n0.mutate(await i)},n2=(e,t)=>n1(e,t).then(e=>(t?.utf8Encoder??rh)(e)),n3=(e,t)=>n2(e,t).then(e=>{if(e.length)try{return JSON.parse(e)}catch(t){throw t?.name==="SyntaxError"&&Object.defineProperty(t,"$responseBodyText",{value:e}),t}return{}}),n5=async(e,t)=>{let i=await n3(e,t);return i.message=i.message??i.Message,i},n4=(e,t)=>{let i=(e,t)=>Object.keys(e).find(e=>e.toLowerCase()===t.toLowerCase()),r=e=>{let t=e;return"number"==typeof t&&(t=t.toString()),t.indexOf(",")>=0&&(t=t.split(",")[0]),t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},n=i(e.headers,"x-amzn-errortype");if(void 0!==n)return r(e.headers[n]);if(t&&"object"==typeof t){let e=i(t,"code");if(e&&void 0!==t[e])return r(t[e]);if(void 0!==t.__type)return r(t.__type)}};function n6(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}let n8=(e,t,i,r,n,o)=>{if(null!=t&&void 0!==t[i]){let t=r();if(t.length<=0)throw Error("Empty value provided for input HTTP label: "+i+".");e=e.replace(n,o?t.split("/").map(e=>n6(e)).join("/"):n6(t))}else throw Error("No value provided for input HTTP label: "+i+".");return e};function n7(e,t){return new n9(e,t)}class n9{constructor(e,t){this.input=e,this.context=t,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){let{hostname:e,protocol:t="https",port:i,path:r}=await this.context.endpoint();for(let e of(this.path=r,this.resolvePathStack))e(this.path);return new o({protocol:t,hostname:this.hostname||e,port:i,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push(t=>{this.path=`${t?.endsWith("/")?t.slice(0,-1):t||""}`+e}),this}p(e,t,i,r){return this.resolvePathStack.push(n=>{this.path=n8(n,this.input,e,t,i,r)}),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}function oe(e,t,i){let r,n;if(void 0===t&&void 0===i)r={},n=e;else{if(r=e,"function"==typeof t)return oi(r,t,n=i);n=t}for(let e of Object.keys(n)){if(!Array.isArray(n[e])){r[e]=n[e];continue}or(r,null,n,e)}return r}let ot=(e,t)=>{let i={};for(let r in t)or(i,e,t,r);return i},oi=(e,t,i)=>oe(e,Object.entries(i).reduce((e,[i,r])=>(Array.isArray(r)?e[i]=r:"function"==typeof r?e[i]=[t,r()]:e[i]=[t,r],e),{})),or=(e,t,i,r)=>{if(null!==t){let n=i[r];"function"==typeof n&&(n=[,n]);let[o=on,s=oo,a=r]=n;("function"==typeof o&&o(t[a])||"function"!=typeof o&&o)&&(e[r]=s(t[a]));return}let[n,o]=i[r];if("function"==typeof o){let t;let i=void 0===n&&null!=(t=o()),s="function"==typeof n&&!!n(void 0)||"function"!=typeof n&&!!n;i?e[r]=t:s&&(e[r]=o())}else{let t=void 0===n&&null!=o,i="function"==typeof n&&!!n(o)||"function"!=typeof n&&!!n;(t||i)&&(e[r]=o)}},on=e=>null!=e,oo=e=>e,os=e=>null!=e,oa=e=>{if(null==e)return{};if(Array.isArray(e))return e.filter(e=>null!=e).map(oa);if("object"==typeof e){let t={};for(let i of Object.keys(e))null!=e[i]&&(t[i]=oa(e[i]));return t}return e},ol=e=>{if(null!=e){if("number"==typeof e){if((0===e||1===e)&&ov.warn(og(`Expected boolean, got ${typeof e}: ${e}`)),0===e)return!1;if(1===e)return!0}if("string"==typeof e){let t=e.toLowerCase();if(("false"===t||"true"===t)&&ov.warn(og(`Expected boolean, got ${typeof e}: ${e}`)),"false"===t)return!1;if("true"===t)return!0}if("boolean"==typeof e)return e;throw TypeError(`Expected boolean, got ${typeof e}: ${e}`)}},od=e=>{if(null!=e){if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&ov.warn(og(`Expected number but observed string: ${e}`)),t}if("number"==typeof e)return e;throw TypeError(`Expected number, got ${typeof e}: ${e}`)}},oc=(e,t)=>{if(null==e){if(t)throw TypeError(`Expected a non-null value for ${t}`);throw TypeError("Expected a non-null value")}return e},ou=e=>{if(null==e)return;if("object"==typeof e&&!Array.isArray(e))return e;let t=Array.isArray(e)?"array":typeof e;throw TypeError(`Expected object, got ${t}: ${e}`)},oh=e=>{if(null!=e){if("string"==typeof e)return e;if(["boolean","number","bigint"].includes(typeof e))return ov.warn(og(`Expected string, got ${typeof e}: ${e}`)),String(e);throw TypeError(`Expected string, got ${typeof e}: ${e}`)}},of=e=>"string"==typeof e?od(om(e)):od(e),op=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,om=e=>{let t=e.match(op);if(null===t||t[0].length!==e.length)throw TypeError("Expected real number, got implicit NaN");return parseFloat(e)},og=e=>String(TypeError(e).stack||e).split("\n").slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join("\n"),ov={warn:console.warn},ob=e=>e.toISOString().replace(".000Z","Z");class oy extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}static isInstance(e){if(!e)return!1;let t=e;return oy.prototype.isPrototypeOf(t)||!!t.$fault&&!!t.$metadata&&("client"===t.$fault||"server"===t.$fault)}static[Symbol.hasInstance](e){if(!e)return!1;let t=e;return this===oy?oy.isInstance(e):!!oy.isInstance(e)&&(t.name&&this.name?this.prototype.isPrototypeOf(e)||t.name===this.name:this.prototype.isPrototypeOf(e))}}let oS=(e,t={})=>{Object.entries(t).filter(([,e])=>void 0!==e).forEach(([t,i])=>{(void 0==e[t]||""===e[t])&&(e[t]=i)});let i=e.message||e.Message||"UnknownError";return e.message=i,delete e.Message,e},ow=({output:e,parsedBody:t,exceptionCtor:i,errorCode:r})=>{let n=ok(e),o=n.httpStatusCode?n.httpStatusCode+"":void 0;throw oS(new i({name:t?.code||t?.Code||r||o||"UnknownError",$fault:"client",$metadata:n}),t)},oC=e=>({output:t,parsedBody:i,errorCode:r})=>{ow({output:t,parsedBody:i,exceptionCtor:e,errorCode:r})},ok=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),oT=e=>{let t;if(null!=e){if("number"==typeof e)t=e;else if("string"==typeof e)t=of(e);else if("object"==typeof e&&1===e.tag)t=e.value;else throw TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(t)||t===1/0||t===-1/0)throw TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(1e3*t))}};class oI extends oy{constructor(e){super(e),Object.setPrototypeOf(this,oI.prototype)}}let oE="***SensitiveInformation***",oA={ALL:"ALL",FILTERED:"FILTERED",NONE:"NONE"},oM={DEFAULT:"DEFAULT",HIDDEN:"HIDDEN"},oO={AccessDenied:"AccessDenied",BadRequest:"BadRequest",Conflict:"Conflict",Forbidden:"Forbidden",NotFound:"NotFound",PhoneNumberAssociationsExist:"PhoneNumberAssociationsExist",PreconditionFailed:"PreconditionFailed",ResourceLimitExceeded:"ResourceLimitExceeded",ServiceFailure:"ServiceFailure",ServiceUnavailable:"ServiceUnavailable",Throttled:"Throttled",Throttling:"Throttling",Unauthorized:"Unauthorized",Unprocessable:"Unprocessable",VoiceConnectorGroupAssociationsExist:"VoiceConnectorGroupAssociationsExist"};class oP extends oI{name="BadRequestException";$fault="client";Code;Message;constructor(e){super({name:"BadRequestException",$fault:"client",...e}),Object.setPrototypeOf(this,oP.prototype),this.Code=e.Code,this.Message=e.Message}}class o_ extends oI{name="ConflictException";$fault="client";Code;Message;constructor(e){super({name:"ConflictException",$fault:"client",...e}),Object.setPrototypeOf(this,o_.prototype),this.Code=e.Code,this.Message=e.Message}}class ox extends oI{name="ForbiddenException";$fault="client";Code;Message;constructor(e){super({name:"ForbiddenException",$fault:"client",...e}),Object.setPrototypeOf(this,ox.prototype),this.Code=e.Code,this.Message=e.Message}}class oR extends oI{name="NotFoundException";$fault="client";Code;Message;constructor(e){super({name:"NotFoundException",$fault:"client",...e}),Object.setPrototypeOf(this,oR.prototype),this.Code=e.Code,this.Message=e.Message}}class oD extends oI{name="ServiceFailureException";$fault="server";Code;Message;constructor(e){super({name:"ServiceFailureException",$fault:"server",...e}),Object.setPrototypeOf(this,oD.prototype),this.Code=e.Code,this.Message=e.Message}}class oN extends oI{name="ServiceUnavailableException";$fault="server";Code;Message;constructor(e){super({name:"ServiceUnavailableException",$fault:"server",...e}),Object.setPrototypeOf(this,oN.prototype),this.Code=e.Code,this.Message=e.Message}}class oL extends oI{name="ThrottledClientException";$fault="client";Code;Message;constructor(e){super({name:"ThrottledClientException",$fault:"client",...e}),Object.setPrototypeOf(this,oL.prototype),this.Code=e.Code,this.Message=e.Message}}class oF extends oI{name="UnauthorizedClientException";$fault="client";Code;Message;constructor(e){super({name:"UnauthorizedClientException",$fault:"client",...e}),Object.setPrototypeOf(this,oF.prototype),this.Code=e.Code,this.Message=e.Message}}class oV extends oI{name="ResourceLimitExceededException";$fault="client";Code;Message;constructor(e){super({name:"ResourceLimitExceededException",$fault:"client",...e}),Object.setPrototypeOf(this,oV.prototype),this.Code=e.Code,this.Message=e.Message}}let oB={CREATED_TIMESTAMP:"CREATED_TIMESTAMP",LAST_MESSAGE_TIMESTAMP:"LAST_MESSAGE_TIMESTAMP"},oU={RESTRICTED:"RESTRICTED",UNRESTRICTED:"UNRESTRICTED"},oj={PRIVATE:"PRIVATE",PUBLIC:"PUBLIC"},o$={ASYNC:"ASYNC"},oz={ABORT:"ABORT",CONTINUE:"CONTINUE"},oH={DEFAULT:"DEFAULT",VOIP:"VOIP"},oW={NON_PERSISTENT:"NON_PERSISTENT",PERSISTENT:"PERSISTENT"},oG={DENIED:"DENIED",FAILED:"FAILED",PENDING:"PENDING",SENT:"SENT"},oK={CONTROL:"CONTROL",STANDARD:"STANDARD"},oq={Channel:"Channel",ChannelMessage:"ChannelMessage"},oJ={ASCENDING:"ASCENDING",DESCENDING:"DESCENDING"},oQ={MEMBERS:"MEMBERS"},oZ={EQUALS:"EQUALS",INCLUDES:"INCLUDES"},oX=e=>({...e,...e.Name&&{Name:oE}}),oY=e=>({...e,...e.InvitedBy&&{InvitedBy:oX(e.InvitedBy)},...e.Members&&{Members:e.Members.map(e=>oX(e))}}),o0=e=>({...e,...e.BatchChannelMemberships&&{BatchChannelMemberships:oY(e.BatchChannelMemberships)}}),o1=e=>({...e,...e.Name&&{Name:oE},...e.Metadata&&{Metadata:oE},...e.CreatedBy&&{CreatedBy:oX(e.CreatedBy)}}),o2=e=>({...e,...e.Name&&{Name:oE},...e.Metadata&&{Metadata:oE}}),o3=e=>({...e,...e.Member&&{Member:oX(e.Member)},...e.CreatedBy&&{CreatedBy:oX(e.CreatedBy)}}),o5=e=>({...e,...e.Member&&{Member:oX(e.Member)}}),o4=e=>({...e,...e.Name&&{Name:oE}}),o6=e=>({...e,...e.Processors&&{Processors:e.Processors.map(e=>o4(e))},...e.Name&&{Name:oE}}),o8=e=>({...e,...e.StringValues&&{StringValues:oE}}),o7=e=>({...e,...e.Title&&{Title:oE},...e.Body&&{Body:oE}}),o9=e=>({...e,...e.Content&&{Content:oE},...e.Metadata&&{Metadata:oE},...e.PushNotification&&{PushNotification:o7(e.PushNotification)},...e.MessageAttributes&&{MessageAttributes:Object.entries(e.MessageAttributes).reduce((e,[t,i])=>(e[t]=o8(i),e),{})},...e.ContentType&&{ContentType:oE}}),se=e=>({...e,...e.ChannelMessage&&{ChannelMessage:o9(e.ChannelMessage)}}),st=e=>({...e,...e.Name&&{Name:oE},...e.Processors&&{Processors:e.Processors.map(e=>o4(e))}}),si=e=>({...e,...e.InvitedBy&&{InvitedBy:oX(e.InvitedBy)},...e.Member&&{Member:oX(e.Member)}}),sr=e=>({...e,...e.Name&&{Name:oE},...e.Metadata&&{Metadata:oE}}),sn=e=>({...e,...e.ChannelSummary&&{ChannelSummary:sr(e.ChannelSummary)}}),so=e=>({...e,...e.FilterRule&&{FilterRule:oE}}),ss=e=>({...e,...e.PushNotifications&&{PushNotifications:so(e.PushNotifications)}}),sa=e=>({...e,...e.Member&&{Member:oX(e.Member)}}),sl=e=>({...e,...e.Content&&{Content:oE},...e.Metadata&&{Metadata:oE},...e.Sender&&{Sender:oX(e.Sender)},...e.MessageAttributes&&{MessageAttributes:Object.entries(e.MessageAttributes).reduce((e,[t,i])=>(e[t]=o8(i),e),{})},...e.ContentType&&{ContentType:oE}}),sd=e=>({...e,...e.Content&&{Content:oE},...e.Metadata&&{Metadata:oE},...e.Sender&&{Sender:oX(e.Sender)},...e.MessageAttributes&&{MessageAttributes:Object.entries(e.MessageAttributes).reduce((e,[t,i])=>(e[t]=o8(i),e),{})},...e.ContentType&&{ContentType:oE}}),sc=e=>({...e,...e.ChannelSummary&&{ChannelSummary:sr(e.ChannelSummary)}}),su=e=>({...e,...e.Moderator&&{Moderator:oX(e.Moderator)},...e.CreatedBy&&{CreatedBy:oX(e.CreatedBy)}}),sh=e=>({...e,...e.Moderator&&{Moderator:oX(e.Moderator)}}),sf=e=>({...e,...e.Key&&{Key:oE},...e.Value&&{Value:oE}}),sp=e=>({...e,...e.Name&&{Name:oE},...e.Metadata&&{Metadata:oE},...e.ClientRequestToken&&{ClientRequestToken:oE},...e.Tags&&{Tags:e.Tags.map(e=>sf(e))},...e.ChannelId&&{ChannelId:oE}}),sm=e=>({...e,...e.Member&&{Member:oX(e.Member)}}),sg=e=>({...e,...e.Processors&&{Processors:e.Processors.map(e=>o4(e))},...e.Name&&{Name:oE},...e.Tags&&{Tags:e.Tags.map(e=>sf(e))},...e.ClientRequestToken&&{ClientRequestToken:oE}}),sv=e=>({...e,...e.Member&&{Member:oX(e.Member)}}),sb=e=>({...e,...e.ChannelModerator&&{ChannelModerator:oX(e.ChannelModerator)}}),sy=e=>({...e,...e.Channel&&{Channel:o1(e.Channel)}}),sS=e=>({...e,...e.ChannelBan&&{ChannelBan:o3(e.ChannelBan)}}),sw=e=>({...e,...e.ChannelFlow&&{ChannelFlow:o6(e.ChannelFlow)}}),sC=e=>({...e,...e.ChannelMembership&&{ChannelMembership:si(e.ChannelMembership)}}),sk=e=>({...e,...e.ChannelMembership&&{ChannelMembership:sn(e.ChannelMembership)}}),sT=e=>({...e,...e.Channel&&{Channel:sc(e.Channel)}}),sI=e=>({...e,...e.ChannelModerator&&{ChannelModerator:su(e.ChannelModerator)}}),sE=e=>({...e,...e.Member&&{Member:oX(e.Member)},...e.Preferences&&{Preferences:ss(e.Preferences)}}),sA=e=>({...e,...e.ChannelMessage&&{ChannelMessage:sl(e.ChannelMessage)}}),sM=e=>({...e,...e.NextToken&&{NextToken:oE}}),sO=e=>({...e,...e.NextToken&&{NextToken:oE},...e.ChannelBans&&{ChannelBans:e.ChannelBans.map(e=>o5(e))}}),sP=e=>({...e,...e.NextToken&&{NextToken:oE}}),s_=e=>({...e,...e.ChannelFlows&&{ChannelFlows:e.ChannelFlows.map(e=>st(e))},...e.NextToken&&{NextToken:oE}}),sx=e=>({...e,...e.NextToken&&{NextToken:oE}}),sR=e=>({...e,...e.ChannelMemberships&&{ChannelMemberships:e.ChannelMemberships.map(e=>sa(e))},...e.NextToken&&{NextToken:oE}}),sD=e=>({...e,...e.NextToken&&{NextToken:oE}}),sN=e=>({...e,...e.ChannelMemberships&&{ChannelMemberships:e.ChannelMemberships.map(e=>sn(e))},...e.NextToken&&{NextToken:oE}}),sL=e=>({...e,...e.NextToken&&{NextToken:oE}}),sF=e=>({...e,...e.NextToken&&{NextToken:oE},...e.ChannelMessages&&{ChannelMessages:e.ChannelMessages.map(e=>sd(e))}}),sV=e=>({...e,...e.NextToken&&{NextToken:oE}}),sB=e=>({...e,...e.NextToken&&{NextToken:oE},...e.ChannelModerators&&{ChannelModerators:e.ChannelModerators.map(e=>sh(e))}}),sU=e=>({...e,...e.NextToken&&{NextToken:oE}}),sj=e=>({...e,...e.Channels&&{Channels:e.Channels.map(e=>sr(e))},...e.NextToken&&{NextToken:oE}}),s$=e=>({...e,...e.NextToken&&{NextToken:oE}}),sz=e=>({...e,...e.Channels&&{Channels:e.Channels.map(e=>o2(e))},...e.NextToken&&{NextToken:oE}}),sH=e=>({...e,...e.NextToken&&{NextToken:oE}}),sW=e=>({...e,...e.Channels&&{Channels:e.Channels.map(e=>sc(e))},...e.NextToken&&{NextToken:oE}}),sG=e=>({...e,...e.NextToken&&{NextToken:oE}}),sK=e=>({...e,...e.NextToken&&{NextToken:oE}}),sq=e=>({...e,...e.Tags&&{Tags:e.Tags.map(e=>sf(e))}}),sJ=e=>({...e,...e.Preferences&&{Preferences:ss(e.Preferences)}}),sQ=e=>({...e,...e.Member&&{Member:oX(e.Member)},...e.Preferences&&{Preferences:ss(e.Preferences)}}),sZ=e=>({...e,...e.NextToken&&{NextToken:oE}}),sX=e=>({...e,...e.Channels&&{Channels:e.Channels.map(e=>sr(e))},...e.NextToken&&{NextToken:oE}}),sY=e=>({...e,...e.Content&&{Content:oE},...e.Metadata&&{Metadata:oE},...e.ClientRequestToken&&{ClientRequestToken:oE},...e.PushNotification&&{PushNotification:o7(e.PushNotification)},...e.MessageAttributes&&{MessageAttributes:Object.entries(e.MessageAttributes).reduce((e,[t,i])=>(e[t]=o8(i),e),{})},...e.ContentType&&{ContentType:oE}}),s0=e=>({...e,...e.Tags&&{Tags:e.Tags.map(e=>sf(e))}}),s1=e=>({...e,...e.TagKeys&&{TagKeys:oE}}),s2=e=>({...e,...e.Name&&{Name:oE},...e.Metadata&&{Metadata:oE}}),s3=e=>({...e,...e.Processors&&{Processors:e.Processors.map(e=>o4(e))},...e.Name&&{Name:oE}}),s5=e=>({...e,...e.Content&&{Content:oE},...e.Metadata&&{Metadata:oE},...e.ContentType&&{ContentType:oE}}),s4=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/channel-flow"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),i=JSON.stringify(ot(e,{ChannelFlowArn:[]})),r.m("PUT").h(n).b(i),r.build()},s6=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});r.bp("/channels/{ChannelArn}/memberships"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[db]:[,"batch-create"]});return i=JSON.stringify(ot(e,{MemberArns:e=>oa(e),SubChannelId:[],Type:[]})),r.m("POST").h(n).q(o).b(i),r.build()},s8=async(e,t)=>{let i;let r=n7(e,t),n={"content-type":"application/json"};r.bp("/channels/{ChannelArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[db]:[,"channel-flow-callback"]});return i=JSON.stringify(ot(e,{CallbackId:[!0,e=>e??tt()],ChannelMessage:e=>oa(e),DeleteResource:[]})),r.m("POST").h(n).q(o).b(i),r.build()},s7=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels"),i=JSON.stringify(ot(e,{AppInstanceArn:[],ChannelId:[],ClientRequestToken:[!0,e=>e??tt()],ElasticChannelConfiguration:e=>oa(e),ExpirationSettings:e=>oa(e),MemberArns:e=>oa(e),Metadata:[],Mode:[],ModeratorArns:e=>oa(e),Name:[],Privacy:[],Tags:e=>oa(e)})),r.m("POST").h(n).b(i),r.build()},s9=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/bans"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),i=JSON.stringify(ot(e,{MemberArn:[]})),r.m("POST").h(n).b(i),r.build()},ae=async(e,t)=>{let i;let r=n7(e,t),n={"content-type":"application/json"};return r.bp("/channel-flows"),i=JSON.stringify(ot(e,{AppInstanceArn:[],ClientRequestToken:[!0,e=>e??tt()],Name:[],Processors:e=>oa(e),Tags:e=>oa(e)})),r.m("POST").h(n).b(i),r.build()},at=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/memberships"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),i=JSON.stringify(ot(e,{MemberArn:[],SubChannelId:[],Type:[]})),r.m("POST").h(n).b(i),r.build()},ai=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/moderators"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),i=JSON.stringify(ot(e,{ChannelModeratorArn:[]})),r.m("POST").h(n).b(i),r.build()},ar=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.m("DELETE").h(n).b(i),r.build()},an=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/bans/{MemberArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MemberArn",()=>e.MemberArn,"{MemberArn}",!1),r.m("DELETE").h(n).b(i),r.build()},ao=async(e,t)=>{let i;let r=n7(e,t),n={};return r.bp("/channel-flows/{ChannelFlowArn}"),r.p("ChannelFlowArn",()=>e.ChannelFlowArn,"{ChannelFlowArn}",!1),r.m("DELETE").h(n).b(i),r.build()},as=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/memberships/{MemberArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MemberArn",()=>e.MemberArn,"{MemberArn}",!1);let o=oe({[dw]:[,e[da]]});return r.m("DELETE").h(n).q(o).b(i),r.build()},aa=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/messages/{MessageId}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MessageId",()=>e.MessageId,"{MessageId}",!1);let o=oe({[dw]:[,e[da]]});return r.m("DELETE").h(n).q(o).b(i),r.build()},al=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/moderators/{ChannelModeratorArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("ChannelModeratorArn",()=>e.ChannelModeratorArn,"{ChannelModeratorArn}",!1),r.m("DELETE").h(n).b(i),r.build()},ad=async(e,t)=>{let i;let r=n7(e,t),n={};return r.bp("/app-instances/{AppInstanceArn}/streaming-configurations"),r.p("AppInstanceArn",()=>e.AppInstanceArn,"{AppInstanceArn}",!1),r.m("DELETE").h(n).b(i),r.build()},ac=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.m("GET").h(n).b(i),r.build()},au=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/bans/{MemberArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MemberArn",()=>e.MemberArn,"{MemberArn}",!1),r.m("GET").h(n).b(i),r.build()},ah=async(e,t)=>{let i;let r=n7(e,t),n={};return r.bp("/channel-flows/{ChannelFlowArn}"),r.p("ChannelFlowArn",()=>e.ChannelFlowArn,"{ChannelFlowArn}",!1),r.m("GET").h(n).b(i),r.build()},af=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/memberships/{MemberArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MemberArn",()=>e.MemberArn,"{MemberArn}",!1);let o=oe({[dw]:[,e[da]]});return r.m("GET").h(n).q(o).b(i),r.build()},ap=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[dS]:[,"app-instance-user-membership"],[dh]:[,oc(e[l8],"AppInstanceUserArn")]});return r.m("GET").h(n).q(o).b(i),r.build()},am=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[dS]:[,"app-instance-user-moderated-channel"],[dh]:[,oc(e[l8],"AppInstanceUserArn")]});return r.m("GET").h(n).q(o).b(i),r.build()},ag=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/moderators/{ChannelModeratorArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("ChannelModeratorArn",()=>e.ChannelModeratorArn,"{ChannelModeratorArn}",!1),r.m("GET").h(n).b(i),r.build()},av=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/channel-flow/{ChannelFlowArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("ChannelFlowArn",()=>e.ChannelFlowArn,"{ChannelFlowArn}",!1),r.m("DELETE").h(n).b(i),r.build()},ab=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/memberships/{MemberArn}/preferences"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MemberArn",()=>e.MemberArn,"{MemberArn}",!1),r.m("GET").h(n).b(i),r.build()},ay=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/messages/{MessageId}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MessageId",()=>e.MessageId,"{MessageId}",!1);let o=oe({[dw]:[,e[da]]});return r.m("GET").h(n).q(o).b(i),r.build()},aS=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/messages/{MessageId}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MessageId",()=>e.MessageId,"{MessageId}",!1);let o=oe({[dS]:[,"message-status"],[dw]:[,e[da]]});return r.m("GET").h(n).q(o).b(i),r.build()},aw=async(e,t)=>{let i;let r=n7(e,t),n={};return r.bp("/endpoints/messaging-session"),r.m("GET").h(n).b(i),r.build()},aC=async(e,t)=>{let i;let r=n7(e,t),n={};return r.bp("/app-instances/{AppInstanceArn}/streaming-configurations"),r.p("AppInstanceArn",()=>e.AppInstanceArn,"{AppInstanceArn}",!1),r.m("GET").h(n).b(i),r.build()},ak=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/bans"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return r.m("GET").h(n).q(o).b(i),r.build()},aT=async(e,t)=>{let i;let r=n7(e,t),n={};r.bp("/channel-flows");let o=oe({[du]:[,oc(e[l6],"AppInstanceArn")],[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return r.m("GET").h(n).q(o).b(i),r.build()},aI=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/memberships"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[dk]:[,e[dd]],[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]],[dw]:[,e[da]]});return r.m("GET").h(n).q(o).b(i),r.build()},aE=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels");let o=oe({[dS]:[,"app-instance-user-memberships"],[dh]:[,e[l8]],[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return r.m("GET").h(n).q(o).b(i),r.build()},aA=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/messages"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[dC]:[,e[dl]],[dg]:[()=>void 0!==e.NotBefore,()=>ob(e[di]).toString()],[dm]:[()=>void 0!==e.NotAfter,()=>ob(e[dt]).toString()],[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]],[dw]:[,e[da]]});return r.m("GET").h(n).q(o).b(i),r.build()},aM=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/moderators"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return r.m("GET").h(n).q(o).b(i),r.build()},aO=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels");let o=oe({[du]:[,oc(e[l6],"AppInstanceArn")],[dy]:[,e[dn]],[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return r.m("GET").h(n).q(o).b(i),r.build()},aP=async(e,t)=>{let i;let r=n7(e,t),n={};r.bp("/channels");let o=oe({[dS]:[,"channel-flow-associations"],[df]:[,oc(e[l9],"ChannelFlowArn")],[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return r.m("GET").h(n).q(o).b(i),r.build()},a_=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels");let o=oe({[dS]:[,"app-instance-user-moderated-channels"],[dh]:[,e[l8]],[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return r.m("GET").h(n).q(o).b(i),r.build()},ax=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});r.bp("/channels/{ChannelArn}/subchannels"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1);let o=oe({[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return r.m("GET").h(n).q(o).b(i),r.build()},aR=async(e,t)=>{let i;let r=n7(e,t),n={};r.bp("/tags");let o=oe({[dc]:[,oc(e[ds],"ResourceARN")]});return r.m("GET").h(n).q(o).b(i),r.build()},aD=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/expiration-settings"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),i=JSON.stringify(ot(e,{ExpirationSettings:e=>oa(e)})),r.m("PUT").h(n).b(i),r.build()},aN=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/memberships/{MemberArn}/preferences"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MemberArn",()=>e.MemberArn,"{MemberArn}",!1),i=JSON.stringify(ot(e,{Preferences:e=>oa(e)})),r.m("PUT").h(n).b(i),r.build()},aL=async(e,t)=>{let i;let r=n7(e,t),n={"content-type":"application/json"};return r.bp("/app-instances/{AppInstanceArn}/streaming-configurations"),r.p("AppInstanceArn",()=>e.AppInstanceArn,"{AppInstanceArn}",!1),i=JSON.stringify(ot(e,{StreamingConfigurations:e=>oa(e)})),r.m("PUT").h(n).b(i),r.build()},aF=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});r.bp("/channels/{ChannelArn}/messages/{MessageId}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MessageId",()=>e.MessageId,"{MessageId}",!1);let o=oe({[db]:[,"redact"]});return i=JSON.stringify(ot(e,{SubChannelId:[]})),r.m("POST").h(n).q(o).b(i),r.build()},aV=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});r.bp("/channels");let o=oe({[db]:[,"search"],[dp]:[()=>void 0!==e.MaxResults,()=>e[de].toString()],[dv]:[,e[dr]]});return i=JSON.stringify(ot(e,{Fields:e=>oa(e)})),r.m("POST").h(n).q(o).b(i),r.build()},aB=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/messages"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),i=JSON.stringify(ot(e,{ClientRequestToken:[!0,e=>e??tt()],Content:[],ContentType:[],MessageAttributes:e=>oa(e),Metadata:[],Persistence:[],PushNotification:e=>oa(e),SubChannelId:[],Target:e=>oa(e),Type:[]})),r.m("POST").h(n).b(i),r.build()},aU=async(e,t)=>{let i;let r=n7(e,t),n={"content-type":"application/json"};r.bp("/tags");let o=oe({[db]:[,"tag-resource"]});return i=JSON.stringify(ot(e,{ResourceARN:[],Tags:e=>oa(e)})),r.m("POST").h(n).q(o).b(i),r.build()},aj=async(e,t)=>{let i;let r=n7(e,t),n={"content-type":"application/json"};r.bp("/tags");let o=oe({[db]:[,"untag-resource"]});return i=JSON.stringify(ot(e,{ResourceARN:[],TagKeys:e=>oa(e)})),r.m("POST").h(n).q(o).b(i),r.build()},a$=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),i=JSON.stringify(ot(e,{Metadata:[],Mode:[],Name:[]})),r.m("PUT").h(n).b(i),r.build()},az=async(e,t)=>{let i;let r=n7(e,t),n={"content-type":"application/json"};return r.bp("/channel-flows/{ChannelFlowArn}"),r.p("ChannelFlowArn",()=>e.ChannelFlowArn,"{ChannelFlowArn}",!1),i=JSON.stringify(ot(e,{Name:[],Processors:e=>oa(e)})),r.m("PUT").h(n).b(i),r.build()},aH=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{"content-type":"application/json",[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/messages/{MessageId}"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.p("MessageId",()=>e.MessageId,"{MessageId}",!1),i=JSON.stringify(ot(e,{Content:[],ContentType:[],Metadata:[],SubChannelId:[]})),r.m("PUT").h(n).b(i),r.build()},aW=async(e,t)=>{let i;let r=n7(e,t),n=oe({},os,{[dT]:e[l7]});return r.bp("/channels/{ChannelArn}/readMarker"),r.p("ChannelArn",()=>e.ChannelArn,"{ChannelArn}",!1),r.m("PUT").h(n).b(i),r.build()},aG=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},aK=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{BatchChannelMemberships:oa,Errors:oa})),i},aq=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{CallbackId:oh,ChannelArn:oh})),i},aJ=async(e,t)=>{if(201!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh})),i},aQ=async(e,t)=>{if(201!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,Member:oa})),i},aZ=async(e,t)=>{if(201!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelFlowArn:oh})),i},aX=async(e,t)=>{if(201!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,Member:oa,SubChannelId:oh})),i},aY=async(e,t)=>{if(201!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,ChannelModerator:oa})),i},a0=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},a1=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},a2=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},a3=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},a5=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},a4=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},a6=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},a8=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Channel:e=>lW(e,t)})),i},a7=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelBan:e=>lG(e,t)})),i},a9=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelFlow:e=>lK(e,t)})),i},le=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelMembership:e=>lq(e,t)})),i},lt=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelMembership:e=>lJ(e,t)})),i},li=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Channel:e=>l0(e,t)})),i},lr=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelModerator:e=>l2(e,t)})),i},ln=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},lo=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,Member:oa,Preferences:oa})),i},ls=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelMessage:e=>lZ(e,t)})),i},la=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Status:oa})),i},ll=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Endpoint:oa})),i},ld=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{StreamingConfigurations:oa})),i},lc=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,ChannelBans:oa,NextToken:oh})),i},lu=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelFlows:oa,NextToken:oh})),i},lh=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,ChannelMemberships:oa,NextToken:oh})),i},lf=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelMemberships:e=>lQ(e,t),NextToken:oh})),i},lp=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,ChannelMessages:e=>lY(e,t),NextToken:oh,SubChannelId:oh})),i},lm=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,ChannelModerators:oa,NextToken:oh})),i},lg=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Channels:e=>l5(e,t),NextToken:oh})),i},lv=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Channels:oa,NextToken:oh})),i},lb=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Channels:e=>l1(e,t),NextToken:oh})),i},ly=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,NextToken:oh,SubChannels:oa})),i},lS=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Tags:oa})),i},lw=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,ExpirationSettings:oa})),i},lC=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,Member:oa,Preferences:oa})),i},lk=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{StreamingConfigurations:oa})),i},lT=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,MessageId:oh,SubChannelId:oh})),i},lI=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{Channels:e=>l5(e,t),NextToken:oh})),i},lE=async(e,t)=>{if(201!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,MessageId:oh,Status:oa,SubChannelId:oh})),i},lA=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},lM=async(e,t)=>{if(204!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return await n1(e.body,t),i},lO=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh})),i},lP=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelFlowArn:oh})),i},l_=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh,MessageId:oh,Status:oa,SubChannelId:oh})),i},lx=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return lR(e,t);let i=oe({$metadata:l4(e)});return Object.assign(i,ot(oc(ou(await n3(e.body,t)),"body"),{ChannelArn:oh})),i},lR=async(e,t)=>{let i={...e,body:await n5(e.body,t)},r=n4(e,i.body);switch(r){case"BadRequestException":case"com.amazonaws.chimesdkmessaging#BadRequestException":throw await lN(i,t);case"ConflictException":case"com.amazonaws.chimesdkmessaging#ConflictException":throw await lL(i,t);case"ForbiddenException":case"com.amazonaws.chimesdkmessaging#ForbiddenException":throw await lF(i,t);case"NotFoundException":case"com.amazonaws.chimesdkmessaging#NotFoundException":throw await lV(i,t);case"ServiceFailureException":case"com.amazonaws.chimesdkmessaging#ServiceFailureException":throw await lU(i,t);case"ServiceUnavailableException":case"com.amazonaws.chimesdkmessaging#ServiceUnavailableException":throw await lj(i,t);case"ThrottledClientException":case"com.amazonaws.chimesdkmessaging#ThrottledClientException":throw await l$(i,t);case"UnauthorizedClientException":case"com.amazonaws.chimesdkmessaging#UnauthorizedClientException":throw await lz(i,t);case"ResourceLimitExceededException":case"com.amazonaws.chimesdkmessaging#ResourceLimitExceededException":throw await lB(i,t);default:return lD({output:e,parsedBody:i.body,errorCode:r})}},lD=oC(oI),lN=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new oP({$metadata:l4(e),...i}),e.body)},lL=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new o_({$metadata:l4(e),...i}),e.body)},lF=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new ox({$metadata:l4(e),...i}),e.body)},lV=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new oR({$metadata:l4(e),...i}),e.body)},lB=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new oV({$metadata:l4(e),...i}),e.body)},lU=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new oD({$metadata:l4(e),...i}),e.body)},lj=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new oN({$metadata:l4(e),...i}),e.body)},l$=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new oL({$metadata:l4(e),...i}),e.body)},lz=async(e,t)=>{let i=oe({});return Object.assign(i,ot(e.body,{Code:oh,Message:oh})),oS(new oF({$metadata:l4(e),...i}),e.body)},lH=(e,t)=>ot(e,{ReadMarkerTimestamp:e=>oc(oT(od(e))),SubChannelId:oh,Type:oh}),lW=(e,t)=>ot(e,{ChannelArn:oh,ChannelFlowArn:oh,CreatedBy:oa,CreatedTimestamp:e=>oc(oT(od(e))),ElasticChannelConfiguration:oa,ExpirationSettings:oa,LastMessageTimestamp:e=>oc(oT(od(e))),LastUpdatedTimestamp:e=>oc(oT(od(e))),Metadata:oh,Mode:oh,Name:oh,Privacy:oh}),lG=(e,t)=>ot(e,{ChannelArn:oh,CreatedBy:oa,CreatedTimestamp:e=>oc(oT(od(e))),Member:oa}),lK=(e,t)=>ot(e,{ChannelFlowArn:oh,CreatedTimestamp:e=>oc(oT(od(e))),LastUpdatedTimestamp:e=>oc(oT(od(e))),Name:oh,Processors:oa}),lq=(e,t)=>ot(e,{ChannelArn:oh,CreatedTimestamp:e=>oc(oT(od(e))),InvitedBy:oa,LastUpdatedTimestamp:e=>oc(oT(od(e))),Member:oa,SubChannelId:oh,Type:oh}),lJ=(e,t)=>ot(e,{AppInstanceUserMembershipSummary:e=>lH(e,t),ChannelSummary:e=>l3(e,t)}),lQ=(e,t)=>(e||[]).filter(e=>null!=e).map(e=>lJ(e,t)),lZ=(e,t)=>ot(e,{ChannelArn:oh,Content:oh,ContentType:oh,CreatedTimestamp:e=>oc(oT(od(e))),LastEditedTimestamp:e=>oc(oT(od(e))),LastUpdatedTimestamp:e=>oc(oT(od(e))),MessageAttributes:oa,MessageId:oh,Metadata:oh,Persistence:oh,Redacted:ol,Sender:oa,Status:oa,SubChannelId:oh,Target:oa,Type:oh}),lX=(e,t)=>ot(e,{Content:oh,ContentType:oh,CreatedTimestamp:e=>oc(oT(od(e))),LastEditedTimestamp:e=>oc(oT(od(e))),LastUpdatedTimestamp:e=>oc(oT(od(e))),MessageAttributes:oa,MessageId:oh,Metadata:oh,Redacted:ol,Sender:oa,Status:oa,Target:oa,Type:oh}),lY=(e,t)=>(e||[]).filter(e=>null!=e).map(e=>lX(e,t)),l0=(e,t)=>ot(e,{ChannelSummary:e=>l3(e,t)}),l1=(e,t)=>(e||[]).filter(e=>null!=e).map(e=>l0(e,t)),l2=(e,t)=>ot(e,{ChannelArn:oh,CreatedBy:oa,CreatedTimestamp:e=>oc(oT(od(e))),Moderator:oa}),l3=(e,t)=>ot(e,{ChannelArn:oh,LastMessageTimestamp:e=>oc(oT(od(e))),Metadata:oh,Mode:oh,Name:oh,Privacy:oh}),l5=(e,t)=>(e||[]).filter(e=>null!=e).map(e=>l3(e,t)),l4=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),l6="AppInstanceArn",l8="AppInstanceUserArn",l7="ChimeBearer",l9="ChannelFlowArn",de="MaxResults",dt="NotAfter",di="NotBefore",dr="NextToken",dn="Privacy",ds="ResourceARN",da="SubChannelId",dl="SortOrder",dd="Type",dc="arn",du="app-instance-arn",dh="app-instance-user-arn",df="channel-flow-arn",dp="max-results",dm="not-after",dg="not-before",dv="next-token",db="operation",dy="privacy",dS="scope",dw="sub-channel-id",dC="sort-order",dk="type",dT="x-amz-chime-bearer";class dI extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","AssociateChannelFlow",{}).n("ChimeSDKMessagingClient","AssociateChannelFlowCommand").f(void 0,void 0).ser(s4).de(aG).build(){}class dE extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","BatchCreateChannelMembership",{}).n("ChimeSDKMessagingClient","BatchCreateChannelMembershipCommand").f(void 0,o0).ser(s6).de(aK).build(){}class dA extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ChannelFlowCallback",{}).n("ChimeSDKMessagingClient","ChannelFlowCallbackCommand").f(se,void 0).ser(s8).de(aq).build(){}class dM extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannelBan",{}).n("ChimeSDKMessagingClient","CreateChannelBanCommand").f(void 0,sm).ser(s9).de(aQ).build(){}class dO extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannel",{}).n("ChimeSDKMessagingClient","CreateChannelCommand").f(sp,void 0).ser(s7).de(aJ).build(){}class dP extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannelFlow",{}).n("ChimeSDKMessagingClient","CreateChannelFlowCommand").f(sg,void 0).ser(ae).de(aZ).build(){}class d_ extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannelMembership",{}).n("ChimeSDKMessagingClient","CreateChannelMembershipCommand").f(void 0,sv).ser(at).de(aX).build(){}class dx extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","CreateChannelModerator",{}).n("ChimeSDKMessagingClient","CreateChannelModeratorCommand").f(void 0,sb).ser(ai).de(aY).build(){}class dR extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelBan",{}).n("ChimeSDKMessagingClient","DeleteChannelBanCommand").f(void 0,void 0).ser(an).de(a1).build(){}class dD extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannel",{}).n("ChimeSDKMessagingClient","DeleteChannelCommand").f(void 0,void 0).ser(ar).de(a0).build(){}class dN extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelFlow",{}).n("ChimeSDKMessagingClient","DeleteChannelFlowCommand").f(void 0,void 0).ser(ao).de(a2).build(){}class dL extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelMembership",{}).n("ChimeSDKMessagingClient","DeleteChannelMembershipCommand").f(void 0,void 0).ser(as).de(a3).build(){}class dF extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelMessage",{}).n("ChimeSDKMessagingClient","DeleteChannelMessageCommand").f(void 0,void 0).ser(aa).de(a5).build(){}class dV extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteChannelModerator",{}).n("ChimeSDKMessagingClient","DeleteChannelModeratorCommand").f(void 0,void 0).ser(al).de(a4).build(){}class dB extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DeleteMessagingStreamingConfigurations",{}).n("ChimeSDKMessagingClient","DeleteMessagingStreamingConfigurationsCommand").f(void 0,void 0).ser(ad).de(a6).build(){}class dU extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelBan",{}).n("ChimeSDKMessagingClient","DescribeChannelBanCommand").f(void 0,sS).ser(au).de(a7).build(){}class dj extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannel",{}).n("ChimeSDKMessagingClient","DescribeChannelCommand").f(void 0,sy).ser(ac).de(a8).build(){}class d$ extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelFlow",{}).n("ChimeSDKMessagingClient","DescribeChannelFlowCommand").f(void 0,sw).ser(ah).de(a9).build(){}class dz extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelMembership",{}).n("ChimeSDKMessagingClient","DescribeChannelMembershipCommand").f(void 0,sC).ser(af).de(le).build(){}class dH extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelMembershipForAppInstanceUser",{}).n("ChimeSDKMessagingClient","DescribeChannelMembershipForAppInstanceUserCommand").f(void 0,sk).ser(ap).de(lt).build(){}class dW extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelModeratedByAppInstanceUser",{}).n("ChimeSDKMessagingClient","DescribeChannelModeratedByAppInstanceUserCommand").f(void 0,sT).ser(am).de(li).build(){}class dG extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DescribeChannelModerator",{}).n("ChimeSDKMessagingClient","DescribeChannelModeratorCommand").f(void 0,sI).ser(ag).de(lr).build(){}class dK extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","DisassociateChannelFlow",{}).n("ChimeSDKMessagingClient","DisassociateChannelFlowCommand").f(void 0,void 0).ser(av).de(ln).build(){}class dq extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetChannelMembershipPreferences",{}).n("ChimeSDKMessagingClient","GetChannelMembershipPreferencesCommand").f(void 0,sE).ser(ab).de(lo).build(){}class dJ extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetChannelMessage",{}).n("ChimeSDKMessagingClient","GetChannelMessageCommand").f(void 0,sA).ser(ay).de(ls).build(){}class dQ extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetChannelMessageStatus",{}).n("ChimeSDKMessagingClient","GetChannelMessageStatusCommand").f(void 0,void 0).ser(aS).de(la).build(){}class dZ extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetMessagingSessionEndpoint",{}).n("ChimeSDKMessagingClient","GetMessagingSessionEndpointCommand").f(void 0,void 0).ser(aw).de(ll).build(){}class dX extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","GetMessagingStreamingConfigurations",{}).n("ChimeSDKMessagingClient","GetMessagingStreamingConfigurationsCommand").f(void 0,void 0).ser(aC).de(ld).build(){}class dY extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelBans",{}).n("ChimeSDKMessagingClient","ListChannelBansCommand").f(sM,sO).ser(ak).de(lc).build(){}class d0 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelFlows",{}).n("ChimeSDKMessagingClient","ListChannelFlowsCommand").f(sP,s_).ser(aT).de(lu).build(){}class d1 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelMemberships",{}).n("ChimeSDKMessagingClient","ListChannelMembershipsCommand").f(sx,sR).ser(aI).de(lh).build(){}class d2 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelMembershipsForAppInstanceUser",{}).n("ChimeSDKMessagingClient","ListChannelMembershipsForAppInstanceUserCommand").f(sD,sN).ser(aE).de(lf).build(){}class d3 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelMessages",{}).n("ChimeSDKMessagingClient","ListChannelMessagesCommand").f(sL,sF).ser(aA).de(lp).build(){}class d5 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelModerators",{}).n("ChimeSDKMessagingClient","ListChannelModeratorsCommand").f(sV,sB).ser(aM).de(lm).build(){}class d4 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelsAssociatedWithChannelFlow",{}).n("ChimeSDKMessagingClient","ListChannelsAssociatedWithChannelFlowCommand").f(s$,sz).ser(aP).de(lv).build(){}class d6 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannels",{}).n("ChimeSDKMessagingClient","ListChannelsCommand").f(sU,sj).ser(aO).de(lg).build(){}class d8 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListChannelsModeratedByAppInstanceUser",{}).n("ChimeSDKMessagingClient","ListChannelsModeratedByAppInstanceUserCommand").f(sH,sW).ser(a_).de(lb).build(){}class d7 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListSubChannels",{}).n("ChimeSDKMessagingClient","ListSubChannelsCommand").f(sG,sK).ser(ax).de(ly).build(){}class d9 extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","ListTagsForResource",{}).n("ChimeSDKMessagingClient","ListTagsForResourceCommand").f(void 0,sq).ser(aR).de(lS).build(){}class ce extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","PutChannelExpirationSettings",{}).n("ChimeSDKMessagingClient","PutChannelExpirationSettingsCommand").f(void 0,void 0).ser(aD).de(lw).build(){}class ct extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","PutChannelMembershipPreferences",{}).n("ChimeSDKMessagingClient","PutChannelMembershipPreferencesCommand").f(sJ,sQ).ser(aN).de(lC).build(){}class ci extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","PutMessagingStreamingConfigurations",{}).n("ChimeSDKMessagingClient","PutMessagingStreamingConfigurationsCommand").f(void 0,void 0).ser(aL).de(lk).build(){}class cr extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","RedactChannelMessage",{}).n("ChimeSDKMessagingClient","RedactChannelMessageCommand").f(void 0,void 0).ser(aF).de(lT).build(){}class cn extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","SearchChannels",{}).n("ChimeSDKMessagingClient","SearchChannelsCommand").f(sZ,sX).ser(aV).de(lI).build(){}class co extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","SendChannelMessage",{}).n("ChimeSDKMessagingClient","SendChannelMessageCommand").f(sY,void 0).ser(aB).de(lE).build(){}class cs extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","TagResource",{}).n("ChimeSDKMessagingClient","TagResourceCommand").f(s0,void 0).ser(aU).de(lA).build(){}class ca extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UntagResource",{}).n("ChimeSDKMessagingClient","UntagResourceCommand").f(s1,void 0).ser(aj).de(lM).build(){}class cl extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UpdateChannel",{}).n("ChimeSDKMessagingClient","UpdateChannelCommand").f(s2,void 0).ser(a$).de(lO).build(){}class cd extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UpdateChannelFlow",{}).n("ChimeSDKMessagingClient","UpdateChannelFlowCommand").f(s3,void 0).ser(az).de(lP).build(){}class cc extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UpdateChannelMessage",{}).n("ChimeSDKMessagingClient","UpdateChannelMessageCommand").f(s5,void 0).ser(aH).de(l_).build(){}class cu extends nQ.classBuilder().ep(iv).m(function(e,t,i,r){return[nE(i,this.serialize,this.deserialize),nB(i,e.getEndpointParameterInstructions())]}).s("ChimeMessagingService","UpdateChannelReadMarker",{}).n("ChimeSDKMessagingClient","UpdateChannelReadMarkerCommand").f(void 0,void 0).ser(aW).de(lx).build(){}let ch={AssociateChannelFlowCommand:dI,BatchCreateChannelMembershipCommand:dE,ChannelFlowCallbackCommand:dA,CreateChannelCommand:dO,CreateChannelBanCommand:dM,CreateChannelFlowCommand:dP,CreateChannelMembershipCommand:d_,CreateChannelModeratorCommand:dx,DeleteChannelCommand:dD,DeleteChannelBanCommand:dR,DeleteChannelFlowCommand:dN,DeleteChannelMembershipCommand:dL,DeleteChannelMessageCommand:dF,DeleteChannelModeratorCommand:dV,DeleteMessagingStreamingConfigurationsCommand:dB,DescribeChannelCommand:dj,DescribeChannelBanCommand:dU,DescribeChannelFlowCommand:d$,DescribeChannelMembershipCommand:dz,DescribeChannelMembershipForAppInstanceUserCommand:dH,DescribeChannelModeratedByAppInstanceUserCommand:dW,DescribeChannelModeratorCommand:dG,DisassociateChannelFlowCommand:dK,GetChannelMembershipPreferencesCommand:dq,GetChannelMessageCommand:dJ,GetChannelMessageStatusCommand:dQ,GetMessagingSessionEndpointCommand:dZ,GetMessagingStreamingConfigurationsCommand:dX,ListChannelBansCommand:dY,ListChannelFlowsCommand:d0,ListChannelMembershipsCommand:d1,ListChannelMembershipsForAppInstanceUserCommand:d2,ListChannelMessagesCommand:d3,ListChannelModeratorsCommand:d5,ListChannelsCommand:d6,ListChannelsAssociatedWithChannelFlowCommand:d4,ListChannelsModeratedByAppInstanceUserCommand:d8,ListSubChannelsCommand:d7,ListTagsForResourceCommand:d9,PutChannelExpirationSettingsCommand:ce,PutChannelMembershipPreferencesCommand:ct,PutMessagingStreamingConfigurationsCommand:ci,RedactChannelMessageCommand:cr,SearchChannelsCommand:cn,SendChannelMessageCommand:co,TagResourceCommand:cs,UntagResourceCommand:ca,UpdateChannelCommand:cl,UpdateChannelFlowCommand:cd,UpdateChannelMessageCommand:cc,UpdateChannelReadMarkerCommand:cu};class cf extends ny{}nS(ch,cf);let cp=async(e,t,i,r=e=>e,...n)=>{let o=new e(i);return o=r(o)??o,await t.send(o,...n)};function cm(e,t,i,r,n){return async function*(o,s,...a){let l;let d=s,c=o.startingToken??d[i],u=!0;for(;u;){if(d[i]=c,n&&(d[n]=d[n]??o.pageSize),o.client instanceof e)l=await cp(t,o.client,s,o.withCommand,...a);else throw Error(`Invalid client, expected instance of ${e.name}`);yield l;let h=c;u=!!((c=cg(l,r))&&(!o.stopOnSameToken||c!==h))}}}let cg=(e,t)=>{let i=e;for(let e of t.split(".")){if(!i||"object"!=typeof i)return;i=i[e]}return i},cv=cm(ny,dY,"NextToken","NextToken","MaxResults"),cb=cm(ny,d0,"NextToken","NextToken","MaxResults"),cy=cm(ny,d2,"NextToken","NextToken","MaxResults"),cS=cm(ny,d1,"NextToken","NextToken","MaxResults"),cw=cm(ny,d3,"NextToken","NextToken","MaxResults"),cC=cm(ny,d5,"NextToken","NextToken","MaxResults"),ck=cm(ny,d4,"NextToken","NextToken","MaxResults"),cT=cm(ny,d8,"NextToken","NextToken","MaxResults"),cI=cm(ny,d6,"NextToken","NextToken","MaxResults"),cE=cm(ny,d7,"NextToken","NextToken","MaxResults"),cA=cm(ny,cn,"NextToken","NextToken","MaxResults")},3538:function(e,t,i){"use strict";i.r(t),i.d(t,{fromHex:function(){return o},toHex:function(){return s}});let r={},n={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),r[e]=t,n[t]=e}function o(e){if(e.length%2!=0)throw Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2){let r=e.slice(i,i+2).toLowerCase();if(r in n)t[i/2]=n[r];else throw Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`)}return t}function s(e){let t="";for(let i=0;i<e.byteLength;i++)t+=r[e[i]];return t}},9193:function(e,t,i){"use strict";i.r(t),i.d(t,{fromUtf8:function(){return a},toUtf8:function(){return l}});let r=e=>{let t=[];for(let i=0,r=e.length;i<r;i++){let r=e.charCodeAt(i);if(r<128)t.push(r);else if(r<2048)t.push(r>>6|192,63&r|128);else if(i+1<e.length&&(64512&r)==55296&&(64512&e.charCodeAt(i+1))==56320){let n=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i));t.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else t.push(r>>12|224,r>>6&63|128,63&r|128)}return Uint8Array.from(t)},n=e=>{let t="";for(let i=0,r=e.length;i<r;i++){let r=e[i];r<128?t+=String.fromCharCode(r):192<=r&&r<224?t+=String.fromCharCode((31&r)<<6|63&e[++i]):240<=r&&r<365?t+=decodeURIComponent("%"+[r,e[++i],e[++i],e[++i]].map(e=>e.toString(16)).join("%")):t+=String.fromCharCode((15&r)<<12|(63&e[++i])<<6|63&e[++i])}return t};function o(e){return new TextEncoder().encode(e)}function s(e){return new TextDecoder("utf-8").decode(e)}let a=e=>"function"==typeof TextEncoder?o(e):r(e),l=e=>"function"==typeof TextDecoder?s(e):n(e)},4537:function(e){"use strict";function t(e,t){for(var i=Array(arguments.length-1),r=0,n=2,o=!0;n<arguments.length;)i[r++]=arguments[n++];return new Promise(function(n,s){i[r]=function(e){if(o){if(o=!1,e)s(e);else{for(var t=Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];n.apply(null,t)}}};try{e.apply(t||null,i)}catch(e){o&&(o=!1,s(e))}})}e.exports=t},7419:function(e,t){"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var r=Array(64),n=Array(123),o=0;o<64;)n[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;i.encode=function(e,t,i){for(var n,o=null,s=[],a=0,l=0;t<i;){var d=e[t++];switch(l){case 0:s[a++]=r[d>>2],n=(3&d)<<4,l=1;break;case 1:s[a++]=r[n|d>>4],n=(15&d)<<2,l=2;break;case 2:s[a++]=r[n|d>>6],s[a++]=r[63&d],l=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return(l&&(s[a++]=r[n],s[a++]=61,1===l&&(s[a++]=61)),o)?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";i.decode=function(e,t,i){for(var r,o=i,a=0,l=0;l<e.length;){var d=e.charCodeAt(l++);if(61===d&&a>1)break;if(void 0===(d=n[d]))throw Error(s);switch(a){case 0:r=d,a=1;break;case 1:t[i++]=r<<2|(48&d)>>4,r=d,a=2;break;case 2:t[i++]=(15&r)<<4|(60&d)>>2,r=d,a=3;break;case 3:t[i++]=(3&r)<<6|d,a=0}}if(1===a)throw Error(s);return i-o},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},9211:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],r=0;r<i.length;)i[r].fn===t?i.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],r=1;r<arguments.length;)i.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,i)}return this}},945:function(e){"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),r=128===i[3];function n(e,r,n){t[0]=e,r[n]=i[0],r[n+1]=i[1],r[n+2]=i[2],r[n+3]=i[3]}function o(e,r,n){t[0]=e,r[n]=i[3],r[n+1]=i[2],r[n+2]=i[1],r[n+3]=i[0]}function s(e,r){return i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i[3]=e[r+3],t[0]}function a(e,r){return i[3]=e[r],i[2]=e[r+1],i[1]=e[r+2],i[0]=e[r+3],t[0]}e.writeFloatLE=r?n:o,e.writeFloatBE=r?o:n,e.readFloatLE=r?s:a,e.readFloatBE=r?a:s}():function(){function t(e,t,i,r){var n=t<0?1:0;if(n&&(t=-t),0===t)e(1/t>0?0:2147483648,i,r);else if(isNaN(t))e(2143289344,i,r);else if(t>34028234663852886e22)e((n<<31|2139095040)>>>0,i,r);else if(t<11754943508222875e-54)e((n<<31|Math.round(t/1401298464324817e-60))>>>0,i,r);else{var o=Math.floor(Math.log(t)/Math.LN2),s=8388607&Math.round(t*Math.pow(2,-o)*8388608);e((n<<31|o+127<<23|s)>>>0,i,r)}}function s(e,t,i){var r=e(t,i),n=(r>>31)*2+1,o=r>>>23&255,s=8388607&r;return 255===o?s?NaN:1/0*n:0===o?1401298464324817e-60*n*s:n*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,r),e.readFloatLE=s.bind(null,n),e.readFloatBE=s.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),r=128===i[7];function n(e,r,n){t[0]=e,r[n]=i[0],r[n+1]=i[1],r[n+2]=i[2],r[n+3]=i[3],r[n+4]=i[4],r[n+5]=i[5],r[n+6]=i[6],r[n+7]=i[7]}function o(e,r,n){t[0]=e,r[n]=i[7],r[n+1]=i[6],r[n+2]=i[5],r[n+3]=i[4],r[n+4]=i[3],r[n+5]=i[2],r[n+6]=i[1],r[n+7]=i[0]}function s(e,r){return i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i[3]=e[r+3],i[4]=e[r+4],i[5]=e[r+5],i[6]=e[r+6],i[7]=e[r+7],t[0]}function a(e,r){return i[7]=e[r],i[6]=e[r+1],i[5]=e[r+2],i[4]=e[r+3],i[3]=e[r+4],i[2]=e[r+5],i[1]=e[r+6],i[0]=e[r+7],t[0]}e.writeDoubleLE=r?n:o,e.writeDoubleBE=r?o:n,e.readDoubleLE=r?s:a,e.readDoubleBE=r?a:s}():function(){function t(e,t,i,r,n,o){var s,a=r<0?1:0;if(a&&(r=-r),0===r)e(0,n,o+t),e(1/r>0?0:2147483648,n,o+i);else if(isNaN(r))e(0,n,o+t),e(2146959360,n,o+i);else if(r>17976931348623157e292)e(0,n,o+t),e((a<<31|2146435072)>>>0,n,o+i);else if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,n,o+t),e((a<<31|s/4294967296)>>>0,n,o+i);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(s=r*Math.pow(2,-l))>>>0,n,o+t),e((a<<31|l+1023<<20|1048576*s&1048575)>>>0,n,o+i)}}function s(e,t,i,r,n){var o=e(r,n+t),s=e(r,n+i),a=(s>>31)*2+1,l=s>>>20&2047,d=4294967296*(1048575&s)+o;return 2047===l?d?NaN:1/0*a:0===l?5e-324*a*d:a*Math.pow(2,l-1075)*(d+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=s.bind(null,n,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function i(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function r(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function n(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},6662:function(e){"use strict";function t(e,t,i){var r=i||8192,n=r>>>1,o=null,s=r;return function(i){if(i<1||i>n)return e(i);s+i>r&&(o=e(r),s=0);var a=t.call(o,s,s+=i);return 7&s&&(s=(7|s)+1),a}}e.exports=t},4997:function(e,t){"use strict";var i=t;i.length=function(e){for(var t=0,i=0,r=0;r<e.length;++r)(i=e.charCodeAt(r))<128?t+=1:i<2048?t+=2:(64512&i)==55296&&(64512&e.charCodeAt(r+1))==56320?(++r,t+=4):t+=3;return t},i.read=function(e,t,i){if(i-t<1)return"";for(var r,n=null,o=[],s=0;t<i;)(r=e[t++])<128?o[s++]=r:r>191&&r<224?o[s++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(r>>10),o[s++]=56320+(1023&r)):o[s++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,o)),s=0);return n?(s&&n.push(String.fromCharCode.apply(String,o.slice(0,s))),n.join("")):String.fromCharCode.apply(String,o.slice(0,s))},i.write=function(e,t,i){for(var r,n,o=i,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:((64512&r)==55296&&(64512&(n=e.charCodeAt(s+1)))==56320?(r=65536+((1023&r)<<10)+(1023&n),++s,t[i++]=r>>18|240,t[i++]=r>>12&63|128):t[i++]=r>>12|224,t[i++]=r>>6&63|128),t[i++]=63&r|128);return i-o}},6730:function(e,t,i){"use strict";i.d(t,{_nn:function(){return s_},I4K:function(){return sL},Eid:function(){return sF},jSZ:function(){return sI},BAg:function(){return sk},Rd2:function(){return sS},enk:function(){return eJ},IWH:function(){return ou},nu2:function(){return oh},Fxf:function(){return s$},aUr:function(){return sV},VSr:function(){return tg},B8T:function(){return rO},nz8:function(){return aV},IIB:function(){return rJ},OuP:function(){return sW},lUb:function(){return se},XHd:function(){return sM},JBA:function(){return r8},LPZ:function(){return e8},Q_v:function(){return sK},KMU:function(){return eF},RkQ:function(){return sA},ZLk:function(){return n6},Za2:function(){return s4},oy9:function(){return os},ojk:function(){return oe},Fwk:function(){return n9},uS1:function(){return sO},V8F:function(){return sB},Zr5:function(){return sU},MB9:function(){return sY},o1U:function(){return sD},Wbj:function(){return ay},LoD:function(){return sn},EJc:function(){return oV},Onx:function(){return o1},fjl:function(){return st},akC:function(){return oW},dJs:function(){return o6},HI:function(){return sP},ULf:function(){return sf}});var r,n,o,s,a,l,d,c,u,h=i(7294),f=i(1686),p=i(6086),m=i.n(p),g=function(e,t){var i,r=m()({},e,t);for(var n in e)e[n]&&"object"==typeof t[n]&&m()(r,((i={})[n]=m()(e[n],t[n]),i));return r},v=function(e){var t={};return Object.keys(e).sort(function(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}).forEach(function(i){t[i]=e[i]}),t},b={breakpoints:[40,52,64].map(function(e){return e+"em"})},y=function(e){return"@media screen and (min-width: "+e+")"},S=function(e,t){return w(t,e,e)},w=function(e,t,i,r,n){for(r=0,t=t&&t.split?t.split("."):[t];r<t.length;r++)e=e?e[t[r]]:n;return e===n?i:e},C=function e(t){var i={},r=function(e){var r={},n=!1,o=e.theme&&e.theme.disableStyledSystemCache;for(var s in e)if(t[s]){var a=t[s],l=e[s],d=w(e.theme,a.scale,a.defaults);if("object"==typeof l){if(i.breakpoints=!o&&i.breakpoints||w(e.theme,"breakpoints",b.breakpoints),Array.isArray(l)){i.media=!o&&i.media||[null].concat(i.breakpoints.map(y)),r=g(r,k(i.media,a,d,l,e));continue}null!==l&&(r=g(r,T(i.breakpoints,a,d,l,e)),n=!0);continue}m()(r,a(l,d,e))}return n&&(r=v(r)),r};r.config=t,r.propNames=Object.keys(t),r.cache=i;var n=Object.keys(t).filter(function(e){return"config"!==e});return n.length>1&&n.forEach(function(i){var n;r[i]=e(((n={})[i]=t[i],n))}),r},k=function(e,t,i,r,n){var o={};return r.slice(0,e.length).forEach(function(r,s){var a,l=e[s],d=t(r,i,n);l?m()(o,((a={})[l]=m()({},o[l],d),a)):m()(o,d)}),o},T=function(e,t,i,r,n){var o={};for(var s in r){var a=e[s],l=t(r[s],i,n);if(a){var d,c=y(a);m()(o,((d={})[c]=m()({},o[c],l),d))}else m()(o,l)}return o},I=function(e){var t=e.properties,i=e.property,r=e.scale,n=e.transform,o=void 0===n?S:n,s=e.defaultScale;t=t||[i];var a=function(e,i,r){var n={},s=o(e,i,r);if(null!==s)return t.forEach(function(e){n[e]=s}),n};return a.scale=r,a.defaults=s,a},E=function(e){void 0===e&&(e={});var t={};return Object.keys(e).forEach(function(i){var r=e[i];if(!0===r){t[i]=I({property:i,scale:i});return}if("function"==typeof r){t[i]=r;return}t[i]=I(r)}),C(t)},A=function(){for(var e={},t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return i.forEach(function(t){t&&t.config&&m()(e,t.config)}),C(e)},M=function(e){return"number"==typeof e&&!isNaN(e)},O=E({width:{property:"width",scale:"sizes",transform:function(e,t){return w(t,e,!M(e)||e>1?e:100*e+"%")}},height:{property:"height",scale:"sizes"},minWidth:{property:"minWidth",scale:"sizes"},minHeight:{property:"minHeight",scale:"sizes"},maxWidth:{property:"maxWidth",scale:"sizes"},maxHeight:{property:"maxHeight",scale:"sizes"},size:{properties:["width","height"],scale:"sizes"},overflow:!0,overflowX:!0,overflowY:!0,display:!0,verticalAlign:!0}),P={color:{property:"color",scale:"colors"},backgroundColor:{property:"backgroundColor",scale:"colors"},opacity:!0};P.bg=P.backgroundColor;var _=E(P),x=E({fontFamily:{property:"fontFamily",scale:"fonts"},fontSize:{property:"fontSize",scale:"fontSizes",defaultScale:[12,14,16,20,24,32,48,64,72]},fontWeight:{property:"fontWeight",scale:"fontWeights"},lineHeight:{property:"lineHeight",scale:"lineHeights"},letterSpacing:{property:"letterSpacing",scale:"letterSpacings"},textAlign:!0,fontStyle:!0}),R=E({alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:!0,flex:!0,flexGrow:!0,flexShrink:!0,flexBasis:!0,justifySelf:!0,alignSelf:!0,order:!0}),D=[0,4,8,16,32,64,128,256,512],N=E({gridGap:{property:"gridGap",scale:"space",defaultScale:D},gridColumnGap:{property:"gridColumnGap",scale:"space",defaultScale:D},gridRowGap:{property:"gridRowGap",scale:"space",defaultScale:D},gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridAutoRows:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0}),L=N,F={border:{property:"border",scale:"borders"},borderWidth:{property:"borderWidth",scale:"borderWidths"},borderStyle:{property:"borderStyle",scale:"borderStyles"},borderColor:{property:"borderColor",scale:"colors"},borderRadius:{property:"borderRadius",scale:"radii"},borderTop:{property:"borderTop",scale:"borders"},borderTopLeftRadius:{property:"borderTopLeftRadius",scale:"radii"},borderTopRightRadius:{property:"borderTopRightRadius",scale:"radii"},borderRight:{property:"borderRight",scale:"borders"},borderBottom:{property:"borderBottom",scale:"borders"},borderBottomLeftRadius:{property:"borderBottomLeftRadius",scale:"radii"},borderBottomRightRadius:{property:"borderBottomRightRadius",scale:"radii"},borderLeft:{property:"borderLeft",scale:"borders"},borderX:{properties:["borderLeft","borderRight"],scale:"borders"},borderY:{properties:["borderTop","borderBottom"],scale:"borders"}};F.borderTopWidth={property:"borderTopWidth",scale:"borderWidths"},F.borderTopColor={property:"borderTopColor",scale:"colors"},F.borderTopStyle={property:"borderTopStyle",scale:"borderStyles"},F.borderTopLeftRadius={property:"borderTopLeftRadius",scale:"radii"},F.borderTopRightRadius={property:"borderTopRightRadius",scale:"radii"},F.borderBottomWidth={property:"borderBottomWidth",scale:"borderWidths"},F.borderBottomColor={property:"borderBottomColor",scale:"colors"},F.borderBottomStyle={property:"borderBottomStyle",scale:"borderStyles"},F.borderBottomLeftRadius={property:"borderBottomLeftRadius",scale:"radii"},F.borderBottomRightRadius={property:"borderBottomRightRadius",scale:"radii"},F.borderLeftWidth={property:"borderLeftWidth",scale:"borderWidths"},F.borderLeftColor={property:"borderLeftColor",scale:"colors"},F.borderLeftStyle={property:"borderLeftStyle",scale:"borderStyles"},F.borderRightWidth={property:"borderRightWidth",scale:"borderWidths"},F.borderRightColor={property:"borderRightColor",scale:"colors"},F.borderRightStyle={property:"borderRightStyle",scale:"borderStyles"};var V=E(F),B={background:!0,backgroundImage:!0,backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0};B.bgImage=B.backgroundImage,B.bgSize=B.backgroundSize,B.bgPosition=B.backgroundPosition,B.bgRepeat=B.backgroundRepeat;var U=E(B),j=[0,4,8,16,32,64,128,256,512],$=E({position:!0,zIndex:{property:"zIndex",scale:"zIndices"},top:{property:"top",scale:"space",defaultScale:j},right:{property:"right",scale:"space",defaultScale:j},bottom:{property:"bottom",scale:"space",defaultScale:j},left:{property:"left",scale:"space",defaultScale:j}}),z=[0,4,8,16,32,64,128,256,512],H=function(e){return"number"==typeof e&&!isNaN(e)},W=function(e,t){if(!H(e))return w(t,e,e);var i=e<0,r=Math.abs(e),n=w(t,r,r);return H(n)?n*(i?-1:1):i?"-"+n:n},G={};G.margin={margin:{property:"margin",scale:"space",transform:W,defaultScale:z},marginTop:{property:"marginTop",scale:"space",transform:W,defaultScale:z},marginRight:{property:"marginRight",scale:"space",transform:W,defaultScale:z},marginBottom:{property:"marginBottom",scale:"space",transform:W,defaultScale:z},marginLeft:{property:"marginLeft",scale:"space",transform:W,defaultScale:z},marginX:{properties:["marginLeft","marginRight"],scale:"space",transform:W,defaultScale:z},marginY:{properties:["marginTop","marginBottom"],scale:"space",transform:W,defaultScale:z}},G.margin.m=G.margin.margin,G.margin.mt=G.margin.marginTop,G.margin.mr=G.margin.marginRight,G.margin.mb=G.margin.marginBottom,G.margin.ml=G.margin.marginLeft,G.margin.mx=G.margin.marginX,G.margin.my=G.margin.marginY,G.padding={padding:{property:"padding",scale:"space",defaultScale:z},paddingTop:{property:"paddingTop",scale:"space",defaultScale:z},paddingRight:{property:"paddingRight",scale:"space",defaultScale:z},paddingBottom:{property:"paddingBottom",scale:"space",defaultScale:z},paddingLeft:{property:"paddingLeft",scale:"space",defaultScale:z},paddingX:{properties:["paddingLeft","paddingRight"],scale:"space",defaultScale:z},paddingY:{properties:["paddingTop","paddingBottom"],scale:"space",defaultScale:z}},G.padding.p=G.padding.padding,G.padding.pt=G.padding.paddingTop,G.padding.pr=G.padding.paddingRight,G.padding.pb=G.padding.paddingBottom,G.padding.pl=G.padding.paddingLeft,G.padding.px=G.padding.paddingX,G.padding.py=G.padding.paddingY;var K=A(E(G.margin),E(G.padding));function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}E({boxShadow:{property:"boxShadow",scale:"shadows"},textShadow:{property:"textShadow",scale:"shadows"}});var J=function(e,t,i,r,n){for(r=0,t=t&&t.split?t.split("."):[t];r<t.length;r++)e=e?e[t[r]]:n;return e===n?i:e},Q=[40,52,64].map(function(e){return e+"em"}),Z={space:[0,4,8,16,32,64,128,256,512],fontSizes:[12,14,16,20,24,32,48,64,72]},X={bg:"backgroundColor",m:"margin",mt:"marginTop",mr:"marginRight",mb:"marginBottom",ml:"marginLeft",mx:"marginX",my:"marginY",p:"padding",pt:"paddingTop",pr:"paddingRight",pb:"paddingBottom",pl:"paddingLeft",px:"paddingX",py:"paddingY"},Y={marginX:["marginLeft","marginRight"],marginY:["marginTop","marginBottom"],paddingX:["paddingLeft","paddingRight"],paddingY:["paddingTop","paddingBottom"],size:["width","height"]},ee={color:"colors",backgroundColor:"colors",borderColor:"colors",margin:"space",marginTop:"space",marginRight:"space",marginBottom:"space",marginLeft:"space",marginX:"space",marginY:"space",padding:"space",paddingTop:"space",paddingRight:"space",paddingBottom:"space",paddingLeft:"space",paddingX:"space",paddingY:"space",top:"space",right:"space",bottom:"space",left:"space",gridGap:"space",gridColumnGap:"space",gridRowGap:"space",gap:"space",columnGap:"space",rowGap:"space",fontFamily:"fonts",fontSize:"fontSizes",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",border:"borders",borderTop:"borders",borderRight:"borders",borderBottom:"borders",borderLeft:"borders",borderWidth:"borderWidths",borderStyle:"borderStyles",borderRadius:"radii",borderTopRightRadius:"radii",borderTopLeftRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",borderTopWidth:"borderWidths",borderTopColor:"colors",borderTopStyle:"borderStyles",borderBottomWidth:"borderWidths",borderBottomColor:"colors",borderBottomStyle:"borderStyles",borderLeftWidth:"borderWidths",borderLeftColor:"colors",borderLeftStyle:"borderStyles",borderRightWidth:"borderWidths",borderRightColor:"colors",borderRightStyle:"borderStyles",outlineColor:"colors",boxShadow:"shadows",textShadow:"shadows",zIndex:"zIndices",width:"sizes",minWidth:"sizes",maxWidth:"sizes",height:"sizes",minHeight:"sizes",maxHeight:"sizes",flexBasis:"sizes",size:"sizes",fill:"colors",stroke:"colors"},et=function(e,t){if("number"!=typeof t||t>=0)return J(e,t,t);var i=Math.abs(t),r=J(e,i,i);return"string"==typeof r?"-"+r:-1*r},ei=["margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","top","bottom","left","right"].reduce(function(e,t){var i;return q({},e,((i={})[t]=et,i))},{}),er=function(e){return function(t){var i={},r=[null].concat(J(t,"breakpoints",Q).map(function(e){return"@media screen and (min-width: "+e+")"}));for(var n in e){var o="function"==typeof e[n]?e[n](t):e[n];if(null!=o){if(!Array.isArray(o)){i[n]=o;continue}for(var s=0;s<o.slice(0,r.length).length;s++){var a=r[s];if(!a){i[n]=o[s];continue}i[a]=i[a]||{},null!=o[s]&&(i[a][n]=o[s])}}}return i}},en=function e(t){return function(i){void 0===i&&(i={});var r=q({},Z,{},i.theme||i),n={},o=er("function"==typeof t?t(r):t)(r);for(var s in o){var a=o[s],l="function"==typeof a?a(r):a;if("variant"===s){var d=e(J(r,l))(r);n=q({},n,{},d);continue}if(l&&"object"==typeof l){n[s]=e(l)(r);continue}var c=J(X,s,s),u=J(ee,c),h=J(r,u,J(r,c,{})),f=J(ei,c,J)(h,l,l);if(Y[c])for(var p=Y[c],m=0;m<p.length;m++)n[p[m]]=f;else n[c]=f}return n}},eo=function(e){var t,i,r=e.scale,n=e.prop,o=void 0===n?"variant":n,s=e.variants,a=void 0===s?{}:s,l=e.key;return(i=Object.keys(a).length?function(e,t,i){return en(w(t,e,null))(i.theme)}:function(e,t){return w(t,e,null)}).scale=r||l,i.defaults=a,C(((t={})[o]=i,t))};eo({key:"buttons"}),eo({key:"textStyles",prop:"textStyle"}),eo({key:"colorStyles",prop:"colors"}),O.width,O.height,O.minWidth,O.minHeight,O.maxWidth,O.maxHeight,O.size,O.verticalAlign,O.display,O.overflow,O.overflowX,O.overflowY,_.opacity,x.fontSize,x.fontFamily,x.fontWeight,x.lineHeight,x.textAlign,x.fontStyle,x.letterSpacing,R.alignItems,R.alignContent,R.justifyItems,R.justifyContent,R.flexWrap,R.flexDirection,R.flex,R.flexGrow,R.flexShrink,R.flexBasis,R.justifySelf,R.alignSelf,R.order,L.gridGap,L.gridColumnGap,L.gridRowGap,L.gridColumn,L.gridRow,L.gridAutoFlow,L.gridAutoColumns,L.gridAutoRows,L.gridTemplateColumns,L.gridTemplateRows,L.gridTemplateAreas,L.gridArea,V.borderWidth,V.borderStyle,V.borderColor,V.borderTop,V.borderRight,V.borderBottom,V.borderLeft,V.borderRadius,U.backgroundImage,U.backgroundSize,U.backgroundPosition,U.backgroundRepeat,$.zIndex,$.top,$.right,$.bottom,$.left;var es=i(3935),ea=i(3204),el=new Uint8Array(16);function ed(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(el)}for(var ec=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,eu=function(e){return"string"==typeof e&&ec.test(e)},eh=[],ef=0;ef<256;++ef)eh.push((ef+256).toString(16).substr(1));var ep=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(eh[e[t+0]]+eh[e[t+1]]+eh[e[t+2]]+eh[e[t+3]]+"-"+eh[e[t+4]]+eh[e[t+5]]+"-"+eh[e[t+6]]+eh[e[t+7]]+"-"+eh[e[t+8]]+eh[e[t+9]]+"-"+eh[e[t+10]]+eh[e[t+11]]+eh[e[t+12]]+eh[e[t+13]]+eh[e[t+14]]+eh[e[t+15]]).toLowerCase();if(!eu(i))throw TypeError("Stringified UUID is invalid");return i},em=function(e,t,i){var r=(e=e||{}).random||(e.rng||ed)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){i=i||0;for(var n=0;n<16;++n)t[i+n]=r[n];return t}return ep(r)};function eg(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)0>t.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]]);return i}function ev(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var eb=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,ey=function(e){var t=Object.create(null);return function(i){return void 0===t[i]&&(t[i]=e(i)),t[i]}}(function(e){return eb.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&91>e.charCodeAt(2)});let eS=(0,f.iv)`
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  width: 1px;
  overflow: hidden;
  position: absolute !important;
`,ew=(0,f.iv)`
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
`,eC=(0,f.iv)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
`,ek=e=>/^#[0-9A-F]{6}$/i.test(e),eT=(e,t=1)=>{var i;if(!ek(e))return"";let[r,n,o]=null===(i=e.match(/\w\w/g))||void 0===i?void 0:i.map(e=>parseInt(e,16));return`rgba(${r}, ${n}, ${o}, ${t||1})`},eI=((e=[])=>({shouldForwardProp:t=>!!e.includes(t)||ey(t)}))(),eE=({css:e})=>e?`@media { ${e} };`:"",eA=e=>K(e),eM=f.ZP.span.withConfig(eI)`
  ${e=>{if("object"==typeof e.value){let t=e.value,i=t.props&&t.props.width||"1rem";return`width: ${i};`}return null}}
  display: inline-block;
  padding: ${e=>"object"==typeof e.value?"0":"0.1rem 0.4rem 0.125rem"};
  border-radius: 0.5rem;
  line-height: ${e=>"object"==typeof e.value?"1":"1.43"};
  color: ${e=>e.theme.colors.greys.white};
  font-size: 0.65rem;
  background-color: ${e=>"alert"===e.status?e.theme.colors.error.primary:e.theme.colors.greys.grey60};

  ${eA};
  ${eE}
`,eO=e=>{var{value:t,status:i="default",className:r,tag:n}=e,o=eg(e,["value","status","className","tag"]);return h.createElement(eM,Object.assign({className:r||"",as:n,status:i,value:t,"data-testid":"badge"},o),t)},eP=f.ZP.button.withConfig(eI)`
  border-radius: ${e=>e.theme.radii.default};
  font-size: ${e=>e.theme.fontSizes.text.fontSize};
  padding: 0.5rem 1rem;
  border-color: transparent;
  transition: background-color 0.1s ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;

  &:hover {
    cursor: pointer;
  }

  &:focus {
    outline: none;
  }

  .ch-icon {
    width: ${e=>e.theme.iconButtonSizes[e.iconSize||"sm"]};
    height: ${e=>e.theme.iconButtonSizes[e.iconSize||"sm"]};
    margin-right: 0.25rem;
  }

  /* variant styles */
  ${e=>"primary"===e.variant&&e_}
  ${e=>"secondary"===e.variant&&ex}
  ${e=>"icon"===e.variant&&eD}

  ${eA}
  ${eE}
`,e_=(0,f.iv)`
  background-color: ${e=>e.selected?e.theme.buttons.primary.selected.bgd:e.theme.buttons.primary.static.bgd};
  color: ${e=>e.selected?e.theme.buttons.primary.selected.text:e.theme.buttons.primary.static.text};
  border: ${e=>e.selected?e.theme.buttons.primary.selected.border:e.theme.buttons.primary.static.border};
  box-shadow: ${e=>e.theme.buttons.primary.static.shadow};

  &:focus {
    background-color: ${e=>e.theme.buttons.primary.focus.bgd};
    border: ${e=>e.theme.buttons.primary.focus.border};
    color: ${e=>e.theme.buttons.primary.focus.text};
    box-shadow: ${e=>e.theme.buttons.primary.focus.shadow};
  }

  &:hover {
    background-color: ${e=>e.theme.buttons.primary.hover.bgd};
    border: ${e=>e.theme.buttons.primary.hover.border};
    color: ${e=>e.theme.buttons.primary.hover.text};
    box-shadow: ${e=>e.theme.buttons.primary.hover.shadow};
  }

  &:focus:hover {
    box-shadow: ${e=>e.theme.buttons.primary.focus.shadow};
  }

  &:active {
    background-color: ${e=>e.theme.buttons.primary.active.bgd};
    border: ${e=>e.theme.buttons.primary.active.border};
    color: ${e=>e.theme.buttons.primary.active.text};
    box-shadow: ${e=>e.theme.buttons.primary.active.shadow};
  }

  &:disabled {
    background-color: ${e=>e.theme.buttons.primary.disabled.bgd};
    border: ${e=>e.theme.buttons.primary.disabled.border};
    color: ${e=>e.theme.buttons.primary.disabled.text};
    cursor: not-allowed;
  }
`,ex=(0,f.iv)`
  background-color: ${e=>e.selected?e.theme.buttons.secondary.selected.bgd:e.theme.buttons.secondary.static.bgd};
  color: ${e=>e.selected?e.theme.buttons.secondary.selected.text:e.theme.buttons.secondary.static.text};
  border: ${e=>e.selected?e.theme.buttons.secondary.selected.border:e.theme.buttons.secondary.static.border};
  box-shadow: ${e=>e.theme.buttons.secondary.shadow};

  &:focus {
    background-color: ${e=>e.theme.buttons.secondary.focus.bgd};
    border: ${e=>e.theme.buttons.secondary.focus.border};
    color: ${e=>e.theme.buttons.secondary.focus.text};
    box-shadow: ${e=>e.theme.buttons.secondary.focus.shadow};
  }

  &:hover {
    background-color: ${e=>e.theme.buttons.secondary.hover.bgd};
    border: ${e=>e.theme.buttons.secondary.hover.border};
    color: ${e=>e.theme.buttons.secondary.hover.text};
    box-shadow: ${e=>e.theme.buttons.secondary.hover.shadow};
  }

  &:focus:hover {
    box-shadow: ${e=>e.theme.buttons.secondary.focus.shadow};
  }

  &:active {
    background-color: ${e=>e.theme.buttons.secondary.active.bgd};
    border: ${e=>e.theme.buttons.secondary.active.border};
    color: ${e=>e.theme.buttons.secondary.active.text};
    box-shadow: ${e=>e.theme.buttons.secondary.focus.shadow};
  }

  &:disabled {
    background-color: ${e=>e.theme.buttons.secondary.disabled.bgd};
    border: ${e=>e.theme.buttons.secondary.disabled.border};
    color: ${e=>e.theme.buttons.secondary.disabled.text};
    cursor: not-allowed;
  }
`,eR={sm:(0,f.iv)`
    top: -15%;
    left: 76%;
  `,md:(0,f.iv)`
    top: 4%;
    left: 76%;
  `,lg:(0,f.iv)`
    top: 10%;
    left: 76%;
  `},eD=(0,f.iv)`
  background-color: ${e=>e.selected?e.theme.buttons.icon.selected.bgd:e.theme.buttons.icon.static.bgd};
  color: ${e=>e.selected?e.theme.buttons.icon.selected.text:e.theme.buttons.icon.static.text};
  border: ${e=>e.selected?e.theme.buttons.icon.selected.border:e.theme.buttons.icon.static.border};
  border-radius: ${e=>e.theme.radii.circle};
  padding: 0.1875rem;
  position: relative;

  > .ch-label {
    ${eS};
  }

  > .ch-icon {
    width: ${e=>e.theme.iconButtonSizes[e.iconSize||"sm"]};
    height: ${e=>e.theme.iconButtonSizes[e.iconSize||"sm"]};
    margin: 0;
  }

  &:focus {
    background-color: ${({theme:e,selected:t})=>t?e.buttons.icon.selected.bgd:e.buttons.icon.static.bgd};
    border: ${e=>e.theme.buttons.icon.focus.border};
    color: ${e=>e.theme.buttons.icon.focus.text};
    color: ${({theme:e,selected:t})=>t?e.buttons.icon.selected.text:e.buttons.icon.static.text};
    box-shadow: ${e=>e.theme.buttons.icon.focus.shadow};
  }

  &:hover {
    background-color: ${e=>e.theme.buttons.icon.hover.bgd};
    border: ${e=>e.theme.buttons.icon.hover.border};
    color: ${e=>e.theme.buttons.icon.hover.text};
  }

  &:active {
    background-color: ${e=>e.theme.buttons.icon.active.bgd};
    border: ${e=>e.theme.buttons.icon.active.border};
    color: ${e=>e.theme.buttons.icon.active.text};
  }

  &:disabled {
    background-color: ${e=>e.theme.buttons.icon.disabled.bgd};
    border: ${e=>e.theme.buttons.icon.disabled.border};
    color: ${e=>e.theme.buttons.icon.disabled.text};
    cursor: not-allowed;
  }

  + * {
    position: absolute;
    font-size: 0.55rem;
    z-index: 1;
    ${({iconSize:e})=>e?eR[e]:eR.sm}
  }
`,eN=f.ZP.span.withConfig(eI)`
  display: inline-block;
  position: relative;
`,eL=(0,h.forwardRef)((e,t)=>h.createElement(eP,Object.assign({},e,{className:e.className||"",as:e.tag,ref:t,"aria-label":e.label,"data-testid":"button",disabled:e.disabled}),e.icon&&h.createElement("span",{className:"ch-icon","data-testid":"button-icon"},e.icon),h.createElement("span",{className:"ch-label","data-testid":"button-label"},e.label))),eF=(0,h.forwardRef)((e,t)=>h.createElement(eL,Object.assign({variant:"primary"},e))),eV=(0,h.forwardRef)((e,t)=>h.createElement(eL,Object.assign({variant:"secondary"},e))),eB=(0,h.forwardRef)((e,t)=>h.createElement(eN,null,h.createElement(eL,Object.assign({ref:t,variant:"icon"},e)),e.badge)),eU=e=>{var{className:t,children:i,viewBox:r="0 0 24 24",xmlns:n="http://www.w3.org/2000/svg",width:o,height:s,title:a}=e,l=eg(e,["className","children","viewBox","xmlns","width","height","title"]);let d={width:o,height:s};return h.createElement("svg",Object.assign({xmlns:n,className:`Svg ${t||""}`,height:s,style:d,viewBox:r,width:o},l),a&&h.createElement("title",null,a),h.createElement("g",{fillRule:"evenodd",fill:"currentColor"},i))},ej={up:"0",right:"90",down:"180",left:"270"};(0,f.ZP)(eU).withConfig(eI)`
  transform: ${({direction:e})=>`rotate(${ej[e||"up"]}deg)`};
`;let e$=e=>{var{disabled:t=!1}=e,i=eg(e,["disabled"]);return h.createElement(eU,Object.assign({},i),t?h.createElement("path",{xmlns:"http://www.w3.org/2000/svg",d:"M4.146 4.146c.196-.195.512-.195.708 0L7.707 7h.007l1 1h-.007L15 14.293v-.007l.894.894-.001.006 3.961 3.96c.195.196.195.512 0 .708-.098.097-.226.146-.354.146-.128 0-.256-.049-.354-.146l-3.747-3.748c-.459.542-1.134.894-1.899.894h-7C5.121 17 4 15.879 4 14.5v-5c0-1.314 1.022-2.383 2.312-2.481L4.146 4.854c-.195-.196-.195-.512 0-.708zM7.293 8H6.5C5.673 8 5 8.673 5 9.5v5c0 .827.673 1.5 1.5 1.5h7c.488 0 .919-.238 1.192-.601L7.293 8zM13.5 7C14.879 7 16 8.121 16 9.5v.566l1.813-1.303c.426-.306.983-.349 1.456-.107.451.231.731.684.731 1.181v4.326c0 .497-.28.95-.731 1.181-.205.104-.424.156-.642.156-.287 0-.571-.089-.814-.263l-1.592-1.144L15 12.873V9.5c0-.827-.673-1.5-1.5-1.5h-3.372l-1-1zm5.313 2.546c-.051-.026-.233-.1-.416.03l-2.256 1.621c-.089.064-.141.16-.141.262v1.082c0 .102.051.197.141.262l2.256 1.622c.182.131.365.054.416.03.055-.029.187-.116.187-.292V9.837c0-.176-.132-.263-.187-.29z"}):h.createElement("path",{d:"M19 14.164c0 .176-.131.262-.187.29-.052.027-.234.1-.416-.028l-2.256-1.622v-.001c-.09-.064-.141-.16-.141-.262v-1.082c0-.102.051-.197.141-.262l2.255-1.622c.081-.057.159-.075.227-.075.09 0 .16.03.19.046.056.029.187.115.187.29v4.328zm-4 .336c0 .828-.673 1.5-1.5 1.5h-7c-.827 0-1.5-.672-1.5-1.5v-5C5 8.673 5.673 8 6.5 8h7c.827 0 1.5.673 1.5 1.5v5zm4.27-5.843c-.471-.242-1.028-.202-1.457.106L16 10.066V9.5C16 8.122 14.879 7 13.5 7h-7C5.121 7 4 8.122 4 9.5v5C4 15.879 5.121 17 6.5 17h7c1.379 0 2.5-1.121 2.5-2.5v-.566l1.814 1.304c.243.174.527.262.813.262.219 0 .438-.051.643-.156.45-.231.73-.683.73-1.18V9.837c0-.497-.28-.95-.73-1.18z"}))};e$.displayName="Camera";let ez={up:"0",right:"90",down:"180",left:"270"},eH=(0,f.ZP)(eU).withConfig(eI)`
  transform: ${({direction:e})=>`rotate(${ez[e||"up"]}deg)`};
`,eW=e=>{var{direction:t="up"}=e,i=eg(e,["direction"]);return h.createElement(eH,Object.assign({direction:t},i),h.createElement("path",{"transform-origin":"center",d:"M8.824 13.88c-.21.18-.526.154-.705-.056-.159-.187-.156-.457-.006-.64l.063-.065 3.523-3c.165-.14.397-.156.577-.05l.074.052 3.477 3c.209.18.232.497.052.706-.16.185-.428.224-.632.104l-.074-.052-3.151-2.72-3.198 2.722z"}))};eW.displayName="Caret";let eG={default:(0,f.iv)`
  .ch-caution-background {
    fill: transparent;
  }
`,"fill-warning":(0,f.iv)`
  .ch-caution-background {
    fill: ${e=>e.theme.colors.warning.primary};
  }

  .ch-caution-exclamation {
    fill: ${e=>e.theme.colors.greys.white};
  }

  .ch-caution-border {
    fill: ${e=>e.theme.colors.warning.primary};
  }
`,"fill-error":(0,f.iv)`
  .ch-caution-background {
    fill: ${e=>e.theme.colors.error.primary};
  }

  .ch-caution-exclamation {
    fill: ${e=>e.theme.colors.greys.white};
  }

  .ch-caution-border {
    fill: ${e=>e.theme.colors.error.primary};
  }
`},eK=f.ZP.g.withConfig(eI)`
  ${e=>eG[e.variant||"default"]};
`,eq=e=>h.createElement(eU,Object.assign({},e),h.createElement(eK,{fill:"currentColor",variant:e.variant},h.createElement("path",{className:"ch-caution-background",d:"M18.728 15.186l-5.085-8.281C13.293 6.338 12.68 6 12 6c-.68 0-1.294.338-1.642.905l-5.085 8.281c-.351.571-.365 1.258-.04 1.841.336.6.98.972 1.68.972h10.17c.704 0 1.348-.372 1.683-.972.326-.583.312-1.27-.04-1.841"}),h.createElement("path",{className:"ch-caution-exclamation",d:"M12.572 14.609v1.219h-1.166v-1.219h1.166zm.023-5.388v1.83l-.288 2.727h-.597l-.305-2.727V9.22h1.19z"}),h.createElement("path",{className:"ch-caution-border",d:"M17.894 16.539c-.161.288-.463.46-.81.46H6.915c-.343 0-.645-.172-.806-.46-.15-.266-.143-.568.017-.829l5.085-8.281c.33-.536 1.25-.538 1.58 0l5.086 8.281c.16.261.167.563.018.829m.834-1.353l-5.085-8.281C13.293 6.338 12.68 6 12 6c-.68 0-1.294.338-1.642.905l-5.085 8.281c-.351.571-.365 1.258-.04 1.841.336.6.98.972 1.68.972h10.17c.704 0 1.348-.372 1.683-.972.326-.583.312-1.27-.04-1.841"})));eq.displayName="Caution";let eJ=e=>h.createElement(eU,Object.assign({},e,{title:"Chat"}),h.createElement("path",{d:"M8.497 6C7.12 6 6 7.12 6 8.497v9.413l1.022-.727c1.483-1.054 4.17-1.911 5.99-1.911h2.48c1.376 0 2.496-1.121 2.496-2.498V8.497C17.988 7.12 16.868 6 15.491 6H8.497zM5.905 19c-.14 0-.284-.034-.416-.102-.302-.156-.489-.464-.489-.804V8.497C5 6.569 6.568 5 8.497 5h6.994c1.93 0 3.497 1.569 3.497 3.497v4.277c0 1.929-1.568 3.498-3.497 3.498h-2.48c-1.616 0-4.093.791-5.409 1.727l-1.172.833c-.158.111-.34.168-.525.168z"}));eJ.displayName="Chat";let eQ=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M16.834 9.178c-.18-.21-.494-.238-.705-.061l-5.912 4.975-2.33-2.846c-.175-.214-.491-.245-.703-.07-.214.175-.246.49-.071.703l2.652 3.238.004.006c.037.044.085.073.132.1.015.01.026.025.04.032.068.03.138.046.21.046.056 0 .113-.01.166-.028.038-.013.07-.037.106-.06.015-.01.03-.014.045-.025v-.001l.006-.003 6.299-5.301c.21-.178.239-.493.06-.705"}));eQ.displayName="Check";let eZ=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M12 4c4.411 0 8 3.589 8 8s-3.589 8-8 8-8-3.589-8-8 3.589-8 8-8zm0 1c-3.86 0-7 3.141-7 7s3.14 7 7 7 7-3.141 7-7-3.14-7-7-7zm3.493 4.873c.211-.179.526-.15.705.061.177.211.15.527-.061.705l-4.476 3.764-.003.002v.001c-.029.024-.061.035-.091.051-.02.011-.039.027-.061.035-.054.019-.11.028-.166.028-.072 0-.143-.015-.209-.045-.016-.007-.027-.023-.042-.032-.047-.028-.095-.056-.132-.1l-.001-.002-.003-.004-1.84-2.246c-.175-.213-.143-.529.07-.703.213-.177.529-.145.704.07l1.518 1.853z"}));eZ.displayName="CheckRound";let eX=e=>h.createElement(eU,Object.assign({},e,{title:"Clear"}),h.createElement("path",{d:"M12 5c3.866 0 7 3.134 7 7s-3.134 7-7 7-7-3.134-7-7 3.134-7 7-7zM9.172 9.17c-.196.196-.196.513 0 .708L11.293 12l-2.12 2.12c-.197.197-.197.513 0 .708.096.098.224.147.352.147.128 0 .256-.05.354-.147L12 12.707l2.121 2.12c.098.099.226.148.353.148.128 0 .256-.05.354-.147.195-.195.195-.511 0-.707L12.708 12l2.12-2.122c.195-.195.195-.512 0-.707-.195-.195-.512-.195-.707 0l-2.12 2.12-2.122-2.12c-.196-.195-.512-.195-.707 0z"}));eX.displayName="Clear";let eY=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M12 4c4.411 0 8 3.589 8 8s-3.589 8-8 8-8-3.589-8-8 3.589-8 8-8zm0 1c-3.859 0-7 3.141-7 7s3.141 7 7 7 7-3.141 7-7-3.141-7-7-7zm0 2.559c.276 0 .5.223.5.5V11.5h3c.276 0 .5.224.5.5s-.224.5-.5.5H12c-.276 0-.5-.224-.5-.5V8.059c0-.277.224-.5.5-.5z"}));eY.displayName="Clock";let e0=e=>{var{title:t="Screen share"}=e,i=eg(e,["title"]);return h.createElement(eU,Object.assign({},i,{title:t}),h.createElement("path",{d:"M15.5 17c.276 0 .5.224.5.5s-.224.5-.5.5h-7c-.276 0-.5-.224-.5-.5s.224-.5.5-.5zM18 6c1.103 0 2 .897 2 2v6c0 1.103-.897 2-2 2H6c-1.103 0-2-.897-2-2V8c0-1.103.897-2 2-2zm0 1H6c-.552 0-1 .449-1 1v6c0 .551.448 1 1 1h12c.552 0 1-.449 1-1V8c0-.551-.448-1-1-1z"}))};e0.displayName="ScreenShare";let e1=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M12 4c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zm0 1c-3.86 0-7 3.14-7 7 0 3.859 3.14 7 7 7 3.859 0 7-3.141 7-7 0-3.86-3.141-7-7-7zm-3 6c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1zm6 0c.553 0 1 .448 1 1s-.447 1-1 1c-.553 0-1-.448-1-1s.447-1 1-1zm-3 0c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1z"}));e1.displayName="Dots",f.ZP.circle.withConfig(eI)`
  fill: ${e=>e.theme.colors.primary.main};
`;let e2=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M12 4c4.411 0 8 3.589 8 8s-3.589 8-8 8-8-3.589-8-8 3.589-8 8-8zm0 1c-3.859 0-7 3.141-7 7s3.141 7 7 7 7-3.141 7-7-3.141-7-7-7zm.016 6.476c.276 0 .5.224.5.5v2.498c0 .276-.224.5-.5.5s-.5-.224-.5-.5v-2.498c0-.276.224-.5.5-.5zM12 8.709c.414 0 .75.335.75.75 0 .414-.336.75-.75.75s-.75-.336-.75-.75c0-.415.336-.75.75-.75z"}));e2.displayName="Information";let e3=e=>{var t=eg(e,["poorConnection","muted"]);return h.createElement(eU,Object.assign({},t))},e5=(0,f.ZP)(e3).withConfig(eI)`
  ${e=>e.poorConnection?`color: ${e.theme.colors.error.light}`:""}
`;function e4(e,t){return e?t?"M4.146 4.146c.196-.195.513-.195.708 0L9.168 8.46h.018l.813.815v.018l5.854 5.854c.002-.005.005-.008.008-.01l.724.724-.008.01 3.276 3.275c.195.195.195.512 0 .707-.098.098-.226.147-.354.147-.127 0-.255-.049-.352-.146l-3.281-3.281C14.82 17.459 13.475 18 11.998 18c-3.308 0-6-2.691-6-6 0-.277.224-.5.5-.5.278 0 .5.223.5.5 0 2.757 2.244 5 5 5 1.2 0 2.29-.436 3.147-1.146l-1.439-1.438c-.14.105-.287.207-.445.285l-.447-.895c.062-.03.116-.073.174-.11l-2.99-2.989v.941H9v-1.063h.88L4.147 4.853c-.196-.194-.196-.511 0-.707zM14.5 19c.276 0 .5.224.5.5s-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5zm3-7.5c.276 0 .5.224.5.5 0 1.106-.307 2.14-.83 3.031l-.748-.748c.357-.687.578-1.456.578-2.283 0-.276.224-.5.5-.5zm-6.293 2.317c.25.121.517.183.793.183l.016 1.001-.098-.008c-.359-.012-.76-.089-1.147-.275zm-1.085-1.278c.093.282.234.536.42.757l-.766.644c-.267-.319-.47-.685-.603-1.089zM15 11.618v.155c0 .325-.051.643-.139.95l-.867-.868c.001-.027.006-.055.006-.082v-.155h1zm0-2.126v1.062h-1V9.492h1zm0-2.125v1.062h-1V7.367h1zM9.155 6.201l.955.297c-.073.235-.11.48-.11.73v.17h-.463l-.512-.512c.024-.232.061-.463.13-.685zm5.079-1.128c.268.321.469.689.599 1.093l-.951.307c-.091-.283-.231-.537-.415-.759zm-3.514-.765l.453.891c-.246.126-.474.312-.656.535l-.776-.63c.274-.338.603-.604.979-.796zM12 4c.434 0 .853.098 1.245.29l-.44.897C12.553 5.064 12.282 5 12 5l-.031-1z":"M14.5 19c.276 0 .5.224.5.5s-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5zM4.146 4.146c.196-.195.512-.195.708 0l15 15c.195.196.195.512 0 .708-.098.097-.226.146-.354.146-.128 0-.256-.049-.354-.146l-3.282-3.283C14.819 17.458 13.475 18 12 18c-3.309 0-6-2.691-6-6 0-.276.224-.5.5-.5s.5.224.5.5c0 2.757 2.243 5 5 5 1.199 0 2.288-.437 3.146-1.146l-1.452-1.453c-.483.366-1.058.599-1.694.599-1.654 0-3-1.448-3-3.228V9.707L4.146 4.854c-.195-.196-.195-.512 0-.708zM17.5 11.5c.276 0 .5.224.5.5 0 1.112-.31 2.152-.84 3.046l-.747-.746c.362-.693.587-1.467.587-2.3 0-.276.224-.5.5-.5zm-7.5-.793v1.065c0 1.229.897 2.228 2 2.228.362 0 .7-.111.992-.301L10 10.707zm2-6.708c1.654 0 3 1.45 3 3.228v4.546c0 .337-.062.655-.151.962l-.859-.858.01-.104V7.228C14 5.998 13.103 5 12 5s-2 .998-2 2.228v.658l-.971-.97C9.178 5.284 10.445 3.998 12 3.998z":t?"M14.5 19c.276 0 .5.224.5.5s-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h5zm3-7.5c.276 0 .5.224.5.5 0 3.309-2.691 6-6 6s-6-2.691-6-6c0-.276.224-.5.5-.5s.5.224.5.5c0 2.757 2.243 5 5 5s5-2.243 5-5c0-.276.224-.5.5-.5zm-6.293 2.318c.25.12.517.183.793.183l.013.958v-.46l.085.492H12.014c-.486-.002-.876-.096-1.242-.274l.435-.9zm2.268-.543l.77.637c-.275.335-.606.6-.983.79l-.447-.896c.25-.125.473-.303.66-.53zm-3.353-.736c.093.283.235.537.42.757l-.765.645c-.268-.32-.472-.687-.604-1.09l.949-.312zM15 11.619v.155c0 .359-.053.71-.16 1.043l-.953-.305c.075-.233.113-.482.113-.738v-.155h1zm-5-1.033v1.063H9v-1.063h1zm5-1.093v1.063h-1V9.492h1zm-5-1.03v1.062H9V8.46h1zm5-1.095V8.43h-1V7.367h1zM9.156 6.2l.955.3c-.074.232-.111.478-.111.728v.17H9v-.17c0-.351.053-.696.156-1.027zm5.08-1.127c.267.32.468.688.598 1.093l-.951.306c-.091-.282-.23-.537-.415-.759l.768-.64zm-3.516-.766l.453.891c-.246.126-.473.311-.656.535l-.775-.63c.273-.337.602-.603.978-.795zM12 4c.433 0 .852.098 1.245.29l-.44.899C12.55 5.064 12.28 5 12 5l-.031-1h.03z":"M14.5 19c.276 0 .5.224.5.5s-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5zm3-7.5c.276 0 .5.224.5.5 0 3.309-2.691 6-6 6s-6-2.691-6-6c0-.276.224-.5.5-.5s.5.224.5.5c0 2.757 2.243 5 5 5s5-2.243 5-5c0-.276.224-.5.5-.5zM12 4c1.654 0 3 1.448 3 3.227v4.546C15 13.552 13.654 15 12 15s-3-1.448-3-3.227V7.227C9 5.447 10.346 4 12 4zm0 1c-1.103 0-2 .999-2 2.227v4.546C10 13 10.897 14 12 14s2-1 2-2.227V7.227C14 5.999 13.103 5 12 5z"}let e6=e=>{var{muted:t=!1,poorConnection:i=!1,mutedTitle:r="Muted microphone",unmutedTitle:n="Microphone"}=e,o=eg(e,["muted","poorConnection","mutedTitle","unmutedTitle"]);let s=e4(t,i);return h.createElement(e5,Object.assign({},o,{muted:t,poorConnection:i,title:t?r:n,"data-testid":i?"poor-connection-mic":"good-connection-mic"}),h.createElement("path",{d:s}))};e6.displayName="Microphone";let e8=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M11.999 10.19c.738 0 3.194.089 3.792 1.241.08.158.117.315.138.418l.228 1.112c.033.167.116.318.239.438l.423.414c.349.341.919.343 1.27 0l.649-.635c.308-.3.347-.777.09-1.107-.776-1.005-2.696-2.698-6.83-2.771-4.132.073-6.052 1.766-6.828 2.77-.257.331-.218.808.09 1.108l.649.635c.349.341.919.343 1.27 0L7.6 13.4c.124-.121.207-.272.24-.438l.228-1.116c.02-.1.058-.257.137-.412.599-1.155 3.055-1.244 3.793-1.244m5.455 4.877c-.483 0-.966-.18-1.334-.539l-.422-.413c-.266-.26-.447-.59-.521-.953l-.23-1.115c-.008-.047-.022-.113-.046-.158-.145-.28-1.17-.699-2.902-.699-1.732 0-2.757.419-2.903.702-.023.042-.037.108-.046.152l-.23 1.119c-.073.362-.254.692-.521.953l-.421.412c-.736.719-1.932.719-2.668 0l-.65-.635c-.67-.656-.75-1.703-.181-2.435.887-1.146 3.056-3.08 7.61-3.158h.019c4.555.078 6.724 2.012 7.61 3.159.569.731.49 1.778-.181 2.434l-.65.635c-.367.359-.85.539-1.333.539"}));e8.displayName="Phone";let e7=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M14.5 5C16.981 5 19 7.019 19 9.5v5c0 2.481-2.019 4.5-4.5 4.5h-5C7.019 19 5 16.981 5 14.5v-5C5 7.019 7.019 5 9.5 5zm0 1h-5C7.57 6 6 7.57 6 9.5v5C6 16.43 7.57 18 9.5 18h5c1.93 0 3.5-1.57 3.5-3.5v-5C18 7.57 16.43 6 14.5 6zM9.172 9.17c.195-.194.511-.194.707 0L12 11.293l2.121-2.121c.195-.195.512-.195.707 0 .195.195.195.512 0 .707L12.708 12l2.12 2.12c.195.197.195.513 0 .708-.098.098-.226.147-.354.147-.127 0-.255-.05-.353-.147l-2.12-2.121-2.122 2.12c-.098.099-.226.148-.354.148-.128 0-.256-.05-.353-.147-.196-.195-.196-.511 0-.707L11.293 12l-2.12-2.122c-.197-.195-.197-.512 0-.707z"}));e7.displayName="Remove";let e9=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M11 16c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5m7.852 2.145l-3.294-3.253C16.455 13.843 17 12.485 17 11c0-3.309-2.691-6-6-6s-6 2.691-6 6 2.691 6 6 6c1.464 0 2.807-.528 3.849-1.403l3.299 3.258c.098.097.225.145.352.145.129 0 .258-.05.355-.148.195-.197.193-.514-.003-.707"}));e9.displayName="Search";let te=e=>{var{disabled:t}=e,i=eg(e,["disabled"]);return h.createElement(eU,Object.assign({},i),t?h.createElement("path",{d:"M10.939 7.261c.393-.297.914-.344 1.361-.124.431.213.7.638.7 1.11v7.506c0 .472-.269.897-.7 1.11-.187.092-.385.137-.582.137-.28 0-.557-.09-.788-.268l-2.486-1.728c-.087-.06-.193-.093-.302-.093H6.256C5.563 14.911 5 14.36 5 13.682v-3.358c0-.68.566-1.235 1.263-1.235h1.88c.108 0 .213-.032.298-.092zm.918.772c-.042-.019-.182-.077-.32.03l-.018.012-2.505 1.741c-.253.178-.555.273-.871.273h-1.88c-.145 0-.263.105-.263.235v3.358c0 .127.115.23.256.23h1.886c.316 0 .618.093.874.272l2.503 1.741c.159.12.297.062.338.042.053-.027.143-.089.143-.214V8.247c0-.125-.09-.187-.143-.214zM14.9 10.13c.195-.195.512-.195.707 0l1.163 1.163 1.163-1.163c.195-.195.512-.195.707 0 .195.195.195.512 0 .707L17.477 12l1.163 1.163c.195.195.195.512 0 .707-.098.098-.226.147-.352.147-.128 0-.256-.049-.355-.147l-1.163-1.163-1.162 1.163c-.099.098-.226.147-.354.147-.128 0-.255-.049-.354-.147-.194-.195-.194-.512 0-.707L16.064 12 14.9 10.837c-.194-.195-.194-.512 0-.707z"}):h.createElement("path",{d:"M10.939 7.26c.397-.295.914-.343 1.361-.123.431.213.7.638.7 1.11v7.506c0 .473-.269.898-.7 1.111-.187.092-.386.137-.582.137-.28 0-.557-.091-.788-.269l-2.486-1.727c-.088-.061-.194-.094-.302-.094H6.256c-.693 0-1.256-.552-1.256-1.229v-3.357c0-.681.566-1.236 1.263-1.236h1.88c.108 0 .214-.033.3-.092zm5.148.054c.176-.211.49-.241.704-.065 1.406 1.164 2.213 2.896 2.213 4.751 0 1.855-.807 3.588-2.213 4.752-.094.077-.207.115-.319.115-.144 0-.286-.061-.385-.18-.177-.213-.147-.529.065-.705 1.177-.974 1.852-2.425 1.852-3.982 0-1.556-.675-3.007-1.852-3.981-.212-.176-.242-.492-.065-.705zm-4.23.719c-.041-.02-.183-.077-.32.029l-.018.013-2.505 1.742c-.255.178-.556.272-.871.272h-1.88c-.145 0-.263.106-.263.236v3.357c0 .127.115.229.256.229h1.886c.315 0 .617.095.874.274l2.503 1.741c.157.117.298.062.337.042.054-.027.144-.09.144-.215V8.247c0-.125-.09-.187-.143-.214zm2.841 1.62c.181-.21.496-.232.705-.053.707.608 1.112 1.483 1.112 2.4 0 .917-.405 1.793-1.112 2.402-.095.08-.21.12-.326.12-.14 0-.28-.058-.379-.173-.18-.21-.156-.524.053-.705.486-.42.764-1.018.764-1.644 0-.625-.278-1.223-.764-1.642-.209-.181-.233-.496-.053-.705z"}))};te.displayName="Sound";let tt=e=>h.createElement(eU,Object.assign({},e,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"}),h.createElement("g",{fill:"none",fillRule:"evenodd"},h.createElement("path",{d:"M0 0H24V24H0z"}),h.createElement("g",{fill:"currentColor"},h.createElement("path",{d:"M8 0c.316 0 .571.256.571.571V4c0 .316-.255.571-.571.571-.316 0-.571-.255-.571-.571V.571C7.429.256 7.684 0 8 0z",transform:"translate(4 4)"}),h.createElement("path",{d:"M14.928 4c.158.273.064.623-.209.78l-2.97 1.715c-.272.158-.622.064-.78-.21-.158-.273-.064-.622.21-.78l2.969-1.714c.273-.158.622-.064.78.209z",opacity:".2",transform:"translate(4 4)"}),h.createElement("path",{d:"M12 1.072c.273.158.367.507.21.78l-1.715 2.97c-.158.273-.507.367-.78.209-.274-.158-.368-.508-.21-.78l1.714-2.97c.158-.273.508-.367.781-.21z",opacity:".12",transform:"translate(4 4)"}),h.createElement("path",{d:"M16 8c0 .316-.256.571-.571.571H12c-.316 0-.571-.255-.571-.571 0-.316.255-.571.571-.571h3.429c.315 0 .571.255.571.571z",opacity:".28",transform:"translate(4 4)"}),h.createElement("path",{d:"M12 14.928c-.273.158-.623.064-.78-.209l-1.715-2.97c-.158-.272-.064-.622.21-.78.273-.158.622-.064.78.21l1.714 2.969c.158.273.064.622-.209.78z",opacity:".44",transform:"translate(4 4)"}),h.createElement("path",{d:"M14.928 12c-.158.273-.507.367-.78.21l-2.97-1.715c-.273-.158-.367-.507-.209-.78.158-.274.508-.368.78-.21l2.97 1.714c.273.158.367.508.21.781z",opacity:".36",transform:"translate(4 4)"}),h.createElement("path",{d:"M8 16c-.316 0-.571-.256-.571-.571V12c0-.316.255-.571.571-.571.316 0 .571.255.571.571v3.429c0 .315-.255.571-.571.571z",opacity:".52",transform:"translate(4 4)"}),h.createElement("path",{d:"M1.072 12c-.158-.273-.064-.623.209-.78l2.97-1.715c.272-.158.622-.064.78.21.158.273.064.622-.21.78l-2.969 1.714c-.273.158-.622.064-.78-.209z",opacity:".68",transform:"translate(4 4)"}),h.createElement("path",{d:"M4 14.928c-.273-.158-.367-.507-.21-.78l1.715-2.97c.158-.273.507-.367.78-.209.274.158.368.508.21.78L4.78 14.72c-.158.273-.508.367-.781.21z",opacity:".6",transform:"translate(4 4)"}),h.createElement("path",{d:"M0 8c0-.316.256-.571.571-.571H4c.316 0 .571.255.571.571 0 .316-.255.571-.571.571H.571C.256 8.571 0 8.316 0 8z",opacity:".76",transform:"translate(4 4)"}),h.createElement("path",{d:"M4 1.072c.273-.158.623-.064.78.209l1.715 2.97c.158.272.064.622-.21.78-.273.158-.622.064-.78-.21L3.791 1.853c-.158-.273-.064-.622.209-.78z",opacity:".92",transform:"translate(4 4)"}),h.createElement("path",{d:"M1.072 4c.158-.273.507-.367.78-.21l2.97 1.715c.273.158.367.507.209.78-.158.274-.508.368-.78.21L1.28 4.78c-.273-.158-.367-.508-.21-.781z",opacity:".84",transform:"translate(4 4)"}))));tt.displayName="Spinner";let ti=e=>h.createElement(eU,Object.assign({},e),h.createElement("path",{d:"M8.824 9.88c-.21.18-.526.154-.705-.056-.159-.187-.156-.457-.006-.64l.063-.065 3.523-3c.165-.14.397-.156.577-.05l.074.052 3.477 3c.209.18.232.497.052.706-.16.185-.428.224-.632.104l-.074-.052-3.151-2.72-3.198 2.722zM15.176 14.12c.21-.18.526-.154.705.056.159.187.157.457.006.64l-.063.065-3.523 3c-.165.14-.397.156-.577.05l-.074-.052-3.477-3c-.209-.18-.232-.497-.052-.706.16-.185.428-.224.632-.104l.074.052 3.151 2.72 3.198-2.722z"}));ti.displayName="UpAndDownCaret";let tr=f.ZP.input.withConfig(eI)`
  ${eS};

  &[aria-invalid='true'] + .ch-checkbox {
    border: ${e=>e.theme.inputs.error.border};
    box-shadow: ${e=>e.theme.inputs.error.shadow};
  }
`,tn=f.ZP.div.withConfig(eI)`
  background-color: ${e=>e.theme.inputs.bgd};
  border: ${e=>e.theme.inputs.border};
  border-radius: ${e=>e.theme.radii.default};
  box-shadow: ${e=>e.theme.inputs.shadow};
  color: ${e=>e.theme.inputs.fontColor};
  display: inline-block;
  height: 1rem;
  position: relative;
  width: 1rem;
  transition: box-shadow 0.05s ease-in;

  > svg {
    left: -0.03125rem;
    position: absolute;
    transform: scale(1.5);
  }

  ${tr}:checked ~ & {
    background-color: ${e=>e.theme.inputs.checked.bgd};
    border: ${e=>e.theme.inputs.checked.border};
    box-shadow: ${e=>e.theme.inputs.checked.shadow};
    color: ${e=>e.theme.inputs.checked.fontColor};
  }

  ${tr}:focus ~ & {
    border: ${e=>e.theme.inputs.focus.border};
    box-shadow: ${e=>e.theme.inputs.focus.shadow};
  }
`,to=e=>{let{checked:t,onChange:i,value:r}=e,n=(0,h.useRef)(null),o=()=>{var e,t;null===(e=n.current)||void 0===e||e.click(),null===(t=n.current)||void 0===t||t.focus()};return h.createElement(h.Fragment,null,h.createElement(tr,Object.assign({},e,{"data-testid":"hidden-checkbox",ref:n,type:"checkbox",value:r,onChange:i})),h.createElement(tn,{"data-testid":"styled-checkbox",checked:t,className:"ch-checkbox",onClick:o},t&&h.createElement(eQ,{"data-testid":"check"})))};to.displayName="Checkbox";let ts=(0,h.createContext)({showLabels:!1,layout:"top"}),ta=()=>(0,h.useContext)(ts),tl={"undocked-vertical":"flex-direction: column;","undocked-horizontal":"flex-direction: row;",top:"flex-direction: row; width: 100%; top: 0; position: fixed;",bottom:"flex-direction: row; width: 100%; bottom: 0; position: fixed;",right:"flex-direction: column; height: 100%; right: 0; position: fixed;",left:"flex-direction: column; height: 100%; left: 0; position: fixed;"},td={popOver:"grid-template-columns: 2.5rem minmax(0.5rem, auto);","popOver&vertical":"grid-template-columns: 1.5rem 1.5rem 1.5rem"},tc=e=>"right"===e||"left"===e||"undocked-vertical"===e,tu=e=>"undocked-vertical"===e||"undocked-horizontal"===e,th={},tf=e=>(0,f.iv)`
    ${({theme:e})=>e.mediaQueries.max.sm} {
      ${th}
      ${tc(e.layout)?tl.left:tl.bottom};
      box-shadow: ${e.theme.controlBar.shadow};
      border: none;
      height: ${tc(e.layout)&&"100%"};
      width: ${!tc(e.layout)&&"100%"};
    }

    ${({theme:e})=>e.mediaQueries.max.xs} {
      justify-content: ${tc(e.layout)?"center":"space-around"};
      ${th}
      ${tc(e.layout)?tl.left:tl.bottom};
      box-shadow: ${({theme:e})=>e.controlBar.shadow};
      border: none;
    }
  `,tp=f.ZP.div.withConfig(eI)`
  display: inline-flex;
  justify-content: center;
  align-items: center;
  border-radius: ${({theme:e,layout:t})=>tu(t)?e.radii.default:"0"};
  background-color: ${e=>e.theme.controlBar.bgd};
  opacity: ${e=>e.theme.controlBar.opacity};
  border: ${({theme:e,layout:t})=>tu(t)?"none":e.controlBar.border};
  box-shadow: ${({theme:e,layout:t})=>tu(t)?e.controlBar.shadow:"none"};
  ${({layout:e})=>tl[`${e}`]};

  ${e=>e.responsive&&tf(e)}

  width: ${({layout:e})=>tc(e)&&"5rem"};
  height: ${({layout:e})=>!tc(e)&&"5rem"};

  ${eA}
  ${eE}
`,tm=f.ZP.div.withConfig(eI)`
  margin: ${({layout:e})=>tc(e)?"0.625rem 0":"0 0.625rem"};
  display: grid;
  grid-template-rows: ${({showLabels:e})=>e?"1.5rem 1rem":"1.5rem"};
  justify-items: center;
  align-items: center;
  ${({popOver:e,layout:t,children:i})=>`
    ${!tc(t)&&(e||i)&&td.popOver||""}
    ${tc(t)&&(e||i)&&td["popOver&vertical"]||""}
  `};

  > :first-child {
    grid-column-start: ${({layout:e,popOver:t,children:i})=>tc(e)&&(t||i)?"2":"1"};
  }

  .ch-control-bar-item-iconButton {
    .ch-icon {
      width: 1.5rem;
      height: 1.5rem;
      border-radius: 100%;
    }
  }

  .ch-control-bar-item-caret {
    width: 1.25rem;
    height: 1.25rem;
    padding: 0;

    .ch-icon {
      width: 100%;
      height: 100%;
    }

    // setting this transform on the shape so we
    // don't overwrite the rotate transform on the Caret
    .Svg g {
      transform: scale(1.333);
      transform-origin: 50% 50%;
    }
  }

  .ch-control-bar-popover {
    background-color: inherit;
    grid-column-start: ${({layout:e,popOver:t,children:i})=>tc(e)&&(t||i)?"2":"1"};
    color: ${({theme:e})=>e.controlBar.text};

    .isOpen.ch-control-bar-item-caret {
      color: ${e=>e.theme.colors.primary.main};
    }
  }

  .ch-control-bar-item-label {
    color: ${({theme:e})=>e.controlBar.text};
    grid-row-start: 2;
    font-size: ${e=>e.theme.fontSizes.footnote.fontSize}; /* TODO: get updated font size from design */
    padding-top: 0.25rem;
    justify-self: center;
    grid-column: ${({layout:e,popOver:t,children:i})=>tc(e)&&(t||i)?"2":"1"};
  }

  ${({theme:e})=>e.mediaQueries.max.sm} {
    justify-content: space-around;
    button ~ span {
      display: none;
    }
  }

  ${({theme:e})=>e.mediaQueries.max.xs} {
    margin: ${({layout:e})=>tc(e)?"0.75rem 0":"0"};
    button ~ span {
      display: none;
    }
  }
`,tg=e=>{var{tag:t,layout:i,showLabels:r=!1,responsive:n=!0,className:o,children:s}=e,a=eg(e,["tag","layout","showLabels","responsive","className","children"]);let l={layout:i,showLabels:r};return h.createElement(ts.Provider,{value:l},h.createElement(tp,Object.assign({className:o||"",responsive:n,as:t},l,{"data-testid":"control-bar"},a),s))};var tv="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};function tb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ty(e,t,i){return e(i={path:t,exports:{},require:function(e,t){return tS(e,null==t?i.path:t)}},i.exports),i.exports}function tS(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var tw=ty(function(e){!function(){var t={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var i=arguments[t];i&&(e=n(e,r(i)))}return e}function r(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var r="";for(var o in e)t.call(e,o)&&e[o]&&(r=n(r,o));return r}function n(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):window.classNames=i}()}),tC=h.createContext(),tk=h.createContext();function tT(e){var t=e.children,i=h.useState(null),r=i[0],n=i[1],o=h.useRef(!1);h.useEffect(function(){return function(){o.current=!0}},[]);var s=h.useCallback(function(e){o.current||n(e)},[]);return h.createElement(tC.Provider,{value:r},h.createElement(tk.Provider,{value:s},t))}var tI=function(e){return Array.isArray(e)?e[0]:e},tE=function(e){if("function"==typeof e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return e.apply(void 0,i)}},tA=function(e,t){if("function"==typeof e)return tE(e,t);null!=e&&(e.current=t)},tM=function(e){return e.reduce(function(e,t){var i=t[0],r=t[1];return e[i]=r,e},{})},tO="undefined"!=typeof window&&window.document&&window.document.createElement?h.useLayoutEffect:h.useEffect,tP="top",t_="bottom",tx="right",tR="left",tD="auto",tN=[tP,t_,tx,tR],tL="start",tF="end",tV="clippingParents",tB="viewport",tU="popper",tj="reference",t$=tN.reduce(function(e,t){return e.concat([t+"-"+tL,t+"-"+tF])},[]),tz=[].concat(tN,[tD]).reduce(function(e,t){return e.concat([t,t+"-"+tL,t+"-"+tF])},[]),tH=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function tW(e){return e?(e.nodeName||"").toLowerCase():null}function tG(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function tK(e){var t=tG(e).Element;return e instanceof t||e instanceof Element}function tq(e){var t=tG(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function tJ(e){if("undefined"==typeof ShadowRoot)return!1;var t=tG(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function tQ(e){return e.split("-")[0]}var tZ=Math.max,tX=Math.min,tY=Math.round;function t0(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function t1(){return!/^((?!chrome|android).)*safari/i.test(t0())}function t2(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var r=e.getBoundingClientRect(),n=1,o=1;t&&tq(e)&&(n=e.offsetWidth>0&&tY(r.width)/e.offsetWidth||1,o=e.offsetHeight>0&&tY(r.height)/e.offsetHeight||1);var s=(tK(e)?tG(e):window).visualViewport,a=!t1()&&i,l=(r.left+(a&&s?s.offsetLeft:0))/n,d=(r.top+(a&&s?s.offsetTop:0))/o,c=r.width/n,u=r.height/o;return{width:c,height:u,top:d,right:l+c,bottom:d+u,left:l,x:l,y:d}}function t3(e){var t=t2(e),i=e.offsetWidth,r=e.offsetHeight;return 1>=Math.abs(t.width-i)&&(i=t.width),1>=Math.abs(t.height-r)&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:r}}function t5(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&tJ(i)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function t4(e){return tG(e).getComputedStyle(e)}function t6(e){return["table","td","th"].indexOf(tW(e))>=0}function t8(e){return((tK(e)?e.ownerDocument:e.document)||window.document).documentElement}function t7(e){return"html"===tW(e)?e:e.assignedSlot||e.parentNode||(tJ(e)?e.host:null)||t8(e)}function t9(e){return tq(e)&&"fixed"!==t4(e).position?e.offsetParent:null}function ie(e){var t=/firefox/i.test(t0());if(/Trident/i.test(t0())&&tq(e)&&"fixed"===t4(e).position)return null;var i=t7(e);for(tJ(i)&&(i=i.host);tq(i)&&0>["html","body"].indexOf(tW(i));){var r=t4(i);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return i;i=i.parentNode}return null}function it(e){for(var t=tG(e),i=t9(e);i&&t6(i)&&"static"===t4(i).position;)i=t9(i);return i&&("html"===tW(i)||"body"===tW(i)&&"static"===t4(i).position)?t:i||ie(e)||t}function ii(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ir(e,t,i){return tZ(e,tX(t,i))}function io(e,t,i){var r=ir(e,t,i);return r>i?i:r}function is(){return{top:0,right:0,bottom:0,left:0}}function ia(e){return Object.assign({},is(),e)}function il(e,t){return t.reduce(function(t,i){return t[i]=e,t},{})}var id=function(e,t){return ia("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:il(e,tN))};function ic(e){return e.split("-")[1]}var iu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ih(e,t){var i=e.x,r=e.y,n=t.devicePixelRatio||1;return{x:tY(i*n)/n||0,y:tY(r*n)/n||0}}function ip(e){var t,i,r=e.popper,n=e.popperRect,o=e.placement,s=e.variation,a=e.offsets,l=e.position,d=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,h=e.isFixed,f=a.x,p=void 0===f?0:f,m=a.y,g=void 0===m?0:m,v="function"==typeof u?u({x:p,y:g}):{x:p,y:g};p=v.x,g=v.y;var b=a.hasOwnProperty("x"),y=a.hasOwnProperty("y"),S=tR,w=tP,C=window;if(c){var k=it(r),T="clientHeight",I="clientWidth";k===tG(r)&&"static"!==t4(k=t8(r)).position&&"absolute"===l&&(T="scrollHeight",I="scrollWidth"),(o===tP||(o===tR||o===tx)&&s===tF)&&(w=t_,g-=(h&&k===C&&C.visualViewport?C.visualViewport.height:k[T])-n.height,g*=d?1:-1),(o===tR||(o===tP||o===t_)&&s===tF)&&(S=tx,p-=(h&&k===C&&C.visualViewport?C.visualViewport.width:k[I])-n.width,p*=d?1:-1)}var E=Object.assign({position:l},c&&iu),A=!0===u?ih({x:p,y:g},tG(r)):{x:p,y:g};return(p=A.x,g=A.y,d)?Object.assign({},E,((i={})[w]=y?"0":"",i[S]=b?"0":"",i.transform=1>=(C.devicePixelRatio||1)?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",i)):Object.assign({},E,((t={})[w]=y?g+"px":"",t[S]=b?p+"px":"",t.transform="",t))}var im={passive:!0},ig={left:"right",right:"left",bottom:"top",top:"bottom"};function iv(e){return e.replace(/left|right|bottom|top/g,function(e){return ig[e]})}var ib={start:"end",end:"start"};function iy(e){return e.replace(/start|end/g,function(e){return ib[e]})}function iS(e){var t=tG(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function iw(e){return t2(t8(e)).left+iS(e).scrollLeft}function iC(e,t){var i=tG(e),r=t8(e),n=i.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(n){o=n.width,s=n.height;var d=t1();(d||!d&&"fixed"===t)&&(a=n.offsetLeft,l=n.offsetTop)}return{width:o,height:s,x:a+iw(e),y:l}}function ik(e){var t,i=t8(e),r=iS(e),n=null==(t=e.ownerDocument)?void 0:t.body,o=tZ(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),s=tZ(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),a=-r.scrollLeft+iw(e),l=-r.scrollTop;return"rtl"===t4(n||i).direction&&(a+=tZ(i.clientWidth,n?n.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}function iT(e){var t=t4(e),i=t.overflow,r=t.overflowX,n=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+n+r)}function iI(e){return["html","body","#document"].indexOf(tW(e))>=0?e.ownerDocument.body:tq(e)&&iT(e)?e:iI(t7(e))}function iE(e,t){void 0===t&&(t=[]);var i,r=iI(e),n=r===(null==(i=e.ownerDocument)?void 0:i.body),o=tG(r),s=n?[o].concat(o.visualViewport||[],iT(r)?r:[]):r,a=t.concat(s);return n?a:a.concat(iE(t7(s)))}function iA(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function iM(e,t){var i=t2(e,!1,"fixed"===t);return i.top=i.top+e.clientTop,i.left=i.left+e.clientLeft,i.bottom=i.top+e.clientHeight,i.right=i.left+e.clientWidth,i.width=e.clientWidth,i.height=e.clientHeight,i.x=i.left,i.y=i.top,i}function iO(e,t,i){return t===tB?iA(iC(e,i)):tK(t)?iM(t,i):iA(ik(t8(e)))}function iP(e){var t=iE(t7(e)),i=["absolute","fixed"].indexOf(t4(e).position)>=0&&tq(e)?it(e):e;return tK(i)?t.filter(function(e){return tK(e)&&t5(e,i)&&"body"!==tW(e)}):[]}function i_(e,t,i,r){var n=[].concat("clippingParents"===t?iP(e):[].concat(t),[i]),o=n[0],s=n.reduce(function(t,i){var n=iO(e,i,r);return t.top=tZ(n.top,t.top),t.right=tX(n.right,t.right),t.bottom=tX(n.bottom,t.bottom),t.left=tZ(n.left,t.left),t},iO(e,o,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function ix(e){var t,i=e.reference,r=e.element,n=e.placement,o=n?tQ(n):null,s=n?ic(n):null,a=i.x+i.width/2-r.width/2,l=i.y+i.height/2-r.height/2;switch(o){case tP:t={x:a,y:i.y-r.height};break;case t_:t={x:a,y:i.y+i.height};break;case tx:t={x:i.x+i.width,y:l};break;case tR:t={x:i.x-r.width,y:l};break;default:t={x:i.x,y:i.y}}var d=o?ii(o):null;if(null!=d){var c="y"===d?"height":"width";switch(s){case tL:t[d]=t[d]-(i[c]/2-r[c]/2);break;case tF:t[d]=t[d]+(i[c]/2-r[c]/2)}}return t}function iR(e,t){void 0===t&&(t={});var i=t,r=i.placement,n=void 0===r?e.placement:r,o=i.strategy,s=void 0===o?e.strategy:o,a=i.boundary,l=void 0===a?tV:a,d=i.rootBoundary,c=void 0===d?tB:d,u=i.elementContext,h=void 0===u?tU:u,f=i.altBoundary,p=void 0!==f&&f,m=i.padding,g=void 0===m?0:m,v=ia("number"!=typeof g?g:il(g,tN)),b=h===tU?tj:tU,y=e.rects.popper,S=e.elements[p?b:h],w=i_(tK(S)?S:S.contextElement||t8(e.elements.popper),l,c,s),C=t2(e.elements.reference),k=ix({reference:C,element:y,strategy:"absolute",placement:n}),T=iA(Object.assign({},y,k)),I=h===tU?T:C,E={top:w.top-I.top+v.top,bottom:I.bottom-w.bottom+v.bottom,left:w.left-I.left+v.left,right:I.right-w.right+v.right},A=e.modifiersData.offset;if(h===tU&&A){var M=A[n];Object.keys(E).forEach(function(e){var t=[tx,t_].indexOf(e)>=0?1:-1,i=[tP,t_].indexOf(e)>=0?"y":"x";E[e]+=M[i]*t})}return E}function iD(e,t){void 0===t&&(t={});var i=t,r=i.placement,n=i.boundary,o=i.rootBoundary,s=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,d=void 0===l?tz:l,c=ic(r),u=c?a?t$:t$.filter(function(e){return ic(e)===c}):tN,h=u.filter(function(e){return d.indexOf(e)>=0});0===h.length&&(h=u);var f=h.reduce(function(t,i){return t[i]=iR(e,{placement:i,boundary:n,rootBoundary:o,padding:s})[tQ(i)],t},{});return Object.keys(f).sort(function(e,t){return f[e]-f[t]})}function iN(e){if(tQ(e)===tD)return[];var t=iv(e);return[iy(e),t,iy(t)]}function iL(e,t,i){return void 0===i&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function iF(e){return[tP,tx,t_,tR].some(function(t){return e[t]>=0})}function iV(e,t,i){var r=tQ(e),n=[tR,tP].indexOf(r)>=0?-1:1,o="function"==typeof i?i(Object.assign({},t,{placement:e})):i,s=o[0],a=o[1];return s=s||0,a=(a||0)*n,[tR,tx].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function iB(e){return"x"===e?"y":"x"}function iU(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function ij(e){return e!==tG(e)&&tq(e)?iU(e):iS(e)}function i$(e){var t=e.getBoundingClientRect(),i=tY(t.width)/e.offsetWidth||1,r=tY(t.height)/e.offsetHeight||1;return 1!==i||1!==r}function iz(e,t,i){void 0===i&&(i=!1);var r=tq(t),n=tq(t)&&i$(t),o=t8(t),s=t2(e,n,i),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!i)&&(("body"!==tW(t)||iT(o))&&(a=ij(t)),tq(t)?(l=t2(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):o&&(l.x=iw(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function iH(e){var t=new Map,i=new Set,r=[];function n(e){i.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!i.has(e)){var r=t.get(e);r&&n(r)}}),r.push(e)}return e.forEach(function(e){t.set(e.name,e)}),e.forEach(function(e){i.has(e.name)||n(e)}),r}function iW(e){var t=iH(e);return tH.reduce(function(e,i){return e.concat(t.filter(function(e){return e.phase===i}))},[])}function iG(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function iK(e){var t=e.reduce(function(e,t){var i=e[t.name];return e[t.name]=i?Object.assign({},i,t,{options:Object.assign({},i.options,t.options),data:Object.assign({},i.data,t.data)}):t,e},{});return Object.keys(t).map(function(e){return t[e]})}var iq={placement:"bottom",modifiers:[],strategy:"absolute"};function iJ(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}var iQ=function(e){void 0===e&&(e={});var t=e,i=t.defaultModifiers,r=void 0===i?[]:i,n=t.defaultOptions,o=void 0===n?iq:n;return function(e,t,i){void 0===i&&(i=o);var n={placement:"bottom",orderedModifiers:[],options:Object.assign({},iq,o),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},s=[],a=!1,l={state:n,setOptions:function(i){var s="function"==typeof i?i(n.options):i;c(),n.options=Object.assign({},o,n.options,s),n.scrollParents={reference:tK(e)?iE(e):e.contextElement?iE(e.contextElement):[],popper:iE(t)};var a=iW(iK([].concat(r,n.options.modifiers)));return n.orderedModifiers=a.filter(function(e){return e.enabled}),d(),l.update()},forceUpdate:function(){if(!a){var e=n.elements,t=e.reference,i=e.popper;if(iJ(t,i)){n.rects={reference:iz(t,it(i),"fixed"===n.options.strategy),popper:t3(i)},n.reset=!1,n.placement=n.options.placement,n.orderedModifiers.forEach(function(e){return n.modifiersData[e.name]=Object.assign({},e.data)});for(var r=0;r<n.orderedModifiers.length;r++){if(!0===n.reset){n.reset=!1,r=-1;continue}var o=n.orderedModifiers[r],s=o.fn,d=o.options,c=void 0===d?{}:d,u=o.name;"function"==typeof s&&(n=s({state:n,options:c,name:u,instance:l})||n)}}}},update:iG(function(){return new Promise(function(e){l.forceUpdate(),e(n)})}),destroy:function(){c(),a=!0}};if(!iJ(e,t))return l;function d(){n.orderedModifiers.forEach(function(e){var t=e.name,i=e.options,r=void 0===i?{}:i,o=e.effect;if("function"==typeof o){var a=o({state:n,name:t,instance:l,options:r}),d=function(){};s.push(a||d)}})}function c(){s.forEach(function(e){return e()}),s=[]}return l.setOptions(i).then(function(e){!a&&i.onFirstUpdate&&i.onFirstUpdate(e)}),l}}({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,i=e.instance,r=e.options,n=r.scroll,o=void 0===n||n,s=r.resize,a=void 0===s||s,l=tG(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&d.forEach(function(e){e.addEventListener("scroll",i.update,im)}),a&&l.addEventListener("resize",i.update,im),function(){o&&d.forEach(function(e){e.removeEventListener("scroll",i.update,im)}),a&&l.removeEventListener("resize",i.update,im)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,i=e.name;t.modifiersData[i]=ix({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,i=e.options,r=i.gpuAcceleration,n=void 0===r||r,o=i.adaptive,s=void 0===o||o,a=i.roundOffsets,l=void 0===a||a,d={placement:tQ(t.placement),variation:ic(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ip(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ip(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var i=t.styles[e]||{},r=t.attributes[e]||{},n=t.elements[e];tq(n)&&tW(n)&&(Object.assign(n.style,i),Object.keys(r).forEach(function(e){var t=r[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(e){var r=t.elements[e],n=t.attributes[e]||{},o=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:i[e]).reduce(function(e,t){return e[t]="",e},{});tq(r)&&tW(r)&&(Object.assign(r.style,o),Object.keys(n).forEach(function(e){r.removeAttribute(e)}))})}},requires:["computeStyles"]},{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,i=e.options,r=e.name,n=i.offset,o=void 0===n?[0,0]:n,s=tz.reduce(function(e,i){return e[i]=iV(i,t.rects,o),e},{}),a=s[t.placement],l=a.x,d=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=d),t.modifiersData[r]=s}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var n=i.mainAxis,o=void 0===n||n,s=i.altAxis,a=void 0===s||s,l=i.fallbackPlacements,d=i.padding,c=i.boundary,u=i.rootBoundary,h=i.altBoundary,f=i.flipVariations,p=void 0===f||f,m=i.allowedAutoPlacements,g=t.options.placement,v=tQ(g)===g,b=l||(v||!p?[iv(g)]:iN(g)),y=[g].concat(b).reduce(function(e,i){return e.concat(tQ(i)===tD?iD(t,{placement:i,boundary:c,rootBoundary:u,padding:d,flipVariations:p,allowedAutoPlacements:m}):i)},[]),S=t.rects.reference,w=t.rects.popper,C=new Map,k=!0,T=y[0],I=0;I<y.length;I++){var E=y[I],A=tQ(E),M=ic(E)===tL,O=[tP,t_].indexOf(A)>=0,P=O?"width":"height",_=iR(t,{placement:E,boundary:c,rootBoundary:u,altBoundary:h,padding:d}),x=O?M?tx:tR:M?t_:tP;S[P]>w[P]&&(x=iv(x));var R=iv(x),D=[];if(o&&D.push(_[A]<=0),a&&D.push(_[x]<=0,_[R]<=0),D.every(function(e){return e})){T=E,k=!1;break}C.set(E,D)}if(k)for(var N=p?3:1,L=function(e){var t=y.find(function(t){var i=C.get(t);if(i)return i.slice(0,e).every(function(e){return e})});if(t)return T=t,"break"},F=N;F>0&&"break"!==L(F);F--);t.placement!==T&&(t.modifiersData[r]._skip=!0,t.placement=T,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,i=e.options,r=e.name,n=i.mainAxis,o=void 0===n||n,s=i.altAxis,a=void 0!==s&&s,l=i.boundary,d=i.rootBoundary,c=i.altBoundary,u=i.padding,h=i.tether,f=void 0===h||h,p=i.tetherOffset,m=void 0===p?0:p,g=iR(t,{boundary:l,rootBoundary:d,padding:u,altBoundary:c}),v=tQ(t.placement),b=ic(t.placement),y=!b,S=ii(v),w=iB(S),C=t.modifiersData.popperOffsets,k=t.rects.reference,T=t.rects.popper,I="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,E="number"==typeof I?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,M={x:0,y:0};if(C){if(o){var O,P="y"===S?tP:tR,_="y"===S?t_:tx,x="y"===S?"height":"width",R=C[S],D=R+g[P],N=R-g[_],L=f?-T[x]/2:0,F=b===tL?k[x]:T[x],V=b===tL?-T[x]:-k[x],B=t.elements.arrow,U=f&&B?t3(B):{width:0,height:0},j=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:is(),$=j[P],z=j[_],H=ir(0,k[x],U[x]),W=y?k[x]/2-L-H-$-E.mainAxis:F-H-$-E.mainAxis,G=y?-k[x]/2+L+H+z+E.mainAxis:V+H+z+E.mainAxis,K=t.elements.arrow&&it(t.elements.arrow),q=K?"y"===S?K.clientTop||0:K.clientLeft||0:0,J=null!=(O=null==A?void 0:A[S])?O:0,Q=R+W-J-q,Z=R+G-J,X=ir(f?tX(D,Q):D,R,f?tZ(N,Z):N);C[S]=X,M[S]=X-R}if(a){var Y,ee="x"===S?tP:tR,et="x"===S?t_:tx,ei=C[w],er="y"===w?"height":"width",en=ei+g[ee],eo=ei-g[et],es=-1!==[tP,tR].indexOf(v),ea=null!=(Y=null==A?void 0:A[w])?Y:0,el=es?en:ei-k[er]-T[er]-ea+E.altAxis,ed=es?ei+k[er]+T[er]-ea-E.altAxis:eo,ec=f&&es?io(el,ei,ed):ir(f?el:en,ei,f?ed:eo);C[w]=ec,M[w]=ec-ei}t.modifiersData[r]=M}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,i=e.state,r=e.name,n=e.options,o=i.elements.arrow,s=i.modifiersData.popperOffsets,a=tQ(i.placement),l=ii(a),d=[tR,tx].indexOf(a)>=0?"height":"width";if(o&&s){var c=id(n.padding,i),u=t3(o),h="y"===l?tP:tR,f="y"===l?t_:tx,p=i.rects.reference[d]+i.rects.reference[l]-s[l]-i.rects.popper[d],m=s[l]-i.rects.reference[l],g=it(o),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,b=p/2-m/2,y=c[h],S=v-u[d]-c[f],w=v/2-u[d]/2+b,C=ir(y,w,S),k=l;i.modifiersData[r]=((t={})[k]=C,t.centerOffset=C-w,t)}},effect:function(e){var t=e.state,i=e.options.element,r=void 0===i?"[data-popper-arrow]":i;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&t5(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,i=e.name,r=t.rects.reference,n=t.rects.popper,o=t.modifiersData.preventOverflow,s=iR(t,{elementContext:"reference"}),a=iR(t,{altBoundary:!0}),l=iL(s,r),d=iL(a,n,o),c=iF(l),u=iF(d);t.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:c,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":u})}}]}),iZ="undefined"!=typeof Element,iX="function"==typeof Map,iY="function"==typeof Set,i0="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function i1(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var i,r,n,o;if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)){if((i=e.length)!=t.length)return!1;for(r=i;0!=r--;)if(!i1(e[r],t[r]))return!1;return!0}if(iX&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(o=e.entries();!(r=o.next()).done;)if(!t.has(r.value[0]))return!1;for(o=e.entries();!(r=o.next()).done;)if(!i1(r.value[1],t.get(r.value[0])))return!1;return!0}if(iY&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(o=e.entries();!(r=o.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(i0&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((i=e.length)!=t.length)return!1;for(r=i;0!=r--;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof t.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof t.toString)return e.toString()===t.toString();if((i=(n=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=i;0!=r--;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;if(iZ&&e instanceof Element)return!1;for(r=i;0!=r--;)if(("_owner"!==n[r]&&"__v"!==n[r]&&"__o"!==n[r]||!e.$$typeof)&&!i1(e[n[r]],t[n[r]]))return!1;return!0}return e!=e&&t!=t}var i2=function(e,t){try{return i1(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw e}},i3=[],i5=function(e,t,i){void 0===i&&(i={});var r=h.useRef(null),n={onFirstUpdate:i.onFirstUpdate,placement:i.placement||"bottom",strategy:i.strategy||"absolute",modifiers:i.modifiers||i3},o=h.useState({styles:{popper:{position:n.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),s=o[0],a=o[1],l=h.useMemo(function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(e){var t=e.state,i=Object.keys(t.elements);es.flushSync(function(){a({styles:tM(i.map(function(e){return[e,t.styles[e]||{}]})),attributes:tM(i.map(function(e){return[e,t.attributes[e]]}))})})},requires:["computeStyles"]}},[]),d=h.useMemo(function(){var e={onFirstUpdate:n.onFirstUpdate,placement:n.placement,strategy:n.strategy,modifiers:[].concat(n.modifiers,[l,{name:"applyStyles",enabled:!1}])};return i2(r.current,e)?r.current||e:(r.current=e,e)},[n.onFirstUpdate,n.placement,n.strategy,n.modifiers,l]),c=h.useRef();return tO(function(){c.current&&c.current.setOptions(d)},[d]),tO(function(){if(null!=e&&null!=t){var r=(i.createPopper||iQ)(e,t,d);return c.current=r,function(){r.destroy(),c.current=null}}},[e,t,i.createPopper]),{state:c.current?c.current.state:null,styles:s.styles,attributes:s.attributes,update:c.current?c.current.update:null,forceUpdate:c.current?c.current.forceUpdate:null}},i4=function(){},i6=function(){return Promise.resolve(null)},i8=[];function i7(e){var t=e.placement,i=void 0===t?"bottom":t,r=e.strategy,n=void 0===r?"absolute":r,o=e.modifiers,s=void 0===o?i8:o,a=e.referenceElement,l=e.onFirstUpdate,d=e.innerRef,c=e.children,u=h.useContext(tC),f=h.useState(null),p=f[0],m=f[1],g=h.useState(null),v=g[0],b=g[1];h.useEffect(function(){tA(d,p)},[d,p]);var y=i5(a||u,p,h.useMemo(function(){return{placement:i,strategy:n,onFirstUpdate:l,modifiers:[].concat(s,[{name:"arrow",enabled:null!=v,options:{element:v}}])}},[i,n,l,s,v])),S=y.state,w=y.styles,C=y.forceUpdate,k=y.update,T=h.useMemo(function(){return{ref:m,style:w.popper,placement:S?S.placement:i,hasPopperEscaped:S&&S.modifiersData.hide?S.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:S&&S.modifiersData.hide?S.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:w.arrow,ref:b},forceUpdate:C||i4,update:k||i6}},[m,b,i,S,w,k,C]);return tI(c)(T)}var i9=function(){};function re(e){var t=e.children,i=e.innerRef,r=h.useContext(tk),n=h.useCallback(function(e){tA(i,e),tE(r,e)},[i,r]);return h.useEffect(function(){return function(){return tA(i,null)}},[]),h.useEffect(function(){i9(!!r,"`Reference` should not be used outside of a `Manager` component.")},[r]),tI(t)({ref:n})}let rt={ESCAPE:27,ARROW_UP:38,ARROW_DOWN:40},ri="360p (nHD) @ 15 fps (600 Kbps max)",rr="540p (qHD) @ 15 fps (1.4 Mbps max)",rn="720p (HD) @ 15 fps (1.4 Mbps max)";function ro(e,t){let i=t=>!!e.current&&!e.current.contains(t.target),r=e=>{i(e)&&t&&t(e)};(0,h.useEffect)(()=>(document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}))}function rs(e,t){let i=()=>!!e.current&&!e.current.contains(document.activeElement),r=e=>{if(9===e.keyCode&&i())return t(e)};(0,h.useEffect)(()=>(document.addEventListener("keyup",r),()=>{document.removeEventListener("keyup",r)}))}let ra=f.ZP.ul.withConfig(eI)`
  width: fit-content;
  max-width: 22rem;
  background-color: ${e=>e.theme.popOver.menuBgd};
  border: ${e=>e.theme.popOver.menuBorder};
  margin: 0;
  border-radius: 0.25rem;
  backdrop-filter: blur(1rem);
  list-style: none;
  padding: 0.5rem 0;
  box-shadow: ${e=>e.theme.popOver.shadow};
  z-index: ${e=>e.theme.zIndex.popOver};
  display: table;
  overflow: inherit;
`,rl=f.ZP.button.withConfig(eI)`
  background-color: transparent;
  padding: 0;
  border: none;
  cursor: pointer;
  &:focus {
    outline: 0;
  }
`,rd=f.ZP.li.withConfig(eI)`
  height: 2rem;
  position: relative;

  button,
  a {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    border: none;
    cursor: pointer;
    background-color: ${e=>e.theme.popOver.itemBgd};
    color: ${e=>e.theme.popOver.itemText};
    line-height: ${e=>e.theme.fontSizes.text.lineHeight};
    font-size: ${e=>e.theme.fontSizes.text.fontSize};
    padding: 0 2.5rem;
    text-decoration: none;
    outline: 0;

    &:hover,
    &:focus {
      background-color: ${e=>e.theme.popOver.active.itemBgd};
      color: ${e=>e.theme.popOver.active.itemText};
      outline: 0;
    }

    &:disabled {
      color: ${e=>e.theme.popOver.disabled};
    }
  }

  a {
    width: unset;
  }

  .ch-content > * {
    ${ew};
  }

  .ch-check {
    position: absolute;
    left: 0.5rem;
    width: 1.5rem;
    height: 1.5rem;
    top: 0.33rem;
  }

  &:hover .ch-check g,
  &:focus .ch-check g {
    fill: ${e=>e.theme.popOver.active.itemText};
  }
`;(0,f.ZP)(rd)`
  > span {
    width: 100%;
    height: 100%;
    display: block;
    height: 2rem;
  }

  > button {
    position: relative;
  }

  .ch-caret {
    position: absolute;
    width: 1.5rem;
    height: 1.5rem;
    right: 0;
    color: inherit;
    fill: inherit;
  }
`,f.ZP.header.withConfig(eI)`
  border-bottom: 0.0625rem solid ${e=>e.theme.popOver.separator};
  margin-bottom: 0.75rem;
  max-width: 22rem;

  img {
    width: 100%;
    display: inline-block;
    margin-top: -0.5rem;
    border-radius: 0.25rem 0.25rem 0 0;
  }

  img + .ch-title {
    margin-top: 0.75rem;
  }

  .ch-title {
    ${ew};
    padding: 0 2.5rem;
    margin-top: 0.5rem;
    margin-bottom: 0;
    color: ${e=>e.theme.popOver.titleText};
    font-size: 1.18125rem;
    line-height: ${e=>e.theme.fontSizes.text.lineHeight};
  }

  .ch-subtitle {
    ${ew};
    padding: 0 2.5rem;
    color: #616672;
    font-size: ${e=>e.theme.fontSizes.text.fontSize};
    line-height: ${e=>e.theme.fontSizes.text.lineHeight};
    line-height: 1.43;
    margin: 0 0 1rem;
  }
`;let rc=f.ZP.li.withConfig(eI)`
  margin: 0;
  border-width: 0.0625rem 0 0 0;
  border-style: solid;
  border-color: ${e=>e.theme.popOver.separator};
  margin-bottom: 0.75rem;
  opacity: 0.8;
`,ru=e=>e.querySelectorAll("button, [href]"),rh=e=>{var{renderButton:t,renderButtonWrapper:i,onPopOverClick:r,children:n,isSubMenu:o=!1,placement:s="bottom-start",a11yLabel:a,className:l,closeOnClick:d=!0}=e,c=eg(e,["renderButton","renderButtonWrapper","onPopOverClick","children","isSubMenu","placement","a11yLabel","className","closeOnClick"]);let u=(0,h.createRef)(),[f,p]=(0,h.useState)(!1);(0,h.useEffect)(()=>{if(f&&u.current){let e=ru(u.current);e&&e[0].focus()}},[f]);let m=e=>{let t=u.current;if(!o&&t){let i=ru(t),r=document.activeElement;for(let t=0;t<i.length;t++)if(i[t]===r){if("down"===e&&t!==i.length-1)return i[t+1].focus();if("up"===e&&t>0)return i[t-1].focus();break}}},g=e=>{if(d)return!e.target.closest("[data-menu='submenu']")&&p(!1)},v=e=>{switch(e.keyCode){case rt.ESCAPE:return p(!1);case rt.ARROW_UP:return m("up");case rt.ARROW_DOWN:return m("down")}},b=()=>{p(!f),r&&r(f)};return ro(u,()=>p(!1)),rs(u,()=>p(!1)),h.createElement("span",{ref:u,onKeyDown:v,"data-testid":"popover"},h.createElement(tT,null,h.createElement(re,null,({ref:e})=>{let r={ref:e,className:tw(l,"ch-popover-toggle"),onClick:b,"data-menu":o?"submenu":null,"aria-label":a,"aria-haspopup":!0,"aria-expanded":f,"data-testid":"popover-toggle"};if(t)return h.createElement(rl,Object.assign({},r),t(f));if(i){let{ref:e}=r,t=eg(r,["ref"]);return h.createElement("span",{ref:e},i(f,t))}return null}),f&&h.createElement(i7,Object.assign({placement:s,modifiers:[{name:"offset",options:{offset:[-8,0]}}]},c),({ref:e,style:t,placement:i})=>h.createElement(ra,{"data-placement":i,onClick:e=>g(e),ref:e,style:t,"data-testid":"menu",className:"ch-popover-menu"},n))))},rf=e=>{var{as:t="button",children:i,checked:r,testId:n="popover-item"}=e,o=eg(e,["as","children","checked","testId"]);let s=t;return h.createElement(rd,{"data-testid":n},r&&h.createElement(eQ,{className:"ch-check","data-testid":"popover-check"}),h.createElement(s,Object.assign({className:"ch-content"},o),i))},rp=new ea.ConsoleLogger("ChimeSDKReactComponent",ea.LogLevel.INFO),rm=h.createContext(rp),rg=()=>(0,h.useContext)(rm),rv=.25,rb=.5,ry=.5,rS=.75,rw=1,rC=(0,f.iv)`
  top: calc(
    ${e=>{var t,i;return null!==(i=null===(t=e.bounds)||void 0===t?void 0:t.top)&&void 0!==i?i:0}}px -
      ${rb+rv+rw}rem
  );
  left: ${e=>{var t,i,r,n;return((null!==(i=null===(t=e.bounds)||void 0===t?void 0:t.left)&&void 0!==i?i:0)+(null!==(n=null===(r=e.bounds)||void 0===r?void 0:r.right)&&void 0!==n?n:0))/2}}px;
  transform: translateX(-50%) translateY(-50%);

  &::before {
    transform: rotateZ(180deg);
    top: 100%;
    left: calc(50% - ${rb}rem);
  }
`,rk=(0,f.iv)`
  top: calc(
    ${e=>{var t,i;return null!==(i=null===(t=e.bounds)||void 0===t?void 0:t.bottom)&&void 0!==i?i:0}}px +
      ${rb+rv+rw}rem
  );
  left: ${e=>{var t,i,r,n;return((null!==(i=null===(t=e.bounds)||void 0===t?void 0:t.left)&&void 0!==i?i:0)+(null!==(n=null===(r=e.bounds)||void 0===r?void 0:r.right)&&void 0!==n?n:0))/2}}px;
  transform: translateX(-50%) translateY(-50%);

  &::before {
    transform: rotateZ(0deg);
    top: -${rb}rem;
    left: calc(50% - ${rb}rem);
  }
`,rT=(0,f.iv)`
  top: ${e=>{var t,i,r,n;return((null!==(i=null===(t=e.bounds)||void 0===t?void 0:t.top)&&void 0!==i?i:0)+(null!==(n=null===(r=e.bounds)||void 0===r?void 0:r.bottom)&&void 0!==n?n:0))/2}}px;
  left: calc(
    ${e=>{var t,i;return null!==(i=null===(t=e.bounds)||void 0===t?void 0:t.left)&&void 0!==i?i:0}}px - ${rb+rv}rem
  );
  transform: translateY(-50%) translateX(-100%);

  &::before {
    transform: rotateZ(90deg);
    top: calc(50% - ${rb/2}rem);
    left: calc(100% - ${rv}rem);
  }
`,rI=(0,f.iv)`
  top: ${e=>{var t,i,r,n;return((null!==(i=null===(t=e.bounds)||void 0===t?void 0:t.top)&&void 0!==i?i:0)+(null!==(n=null===(r=e.bounds)||void 0===r?void 0:r.bottom)&&void 0!==n?n:0))/2}}px;
  left: calc(
    ${e=>{var t,i;return null!==(i=null===(t=e.bounds)||void 0===t?void 0:t.right)&&void 0!==i?i:0}}px + ${rb+rv}rem
  );
  transform: translateY(-50%);

  &::before {
    transform: rotateZ(270deg);
    top: calc(50% - ${rb/2}rem);
    left: -${rb+rv}rem;
  }
`,rE=f.ZP.span.withConfig(eI)`
  @keyframes fadeIn {
    0% {
      opacity: 0;
    }

    100% {
      opacity: 1;
    }
  }

  position: fixed;
  z-index: 9999;
  color: white;
  white-space: nowrap;
  pointer-events: none;
  line-height: normal;
  background-color: rgba(0, 0, 0, 0.8);
  border-radius: ${rw/2}rem;
  font-size: ${rw}rem;
  font-weight: 300;
  padding: ${ry}rem ${rS}rem;
  white-space: nowrap;
  animation: fadeIn 0.3s;

  &::before {
    border-bottom: ${rb}rem solid rgba(0, 0, 0, 0.8);
    border-left: ${rb}rem solid transparent;
    border-right: ${rb}rem solid transparent;
    content: '';
    height: 0;
    transform: translateX(-100%) translateY(-50%);
    width: 0;
    z-index: 1;
    position: absolute;
  }

  ${e=>"top"===e.position&&rC}
  ${e=>"bottom"===e.position&&rk}
  ${e=>"left"===e.position&&rT}
  ${e=>"right"===e.position&&rI}
`,rA={show:!1,bounds:null},rM=(e,t)=>i=>{var r;let n=rg(),[{show:o,bounds:s},a]=(0,h.useState)(rA),[l,d]=(0,h.useState)(null),c=null!==(r=i.tooltipPosition)&&void 0!==r?r:"top",u=(0,h.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t=e.target;for(;!t.getAttribute("data-tooltip");)t=t.parentElement;a({show:!0,bounds:t.getBoundingClientRect()})},[]),f=(0,h.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),a(rA)},[]);return(0,h.useEffect)(()=>(document.addEventListener("scroll",f,!0),()=>document.removeEventListener("scroll",f,!0)),[]),(0,h.useEffect)(()=>{let e=document.getElementById(t||"Tooltip__container");if(!e){n.warn("Attempted to use 'WithTooltip' but could not find container element.Pass a valid element ID or add 'Tooltip__container' ID to existing element");return}d(e)},[t]),h.createElement(h.Fragment,null,o&&s&&l&&es.createPortal(h.createElement(rE,{position:c,bounds:s},i.tooltipContent||i.label),l),h.createElement(e,Object.assign({},i,{"data-tooltip":!0,"data-tooltip-position":c,onClick:e=>{var t;o&&f(e),null===(t=null==i?void 0:i.onClick)||void 0===t||t.call(i,e)},onFocus:e=>{var t;o||u(e),null===(t=null==i?void 0:i.onFocus)||void 0===t||t.call(i,e)},onBlur:e=>{var t;o&&f(e),null===(t=null==i?void 0:i.onBlur)||void 0===t||t.call(i,e)},onMouseEnter:e=>{var t;o||u(e),null===(t=null==i?void 0:i.onMouseEnter)||void 0===t||t.call(i,e)},onMouseLeave:e=>{var t;o&&f(e),null===(t=null==i?void 0:i.onMouseLeave)||void 0===t||t.call(i,e)}})))},rO=e=>{var{icon:t,onClick:i,label:r,isSelected:n=!1,popOver:o=null,popOverPlacement:s,popOverLabel:a,tooltipContainerId:l,tooltipContent:d,children:c}=e,u=eg(e,["icon","onClick","label","isSelected","popOver","popOverPlacement","popOverLabel","tooltipContainerId","tooltipContent","children"]);let f=ta(),p=(0,h.useMemo)(()=>rM(eB,l),[l]),m=u["data-tooltip"]?p:eB,g=u["data-tooltip-position"]?{tooltipPosition:u["data-tooltip-position"],tooltipContent:d}:{},v=()=>h.createElement(rh,{renderButtonWrapper:(e,t)=>h.createElement(eB,Object.assign({},t,{icon:h.createElement(eW,{direction:tc(f.layout)?"right":"up","data-testid":"control-bar-item-caret"}),label:a||r,selected:e,className:`ch-control-bar-item-caret ${e?"isOpen":""}`})),a11yLabel:r,className:"ch-control-bar-popover",placement:s},null==o?void 0:o.map((e,t)=>h.createElement(rf,Object.assign({},e,{key:t}))),c);return h.createElement(tm,Object.assign({isSelected:n,"data-testid":"control-bar-item"},u,f,{popOver:o}),h.createElement(m,Object.assign({},g,{onClick:i,label:r,icon:t,className:"ch-control-bar-item-iconButton",selected:n})),(o||c)&&v(),f.showLabels&&h.createElement("div",{className:"ch-control-bar-item-label"},r))},rP=(0,f.iv)`
  display: flex;
  width: 100%;
  height: 100%;
`,r_=(0,f.iv)`
  ${rP};
  align-items: center;
  justify-content: center;
`,rx={"fill-space":rP,"fill-space-centered":r_,"equal-columns":(0,f.iv)`
  display: flex;
  flex-direction: row;
  height: 100%;
  align-items: stretch;

  > * {
    flex-grow: 1;
    flex-basis: 50%;
  }
`,stack:(0,f.iv)`
  display: flex;
  flex-direction: column;
  align-items: center;

  > * {
    width: 100%;
  }
`},rR=f.ZP.div.withConfig(eI)`
  align-items: ${e=>e.alignItems};
  display: ${e=>e.container?"flex":"block"};
  flex: ${e=>e.flex||""};
  flex-basis: ${e=>e.flexBasis};
  flex-direction: ${e=>e.flexDirection};
  flex-grow: ${e=>e.flexGrow||""};
  flex-shrink: ${e=>e.flexShrink};
  flex-wrap: ${e=>e.flexWrap};
  justify-content: ${e=>e.justifyContent};

  // layout variants
  ${e=>!!e.layout&&rx[e.layout]}

  ${eA}
  ${eE}
`,rD=e=>{var{children:t,className:i,tag:r,alignItems:n="stretch",container:o=!1,flexBasis:s="auto",flexDirection:a="row",flexShrink:l=1,flexWrap:d="nowrap",justifyContent:c="flex-start"}=e,u=eg(e,["children","className","tag","alignItems","container","flexBasis","flexDirection","flexShrink","flexWrap","justifyContent"]);return h.createElement(rR,Object.assign({alignItems:n,container:o,flexBasis:s,flexDirection:a,flexShrink:l,flexWrap:d,justifyContent:c,as:r,"data-testid":"flex",className:i||""},u),t)};function rN(){let[e]=(0,h.useState)(()=>em());return e}let rL=f.ZP.label.withConfig(eI)`
  color: ${e=>e.theme.inputs.fontColor};
  font-size: ${e=>e.theme.fontSizes.label.fontSize};
  line-height: ${e=>e.theme.fontSizes.label.lineHeight};

  ${eA}
  ${eE}
`,rF=(0,h.forwardRef)((e,t)=>{let{className:i,tag:r}=e,n=eg(e,["className","tag"]);return h.createElement(rL,Object.assign({as:r,"data-testid":"label",className:i||""},n),e.children)}),rV=(0,f.iv)`
  &.ch-form-field-input,
  &.ch-form-field-select,
  &.ch-form-field-textarea {
    display: flex;
    flex-direction: column;

    label {
      display: block;
      margin-bottom: 0.5rem;
    }

    input,
    select {
      width: 100%;
    }
  }

  &.ch-form-field-checkbox {
    display: grid;
    grid-template-columns: 1.5rem 1fr;
    grid-template-rows: auto;
    gap: 0px 0.5rem;

    .ch-checkbox {
      grid-column: 1;
      grid-row: 1;
    }

    .ch-checkbox-label {
      line-height: 1.3;
      grid-column: 2;
    }

    .ch-help-text {
      grid-row: 2;
      grid-column: 1/3;
    }
  }

  &.ch-form-field-radiogroup {
    flex-direction: column;

    .ch-radio-wrapper {
      display: block;
      margin-bottom: 0.5rem;
      padding-left: 0.125rem;
      display: grid;
      grid-template-columns: 1.5rem 1fr;
      grid-template-rows: auto;

      align-items: center;
    }

    .ch-radio-label {
      margin-left: 1rem;
      position: relative;
      bottom: -0.5px;
    }
  }
`,rB=(0,f.iv)`
  @media (max-width: 599px) {
    ${rV};
  }

  @media (min-width: 600px) {
    &.ch-form-field-input,
    &.ch-form-field-select,
    &.ch-form-field-textarea,
    &.ch-form-field-checkbox {
      display: grid;
      grid-template-columns: 30% 1fr;
      grid-template-rows: auto;
      gap: 0px 0.5rem;
      align-items: center;

      input {
        width: 100%;
      }

      .ch-help-text {
        grid-column: 2;
      }
    }

    &.ch-form-field-radiogroup {
      flex-wrap: wrap;

      fieldset {
        width: 100%;
      }

      .ch-radio-wrapper {
        display: grid;
        grid-template-columns: 30% 1fr;
        grid-template-rows: auto;
        gap: 0px 0.5rem;
        align-items: center;
        margin-bottom: 0.5rem;
      }

      .ch-radio {
        grid-column: 2;
        grid-row: 1;
        margin-top: -4px;
      }

      .ch-radio-label {
        grid-column: 1;
        padding-right: 1rem;
        margin-left: 0;
      }

      .ch-help-text {
        width: 100%;
      }
    }
  }
`,rU={stack:rV,horizontal:rB,"input-only":(0,f.iv)`
  &.ch-form-field-input,
  &.ch-form-field-select,
  &.ch-form-field-textarea {
    display: flex;
    flex-direction: column;

    input {
      width: 100%;
    }
  }

  &.ch-form-field-checkbox {
    display: flex;
    flex-wrap: wrap;
    align-items: center;

    .ch-checkbox {
      order: 1;
    }

    .ch-checkbox-label {
      order: 2;
      padding-left: 1rem;
    }

    .ch-help-text {
      width: 100%;
      order: 3;
    }
  }

  &.ch-form-field-radiogroup {
    flex-direction: column;

    .ch-radio-wrapper {
      display: block;
      margin-bottom: 0.5rem;
    }

    .ch-radio-label {
      margin-left: 1rem;
    }
  }
`},rj=f.ZP.div.withConfig(eI)`
  display: flex;
  margin-bottom: 1rem;
  position: relative;

  fieldset {
    margin: 0;
    border: none;
    padding: 0;
  }

  .ch-help-text {
    font-size: ${e=>e.theme.fontSizes.small.fontSize};
    margin-top: 0.5rem;
    color: ${e=>e.error?e.theme.inputs.error.fontColor:e.theme.inputs.fontColor};
  }

  legend {
    font-size: ${e=>e.theme.fontSizes.text.fontSize};
    color: ${e=>e.theme.inputs.fontColor};
    margin-bottom: 0.5rem;
  }

  ${e=>!!e.layout&&rU[e.layout]}

  ${eA}
  ${eE}
`,r$=(0,h.forwardRef)((e,t)=>{var i;let{field:r,label:n,layout:o="stack",errorText:s,fieldProps:a,infoText:l,error:d,onChange:c,value:u,checked:f,options:p,className:m}=e,g=eg(e,["field","label","layout","errorText","fieldProps","infoText","error","onChange","value","checked","options","className"]),v=(null===(i=r.displayName)||void 0===i?void 0:i.toLowerCase())||"",b=rN(),y=rN(),S=d&&s||l,w=()=>"input-only"===o&&"checkbox"!==v?null:"radiogroup"!==v&&h.createElement(rF,{htmlFor:b,className:`ch-${v}-label`},n);return h.createElement(rj,Object.assign({layout:o,error:d,className:`ch-form-field-${v} ${m||""}`,"data-testid":"form-field"},g),w(),"radiogroup"===v?h.createElement("fieldset",{"aria-describedby":S&&y,"aria-invalid":d},n&&h.createElement("legend",null,n),h.createElement(r,Object.assign({options:p,ref:t,id:b,onChange:c,value:u},a))):h.createElement(r,Object.assign({options:p,"aria-label":"input-only"===o&&n||null,"aria-describedby":S&&y,"aria-invalid":d,ref:t,id:b,onChange:c,value:u,checked:f},a)),S&&h.createElement("span",{className:"ch-help-text",id:y},S))}),rz=f.ZP.h1.withConfig(eI)`
  display: block;
  margin: 0;

  font-size: ${e=>e.theme.fontSizes[`h${e.level}`].mobile.fontSize};
  font-weight: ${e=>e.theme.fontSizes[`h${e.level}`].mobile.fontWeight};
  line-height: ${e=>e.theme.fontSizes[`h${e.level}`].mobile.lineHeight};

  ${({theme:e})=>e.mediaQueries.min.md} {
    font-size: ${e=>e.theme.fontSizes[`h${e.level}`].fontSize};
    font-weight: ${e=>e.theme.fontSizes[`h${e.level}`].fontWeight};
    line-height: ${e=>e.theme.fontSizes[`h${e.level}`].lineHeight};
  }

  ${eA}
  ${eE}
`;(0,h.forwardRef)((e,t)=>{let{tag:i,children:r,className:n,level:o}=e,s=eg(e,["tag","children","className","level"]);return h.createElement(rz,Object.assign({as:i||`h${o}`,className:n||"",level:o,ref:t,"data-testid":"heading"},s),r)});let rH=e=>{let{sizing:t,leadingIcon:i}=e;return"sm"===t?`0.125rem 1.75rem 0.125rem ${i?"1.3125rem":"0.5rem"}`:`0.34375rem 1.75rem 0.34375rem ${i?"1.3125rem":"0.5rem"}`},rW=f.ZP.span.withConfig(eI)`
  position: relative;

  > .ch-icon {
    position: absolute;
    width: 1rem;
    left: 0.1875rem;
    position: absolute;
    top: 54%;
    transform: translateY(-50%);
  }

  > input {
    padding: ${e=>rH(e)};
  }
`,rG=f.ZP.input.withConfig(eI)`
  align-items: center;
  display: flex;
  letter-spacing: -0.005625rem;
  transition: box-shadow 0.05s ease-in;
  background-color: ${e=>e.theme.inputs.bgd};
  border: ${e=>e.theme.inputs.border};
  border-radius: ${e=>e.theme.inputs.borderRadius};
  box-shadow: ${e=>e.theme.inputs.shadow};
  color: ${e=>e.theme.inputs.fontColor};
  font-size: ${e=>e.theme.fontSizes.text.fontSize};
  line-height: ${e=>e.theme.fontSizes.text.lineHeight};

  &::placeholder {
    color: ${e=>e.theme.inputs.placeholder};
  }

  &:focus,
  &[aria-invalid='true']:focus {
    border: ${e=>e.theme.inputs.focus.border};
    box-shadow: ${e=>e.theme.inputs.focus.shadow};
    outline: none;
  }

  &[aria-invalid='true'] {
    border: ${e=>e.theme.inputs.error.border};
    box-shadow: ${e=>e.theme.inputs.error.shadow};
  }

  // Hides native clear button
  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    display: none;
  }

  &::-ms-clear,
  &::-ms-reveal {
    display: none;
    width: 0;
    height: 0;
  }

  ${eA}
  ${eE}
`,rK=f.ZP.button.withConfig(eI)`
  position: absolute;
  top: 50%;
  right: 0.125rem;
  transform: translateY(-44%);
  border: none;
  background: none;
  cursor: pointer;
  display: ${e=>e.active?"block":"none"};

  path {
    fill: ${e=>e.theme.inputs.clearBg};
  }

  &:active,
  &:focus {
    outline: none;
  }
`,rq=(0,h.forwardRef)((e,t)=>{let{leadingIcon:i,children:r,sizing:n}=e,o=eg(e,["leadingIcon","children","sizing"]);return h.createElement(rW,Object.assign({ref:t,sizing:n,leadingIcon:i},o,{"data-testid":"input-wrapper"}),i&&h.createElement("span",{className:"ch-icon"},i),r)}),rJ=(0,h.forwardRef)((e,t)=>{let{type:i,value:r,sizing:n,onClear:o,onChange:s,className:a,leadingIcon:l,showClear:d=!0}=e,c=eg(e,["type","value","sizing","onClear","onChange","className","leadingIcon","showClear"]),[u,f]=(0,h.useState)(!1),p=(0,h.useRef)(!1),m=(0,h.useRef)(null),g=t||m,v=(0,h.useRef)(null),b=e["aria-label"]?`clear ${e["aria-label"]}`:"clear",y=()=>{var e;if(o){o();return}let t=g.current,i=null===(e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))||void 0===e?void 0:e.set;i&&t&&(i.call(t,""),t.dispatchEvent(new Event("input",{bubbles:!0}))),t.focus()};return(0,h.useEffect)(()=>{let e=!1,t=t=>{if(p.current){if(t.target!==v.current&&t.target!==g.current){p.current=!1,f(!1);return}e&&(e=!1)}},i=()=>{p.current&&(e=!0,setTimeout(()=>{e&&(p.current=!1,f(!1)),e=!1},10))};return document.addEventListener("focusin",t),document.addEventListener("focusout",i),()=>{document.removeEventListener("focusin",t),document.removeEventListener("focusout",i)}},[]),h.createElement(rq,{leadingIcon:l,sizing:n,className:`ch-input-wrapper ${a||""}`},h.createElement(rG,Object.assign({},c,{value:r,type:i||"text",ref:g,className:"ch-input",onChange:s,"data-testid":"input",onFocus:()=>{p.current=!0,f(!0)}})),d&&h.createElement(rK,{type:"button",active:!!(o||u&&r.length),tabIndex:-1,"aria-label":b,onClick:y,ref:v},h.createElement(eX,{width:"1.25rem"})))});rJ.displayName="Input";let rQ=(0,h.forwardRef)((e,t)=>{let i=Object.assign(Object.assign({},e),{sizing:"sm",type:"search",leadingIcon:h.createElement(e9,{"data-testid":"search-icon"})});return h.createElement(rJ,Object.assign({},i,{ref:t}))});(0,h.createContext)({onClose(){},labelID:"",dismissible:!0});let rZ=(0,f.F4)`
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
`,rX=(0,f.F4)`
  0% {
    opacity: 0;
    transform: translateY(4rem) scale(0.4);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
`;f.ZP.div.withConfig(eI)`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: ${e=>e.theme.modal.wrapperBgd};
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: ${e=>e.theme.zIndex.modal};
  overflow-x: hidden;
  animation: ${rZ} 0.25s ease 0s forwards;
  will-change: opacity;

  > section {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    border-radius: ${e=>e.theme.radii.default};
    color: ${e=>e.theme.modal.text};
    background-color: ${e=>e.theme.modal.bgd};
    width: ${e=>e.theme.modalSizes[e.size||"md"].width};
    box-shadow: ${e=>e.theme.modal.shadow};
    max-width: ${e=>"fullscreen"===e.size?e.theme.modalSizes[e.size].width:"90vw"};
    height: ${e=>"fullscreen"===e.size?e.theme.modalSizes[e.size].height:"auto"};
    max-height: ${e=>e.theme.modalSizes[e.size||"md"].height};
    will-change: transform, opacity;
    animation: ${rX} 0.15s ease 0s forwards;

    @media only screen and (max-height: 25rem) {
      position: absolute;
      top: 2rem;
      height: auto;
      max-height: none;
    }
  }

  ${eA}
  ${eE}
`,f.ZP.header.withConfig(eI)`
  padding: 1rem 1.5rem;

  .ch-close-button {
    position: absolute;
    right: 1.55rem;
    top: 1rem;
  }

  .ch-title {
    padding-right: 2rem;
    margin: 0;
    font-size: ${e=>e.theme.modal.titleSize};
    font-weight: ${e=>e.theme.modal.titleWeight};
  }

  ${eA}
  ${eE}
`,f.ZP.div.withConfig(eI)`
  font-size: ${e=>e.theme.fontSizes.text.fontSize};
  line-height: ${e=>e.theme.fontSizes.text.lineHeight};
  padding: 0 1.5rem;
  flex-grow: 1;
  overflow-y: auto;

  ${eA}
  ${eE}
`,f.ZP.footer.withConfig(eI)`
  padding: 1.5rem;
  border-top: 1px solid ${e=>e.theme.modal.border};
  display: flex;
  flex-direction: row-reverse;
  justify-content: space-between;

  div:first-child {
    display: flex;
    flex-direction: row-reverse;
  }

  button + button {
    margin: 0 0.5rem 0 0.5rem;
  }

  @media (max-width: 35rem) {
    flex-direction: column;

    button {
      width: 100%;
    }

    div:first-child {
      display: flex;
      flex-direction: column;
    }

    button + button,
    div + div {
      margin: 0.5rem 0 0;
    }
  }

  ${eA}
  ${eE}
`;let rY=f.ZP.div.withConfig(eI)`
  display: flex;
  height: 3rem;
  align-items: center;
  border-bottom: ${({theme:e})=>`0.03125rem solid ${e.navbar.headerBorder}`};
  padding: 1rem;

  .ch-title {
    flex: 1;
  }

  .ch-btn-close {
    margin-left: auto;
    margin-right: 1rem;
  }

  ${({theme:e})=>e.mediaQueries.min.md} {
    display: none;
  }
`,r0=f.ZP.div.withConfig(eI)`
  display: flex;
  align-items: center;
  justify-content: center;
  width: 4.25rem;
  min-height: 3rem;
  flex-direction: column;
  padding: 0 0.25rem;

  .ch-navigation-bar-item-label {
    text-align: center;
    display: ${({showLabel:e})=>e?"block":"none"};
    font-size: ${({theme:e})=>e.fontSizes.footnote.fontSize};
    width: 100%;
    padding: 0 0.25rem;
    margin-bottom: 1.5rem;
  }
`;(0,f.ZP)(rD)`
  display: flex;
  flex-direction: column;
  height: 100%;
  max-width: 100%;
  color: ${e=>e.theme.navbar.text};
  background-color: ${({theme:e})=>e.navbar.bgd};
  width: 4.25rem;
  padding-top: 1rem;

  ${({theme:e,responsive:t})=>e.mediaQueries.max.md} {
    width: ${e=>e.responsive?"20rem":"4.25rem;"};
    padding-top: ${e=>e.responsive?"0":"1rem"};

    ${rY} {
      display: ${e=>e.responsive?"flex":"none"};
    }

    ${r0} {
      ${e=>e.responsive&&` 
        width: auto;
        flex-direction: row;

        .ch-navigation-bar-item-label {
          font-size: 1rem;
          text-align: left;
          margin-left: 1.5rem;
          margin-bottom: 0;
          display: block;
        }`};
    }
  }

  ${eE}
  ${eA}
`;let r1=(0,f.ZP)(eB)``,r2=(0,f.ZP)(eV)``;f.ZP.div.withConfig(eI)`
  align-items: center;
  position: relative;
  display: inline-flex;
  align-items: center;
  color: ${({theme:e,severity:t})=>e.notification[t].text};
  background-color: ${({theme:e,severity:t})=>e.colors[t].primary};
  padding: 0.75rem;
  box-shadow: ${({theme:e})=>e.notification.shadow};
  border-radius: 0.25rem;
  margin: 0.75rem;
  max-width: 45rem;
  pointer-events: auto;

  .ch-severity-icon {
    width: 1.5rem;
    flex-shrink: 0;
  }

  .ch-message {
    display: flex;
    flex-flow: column wrap;
    font-size: ${e=>e.theme.fontSizes.text.fontSize};
    line-height: ${e=>e.theme.fontSizes.text.lineHeight};
    letter-spacing: -0.005625rem;
    margin: 0.5rem 0.75rem;

    &:empty {
      margin: 0;
    }
  }

  ${r2} {
    margin-right: 1.6rem;
    border-color: ${({theme:e,severity:t})=>e.notification[t].text};
  }

  ${r1},
  ${r2} {
    background-color: ${({theme:e,severity:t})=>e.colors[t].primary};
    color: ${({theme:e,severity:t})=>e.notification[t].closeButton.text};
  }

  ${r1}:hover, ${r1}:focus, ${r2}:hover, ${r2}:focus {
    background-color: ${({theme:e,severity:t})=>e.notification[t].closeButton.hover.bgd};
    color: ${({theme:e,severity:t})=>e.notification[t].closeButton.hover.text};
  }

  ${r1}:active, ${r2}:active {
    background-color: ${({theme:e,severity:t})=>e.notification[t].closeButton.active.bgd};
    color: ${({theme:e,severity:t})=>e.notification[t].closeButton.active.text};
  }

  ${eA}
  ${eE}
`,function(e){e.ERROR="error",e.SUCCESS="success",e.INFO="info",e.WARNING="warning"}(n||(n={})),h.createElement(eZ,null),h.createElement(eY,null),h.createElement(eq,null),h.createElement(e2,null),function(e){e.ERROR="error",e.SUCCESS="success",e.INFO="info",e.WARNING="warning"}(o||(o={})),function(e){e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e[e.REMOVE_ALL=2]="REMOVE_ALL"}(s||(s={}));let r3={notifications:[]},r5=(e,t)=>{let{type:i,payload:r}=t;switch(i){case s.ADD:{let t=Object.assign({id:em()},r),i=(null==t?void 0:t.replaceAll)?[t]:[...e.notifications,t];return Object.assign(Object.assign({},e),{notifications:i})}case s.REMOVE:{let t=e.notifications.filter(e=>(null==e?void 0:e.id)!==r);return Object.assign(Object.assign({},e),{notifications:t})}case s.REMOVE_ALL:return Object.assign(Object.assign({},e),{notifications:[]});default:throw Error("Incorrect type in NotificationProvider")}},r4=h.createContext(r3),r6=h.createContext(()=>{}),r8=({children:e})=>{let[t,i]=(0,h.useReducer)(r5,r3);return h.createElement(r4.Provider,{value:t},h.createElement(r6.Provider,{value:i},e))};f.ZP.div.withConfig(eI)`
  position: fixed;
  top: 2rem;
  left: 0;
  right: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: ${e=>e.theme.zIndex.notificationGroup};
  pointer-events: none;
`;let r7=e=>h.createElement(rc,Object.assign({"data-testid":"popover-separator"},e)),r9=f.ZP.input.withConfig(eI)`
  ${eS};

  &[aria-invalid='true'] + .ch-radio {
    border: ${e=>e.theme.inputs.error.border};
    box-shadow: ${e=>e.theme.inputs.error.shadow};
  }
`,ne=f.ZP.span.withConfig(eI)`
  > label {
    margin-left: 0.5rem;
  }
`,nt=f.ZP.div.withConfig(eI)`
  background-color: ${e=>e.theme.inputs.bgd};
  border: ${e=>e.theme.inputs.border};
  border-radius: ${e=>e.theme.radii.circle};
  box-shadow: ${e=>e.theme.inputs.shadow};
  margin-bottom: -0.1875rem;
  transition: box-shadow 0.05s ease-in;

  ${r9}:checked ~ & {
    background-color: ${e=>e.theme.inputs.checked.bgd};
    border: ${e=>e.theme.inputs.checked.border};
    box-shadow: ${e=>e.theme.inputs.checked.shadow};
  }

  ${r9}:focus ~ & {
    border: ${e=>e.theme.inputs.focus.border};
    box-shadow: ${e=>e.theme.inputs.focus.shadow};
  }
`,ni=(0,f.ZP)(nt)`
  display: inline-block;
  height: 1rem;
  position: relative;
  width: 1rem;

  &:after {
    background-color: ${e=>e.checked?e.theme.inputs.checked.fontColor:e.theme.inputs.bgd};
    border-radius: ${e=>e.theme.radii.circle};
    content: '';
    display: block;
    height: 0.375rem;
    padding: 0.03125rem;
    width: 0.375rem;
    ${eC};
  }
`,nr=(0,f.ZP)(nt)`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.5rem;
  border-color: ${e=>e.theme.colors.greys.white};
  box-shadow: none;
  margin: 0.1rem;

  ${r9}:checked ~ & {
    svg {
      stroke: ${e=>e.theme.colors.greys.white};
    }
  }
`;(e=>{let{value:t,checked:i,label:r,icon:n,onChange:o,testId:s}=e,a=eg(e,["value","checked","label","icon","onChange","testId"]),l=(0,h.useRef)(null),d=rN(),c=()=>{var e,t;null===(e=l.current)||void 0===e||e.click(),null===(t=l.current)||void 0===t||t.focus()};return h.createElement(ne,{className:"ch-radio-wrapper","data-testid":s},h.createElement(r9,Object.assign({checked:i,id:d,onChange:o,type:"radio",value:t,ref:l,"data-testid":"hidden-radio","aria-label":r},a)),n?h.createElement(h.Fragment,null,h.createElement(nr,{checked:i,className:"ch-radio",onClick:c,"data-testid":"styled-radio-icon"},h.createElement("span",{className:"ch-icon"},n))):h.createElement(h.Fragment,null,h.createElement(ni,{checked:i,className:"ch-radio",onClick:c,"data-testid":"styled-radio"}),h.createElement(rF,{htmlFor:d,className:"ch-radio-label"},r)))}).displayName="Radio";let nn=f.ZP.div.withConfig(eI)`
  position: relative;

  .ch-select-icon {
    pointer-events: none;
  }

  ${eA}
  ${eE}
`,no=f.ZP.select.withConfig(eI)`
  background-color: ${e=>e.theme.inputs.bgd};
  border: ${e=>e.theme.inputs.border};
  border-radius: ${e=>e.theme.inputs.borderRadius};
  box-shadow: ${e=>e.theme.inputs.shadow};
  color: ${e=>e.theme.inputs.fontColor};
  font-size: ${e=>e.theme.fontSizes.text.fontSize};
  line-height: ${e=>e.theme.fontSizes.text.lineHeight};
  height: 2rem;
  letter-spacing: -0.005625rem;
  width: 100%;
  padding: 0.375rem 1.5rem 0.375rem 0.5rem;
  transition: box-shadow 0.05s ease-in;
  display: inline-block;
  appearance: none;

  &:focus,
  &[aria-invalid='true']:focus {
    border: ${e=>e.theme.inputs.focus.border};
    box-shadow: ${e=>e.theme.inputs.focus.shadow};
    outline: none;
  }

  &[aria-invalid='true'] {
    border: ${e=>e.theme.inputs.error.border};
    box-shadow: ${e=>e.theme.inputs.error.shadow};
  }

  ${eA}
  ${eE}
`,ns=e=>e.map(({value:e,label:t})=>h.createElement("option",{key:e,value:e},t)),na={position:"absolute",top:"50%",transform:"translateY(-50%)",right:"0.2rem",width:"1.5rem",height:"1.5rem"},nl=(0,h.forwardRef)((e,t)=>h.createElement(nn,null,h.createElement(no,Object.assign({className:"ch-select","data-testid":"select",ref:t},e),ns(e.options)),h.createElement(ti,{style:na,className:"ch-select-icon","data-testid":"select-icon"})));nl.displayName="Select";let nd=f.ZP.textarea.withConfig(eI)`
  background-color: ${e=>e.theme.inputs.bgd};
  border: ${e=>e.theme.inputs.border};
  border-radius: ${e=>e.theme.inputs.borderRadius};
  box-shadow: ${e=>e.theme.inputs.shadow};
  color: ${e=>e.theme.inputs.fontColor};
  font-size: ${e=>e.theme.fontSizes.text.fontSize};
  padding: 0.5rem;
  position: relative;
  min-height: 4rem;
  transition: box-shadow 0.05s ease-in;
  width: 100%;

  &:focus,
  &[aria-invalid='true']:focus {
    border: ${e=>e.theme.inputs.focus.border};
    box-shadow: ${e=>e.theme.inputs.focus.shadow};
    outline: none;
  }

  &[aria-invalid='true'] {
    border: ${e=>e.theme.inputs.error.border};
    box-shadow: ${e=>e.theme.inputs.error.shadow};
  }
`;h.forwardRef((e,t)=>{var{label:i}=e,r=eg(e,["label"]);return h.createElement(nd,Object.assign({"aria-label":i,className:"ch-textarea","data-testid":"textarea",ref:t},r))}).displayName="Textarea";var nc=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var i=-1;return e.some(function(e,r){return e[0]===t&&(i=r,!0)}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var i=e(this.__entries__,t),r=this.__entries__[i];return r&&r[1]},t.prototype.set=function(t,i){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=i:this.__entries__.push([t,i])},t.prototype.delete=function(t){var i=this.__entries__,r=e(i,t);~r&&i.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var i=0,r=this.__entries__;i<r.length;i++){var n=r[i];e.call(t,n[1],n[0])}},t}()}(),nu="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,nh=function(){return void 0!==i.g&&i.g.Math===Math?i.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")()}(),nf=function(){return"function"==typeof requestAnimationFrame?requestAnimationFrame.bind(nh):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),np=2;function nm(e,t){var i=!1,r=!1,n=0;function o(){i&&(i=!1,e()),r&&a()}function s(){nf(o)}function a(){var e=Date.now();if(i){if(e-n<np)return;r=!0}else i=!0,r=!1,setTimeout(s,t);n=e}return a}var ng=20,nv=["top","right","bottom","left","width","height","size","weight"],nb="undefined"!=typeof MutationObserver,ny=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=nm(this.refresh.bind(this),ng)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},e.prototype.connect_=function(){nu&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),nb?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){nu&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=void 0===t?"":t;nv.some(function(e){return!!~i.indexOf(e)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),nS=function(e,t){for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},nw=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||nh},nC=nx(0,0,0,0);function nk(e){return parseFloat(e)||0}function nT(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.reduce(function(t,i){return t+nk(e["border-"+i+"-width"])},0)}function nI(e){for(var t=["top","right","bottom","left"],i={},r=0,n=t;r<n.length;r++){var o=n[r],s=e["padding-"+o];i[o]=nk(s)}return i}function nE(e){var t=e.getBBox();return nx(0,0,t.width,t.height)}function nA(e){var t=e.clientWidth,i=e.clientHeight;if(!t&&!i)return nC;var r=nw(e).getComputedStyle(e),n=nI(r),o=n.left+n.right,s=n.top+n.bottom,a=nk(r.width),l=nk(r.height);if("border-box"===r.boxSizing&&(Math.round(a+o)!==t&&(a-=nT(r,"left","right")+o),Math.round(l+s)!==i&&(l-=nT(r,"top","bottom")+s)),!nO(e)){var d=Math.round(a+o)-t,c=Math.round(l+s)-i;1!==Math.abs(d)&&(a-=d),1!==Math.abs(c)&&(l-=c)}return nx(n.left,n.top,a,l)}var nM=function(){return"undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof nw(e).SVGGraphicsElement}:function(e){return e instanceof nw(e).SVGElement&&"function"==typeof e.getBBox}}();function nO(e){return e===nw(e).document.documentElement}function nP(e){return nu?nM(e)?nE(e):nA(e):nC}function n_(e){var t=e.x,i=e.y,r=e.width,n=e.height,o=Object.create(("undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object).prototype);return nS(o,{x:t,y:i,width:r,height:n,top:i,right:t+r,bottom:n+i,left:t}),o}function nx(e,t,i,r){return{x:e,y:t,width:i,height:r}}var nR=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=nx(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=nP(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),nD=function(){return function(e,t){nS(this,{target:e,contentRect:n_(t)})}}(),nN=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new nc,"function"!=typeof e)throw TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof nw(e).Element))throw TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new nR(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof nw(e).Element))throw TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new nD(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),nL="undefined"!=typeof WeakMap?new WeakMap:new nc,nF=function(){function e(t){if(!(this instanceof e))throw TypeError("Cannot call a class as a function.");if(!arguments.length)throw TypeError("1 argument required, but only 0 present.");var i=new nN(t,ny.getInstance(),this);nL.set(this,i)}return e}();["observe","unobserve","disconnect"].forEach(function(e){nF.prototype[e]=function(){var t;return(t=nL.get(this))[e].apply(t,arguments)}});var nV=function(){return void 0!==nh.ResizeObserver?nh.ResizeObserver:nF}(),nB=tb(ty(function(e,t){!function(e,i){i(t)}(0,function(e){function t(e,t,i,r){var n,o=!1,s=0;function a(){n&&clearTimeout(n)}function l(){a(),o=!0}function d(){for(var l=arguments.length,d=Array(l),c=0;c<l;c++)d[c]=arguments[c];var u=this,h=Date.now()-s;function f(){s=Date.now(),i.apply(u,d)}function p(){n=void 0}o||(r&&!n&&f(),a(),void 0===r&&h>e?f():!0!==t&&(n=setTimeout(r?p:f,void 0===r?e-h:e)))}return"boolean"!=typeof t&&(r=i,i=t,t=void 0),d.cancel=l,d}function i(e,i,r){return void 0===r?t(e,i,!1):t(e,r,!1!==i)}e.debounce=i,e.throttle=t,Object.defineProperty(e,"__esModule",{value:!0})})}));function nU(e,t){let i=t/e;return i>1.6?"r16by9":i>1.4?"r3by2":i>1.25?"r4by3":i>.9?"r1by1":i>.7?"r2by3":i>.4?"r1by2":"slim"}let nj=e=>{let[t,i]=(0,h.useState)(null);return(0,h.useLayoutEffect)(()=>{if(!e.current)return;let{height:t,width:r}=e.current.getBoundingClientRect();i(nU(t,r))},[]),(0,h.useEffect)(()=>{if(!e.current)return;let t=new nV(nB.debounce(50,e=>{let{height:t,width:r}=e[0].contentRect;i(nU(t,r))}));return t.observe(e.current),()=>t.disconnect()},[]),t},n$=["slim","r1by2","r2by3","r1by1","r4by3","r3by2","r16by9"],nz={1:"grid-template: 1fr / 1fr;","1.slim":"grid-template: repeat(2, 1fr) / 1fr;","1.r2by3":"grid-template: 1fr / 1fr;","1.featured":'grid-template: "ft" 1fr / 1fr;',2:"grid-template: 1fr / repeat(2,1fr);","2.slim":"grid-template: repeat(3,1fr) / 1fr;","2.r1by2":"grid-template: repeat(2,1fr) / 1fr;","2.r2by3":"grid-template: repeat(2,1fr) / 1fr;","2.r4by3":"grid-template: repeat(2,1fr) / repeat(2,1fr);","2.r16by9":"grid-template: 1fr / repeat(2,1fr);","2.featured":`grid-template: repeat(3,1fr) / repeat(2,1fr);
  grid-template-areas: 'ft ft' 'ft ft';`,"2.r16by9.featured":`grid-template: repeat(2,1fr) / repeat(3,1fr);
    grid-template-areas: 'ft ft v' 'ft ft v' 'ft ft v';`,3:"grid-template: repeat(3,1fr) / 1fr;","3.r2by3":"grid-template: repeat(3,1fr) / repeat(1,1fr);","3.r1by1":"grid-template: repeat(2,1fr) / repeat(2,1fr);","3.featured":`grid-template: repeat(3,1fr) / repeat(2,1fr);
    grid-template-areas: 'ft ft' 'ft ft';
  `,"3.r16by9.featured":`grid-template: repeat(2,1fr) / repeat(3,1fr);
    grid-template-areas: 'ft ft v' 'ft ft v';`,4:"grid-template: repeat(2,1fr) / repeat(2,1fr);","4.slim":"grid-template: repeat(4,1fr) / 1fr;","4.r2by3":"grid-template: repeat(2,1fr) / repeat(2,1fr);","4.featured":`grid-template: repeat(3,1fr) / repeat(3,1fr);
    grid-template-areas: 'ft ft ft' 'ft ft ft';`,"4.r16by9.featured":"grid-template-areas: 'ft ft v' 'ft ft v' 'ft ft v';",5:"grid-template: repeat(2,1fr) / repeat(3,1fr);","5.slim":"grid-template: repeat(5,1fr) / 1fr;","5.r1by2":"grid-template: repeat(3,1fr) / repeat(2,1fr);","5.r2by3":"grid-template: repeat(3,1fr) / repeat(2,1fr);","5.r3by2":"grid-template: repeat(2,1fr) / repeat(3,1fr);","5.r16by9":"grid-template: repeat(2,1fr) / repeat(3,1fr);","5.featured":`grid-template: repeat(4,1fr) / repeat(2,1fr);
    grid-template-areas: 'ft ft' 'ft ft';`,"5.r1by1.featured":`grid-template: repeat(3,1fr) / repeat(3,1fr);
    grid-template-areas: 'ft ft v' 'ft ft v';`,6:"grid-template: repeat(3,1fr) / repeat(3,1fr);","6.slim":"grid-template: repeat(4,1fr) / repeat(2,1fr);","6.r1by2":"grid-template: repeat(3,1fr) / repeat(2,1fr);","6.r1by1":"grid-template: repeat(3,1fr) / repeat(2,1fr);","6.r2by3":"grid-template: repeat(3,1fr) / repeat(2,1fr);","6.r3by2":"grid-template: repeat(2,1fr) / repeat(3,1fr);","6.r16by9":"grid-template: repeat(2,1fr) / repeat(3,1fr);","6.featured":`grid-template: repeat(4,1fr) / repeat(3,1fr);
    grid-template-areas: 'ft ft ft' 'ft ft ft';`,"6.r1by1.featured":`grid-template: repeat(3,1fr) / repeat(3,1fr);
    grid-template-areas: 'ft ft v' 'ft ft v';`,7:"grid-template: repeat(3,1fr) / repeat(3,1fr);","7.slim":"grid-template: repeat(4,1fr) / repeat(2,1fr);","7.r4by3":"grid-template: repeat(3,1fr) / repeat(3,1fr);","7.r16by9":"grid-template: repeat(2,1fr) / repeat(4,1fr);","7.featured":`grid-template: repeat(4,1fr) / repeat(3,1fr);
    grid-template-areas: 'ft ft ft' 'ft ft ft';`,"7.r1by1.featured":`grid-template: repeat(4,1fr) / repeat(4,1fr);
    grid-template-areas: 'ft ft ft v' 'ft ft ft v' 'ft ft ft v';`,8:"grid-template: repeat(3,1fr) / repeat(3,1fr);","8.slim":"grid-template: repeat(4,1fr) / repeat(2,1fr);","8.r4by3":"grid-template: repeat(3,1fr) / repeat(3,1fr);","8.r16by9":"grid-template: repeat(2,1fr) / repeat(4,1fr);","8.featured":`grid-template: repeat(5,1fr) / repeat(4,1fr);
    grid-template-areas: 'ft ft ft ft ft' 'ft ft ft ft ft' 'ft ft ft ft ft';`,"8.r1by1.featured":`grid-template: repeat(4,1fr) / repeat(4,1fr);
    grid-template-areas: 'ft ft ft v' 'ft ft ft v' 'ft ft ft x';`,"8.r16by9.featured":"grid-template-areas: 'ft ft ft v' 'ft ft ft v' 'ft ft ft x';",9:"grid-template: repeat(3,1fr) / repeat(3,1fr);","9.slim":"grid-template: repeat(5,1fr) / repeat(2,1fr);","9.r1by1":"grid-template: repeat(3,1fr) / repeat(3,1fr);","9.r16by9":"grid-template: repeat(3,1fr) / repeat(4,1fr);","9.featured":`grid-template: repeat(5,1fr) / repeat(4,1fr);
    grid-template-areas: 'ft ft ft ft ft' 'ft ft ft ft ft' 'ft ft ft ft ft';`,"9.r1by1.featured":`grid-template: repeat(5,1fr) / repeat(5,1fr);
    grid-template-areas: 'ft ft ft ft v' 'ft ft ft ft v' 'ft ft ft ft v' 'ft ft ft ft v';`,10:"grid-template: repeat(4,1fr) / repeat(3,1fr);","10.slim":"grid-template: repeat(5,1fr) / repeat(2,1fr);","10.r1by1":"grid-template: repeat(4,1fr) / repeat(3,1fr);","10.r3by2":"grid-template: repeat(3,1fr) / repeat(4,1fr);","10.featured":`grid-template: repeat(5,1fr) / repeat(4,1fr);
    grid-template-areas: 'ft ft ft ft ft' 'ft ft ft ft ft' 'ft ft ft ft ft';`,"10.r1by1.featured":`grid-template: repeat(5,1fr) / repeat(5,1fr);
    grid-template-areas: 'ft ft ft ft v' 'ft ft ft ft v' 'ft ft ft ft v' 'ft ft ft ft v';`,11:"grid-template: repeat(4,1fr) / repeat(3,1fr);","11.slim":"grid-template: repeat(6,1fr) / repeat(2,1fr);","11.r1by1":"grid-template: repeat(4,1fr) / repeat(3,1fr);","11.r3by2":"grid-template: repeat(3,1fr) / repeat(4,1fr);","11.r16by9":"grid-template: repeat(3,1fr) / repeat(4,1fr);","11.featured":`grid-template: repeat(6,1fr) / repeat(6,1fr);
    grid-template-areas: 'ft ft ft ft ft ft' 'ft ft ft ft ft ft' 'ft ft ft ft ft ft' 'ft ft ft ft ft ft';`,"11.r1by1.featured":`grid-template-areas:
      'ft ft ft ft ft v' 'ft ft ft ft ft v' 'ft ft ft ft ft v'
      'ft ft ft ft ft v' 'ft ft ft ft ft x';`,12:"grid-template: repeat(4,1fr) / repeat(3,1fr);","12.slim":"grid-template: repeat(6,1fr) / repeat(2,1fr);","12.r2by3":"grid-template: repeat(4,1fr) / repeat(3,1fr);","12.r3by2":"grid-template: repeat(3,1fr) / repeat(4,1fr);","12.featured":`grid-template: repeat(6,1fr) / repeat(6,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft' 'ft ft ft ft ft ft' 'ft ft ft ft ft ft'
      'ft ft ft ft ft ft';`,"12.r1by1.featured":`grid-template-areas:
    'ft ft ft ft ft v' 'ft ft ft ft ft v' 'ft ft ft ft ft v'
    'ft ft ft ft ft v' 'ft ft ft ft ft x';`,13:"grid-template: repeat(4,1fr) / repeat(4,1fr);","13.slim":"grid-template: repeat(7,1fr) / repeat(2,1fr);","13.r2by3":"grid-template: repeat(5,1fr) / repeat(3,1fr);","13.r1by1":"grid-template: repeat(4,1fr) / repeat(4,1fr);","13.r3by2":"grid-template: repeat(4,1fr) / repeat(4,1fr);","13.r16by9":"grid-template: repeat(3,1fr) / repeat(5,1fr);","13.featured":`grid-template: repeat(7,1fr) / repeat(6,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft' 'ft ft ft ft ft ft' 'ft ft ft ft ft ft' 'ft ft ft ft ft ft'
      'ft ft ft ft ft ft';`,"13.r1by1.featured":`grid-template-areas:
      'ft ft ft ft ft v' 'ft ft ft ft ft v' 'ft ft ft ft ft v' 'ft ft ft ft ft v'
      'ft ft ft ft ft v' 'ft ft ft ft ft x';`,14:"grid-template: repeat(4,1fr) / repeat(4,1fr);","14.slim":"grid-template: repeat(7,1fr) / repeat(2,1fr);","14.r2by3":"grid-template: repeat(5,1fr) / repeat(3,1fr);","14.r3by2":"grid-template: repeat(4,1fr) / repeat(4,1fr);","14.r16by9":"grid-template: repeat(3,1fr) / repeat(5,1fr);","14.featured":`grid-template: repeat(7,1fr) / repeat(7,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft'
      'ft ft ft ft ft ft ft';`,"14.r1by1.featured":`grid-template-areas:
      'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v'
      'ft ft ft ft ft ft v' 'ft ft ft ft ft ft x';`,15:"grid-template: repeat(5,1fr) / repeat(3,1fr);","15.slim":"grid-template: repeat(8,1fr) / repeat(2,1fr);","15.r1by2":"grid-template: repeat(5,1fr) / repeat(3,1fr);","15.r3by2":"grid-template: repeat(4,1fr) / repeat(4,1fr);","15.r16by9":"grid-template: repeat(3,1fr) / repeat(5,1fr);","15.featured":`grid-template: repeat(8,1fr) / repeat(8,1fr);
    grid-template-areas:
     'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft'
     'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft';`,"15.r1by1.featured":`grid-template-areas:
     'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v'
     'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft x';`,16:"grid-template: repeat(4,1fr) / repeat(4,1fr);","16.slim":"grid-template: repeat(8,1fr) / repeat(2,1fr);","16.r1by2":"grid-template: repeat(6,1fr) / repeat(3,1fr);","16.r1by1":"grid-template: repeat(4,1fr) / repeat(4,1fr);","16.featured":`grid-template: repeat(8,1fr) / repeat(8,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft'
      'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft';`,"16.r1by1.featured":`grid-template-areas:
      'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v'
      'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft x';`,17:"grid-template: repeat(5,1fr) / repeat(4,1fr);","17.slim":"grid-template: repeat(8,1fr) / repeat(3,1fr);","17.r1by2":"grid-template: repeat(6,1fr) / repeat(4,1fr);","17.r1by1":"grid-template: repeat(4,1fr) / repeat(5,1fr);","17.featured":`grid-template: repeat(8,1fr) / repeat(9,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft'
      'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft';`,"17.r1by1.featured":`grid-template-areas:
      'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v'
      'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft x';`,18:"grid-template: repeat(5,1fr) / repeat(4,1fr);","18.slim":"grid-template: repeat(8,1fr) / repeat(3,1fr);","18.r1by2":"grid-template: repeat(6,1fr) / repeat(4,1fr);","18.r1by1":"grid-template: repeat(4,1fr) / repeat(5,1fr);","18.featured":`grid-template: repeat(8,1fr) / repeat(9,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft'
      'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft';`,"18.r1by1.featured":`grid-template: repeat(9,1fr) / repeat(9,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v'
      'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft x';`,19:"grid-template: repeat(5,1fr) / repeat(4,1fr);","19.slim":"grid-template: repeat(8,1fr) / repeat(3,1fr);","19.r1by2":"grid-template: repeat(6,1fr) / repeat(4,1fr);","19.r1by1":"grid-template: repeat(4,1fr) / repeat(5,1fr);","19.featured":`grid-template: repeat(8,1fr) / repeat(9,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft'
      'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft';`,"19.r1by1.featured":`grid-template: repeat(9,1fr) / repeat(10,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 
      'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 
      'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft x';`,20:"grid-template: repeat(5,1fr) / repeat(4,1fr);","20.slim":"grid-template: repeat(8,1fr) / repeat(3,1fr);","20.r1by2":"grid-template: repeat(6,1fr) / repeat(4,1fr);","20.r1by1":"grid-template: repeat(4,1fr) / repeat(5,1fr);","20.featured":`grid-template: repeat(11,1fr) / repeat(7,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 
      'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft';`,"20.r1by1.featured":`grid-template: repeat(10,1fr) / repeat(10,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 
      'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 
      'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft ft x';`,21:"grid-template: repeat(5,1fr) / repeat(5,1fr);","21.slim":"grid-template: repeat(8,1fr) / repeat(3,1fr);","21.r1by2":"grid-template: repeat(6,1fr) / repeat(4,1fr);","21.r1by1":"grid-template: repeat(5,1fr) / repeat(5,1fr);","21.featured":`grid-template: repeat(11,1fr) / repeat(7,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 
      'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft';`,"21.r1by1.featured":`grid-template: repeat(8,1fr) / repeat(7,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v'  
      'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v' 'ft ft ft ft ft ft x';`,22:"grid-template: repeat(5,1fr) / repeat(5,1fr);","22.slim":"grid-template: repeat(8,1fr) / repeat(3,1fr);","22.r1by2":"grid-template: repeat(6,1fr) / repeat(4,1fr);","22.r1by1":"grid-template: repeat(5,1fr) / repeat(5,1fr);","22.featured":`grid-template: repeat(11,1fr) / repeat(7,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 
      'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft';`,"22.r1by1.featured":`grid-template: repeat(9,1fr) / repeat(7,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v' 
      'ft ft ft ft ft ft v' 'ft ft ft ft ft ft v' 'ft ft ft ft ft ft x';`,23:"grid-template: repeat(5,1fr) / repeat(5,1fr);","23.slim":"grid-template: repeat(8,1fr) / repeat(3,1fr);","23.r1by2":"grid-template: repeat(6,1fr) / repeat(4,1fr);","23.r1by1":"grid-template: repeat(5,1fr) / repeat(5,1fr);","23.featured":`grid-template: repeat(11,1fr) / repeat(8,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 
      'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft';`,"23.r1by1.featured":`grid-template: repeat(8,1fr) / repeat(8,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v'  
      'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft x';`,24:"grid-template: repeat(5,1fr) / repeat(5,1fr);","24.slim":"grid-template: repeat(8,1fr) / repeat(3,1fr);","24.r1by2":"grid-template: repeat(6,1fr) / repeat(4,1fr);","24.r1by1":"grid-template: repeat(5,1fr) / repeat(5,1fr);","24.featured":`grid-template: repeat(11,1fr) / repeat(8,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 
      'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft';`,"24.r1by1.featured":`grid-template: repeat(9,1fr) / repeat(8,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 
      'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft x';`,25:"grid-template: repeat(5,1fr) / repeat(5,1fr);","25.slim":"grid-template: repeat(9,1fr) / repeat(3,1fr);","25.r1by2":"grid-template: repeat(7,1fr) / repeat(4,1fr);","25.r1by1":"grid-template: repeat(5,1fr) / repeat(5,1fr);","25.featured":`grid-template: repeat(11,1fr) / repeat(8,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 
      'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft';`,"25.r1by1.featured":`grid-template: repeat(10,1fr) / repeat(8,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 
      'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft x';`,26:"grid-template: repeat(6,1fr) / repeat(5,1fr);","26.slim":"grid-template: repeat(9,1fr) / repeat(3,1fr);","26.r1by2":"grid-template: repeat(7,1fr) / repeat(4,1fr);","26.r1by1":"grid-template: repeat(6,1fr) / repeat(5,1fr);","26.featured":`grid-template: repeat(11,1fr) / repeat(9,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft'
      'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft' 'ft ft ft ft ft ft ft ft ft';`,"26.r1by1.featured":`grid-template: repeat(9,1fr) / repeat(9,1fr);
    grid-template-areas:
      'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 
      'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft v' 'ft ft ft ft ft ft ft ft x';`},nH={"2.featured":`
    @media (max-width: 600px) {
      grid-template-columns: 1fr;
      grid-template-rows: calc(100% / 3);
      grid-auto-rows: calc(100% / 3);
    }
  `,"3.r16by9":`
    @media (max-height: 600px) {
      grid-template-rows: repeat(2,1fr);
      grid-template-columns: 50%;
      grid-auto-columns: 50%;
      grid-auto-flow: column;
    }
  `,"3.featured":`
    @media (max-width: 600px) {
      grid-template-areas: 'ft' 'ft';
      grid-template-columns: 1fr;
      grid-template-rows: 25%;
      grid-auto-rows: 25%;
    }
  `,"4.r16by9":`
    @media (max-height: 600px) {
      grid-template-rows: repeat(2,1fr);
      grid-template-columns: 50%;
      grid-auto-columns: 50%;
      grid-auto-flow: column;
    }
  `,"5.r16by9":`grid-template: repeat(2,1fr) / repeat(3,1fr);
    @media (max-height: 600px) {
      grid-template-rows: repeat(2,1fr);
      grid-template-columns: calc(100% / 3);
      grid-auto-columns: calc(100% / 3);
      grid-auto-flow: column;
    }
  `,"6.r16by9":`grid-template: repeat(2,1fr) / repeat(3,1fr);
    @media (max-height: 600px) {
      grid-template-rows: repeat(2,1fr);
      grid-template-columns: calc(100% / 3);
      grid-auto-columns: calc(100% / 3);
      grid-auto-flow: column;
    }
  `,"7.r16by9":`
    @media (max-height: 600px) {
      grid-template-rows: repeat(2,1fr);
      grid-template-columns: 25%;
      grid-auto-columns: 25%;
      grid-auto-flow: column;
    }
  `},nW=`
  @media (max-width: 600px) {
    grid-template-areas: 'ft ft' 'ft ft';
    grid-template-columns: repeat(2,1fr);
    grid-template-rows: 25%;
    grid-auto-rows: 25%;
  }
`,nG=`
  @media (max-height: 600px) {
    grid-template-areas: 'ft ft' 'ft ft';
    grid-template-rows: repeat(2,1fr);
    grid-template-columns: 25%;
    grid-auto-columns: 25%;
    grid-auto-flow: column;
  }
`,nK=f.ZP.div.withConfig(eI)`
  position: relative;
  display: grid;
  height: 100%;
  width: 100%;
  overflow: auto;
  background-color: ${e=>e.theme.videoGrid.bgd};

  ${({size:e,featured:t})=>nz[`${e}${t?".featured":""}`]||""}
  ${({size:e,featured:t,ratio:i})=>{if(!i)return;let r="",n=n$.indexOf(i);for(let i=0;i<=n;i++){let n=n$[i];r+=nz[`${e}.${n}${t?".featured":""}`]||""}let o=nH[`${e}.${i}${t?".featured":""}`]||nH[`${e}${t?".featured":""}`];return o?r+=o:"r16by9"===i&&(e>7||t)?r+=nG:(e>7||t)&&(r+=nW),r}};
`,nq={usingGrid:!0},nJ=(0,h.createContext)(null),nQ=e=>{var{size:t,children:i,layout:r="standard"}=e,n=eg(e,["size","children","layout"]);let o=(0,h.createRef)(),s=nj(o),a="number"==typeof t?t:h.Children.count(i);return h.createElement(nJ.Provider,{value:nq},h.createElement(nK,Object.assign({ref:o},n,{size:a,ratio:s,featured:"featured"===r,"data-testid":"video-grid"}),i))},nZ=()=>(0,h.useContext)(nJ),nX=f.ZP.div.withConfig(eI)`
  height: 100%;
  width: 100%;
  position: relative;
  background: ${e=>e.theme.colors.greys.grey100};

  video {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
    object-fit: ${e=>e.objectFit||"cover"};
  }

  .ch-icon {
    width: 1.5rem;
    height: 1.5rem;
    display: inline-block;
    background-color: papayawhip; /* TODO: figure out what this is supposed to be */
    margin-right: 0.5rem;
    flex: 0 0 1.5rem;
  }

  .ch-nameplate {
    backdrop-filter: blur(20px);
    background-color: rgba(46, 47, 52, 0.85);
    border-radius: 0.25rem;
    bottom: 0.5rem;
    color: ${e=>e.theme.colors.greys.white};
    left: 0.5rem;
    max-width: calc(100% - 2rem);
    padding: 0.5rem;
    position: absolute;

    div {
      ${ew};
      display: flex;
      align-items: center;
    }

    .ch-text {
      font-size: ${e=>e.theme.fontSizes.text.fontSize};
      ${ew};
      margin: 0;
    }
  }

  ${eA}
  ${eE}
`,nY=(0,h.forwardRef)((e,t)=>{let{tag:i,className:r,nameplate:n}=e,o=eg(e,["tag","className","nameplate"]);return h.createElement(nX,Object.assign({as:i,className:r||"","data-testid":"video-tile"},o),h.createElement("video",{ref:t,className:"ch-video"}),n&&h.createElement("header",{className:"ch-nameplate"},h.createElement("p",{className:"ch-text"},n)))});f.ZP.div.withConfig(eI)`
  display: grid;
  width: 100%;
  height: 100%;

  ${N}
  ${eA}
  ${eE}

  ${({responsive:e,theme:t})=>e?`
    ${t.mediaQueries.max.md} {
      grid-template-columns: 1fr 1fr;
    }

    ${t.mediaQueries.max.sm} {
      grid-template-columns: 1fr;
    }
  `:""}

  ${e=>e.css||""}
`,f.ZP.div.withConfig(eI)`
  ${eA}
  ${N}

  ${e=>e.css||""}
`;let n0=f.ZP.aside.withConfig(eI)`
  width: 100%;
  height: 100%;
  padding-bottom: 1rem;
  overflow-y: auto;
  background-color: ${e=>e.theme.roster.bgd};
  box-shadow: 1rem 1rem 3.75rem 0 rgba(0, 0, 0, 0.1);
  border-left: 0.0625rem solid ${e=>e.theme.roster.containerBorder};
  border-right: 0.0625rem solid ${e=>e.theme.roster.containerBorder};

  ${({theme:e})=>e.mediaQueries.min.md} {
    width: ${e=>e.theme.roster.maxWidth};
  }

  ${eA}
  ${eE}
`,n1=f.ZP.span.withConfig(eI)`
  display: inline-block;
  margin: 0 0.625rem 0 0;
  font-weight: 600;
  font-size: 0.675rem;
  color: ${e=>e.theme.roster.secondaryText};
`,n2=f.ZP.div.withConfig(eI)`
  margin: 0 0.5rem;

  & + & {
    margin-top: 1rem;
  }

  ${eA}
  ${eE}
`,n3=f.ZP.div.withConfig(eI)`
  background-color: ${e=>e.theme.roster.fgd};
  border-radius: ${e=>e.theme.radii.default};

  ${eA}
  ${eE}
`,n5=f.ZP.div.withConfig(eI)`
  position: relative;
  display: flex;
  align-items: center;
  padding: 0.75rem 1rem;
  margin-bottom: 0.5rem;
  border-bottom: 0.0625rem solid ${e=>e.theme.roster.headerBorder};

  .ch-title {
    font-size: 0.875rem;
    color: ${e=>e.theme.roster.primaryText};
    ${e=>e.isSearching?"opacity: 0;":""}
    ${ew};
  }

  .ch-badge {
    margin-left: 0.5rem;
    ${e=>e.isSearching?"opacity: 0;":""}
  }

  .ch-buttons {
    margin-left: auto;
    display: flex;

    > * {
      margin-left: 0.5rem;
    }

    ${e=>e.isSearching?"opacity: 0;":""}
  }

  .ch-search-wrapper {
    position: absolute !important;
    bottom: 0.75rem;
    left: 0.5rem;
    right: 0.5rem;

    .ch-search-input {
      flex: 1;

      input {
        width: 100%;
      }
    }

    .ch-search-close {
      margin-left: 0.5rem;
    }
  }

  .ch-navigation-icon {
    margin-right: 0.5rem;
    margin-left: -0.5rem;

    ${({theme:e})=>e.mediaQueries.min.md} {
      display: none;
    }
  }

  ${eA}
  ${eE}
`,n4=f.ZP.div.withConfig(eI)`
  flex-grow: 1;
  min-width: 0;
  line-height: 1.5;

  .ch-name {
    ${ew};
    font-size: 0.875rem;
    color: ${e=>e.theme.roster.primaryText};
  }

  .ch-subtitle {
    ${ew};
    font-size: 0.65rem;
    color: ${e=>e.theme.roster.secondaryText};
  }
`,n6=e=>{var{children:t}=e,i=eg(e,["children"]);return h.createElement(n0,Object.assign({},i),t)},n8=e=>{var{menu:t,buttonProps:i,tooltipContainerId:r,a11yMenuLabel:n=""}=e,o=eg(e,["menu","buttonProps","tooltipContainerId","a11yMenuLabel"]);let s=(0,h.useMemo)(()=>rM(eB,r),[r]),a=o["data-tooltip"]?s:eB,l=o["data-tooltip-position"]?{tooltipPosition:o["data-tooltip-position"]}:{};return h.createElement(rh,{className:"ch-menu",a11yLabel:n,renderButtonWrapper:(e,t)=>h.createElement(a,Object.assign({},l,i,t,o,{className:tw("ch-menu",null==i?void 0:i.className),icon:h.createElement(e1,null),label:n}))},t)},n7=({onChange:e,onClose:t,value:i})=>{let r=(0,h.useRef)(null),n=()=>{var e;let i=r.current,n=null===(e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))||void 0===e?void 0:e.set;n&&i&&(n.call(i,""),i.dispatchEvent(new Event("input",{bubbles:!0}))),t()};return(0,h.useEffect)(()=>{var e;null===(e=r.current)||void 0===e||e.focus()},[]),h.createElement(rD,{container:!0,alignItems:"center",className:"ch-search-wrapper"},h.createElement(rQ,{"aria-label":"Search",className:"ch-search-input",ref:r,onChange:e,value:i,onClear:n}))},n9=e=>{var{tag:t,title:i,badge:r,searchValue:n,onClose:o,onSearch:s,className:a,menu:l,a11yMenuLabel:d="",searchLabel:c="Open search",closeLabel:u="Close",tooltipContainerId:f,children:p}=e,m=eg(e,["tag","title","badge","searchValue","onClose","onSearch","className","menu","a11yMenuLabel","searchLabel","closeLabel","tooltipContainerId","children"]);let g=(0,h.useMemo)(()=>rM(eB,f),[f]),v=m["data-tooltip"]?g:eB,b=m["data-tooltip-position"]?{tooltipPosition:m["data-tooltip-position"]}:{},y=m["data-tooltip"]?{"data-tooltip-position":m["data-tooltip-position"],"data-tooltip":m["data-tooltip"]}:{},[S,w]=(0,h.useState)(!1),C=(0,h.useRef)(null),k=()=>{w(!0)},T=()=>{var e;null==s||s({target:{value:""},currentTarget:{value:""}}),w(!1),null===(e=C.current)||void 0===e||e.focus()};return h.createElement(n5,Object.assign({isSearching:S,as:t,className:a||""},m),h.createElement("div",{className:"ch-title"},i),"number"==typeof r&&r>-1&&h.createElement(eO,{className:"ch-badge",value:r}),h.createElement("div",{className:"ch-buttons"},s&&h.createElement(v,Object.assign({},b,{ref:C,label:c,onClick:k,icon:h.createElement(e9,null)})),l&&h.createElement(n8,Object.assign({},y,{tooltipContainerId:f,menu:l,a11yMenuLabel:d})),p,o&&h.createElement(v,Object.assign({},b,{label:u,onClick:o,icon:h.createElement(e7,null)}))),S&&h.createElement(n7,{value:n,onClose:T,onChange:s}))},oe=e=>{var{tag:t,title:i,badge:r,className:n,children:o}=e,s=eg(e,["tag","title","badge","className","children"]);return h.createElement(n2,Object.assign({as:t,className:n||""},s),i&&h.createElement(rD,{alignItems:"center",pl:".5rem",mb:".5rem"},h.createElement(n1,null,i),"number"==typeof r&&r>-1&&h.createElement(eO,{value:r})),h.createElement(n3,null,o))},ot=({name:e,subtitle:t})=>h.createElement(n4,null,h.createElement("div",{className:"ch-name"},e),t&&h.createElement("div",{className:"ch-subtitle"},t)),oi=f.ZP.div.withConfig(eI)`
  display: flex;
  align-items: center;
  padding: 0.625rem 1rem;

  .ch-mic {
    flex-shrink: 0;
    width: 1.5rem;
    line-height: 0;

    ${({micPosition:e})=>"leading"===e?`
        order: -1;
        margin-right: .75rem;
      `:""}
  }

  .ch-menu {
    color: ${e=>e.theme.buttons.icon.hover.bgd};

    &:hover,
    &:focus {
      color: ${e=>e.theme.buttons.icon.hover.text};
    }
  }

  svg {
    width: 1.5rem;
    flex-shrink: 0;
  }

  > * {
    margin-right: 0.5rem;
  }

  > :last-child {
    margin-right: 0;
  }

  ${eA}
  ${eE}
`,or=f.ZP.div.withConfig(eI)`
  display: flex;
  align-items: center;
  white-space: nowrap;
  font-size: 0.65rem;
  color: ${({theme:e})=>e.roster.secondaryText};

  > svg {
    margin-right: 0.25rem;
    color: ${({theme:e})=>e.roster.secondaryText};
  }
`,on=({children:e})=>h.createElement(or,null,h.createElement(eY,null),e);function oo(e,t){return t?h.createElement(e0,null):"boolean"==typeof e?h.createElement(e$,{disabled:!e}):null}let os=e=>{let{tag:t,name:i,menu:r,subtitle:n,className:o,runningLate:s,muted:a,videoEnabled:l,sharingContent:d,poorConnection:c=!1,microphone:u,a11yMenuLabel:f="",extraIcon:p,buttonProps:m}=e,g=eg(e,["tag","name","menu","subtitle","className","runningLate","muted","videoEnabled","sharingContent","poorConnection","microphone","a11yMenuLabel","extraIcon","buttonProps"]),v=oo(l,d),b="boolean"==typeof a,y=u||h.createElement(e6,{muted:a,poorConnection:c}),S=g["data-tooltip"]?{"data-tooltip-position":g["data-tooltip-position"],"data-tooltip":g["data-tooltip"]}:{};return h.createElement(oi,Object.assign({className:o||"",as:t},e,{"data-testid":"roster-cell"}),h.createElement(ot,{name:i,subtitle:n}),s?h.createElement(on,null,s):h.createElement(h.Fragment,null,b&&h.createElement("div",{className:"ch-mic"},y),p,v),r&&h.createElement(n8,Object.assign({},S,{menu:r,a11yMenuLabel:f,buttonProps:m})))},oa=(0,h.createContext)(null);f.ZP.div.withConfig(eI)`
  z-index: ${e=>e.isActive?e.theme.zIndex.controlBar:"-10"};
  visibility: ${e=>e.isActive?"visible":"hidden"};

  &.ch-active {
    animation: ${rZ} 0.25s ease 0s forwards;
  }
`,f.ZP.ul.withConfig(eI)`
  display: flex;
  flex-direction: column;
  width: 20rem;

  ${eE}
  ${eA}
`,f.ZP.li.withConfig(eI)`
  position: relative;

  ${eE};
  ${eA};

  & .ch-channel-button {
    width: 100%;
    height: 100%;
    padding: 11px 0;
    background-color: ${e=>e.theme.channelList.bgd};
    border: none;
    border-radius: unset;
    justify-content: left;
    padding-left: 1rem;
    color: ${e=>e.theme.channelList.fontColor};
    border: ${e=>e.theme.channelList.border};
    font-family: ${e=>e.theme.fonts.body};

    &:hover {
      background-color: ${e=>e.theme.channelList.hover.bgd};
    }

    &:active {
      background-color: ${e=>e.theme.channelList.active.bgd};
      color: ${e=>e.theme.channelList.active.fontColor};
    }

    &:focus {
      border: ${e=>e.theme.channelList.focus.border};
    }
  }

  & .ch-label {
    padding-left: 1.5rem;
  }

  & .ch-unread-badge {
    display: ${e=>e.unread?"inline":"none"};
    position: absolute;
    z-index: 2;
    top: 12px;
    left: 5px;
    background-color: ${e=>e.theme.colors.primary.light};
  }

  &.ch-unread .ch-channel-button {
    font-weight: bold;
  }

  &.ch-selected .ch-channel-button {
    background-color: ${e=>e.theme.colors.primary.light};
    color: ${e=>e.theme.channelList.selected.fontColor};

    &:focus {
      border: ${e=>e.theme.channelList.focus.selectedBorder};
    }
  }

  & .ch-popover-toggle {
    position: absolute;
    right: 1rem;
    margin: 0.5rem 0;
    height: 1.5rem;
    border-radius: 50%;

    .ch-channel-actions {
      border: 1px solid transparent;
    }

    & g {
      fill: ${e=>e.theme.channelList.active.fontColor};
    }

    & button:focus .ch-channel-actions {
      border: ${e=>e.theme.channelList.focus.selectedBorder};
      border-radius: 50%;
    }

    &:hover,
    &:active {
      background-color: ${e=>e.theme.channelList.iconButton.activeBgd};

      & g {
        fill: ${e=>e.theme.colors.primary.light};
      }
    }
  }

  & .ch-detailed-channel {
    display: grid;
    grid-template-rows: 17px 1fr max-content;
    grid-gap: 16px;
    padding: 10px 20px;
    background-color: ${e=>e.theme.channelList.bgd};
    color: ${e=>e.theme.channelList.fontColor};
    border-bottom: 0.5px solid #d3d3d3;
    font-family: ${e=>e.theme.fonts.body};

    &:hover {
      background-color: ${e=>e.theme.channelList.hover.bgd};
    }

    &:active {
      background-color: ${e=>e.theme.channelList.active.bgd};
      color: ${e=>e.theme.channelList.active.fontColor};
    }

    &:focus {
      border: ${e=>e.theme.channelList.focus.border};
    }
  }

  & .ch-detailed-channel-name {
    font-weight: bold;
    padding-left: 25px;
    white-space: nowrap;
    overflow-x: hidden;
    text-overflow: ellipsis;
    font-size: 14px;
    max-width: 85%;
  }

  & .ch-detailed-channel-message {
    grid-row: span 2;
    padding-left: 25px;
    white-space: nowrap;
    overflow-x: hidden;
    text-overflow: ellipsis;
    font-size: 14px;
    max-width: 90%;
  }

  & .ch-detailed-channel-message-time {
    position: absolute;
    top: 0.8rem;
    right: 0.5rem;
    font-size: 8px;
    max-width: 15%;
    text-align: right;
  }

  & .ch-unread-badge-detailed {
    display: ${e=>e.unread?"inline":"none"};
    position: absolute;
    z-index: 2;
    top: 10px;
    left: 5px;
    background-color: ${e=>e.theme.colors.primary.light};
  }

  &.ch-selected .ch-detailed-channel {
    background-color: ${e=>e.theme.colors.primary.light};
    color: ${e=>e.theme.channelList.selected.fontColor};

    &:focus {
      border: ${e=>e.theme.channelList.focus.selectedBorder};
    }
  }

  & .ch-popover-toggle-detailed {
    position: absolute;
    top: 1.75rem;
    right: 1rem;
    margin: 0.5rem 0;
    height: 1.5rem;
    border-radius: 50%;

    .ch-channel-actions {
      border: 1px solid transparent;
    }

    & g {
      fill: ${e=>e.theme.channelList.active.fontColor};
    }

    & button:focus .ch-channel-actions {
      border: ${e=>e.theme.channelList.focus.selectedBorder};
      border-radius: 50%;
    }

    &:hover,
    &:active {
      background-color: ${e=>e.theme.channelList.iconButton.activeBgd};

      & g {
        fill: ${e=>e.theme.colors.primary.light};
      }
    }
  }
`;let ol=f.ZP.div.withConfig(eI)`
  display: flex;
  flex-direction: row;
  font-size: 0.65rem;
  margin-left: 1rem;
  align-items: center;
  background-color: ${e=>e.theme.chatBubble.container.bgd};
  width: 100%;

  .ch-timestamp {
    padding-right: ${e=>e.actions?"1rem":"2.5rem"};
  }

  ${eA}
  ${eE}
`,od=f.ZP.div.withConfig(eI)`
  background-color: ${e=>e.theme.chatBubble[e.variant].bgd};
  padding: 0.625rem 1rem;
  border-radius: 4px;
  width: fit-content;
  color: ${e=>e.theme.chatBubble[e.variant].fontColor};
  box-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.1);
  line-height: 20px;
  width: ${e=>e.editable?"100%":"fit-content"};
  max-width: 70.6%;
  font-size: 0.875rem;
  position: relative;
  margin-bottom: ${e=>e.editable?"4rem":"unset"};
  overflow-wrap: break-word;
  word-break: break-word;
  hyphens: auto;

  & .ch-header {
    display: flex;
    flex-direction: row;
    margin-bottom: 0.5rem;
    align-items: baseline;
  }

  & .ch-sender-name {
    font-weight: bold;
    padding-right: 0.5rem;
  }

  & .ch-header-timestamp {
    font-size: 0.65rem;
  }

  & svg {
    position: absolute;
    height: 19px;
    width: 11px;
    margin-top: -14px;
    margin-left: -25px;

    & .ch-chat-bubble-tail {
      fill: ${e=>e.theme.chatBubble[e.variant].bgd};
    }
  }

  .ch-input {
    width: 100%;
  }

  .ch-edit-buttons {
    position: absolute;
    margin-top: 1rem;
    display: flex;
    flex-direction: row-reverse;
    width: 10rem;
    justify-content: space-between;
  }

  ${eA};
  ${eE};
`,oc=f.ZP.div.withConfig(eI)`
  display: flex;
  margin-right: 0.5rem;
  margin-left: auto;
  color: ${e=>e.theme.chatBubble.container.fontColor};
  align-items: center;

  & .ch-message-actions {
    border: 1px solid transparent;
    border-radius: 50%;
  }

  & button:hover .ch-message-actions {
    background-color: ${e=>e.theme.buttons.icon.hover.bgd};

    & g {
      fill: ${e=>e.theme.buttons.icon.hover.text};
    }
  }

  & button:focus .ch-message-actions {
    border: 1px solid ${e=>e.theme.colors.primary.dark};
    border-radius: 50%;
  }

  & .ch-message-actions g {
    fill: ${e=>e.theme.chatBubble.container.fontColor};
  }

  & .ch-message-actions.isOpen {
    background-color: ${e=>e.theme.buttons.icon.active.bgd};
    border-radius: 50%;

    & g {
      fill: ${e=>e.theme.buttons.icon.active.text};
    }
  }
`,ou=e=>{var{variant:t,senderName:i,timestamp:r,showTail:n,redacted:o,children:s}=e,a=eg(e,["variant","senderName","timestamp","showTail","redacted","children"]);return h.createElement(od,Object.assign({variant:t,editable:!1},a,{"data-testid":"chat-bubble"}),(i||r)&&h.createElement("div",{className:"ch-header"},i&&h.createElement("div",{className:"ch-sender-name","data-testid":"chat-bubble-sender-name"},i),r&&h.createElement("div",{className:"ch-header-timestamp","data-testid":"chat-bubble-timestamp"},r)),s&&h.createElement("div",null,s),n&&h.createElement("svg",{viewBox:"0 0 4 9","data-testid":"tail"},h.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},h.createElement("g",{transform:"translate(0, -53)",className:"ch-chat-bubble-tail"},h.createElement("path",{d:"M4,62 L3.92789928,61.999999 C2.89671177,62.0004988 1.33197354,61.8123902 0.200755581,60.8250184 C-0.0781312712,60.5814641 -0.0639788041,60.0290387 0.229060515,59.8181428 C1.47198013,58.9247413 3.99237825,57.6821586 4,52.9112516 L4,52.9112516 L4,62 Z"})))))},oh=h.forwardRef((e,t)=>{let{timestamp:i,actions:r,tooltipContainerId:n,a11yLabel:o="Open channel options"}=e,s=eg(e,["timestamp","actions","tooltipContainerId","a11yLabel"]),a=(0,h.useMemo)(()=>rM(eB,n),[n]),l=s["data-tooltip"]?a:eB,d=s["data-tooltip-position"]?{tooltipPosition:s["data-tooltip-position"]}:{};return h.createElement(ol,Object.assign({"data-testid":"chat-bubble-container",ref:t,actions:r},s),e.children,h.createElement(oc,null,i&&h.createElement("span",{className:"ch-timestamp","data-testid":"message-time"},i),r&&h.createElement(rh,{a11yLabel:o,placement:"bottom-end",renderButtonWrapper:(e,t)=>h.createElement(l,Object.assign({},d,{icon:h.createElement(e1,{width:"1.5rem",height:"1.5rem"}),selected:e},t,{label:o})),children:r})))}),of=(0,f.F4)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`;function op(e,t){var i=t&&t.cache?t.cache:oT,r=t&&t.serializer?t.serializer:oC;return(t&&t.strategy?t.strategy:oy)(e,{cache:i,serializer:r})}function om(e){return null==e||"number"==typeof e||"boolean"==typeof e}function og(e,t,i,r){var n=om(r)?r:i(r),o=t.get(n);return void 0===o&&(o=e.call(this,r),t.set(n,o)),o}function ov(e,t,i){var r=Array.prototype.slice.call(arguments,3),n=i(r),o=t.get(n);return void 0===o&&(o=e.apply(this,r),t.set(n,o)),o}function ob(e,t,i,r,n){return i.bind(t,e,r,n)}function oy(e,t){var i=1===e.length?og:ov;return ob(e,this,i,t.cache.create(),t.serializer)}function oS(e,t){return ob(e,this,ov,t.cache.create(),t.serializer)}function ow(e,t){return ob(e,this,og,t.cache.create(),t.serializer)}function oC(){return JSON.stringify(arguments)}function ok(){this.cache=Object.create(null)}f.ZP.ul.withConfig(eI)`
  background-color: ${e=>e.theme.chatBubble.container.bgd};
  overflow-y: scroll;
  display: flex;
  flex-direction: column;
  list-style: none;
  padding: 0;

  /* disable scrolling while fetching */
  &.ch-not-scrollable {
    overflow-y: hidden;
  }

  ${eA}
  ${eE}

  .ch-spinner {
    margin: 0 auto;
  }

  .ch-spinner svg {
    width: 2rem;
    height: 2rem;
    animation: ${of} 2s linear infinite;
    display: block;
  }
`,f.ZP.div.withConfig(eI)`
  display: flex;
  flex-direction: row;
  padding: 10px;

  & .ch-attachment-icon {
    height: 2rem;
    width: 2rem;
    margin: auto;
    background-color: ${e=>e.theme.messageAttachment.icon.bgd};
    border-radius: 25px;

    & .ch-document-icon {
      margin: auto 0;
      color: ${e=>e.theme.messageAttachment.icon.color};
    }
  }
  & .ch-attachment-name {
    margin-left: 1rem;

    & a:link,
    & a:visited,
    & a:hover,
    & a:active {
      color: ${e=>e.theme.messageAttachment.name.fontColor};
      text-decoration: none;
    }
  }
  & .ch-attachment-size {
    font-size: ${e=>e.theme.messageAttachment.size.fontSize};
    color: ${e=>e.theme.messageAttachment.size.fontColor};
    display: block;
    padding-top: 3px;
  }
`,f.ZP.div.withConfig(eI)`
  color: ${e=>e.theme.messageAttachment.content.fontColor};
  display: flex;
  flex-direction: column;
  width: fit-content;
  border-radius: 4px;
  overflow: hidden;
  box-shadow: 0 1px 4px 0 rgba(0, 0, 0, 0.1);
  background-color: ${e=>e.theme.messageAttachment.content.bgd};
  letter-spacing: ${e=>e.theme.messageAttachment.content.letterSpacing};
  font-size: ${e=>e.theme.fontSizes.text.fontSize};
  line-height: ${e=>e.theme.fontSizes.text.lineHeight};

  & img {
    ${e=>e.imgStyles};
  }

  ${eA}
  ${eE}
`,ok.prototype.has=function(e){return e in this.cache},ok.prototype.get=function(e){return this.cache[e]},ok.prototype.set=function(e,t){this.cache[e]=t};var oT={create:function(){return new ok}},oI=op,oE={variadic:oS,monadic:ow};oI.strategies=oE;let oA={weekday:"long",year:"numeric",month:"long",day:"numeric"};oI((e,t,i,r,n)=>{let o=i||oA,s=new Date(e).toLocaleDateString(t,o),a=new Date;return(a.setDate(a.getDate()-1),s===a.toLocaleDateString(t,o))?n||"Yesterday":s===new Date().toLocaleDateString(t,o)?r||"Today":s}),function(e){e[e.Loading=0]="Loading",e[e.Succeeded=1]="Succeeded",e[e.Failed=2]="Failed",e[e.Ended=3]="Ended",e[e.JoinedFromAnotherDevice=4]="JoinedFromAnotherDevice",e[e.Left=5]="Left",e[e.TerminalFailure=6]="TerminalFailure",e[e.Reconnecting=7]="Reconnecting"}(a||(a={})),function(e){e.UNTRIGGERED="UNTRIGGERED",e.IN_PROGRESS="IN_PROGRESS",e.GRANTED="GRANTED",e.DENIED="DENIED"}(l||(l={})),function(e){e[e.None=1]="None",e[e.Audio=2]="Audio",e[e.Video=3]="Video",e[e.AudioAndVideo=4]="AudioAndVideo"}(d||(d={})),function(e){e[e.STARTING=0]="STARTING",e[e.DID_STOP=1]="DID_STOP",e[e.UPDATE=2]="UPDATE",e[e.TOGGLE_PAUSE=3]="TOGGLE_PAUSE",e[e.REMOVE=4]="REMOVE",e[e.DENIED=5]="DENIED",e[e.RESET=6]="RESET",e[e.UPDATE_CAN_START=7]="UPDATE_CAN_START"}(c||(c={}));let oM={paused:!1,isLocalUserSharing:!1,isLocalShareLoading:!1,canStartContentShare:!0,tileId:null,sharingAttendeeId:null,tiles:[],tileIdToAttendeeId:{},attendeeIdToTileId:{}},oO=(e,t,i)=>({tiles:[...e.tiles,t],tileIdToAttendeeId:Object.assign(Object.assign({},e.tileIdToAttendeeId),{[t.toString()]:i}),attendeeIdToTileId:Object.assign(Object.assign({},e.attendeeIdToTileId),{[i]:t})}),oP=(e,t)=>{let i=e.tileIdToAttendeeId[t.toString()];if(!i)return{tiles:e.tiles,tileIdToAttendeeId:e.tileIdToAttendeeId,attendeeIdToTileId:e.attendeeIdToTileId,removedAttendeeId:void 0};let r=e.tiles.filter(e=>e!==t),n=Object.assign({},e.tileIdToAttendeeId);delete n[t.toString()];let o=Object.assign({},e.attendeeIdToTileId);return delete o[i],{tiles:r,tileIdToAttendeeId:n,attendeeIdToTileId:o,removedAttendeeId:i}},o_=(e,t,i,r)=>{if(r&&r!==e.sharingAttendeeId)return{tileId:e.tileId,sharingAttendeeId:e.sharingAttendeeId};if(0===t.length)return{tileId:null,sharingAttendeeId:null};let n=Math.max(...t);return{tileId:n,sharingAttendeeId:i[n.toString()]}};function ox(e,{type:t,payload:i}){switch(t){case c.STARTING:return Object.assign(Object.assign({},e),{isLocalShareLoading:!0});case c.UPDATE:{let{isLocalUser:t,tileState:r}=i,n=r.tileId,o=r.boundAttendeeId;if(e.tileIdToAttendeeId[n.toString()])return e;let s=oO(e,n,o),a=o_(e,s.tiles,s.tileIdToAttendeeId);return Object.assign(Object.assign(Object.assign(Object.assign({},e),s),a),{isLocalShareLoading:!t&&e.isLocalShareLoading,isLocalUserSharing:!!t||e.isLocalUserSharing})}case c.REMOVE:{let{tileId:t,isLocalUser:r}=i,{tiles:n,tileIdToAttendeeId:o,attendeeIdToTileId:s,removedAttendeeId:a}=oP(e,t);if(!a)return e;let l=o_(e,n,o,a);return Object.assign(Object.assign(Object.assign(Object.assign({},e),{tiles:n,tileIdToAttendeeId:o,attendeeIdToTileId:s}),l),{isLocalUserSharing:!r&&e.isLocalUserSharing,paused:!r&&e.paused})}case c.DID_STOP:{let{isLocalUserSharing:t}=e,{localAttendeeId:r}=i;if(t){let t=e.attendeeIdToTileId[r];if(t){let{tiles:i,tileIdToAttendeeId:r,attendeeIdToTileId:n,removedAttendeeId:o}=oP(e,t),s=o_(e,i,r,o);return Object.assign(Object.assign(Object.assign(Object.assign({},e),{tiles:i,tileIdToAttendeeId:r,attendeeIdToTileId:n}),s),{isLocalUserSharing:!1,paused:!1,isLocalShareLoading:!1})}}return Object.assign(Object.assign({},e),{isLocalShareLoading:!1,isLocalUserSharing:!1,paused:!1})}case c.TOGGLE_PAUSE:if(!e.isLocalUserSharing)return e;return Object.assign(Object.assign({},e),{paused:!e.paused});case c.DENIED:if(!e.isLocalShareLoading)return e;return Object.assign(Object.assign({},e),{isLocalShareLoading:!1});case c.RESET:return oM;case c.UPDATE_CAN_START:{let{maxContentShares:t}=i;return Object.assign(Object.assign({},e),{canStartContentShare:!e.isLocalUserSharing&&e.tiles.length<t})}default:throw Error("Incorrect type in ContentShareProvider")}}let oR=1,oD=2,oN=(0,h.createContext)(null),oL=(0,h.createContext)(null),oF=({children:e,maxContentShares:t=1})=>{var i,r,n;let o=sn(),s=rg(),[a,l]=(0,h.useReducer)(ox,oM),{paused:d,isLocalUserSharing:u,isLocalShareLoading:f,canStartContentShare:p}=a,m=(0,h.useRef)(null),g=null===(n=null===(r=null===(i=null==o?void 0:o.audioVideoController)||void 0===i?void 0:i.realtimeController)||void 0===r?void 0:r.state)||void 0===n?void 0:n.localAttendeeId,v=(0,h.useMemo)(()=>Math.max(oR,Math.min(t,oD)),[t]);(0,h.useEffect)(()=>{t>oD?s.warn(`ContentShareProvider: maxContentShares value ${t} exceeds the currently supported maximum of ${oD}.The value has been set to ${v} instead.`):t<oR&&s.warn(`ContentShareProvider: maxContentShares value ${t} is below the minimum of ${oR}. The value has been set to ${v} instead.`)},[t,v]),(0,h.useEffect)(()=>{if(!o)return;let e={videoTileDidUpdate:e=>{if(!e.boundAttendeeId||!e.isContent||!e.tileId)return;let{boundAttendeeId:t}=e,i=new ea.DefaultModality(t).base()===g;1===v&&!i&&m.current&&m.current<e.tileId&&(o.stopContentShare(),m.current=null),i&&(m.current=e.tileId),l({type:c.UPDATE,payload:{tileState:e,isLocalUser:i}})},videoTileWasRemoved:e=>{let t=e===m.current;t&&(m.current=null),l({type:c.REMOVE,payload:{isLocalUser:t,tileId:e}})}},t={contentShareDidStop:()=>{var e,t,i;l({type:c.DID_STOP,payload:{localAttendeeId:null===(i=null===(t=null===(e=null==o?void 0:o.audioVideoController)||void 0===e?void 0:e.realtimeController)||void 0===t?void 0:t.state)||void 0===i?void 0:i.localAttendeeId}})}};return o.addObserver(e),o.addContentShareObserver(t),()=>{o.removeObserver(e),o.removeContentShareObserver(t),l({type:c.RESET})}},[o,g,v]),(0,h.useEffect)(()=>{if(!o)return;let e=e=>{"NotAllowedError"===e.reason.name&&l({type:c.DENIED})};return window.addEventListener("unhandledrejection",e),()=>window.removeEventListener("unhandledrejection",e)},[o,f]);let b=(0,h.useCallback)(e=>ev(void 0,void 0,void 0,function*(){o&&(u||f?o.stopContentShare():(e&&"string"==typeof e?yield o.startContentShareFromScreenCapture(e):e&&e instanceof MediaStream?yield o.startContentShare(e):yield o.startContentShareFromScreenCapture(),l({type:c.STARTING})))}),[o,u,f]),y=(0,h.useCallback)(()=>{o&&u&&(d?o.unpauseContentShare():o.pauseContentShare(),l({type:c.TOGGLE_PAUSE}))},[o,d,u]);(0,h.useEffect)(()=>{l({type:c.UPDATE_CAN_START,payload:{maxContentShares:v}})},[u,a.tiles.length,v]);let S=(0,h.useMemo)(()=>({paused:d,isLocalUserSharing:u,isLocalShareLoading:f,toggleContentShare:b,togglePauseContentShare:y,canStartContentShare:p}),[d,u,f,b,y,p]);return h.createElement(oN.Provider,{value:a},h.createElement(oL.Provider,{value:S},e))},oV=()=>{let e=(0,h.useContext)(oN);if(!e)throw Error("useContentShareState must be used within a ContentShareProvider");return e},oB=()=>{let e=(0,h.useContext)(oL);if(!e)throw Error("useContentShareControlContext must be used within ContentShareControlProvider");return e};!function(e){e[e.UPDATE=0]="UPDATE",e[e.REMOVE=1]="REMOVE",e[e.RESET=2]="RESET"}(u||(u={}));let oU={tiles:[],tileIdToAttendeeId:{},attendeeIdToTileId:{},size:0},oj=(e,t)=>{let i=Object.assign({},e);return delete i[t],i};function o$(e,{type:t,payload:i}){let{tiles:r,tileIdToAttendeeId:n,attendeeIdToTileId:o,size:s}=e;switch(t){case u.UPDATE:{let{tileId:t,attendeeId:a=""}=i,l=t.toString();if(n[l])return e;return{tiles:[...r,t],tileIdToAttendeeId:Object.assign(Object.assign({},n),{[l]:a}),attendeeIdToTileId:Object.assign(Object.assign({},o),{[a]:t}),size:s+1}}case u.REMOVE:{let{tileId:t}=i,a=n[t],l=t.toString();if(!a)return e;return{tiles:r.filter(e=>t!==e),tileIdToAttendeeId:oj(n,l),attendeeIdToTileId:oj(o,a),size:s-1}}case u.RESET:return oU;default:throw Error("Incorrect type in VideoProvider")}}let oz=(0,h.createContext)(null),oH=({children:e})=>{let t=sn(),[i,r]=(0,h.useReducer)(o$,oU);return(0,h.useEffect)(()=>{if(!t)return;let e={videoTileDidUpdate:e=>{if((null==e?void 0:e.boundAttendeeId)&&(null==e?void 0:e.tileId)&&!e.isContent&&!e.localTile){let{tileId:t,boundAttendeeId:i}=e;r({type:u.UPDATE,payload:{tileId:t,attendeeId:i}})}},videoTileWasRemoved:e=>{r({type:u.REMOVE,payload:{tileId:e}})}};return t.addObserver(e),()=>t.removeObserver(e)},[t]),(0,h.useEffect)(()=>{if(t)return()=>r({type:u.RESET})},[t]),h.createElement(oz.Provider,{value:i},e)},oW=()=>{let e=(0,h.useContext)(oz);if(!e)throw Error("useRemoteVideoTileState must be used within a RemoteVideoTileProvider");return e},oG=1500,oK=(0,h.createContext)(null),oq=({children:e})=>{let t=st(),{attendeeIdToTileId:i}=oW(),r=(0,h.useRef)(null),[n,o]=(0,h.useState)(null),s=(0,h.useRef)(null),a=(0,h.useRef)(null);(0,h.useEffect)(()=>{let e=e=>{let t=e[0];if(t===a.current)return;if(a.current=t,s.current&&clearTimeout(s.current),!t){r.current=null,o(null);return}let n=i[t];if(!n){r.current&&(s.current=window.setTimeout(()=>{r.current=null,o(null)},oG));return}n!==r.current&&(r.current?s.current=window.setTimeout(()=>{r.current=n,o(n)},oG):(r.current=n,o(n)))};return t.subscribeToActiveSpeaker(e),()=>t.unsubscribeFromActiveSpeaker(e)},[i]);let l=(0,h.useMemo)(()=>({tileId:n}),[n]);return h.createElement(oK.Provider,{value:l},e)};function oJ(){let e=(0,h.useContext)(oK);if(!e)throw Error("useFeaturedTileState must be used within an FeaturedVideoTileProvider");return e}let oQ=(0,h.createContext)(null),oZ=({children:e})=>{let t=rg(),i=sn(),[r,n]=(0,h.useState)(!0),o=(0,h.useRef)(null);(0,h.useEffect)(()=>{if(i){if(o.current){let e;e=o.current,ev(void 0,void 0,void 0,function*(){try{yield i.bindAudioElement(e)}catch(e){t.error(`Failed to bind audio element. ${e}`)}})}return()=>{i.unbindAudioElement(),n(!0)}}},[i]);let s=(0,h.useCallback)(()=>{if(o.current){if(n(!r),r)null==i||i.unbindAudioElement();else{let e;e=o.current,ev(void 0,void 0,void 0,function*(){try{yield null==i?void 0:i.bindAudioElement(e)}catch(e){t.error(`Failed to bind audio element. ${e}`)}})}}},[o,i,r]),a=(0,h.useMemo)(()=>({isAudioOn:r,toggleAudio:s}),[r,s]);return h.createElement(oQ.Provider,{value:a},e,h.createElement("audio",{ref:o,style:{display:"none"}}))},oX=()=>{let e=(0,h.useContext)(oQ);if(!e)throw Error("useLocalAudioOutput must be used within LocalAudioOutputProvider");return e},oY=(0,h.createContext)(null),o0=({children:e})=>{let t=rg(),i=st(),r=sn(),{devices:n,selectedDevice:o}=sf(),[s,a]=(0,h.useState)(!1),[l,d]=(0,h.useState)(!1),[c,u]=(0,h.useState)(null);(0,h.useEffect)(()=>{if(!r)return;r.hasStartedLocalVideoTile()&&a(!0);let e={videoAvailabilityDidChange:e=>{e.canStartLocalVideo?d(!1):d(!0),t.info(`video availability changed: canStartLocalVideo ${e.canStartLocalVideo}`)}};return r.addObserver(e),()=>{a(!1),r.removeObserver(e)}},[r]),(0,h.useEffect)(()=>{l&&t.warn("Reach the number of maximum active videos")},[l]),(0,h.useEffect)(()=>{(null==r?void 0:r.hasStartedLocalVideoTile())||a(!1)},[n]);let f=(0,h.useCallback)(()=>ev(void 0,void 0,void 0,function*(){try{s||!o?(o||t.warn("There is no input video device chosen!"),yield null==r?void 0:r.stopVideoInput(),a(!1)):l?t.error("Video limit is reached and can not turn on more videos!"):(yield i.startVideoInputDevice(o),null==r||r.startLocalVideoTile(),a(!0))}catch(e){t.error("Failed to toggle video")}}),[r,s,l,o]);(0,h.useEffect)(()=>{if(!r)return;let e={videoTileDidUpdate:e=>{e.localTile&&e.tileId&&c!==e.tileId&&u(e.tileId)}};return r.addObserver(e),()=>r.removeObserver(e)},[r,c]);let p=(0,h.useMemo)(()=>({tileId:c,isVideoEnabled:s,setIsVideoEnabled:a,hasReachedVideoLimit:l,setHasReachedVideoLimit:d,toggleVideo:f}),[c,s,a,l,d,f]);return h.createElement(oY.Provider,{value:p},e)},o1=()=>{let e=(0,h.useContext)(oY);if(!e)throw Error("useLocalVideo must be used within LocalVideoProvider");return e},o2=(0,h.createContext)(void 0),o3=({children:e})=>{let[t,i]=(0,h.useState)(),r=st();return(0,h.useEffect)(()=>{function e(e,t){i({name:e,attributes:t})}return r.subscribeToEventDidReceive(e),()=>{r.unsubscribeFromEventDidReceive(e)}},[]),h.createElement(o2.Provider,{value:t},e)},o5=h.createContext(null),o4=({children:e})=>{let t=st(),i=sn(),r=(0,h.useRef)({}),[n,o]=(0,h.useState)({});(0,h.useEffect)(()=>{if(!i)return;let e=(e,i,n)=>ev(void 0,void 0,void 0,function*(){if(!i){delete r.current[e],o(t=>{let i=t,r=e;return i[r],Object.assign({},eg(i,["symbol"==typeof r?r:r+""]))});return}let s=new ea.DefaultModality(e).base();if(s!==e||r.current[e])return;let a={chimeAttendeeId:e};if(n&&(a.externalUserId=n),r.current[s]=a,o(e=>Object.assign(Object.assign({},e),{[s]:a})),t.getAttendee){let e=yield t.getAttendee(s,n);if(!r.current[s])return;a=Object.assign(Object.assign({},a),e),o(e=>Object.assign(Object.assign({},e),{[s]:a}))}});return i.realtimeSubscribeToAttendeeIdPresence(e),()=>{o({}),r.current={},i.realtimeUnsubscribeToAttendeeIdPresence(e)}},[i]);let s=(0,h.useMemo)(()=>({roster:n}),[n]);return h.createElement(o5.Provider,{value:s},e)};function o6(){let e=(0,h.useContext)(o5);if(!e)throw Error("userRosterState must be used within RosterProvider");return e}function o8(){return Promise.resolve(new MediaStream)}class o7{getDeviceLabels(){return this.deviceLabels}constructor(e){this.meetingSession=null,this.meetingStatus=a.Loading,this.meetingStatusObservers=[],this.audioVideo=null,this.audioVideoObservers={},this.meetingId=null,this.selectedAudioOutputDeviceObservers=[],this.selectedAudioInputDeviceObservers=[],this.selectedVideoInputDeviceObservers=[],this.audioInputDevices=null,this.audioOutputDevices=null,this.videoInputDevices=null,this.deviceLabelTriggerStatus=l.UNTRIGGERED,this.deviceLabelTriggerStatusObservers=[],this.deviceLabelTriggerObservers=[],this.activeSpeakerListener=null,this.activeSpeakerCallbacks=[],this.activeSpeakers=[],this.audioVideoCallbacks=[],this.devicesUpdatedCallbacks=[],this.meetingEventObserverSet=new Set,this.audioVideoDidStart=()=>{this.logger.info("[MeetingManager audioVideoDidStart] Meeting started successfully"),this.meetingStatus=a.Succeeded,this.publishMeetingStatus()},this.audioVideoDidStartConnecting=e=>{this.meetingStatus!==a.Reconnecting&&e&&(this.meetingStatus=a.Reconnecting,this.publishMeetingStatus())},this.audioVideoDidStop=e=>{var t;let i=e.statusCode();switch(i){case ea.MeetingSessionStatusCode.MeetingEnded:this.logger.info(`[MeetingManager audioVideoDidStop] Meeting ended for all: ${i}`),this.meetingStatus=a.Ended;break;case ea.MeetingSessionStatusCode.Left:this.logger.info(`[MeetingManager audioVideoDidStop] Left the meeting: ${i}`),this.meetingStatus=a.Left;break;case ea.MeetingSessionStatusCode.AudioJoinedFromAnotherDevice:this.logger.info(`[MeetingManager audioVideoDidStop] Meeting joined from another device: ${i}`),this.meetingStatus=a.JoinedFromAnotherDevice;break;default:e.isFailure()&&!e.isTerminal()?(this.logger.info(`[MeetingManager audioVideoDidStop] Non-Terminal failure occurred: ${i}`),this.meetingStatus=a.Failed):e.isTerminal()?(this.logger.info(`[MeetingManager audioVideoDidStop] Terminal failure occurred: ${i}`),this.meetingStatus=a.TerminalFailure):this.logger.info(`[MeetingManager audioVideoDidStop] session stopped with code ${i}`)}this.publishMeetingStatus(),null===(t=this.audioVideo)||void 0===t||t.removeObserver(this.audioVideoObservers),this.leave()},this.startAudioInputDevice=e=>ev(this,void 0,void 0,function*(){var t;try{yield null===(t=this.audioVideo)||void 0===t?void 0:t.startAudioInput(e),this.selectedAudioInputDevice=e,this.publishSelectedAudioInputDevice()}catch(t){let e=Error("MeetingManager failed to select audio input device.");throw t instanceof Error&&(e.name=t.name,e.message+=" "+t.message),this.logger.error(e.toString()),e}}),this.startAudioOutputDevice=e=>ev(this,void 0,void 0,function*(){var t;try{yield null===(t=this.audioVideo)||void 0===t?void 0:t.chooseAudioOutput(e),this.selectedAudioOutputDevice=e,this.publishSelectedAudioOutputDevice()}catch(e){throw this.logger.error(`MeetingManager failed to select audio output device: ${e}`),Error("MeetingManager failed to select audio output device")}}),this.startVideoInputDevice=e=>ev(this,void 0,void 0,function*(){var t;try{yield null===(t=this.audioVideo)||void 0===t?void 0:t.startVideoInput(e),this.selectedVideoInputDevice=e,this.publishSelectedVideoInputDevice()}catch(t){let e=Error("MeetingManager failed to select video input device.");throw t instanceof Error&&(e.name=t.name,e.message+=" "+t.message),this.logger.error(e.toString()),e}}),this.stopVideoInputDevice=()=>ev(this,void 0,void 0,function*(){var e;try{yield null===(e=this.audioVideo)||void 0===e?void 0:e.stopVideoInput(),this.selectedVideoInputDevice=void 0,this.publishSelectedVideoInputDevice()}catch(e){throw this.logger.error(`MeetingManager failed to unselect video input device: ${e}`),Error("MeetingManager failed to unselect video input device")}}),this.selectVideoInputDevice=e=>{this.selectedVideoInputDevice=e,this.publishSelectedVideoInputDevice()},this.invokeDeviceProvider=e=>{this.setupDeviceLabelTrigger(e),this.publishDeviceLabelTrigger()},this.subscribeToAudioVideo=e=>{this.audioVideoCallbacks.push(e)},this.unsubscribeFromAudioVideo=e=>{this.audioVideoCallbacks=this.audioVideoCallbacks.filter(t=>t!==e)},this.publishAudioVideo=()=>{this.audioVideoCallbacks.forEach(e=>{e(this.audioVideo)})},this.subscribeToActiveSpeaker=e=>{this.activeSpeakerCallbacks.push(e),e(this.activeSpeakers)},this.unsubscribeFromActiveSpeaker=e=>{this.activeSpeakerCallbacks=this.activeSpeakerCallbacks.filter(t=>t!==e)},this.publishActiveSpeaker=()=>{this.activeSpeakerCallbacks.forEach(e=>{e(this.activeSpeakers)})},this.subscribeToSelectedVideoInputDevice=e=>{this.selectedVideoInputDeviceObservers.push(e)},this.unsubscribeFromSelectedVideoInputDevice=e=>{this.selectedVideoInputDeviceObservers=this.selectedVideoInputDeviceObservers.filter(t=>t!==e)},this.publishSelectedVideoInputDevice=()=>{for(let e of this.selectedVideoInputDeviceObservers)e(this.selectedVideoInputDevice)},this.subscribeToSelectedAudioInputDevice=e=>{this.selectedAudioInputDeviceObservers.push(e)},this.unsubscribeFromSelectedAudioInputDevice=e=>{this.selectedAudioInputDeviceObservers=this.selectedAudioInputDeviceObservers.filter(t=>t!==e)},this.publishSelectedAudioInputDevice=()=>{for(let e of this.selectedAudioInputDeviceObservers)e(this.selectedAudioInputDevice)},this.subscribeToSelectedAudioOutputDevice=e=>{this.selectedAudioOutputDeviceObservers.push(e)},this.unsubscribeFromSelectedAudioOutputDevice=e=>{this.selectedAudioOutputDeviceObservers=this.selectedAudioOutputDeviceObservers.filter(t=>t!==e)},this.publishSelectedAudioOutputDevice=()=>{for(let e of this.selectedAudioOutputDeviceObservers)e(this.selectedAudioOutputDevice)},this.subscribeToMeetingStatus=e=>{this.meetingStatusObservers.push(e),e(this.meetingStatus)},this.unsubscribeFromMeetingStatus=e=>{this.meetingStatusObservers=this.meetingStatusObservers.filter(t=>t!==e)},this.publishMeetingStatus=()=>{this.meetingStatusObservers.forEach(e=>{e(this.meetingStatus)})},this.subscribeToDeviceLabelTrigger=e=>{this.deviceLabelTriggerObservers.push(e)},this.unsubscribeFromDeviceLabelTrigger=e=>{this.deviceLabelTriggerObservers=this.deviceLabelTriggerObservers.filter(t=>t!==e)},this.publishDeviceLabelTrigger=()=>{for(let e of this.deviceLabelTriggerObservers)e()},this.subscribeToDeviceLabelTriggerStatus=e=>{this.deviceLabelTriggerStatusObservers.push(e)},this.unsubscribeFromDeviceLabelTriggerStatus=e=>{this.deviceLabelTriggerStatusObservers=this.deviceLabelTriggerStatusObservers.filter(t=>t!==e)},this.publishDeviceLabelTriggerStatus=()=>{for(let e of this.deviceLabelTriggerStatusObservers)e(this.deviceLabelTriggerStatus)},this.subscribeToEventDidReceive=e=>{this.meetingEventObserverSet.add(e)},this.unsubscribeFromEventDidReceive=e=>{this.meetingEventObserverSet.delete(e)},this.publishEventDidReceiveUpdate=(e,t)=>{this.meetingEventObserverSet.forEach(i=>i(e,t))},this.logger=e,this.eventDidReceiveRef={eventDidReceive:(e,t)=>{this.publishEventDidReceiveUpdate(e,t)}}}initializeMeetingManager(){this.meetingSession=null,this.audioVideo=null,this.meetingSessionConfiguration=void 0,this.meetingId=null,this.selectedAudioOutputDevice=null,this.selectedAudioInputDevice=void 0,this.selectedVideoInputDevice=void 0,this.audioInputDevices=[],this.audioOutputDevices=[],this.videoInputDevices=[],this.activeSpeakers=[],this.activeSpeakerListener=null,this.audioVideoObservers={}}join(e,t){return ev(this,void 0,void 0,function*(){let{deviceLabels:i,eventController:r,enableWebAudio:n,activeSpeakerPolicy:o,skipDeviceSelection:s}=this.parseJoinParams(t);this.meetingSessionConfiguration=e,this.meetingId=this.meetingSessionConfiguration.meetingId;let l=new ea.DefaultDeviceController(this.logger,{enableWebAudio:n});this.meetingSession=new ea.DefaultMeetingSession(e,this.logger,l,r),this.audioVideo=this.meetingSession.audioVideo,r?r.addObserver(this.eventDidReceiveRef):this.meetingSession.eventController.addObserver(this.eventDidReceiveRef),this.setupAudioVideoObservers(),this.setupDeviceLabelTrigger(i),s||(this.logger.info("[MeetingManager.join] listing and selecting devices"),yield this.listAndSelectDevices(i)),this.publishAudioVideo(),this.setupActiveSpeakerDetection(o),this.meetingStatus=a.Loading,this.publishMeetingStatus()})}parseJoinParams(e){let t=(null==e?void 0:e.deviceLabels)||d.AudioAndVideo,i=null==e?void 0:e.eventController;return{deviceLabels:t,eventController:i,enableWebAudio:(null==e?void 0:e.enableWebAudio)||!1,activeSpeakerPolicy:(null==e?void 0:e.activeSpeakerPolicy)||new ea.DefaultActiveSpeakerPolicy,skipDeviceSelection:(null==e?void 0:e.skipDeviceSelection)||!1}}start(){var e;return ev(this,void 0,void 0,function*(){null===(e=this.audioVideo)||void 0===e||e.start()})}leave(){var e,t;return ev(this,void 0,void 0,function*(){if(this.audioVideo){this.audioVideo.stopContentShare(),this.audioVideo.stopLocalVideoTile(),this.audioVideo.unbindAudioElement();try{yield null===(e=this.meetingSession)||void 0===e?void 0:e.deviceController.chooseAudioOutput(null),yield null===(t=this.meetingSession)||void 0===t?void 0:t.deviceController.destroy()}catch(e){this.logger.info("MeetingManager failed to clean up media resources on leave")}this.activeSpeakerListener&&this.audioVideo.unsubscribeFromActiveSpeakerDetector(this.activeSpeakerListener),this.audioVideo.stop()}this.initializeMeetingManager(),this.publishAudioVideo(),this.publishActiveSpeaker()})}setupAudioVideoObservers(){this.audioVideo&&(this.audioVideoObservers={audioVideoDidStart:this.audioVideoDidStart,audioVideoDidStartConnecting:this.audioVideoDidStartConnecting,audioVideoDidStop:this.audioVideoDidStop},this.audioVideo.addObserver(this.audioVideoObservers))}updateDeviceLists(){var e,t,i;return ev(this,void 0,void 0,function*(){this.audioInputDevices=(yield null===(e=this.audioVideo)||void 0===e?void 0:e.listAudioInputDevices())||[],this.videoInputDevices=(yield null===(t=this.audioVideo)||void 0===t?void 0:t.listVideoInputDevices())||[],this.audioOutputDevices=(yield null===(i=this.audioVideo)||void 0===i?void 0:i.listAudioOutputDevices())||[]})}setupDeviceLabelTrigger(e=d.AudioAndVideo){var t;let i;if(this.deviceLabels=e,"function"==typeof e)i=e;else if(e===d.None)i=o8;else{let t={};switch(e){case d.Audio:t.audio=!0;break;case d.Video:t.video=!0;break;case d.AudioAndVideo:t.audio=!0,t.video=!0}i=()=>ev(this,void 0,void 0,function*(){this.deviceLabelTriggerStatus=l.IN_PROGRESS,this.publishDeviceLabelTriggerStatus();try{let e=(yield navigator.mediaDevices.enumerateDevices()).some(e=>"videoinput"===e.kind),i=yield navigator.mediaDevices.getUserMedia({audio:t.audio,video:t.video&&e});return this.deviceLabelTriggerStatus=l.GRANTED,this.publishDeviceLabelTriggerStatus(),i}catch(e){throw this.logger.error("MeetingManager failed to get device permissions"),this.deviceLabelTriggerStatus=l.DENIED,this.publishDeviceLabelTriggerStatus(),e}})}null===(t=this.audioVideo)||void 0===t||t.setDeviceLabelTrigger(i)}setupActiveSpeakerDetection(e){var t;this.publishActiveSpeaker(),this.activeSpeakerListener=e=>{this.activeSpeakers=e,this.activeSpeakerCallbacks.forEach(t=>t(e))},null===(t=this.audioVideo)||void 0===t||t.subscribeToActiveSpeakerDetector(e||new ea.DefaultActiveSpeakerPolicy,this.activeSpeakerListener)}listAndSelectDevices(e=d.AudioAndVideo){var t,i;return ev(this,void 0,void 0,function*(){if(yield this.updateDeviceLists(),"function"==typeof e)return;let r=!1,n=!1;switch(e){case d.None:break;case d.Audio:r=!0;break;case d.Video:n=!0;break;case d.AudioAndVideo:r=!0,n=!0}if(r&&!this.selectedAudioInputDevice&&this.audioInputDevices&&this.audioInputDevices.length){this.selectedAudioInputDevice=this.audioInputDevices[0].deviceId;try{yield null===(t=this.audioVideo)||void 0===t?void 0:t.startAudioInput(this.audioInputDevices[0].deviceId)}catch(e){this.logger.error(`MeetingManager failed to select audio input device on join: ${e}`)}this.publishSelectedAudioInputDevice()}if(r&&!this.selectedAudioOutputDevice&&this.audioOutputDevices&&this.audioOutputDevices.length){if(this.selectedAudioOutputDevice=this.audioOutputDevices[0].deviceId,new ea.DefaultBrowserBehavior().supportsSetSinkId())try{yield null===(i=this.audioVideo)||void 0===i?void 0:i.chooseAudioOutput(this.audioOutputDevices[0].deviceId)}catch(e){this.logger.error(`MeetingManager failed to select audio output device on join: ${e}`)}this.publishSelectedAudioOutputDevice()}n&&!this.selectedVideoInputDevice&&this.videoInputDevices&&this.videoInputDevices.length&&(this.selectedVideoInputDevice=this.videoInputDevices[0].deviceId,this.publishSelectedVideoInputDevice())})}}let o9=(0,h.createContext)(null),se=({onDeviceReplacement:e,meetingManager:t,maxContentShares:i,children:r})=>{let n=rg(),[o]=(0,h.useState)(()=>t||new o7(n));return h.createElement(o9.Provider,{value:o},h.createElement(o3,null,h.createElement(sr,null,h.createElement(sp,{onDeviceReplacement:e},h.createElement(o4,null,h.createElement(oH,null,h.createElement(o0,null,h.createElement(oZ,null,h.createElement(oF,{maxContentShares:i},h.createElement(oq,null,r))))))))))},st=()=>{let e=(0,h.useContext)(o9);if(!e)throw Error("useMeetingManager must be used within MeetingProvider");return e},si=(0,h.createContext)(null),sr=({children:e})=>{let t=st(),[i,r]=(0,h.useState)(null);return(0,h.useEffect)(()=>{function e(e){r(e)}return t.subscribeToAudioVideo(e),()=>t.unsubscribeFromAudioVideo(e)},[]),h.createElement(si.Provider,{value:i},e)},sn=()=>(0,h.useContext)(si),so=(0,h.createContext)(null),ss=({children:e,onDeviceReplacement:t})=>{let i=rg(),r=st(),n=sn(),[o,s]=(0,h.useState)([]),[a,l]=(0,h.useState)(r.selectedAudioInputDevice),c=(0,h.useRef)(a);c.current=a;let u=e=>ev(void 0,void 0,void 0,function*(){return t?t(e,r.selectedAudioInputDevice):e});(0,h.useEffect)(()=>(r.subscribeToSelectedAudioInputDevice(l),()=>{r.unsubscribeFromSelectedAudioInputDevice(l)}),[]),(0,h.useEffect)(()=>{let e=!0,t={audioInputsChanged:e=>ev(void 0,void 0,void 0,function*(){if(i.info("AudioInputProvider - audio inputs updated"),r.getDeviceLabels()!==d.Audio&&r.getDeviceLabels()!==d.AudioAndVideo){i.info("Device labels do not allow audio, skipping audio input selection on audioInputsChanged");return}let t=e.some(e=>e.deviceId===c.current),n="default";c.current&&!t&&e.length?(i.info("Previously selected audio input lost. Selecting a default device."),n=e[0].deviceId):"default"===c.current&&i.info('Audio devices updated and "default" device is selected. Reselecting input.');let o=yield u(n);try{yield r.startAudioInputDevice(o)}catch(e){i.error(`Failed to select audio input device on audioInputsChanged: ${e}`)}s(e)})};function o(){return ev(this,void 0,void 0,function*(){if(!n)return;let i=yield n.listAudioInputDevices();e&&(s(i),n.addDeviceChangeObserver(t))})}let a=()=>{o()};return r.subscribeToDeviceLabelTrigger(a),o(),()=>{e=!1,null==n||n.removeDeviceChangeObserver(t),r.unsubscribeFromDeviceLabelTrigger(a)}},[n,t]);let f=(0,h.useMemo)(()=>({devices:o,selectedDevice:a}),[o,a]);return h.createElement(so.Provider,{value:f},e)},sa=()=>{let e=(0,h.useContext)(so);if(!e)throw Error("useAudioInputs must be used within AudioInputProvider");return e},sl=(0,h.createContext)(null),sd=({children:e})=>{let t=rg(),i=sn(),[r,n]=(0,h.useState)([]),o=st(),[s,a]=(0,h.useState)(o.selectedAudioOutputDevice);(0,h.useEffect)(()=>(o.subscribeToSelectedAudioOutputDevice(a),()=>{o.unsubscribeFromSelectedAudioOutputDevice(a)}),[]),(0,h.useEffect)(()=>{let e=!0,r={audioOutputsChanged:e=>{t.info("AudioOutputProvider - audio outputs updated"),n(e)}};function s(){return ev(this,void 0,void 0,function*(){if(!i)return;let t=yield i.listAudioOutputDevices();e&&(n(t),i.addDeviceChangeObserver(r))})}let a=()=>{s()};return o.subscribeToDeviceLabelTrigger(a),s(),()=>{e=!1,null==i||i.removeDeviceChangeObserver(r),o.unsubscribeFromDeviceLabelTrigger(a)}},[i]);let l=(0,h.useMemo)(()=>({devices:r,selectedDevice:s}),[r,s]);return h.createElement(sl.Provider,{value:l},e)},sc=()=>{let e=(0,h.useContext)(sl);if(!e)throw Error("useAudioOutputs must be used within AudioOutputProvider");return e},su=(0,h.createContext)(null),sh=({children:e})=>{let t=rg(),i=sn(),[r,n]=(0,h.useState)([]),o=st(),[s,a]=(0,h.useState)(o.selectedVideoInputDevice);(0,h.useEffect)(()=>(o.subscribeToSelectedVideoInputDevice(a),()=>{o.unsubscribeFromSelectedVideoInputDevice(a)}),[]),(0,h.useEffect)(()=>{let e=!0,r={videoInputsChanged:e=>{t.info("VideoInputProvider - video inputs updated"),n(e)}};function s(){return ev(this,void 0,void 0,function*(){if(!i)return;let t=yield i.listVideoInputDevices();e&&(n(t),i.addDeviceChangeObserver(r))})}let a=()=>{s()};return o.subscribeToDeviceLabelTrigger(a),s(),()=>{e=!1,null==i||i.removeDeviceChangeObserver(r),o.unsubscribeFromDeviceLabelTrigger(a)}},[i]);let l=(0,h.useMemo)(()=>({devices:r,selectedDevice:s}),[r,s]);return h.createElement(su.Provider,{value:l},e)},sf=()=>{let e=(0,h.useContext)(su);if(!e)throw Error("useVideoInputs must be used within VideoInputProvider");return e},sp=({children:e,onDeviceReplacement:t})=>h.createElement(ss,{onDeviceReplacement:t},h.createElement(sd,null,h.createElement(sh,null,e))),sm=(e,t)=>ev(void 0,void 0,void 0,function*(){return(yield sg(e))===t}),sg=e=>ev(void 0,void 0,void 0,function*(){let t;return e?(t=(0,ea.isAudioTransformDevice)(e)||(0,ea.isVideoTransformDevice)(e)?yield e.intrinsicDevice():e,ea.DefaultDeviceController.getIntrinsicDeviceId(t)):""});function sv(e,t){let i=void 0===t;return void 0===e&&i}function sb(e,t){let i=e&&0===Object.keys(e).length,r=t&&0===Object.keys(t).length;return i&&r}let sy=e=>{var{onChange:t,label:i,devices:r,selectedDevice:n,notFoundMsg:o}=e,s=eg(e,["onChange","label","devices","selectedDevice","notFoundMsg"]);let[a,l]=(0,h.useState)("");(0,h.useEffect)(()=>{ev(void 0,void 0,void 0,function*(){l((yield sg(n)))})},[n]);let d=r.map(e=>({value:e.deviceId,label:e.label})),c=d.length?d:[{value:"not-available",label:o}],u=e=>{let i=e.target.value;"not-available"!==i&&t(i)};return h.createElement(r$,Object.assign({field:nl,options:c,onChange:u,value:a,label:i},s))},sS=e=>{var{notFoundMsg:t="No camera devices found",label:i="Camera source"}=e,r=eg(e,["notFoundMsg","label"]);let n=rg(),{devices:o,selectedDevice:s}=sf(),a=st(),l=e=>ev(void 0,void 0,void 0,function*(){try{yield a.startVideoInputDevice(e)}catch(e){n.error("CameraSelection failed to select camera")}});return h.createElement(sy,Object.assign({label:i,onChange:l,devices:o,selectedDevice:s,notFoundMsg:t},r))};function sw(e,t){let i=(0,h.useRef)(),r=i.current,n=t(r,e);return(0,h.useEffect)(()=>{n||(i.current=e)}),n?r:e}let sC=(0,h.createContext)(void 0),sk=({spec:e,options:t,children:i})=>{let r=rg();r=(null==t?void 0:t.logger)||r;let[n,o]=(0,h.useState)(void 0),[s,a]=(0,h.useState)(),l=sw(e,(e,t)=>!!Object.is(e,t)),d=sw(t,(e,t)=>!!(sv(e,t)||sb(e,t))||(null==e?void 0:e.filterCPUUtilization)===(null==t?void 0:t.filterCPUUtilization)&&(null==e?void 0:e.blurStrength)===(null==t?void 0:t.blurStrength)&&(null==e?void 0:e.logger)===(null==t?void 0:t.logger)&&(null==e?void 0:e.reportingPeriodMillis)===(null==t?void 0:t.reportingPeriodMillis));function c(){return ev(this,void 0,void 0,function*(){r.info(`Initializing background blur processor with, spec: ${JSON.stringify(e)}, options: { blurStrength: ${null==t?void 0:t.blurStrength}, filterCPUUtilization: ${null==t?void 0:t.filterCPUUtilization}, reportingPeriodMillis: ${null==t?void 0:t.reportingPeriodMillis} }`);try{let i=yield ea.BackgroundBlurVideoFrameProcessor.create(Object.assign({},e),Object.assign({},t));if(!(i instanceof ea.NoOpVideoFrameProcessor))return r.info("Initialized background blur processor"),a(i),o(!0),i;r.warn("Initialized NoOpVideoFrameProcessor"),a(void 0),o(!1);return}catch(e){r.error(`Error creating a background blur video frame processor device ${e}`),a(void 0),o(!1);return}})}(0,h.useEffect)(()=>(c(),()=>{r.info("Specs or options were changed. Destroying and re-initializing background blur processor."),null==s||s.destroy()}),[d,l]);let u={createBackgroundBlurDevice:e=>ev(void 0,void 0,void 0,function*(){r.info(`Calling createBackgroundBlurDevice with device: ${JSON.stringify(e)}`);let t=yield c();try{if(t)return new ea.DefaultVideoTransformDevice(r,e,[t]);throw Error("Processor has not been created. Background Blur is not supported.")}catch(e){throw Error(`Failed to create a DefaultVideoTransformDevice: ${e}`)}}),isBackgroundBlurSupported:n,backgroundBlurProcessor:s};return h.createElement(sC.Provider,{value:u},i)},sT=()=>{let e=(0,h.useContext)(sC);if(!e)throw Error("useBackgroundBlur must be used within BackgroundBlurProvider");return e},sI=e=>{var{label:t="Blur my background"}=e,i=eg(e,["label"]);let r=rg(),{isBackgroundBlurSupported:n,createBackgroundBlurDevice:o}=sT(),[s,a]=(0,h.useState)(!1),{selectedDevice:l}=sf(),d=st(),c=()=>ev(void 0,void 0,void 0,function*(){if(!s&&l)try{let e;if(a(!0),(0,ea.isVideoTransformDevice)(l))e=yield l.intrinsicDevice(),r.info(`Video filter was turned off - selecting inner device: ${JSON.stringify(e)}`);else{if(!n){r.warn("Background blur processor is not supported yet.");return}e=yield o(l),r.info(`Video filter turned on - selecting video transform device: ${JSON.stringify(e)}`)}yield d.startVideoInputDevice(e)}catch(e){r.error("Failed to toggle Background Blur")}finally{a(!1)}});return h.createElement(r$,Object.assign({field:to,onChange:c,value:"Background Blur",checked:(0,ea.isVideoTransformDevice)(l),label:t},i))};function sE(){let e=sn(),t=rg();return(0,h.useCallback)(i=>{if(e)switch(t.info(`Selecting video quality: ${i}`),i){case"360p":e.chooseVideoInputQuality(640,360,15),e.setVideoMaxBandwidthKbps(600);break;case"540p":e.chooseVideoInputQuality(960,540,15),e.setVideoMaxBandwidthKbps(1400);break;case"720p":e.chooseVideoInputQuality(1280,720,15),e.setVideoMaxBandwidthKbps(1400);break;default:t.warn(`Unsupported video quality: ${i}`)}},[e])}let sA=e=>{var{label:t="Video quality",labelForUnselected:i="Select video quality"}=e,r=eg(e,["label","labelForUnselected"]);let n=sE(),[o,s]=(0,h.useState)("unselected"),a=[{label:i,value:"unselected"},{label:rn,value:"720p"},{label:rr,value:"540p"},{label:ri,value:"360p"}];function l(e){return ev(this,void 0,void 0,function*(){let t=e.target.value;s(t),n(t)})}return h.createElement(r$,Object.assign({field:nl,options:a,onChange:l,value:o,label:t},r))},sM=e=>{var{notFoundMsg:t="No microphone devices found",label:i="Microphone source"}=e,r=eg(e,["notFoundMsg","label"]);let n=rg(),{devices:o,selectedDevice:s}=sa(),a=st(),l=e=>ev(void 0,void 0,void 0,function*(){try{yield a.startAudioInputDevice(e)}catch(e){n.error("MicSelection failed to select mic")}});return h.createElement(sy,Object.assign({label:i,onChange:l,devices:o,selectedDevice:s,notFoundMsg:t},r))},sO=e=>{var{notFoundMsg:t="No speaker devices found",label:i="Speaker source",onChange:r}=e,n=eg(e,["notFoundMsg","label","onChange"]);let o=rg(),{devices:s,selectedDevice:a}=sc(),l=st(),d=e=>ev(void 0,void 0,void 0,function*(){try{yield l.startAudioOutputDevice(e),r&&r(e)}catch(e){o.error("SpeakerSelection failed to select speaker")}});return h.createElement(sy,Object.assign({label:i,devices:s,onChange:d,selectedDevice:a,notFoundMsg:t},n))};function sP(){let e=sn(),[t,i]=(0,h.useState)(()=>(null==e?void 0:e.realtimeIsLocalAudioMuted())||!1);(0,h.useEffect)(()=>{let t=e=>{i(e)};return null==e||e.realtimeSubscribeToMuteAndUnmuteLocalAudio(t),i((null==e?void 0:e.realtimeIsLocalAudioMuted())||!1),()=>{null==e||e.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(t)}},[e]);let r=(0,h.useCallback)(()=>{t?null==e||e.realtimeUnmuteLocalAudio():null==e||e.realtimeMuteLocalAudio()},[t,e]);return{muted:t,toggleMute:r}}let s_=e=>{var{muteLabel:t="Mute",unmuteLabel:i="Unmute",mutedIconTitle:r,unmutedIconTitle:n}=e,o=eg(e,["muteLabel","unmuteLabel","mutedIconTitle","unmutedIconTitle"]);let s=rg(),a=st(),{muted:l,toggleMute:d}=sP(),{devices:c,selectedDevice:u}=sa(),[f,p]=(0,h.useState)([]);return(0,h.useEffect)(()=>{let e=e=>ev(void 0,void 0,void 0,function*(){try{yield a.startAudioInputDevice(e)}catch(e){s.error("AudioInputControl failed to select audio input device")}});ev(void 0,void 0,void 0,function*(){p((yield Promise.all(c.map(t=>ev(void 0,void 0,void 0,function*(){return{children:h.createElement("span",null,t.label),checked:yield sm(u,t.deviceId),onClick:()=>ev(void 0,void 0,void 0,function*(){return yield e(t.deviceId)})}})))))})},[c,u,a,a.startAudioInputDevice]),h.createElement(rO,Object.assign({icon:h.createElement(e6,{muted:l,mutedTitle:r,unmutedTitle:n}),onClick:d,label:l?i:t,popOver:f},o))};var sx=ty(function(e,t){var i=200,r="__lodash_hash_undefined__",n=1,o=2,s=9007199254740991,a="[object Arguments]",l="[object Array]",d="[object AsyncFunction]",c="[object Boolean]",u="[object Date]",h="[object Error]",f="[object Function]",p="[object GeneratorFunction]",m="[object Map]",g="[object Number]",v="[object Null]",b="[object Object]",y="[object Promise]",S="[object Proxy]",w="[object RegExp]",C="[object Set]",k="[object String]",T="[object Symbol]",I="[object Undefined]",E="[object WeakMap]",A="[object ArrayBuffer]",M="[object DataView]",O="[object Float64Array]",P="[object Int8Array]",_="[object Int16Array]",x="[object Int32Array]",R="[object Uint8Array]",D="[object Uint8ClampedArray]",N="[object Uint16Array]",L="[object Uint32Array]",F=/[\\^$.*+?()[\]{}|]/g,V=/^\[object .+?Constructor\]$/,B=/^(?:0|[1-9]\d*)$/,U={};U["[object Float32Array]"]=U[O]=U[P]=U[_]=U[x]=U[R]=U[D]=U[N]=U[L]=!0,U[a]=U[l]=U[A]=U[c]=U[M]=U[u]=U[h]=U[f]=U[m]=U[g]=U[b]=U[w]=U[C]=U[k]=U[E]=!1;var j="object"==typeof tv&&tv&&tv.Object===Object&&tv,$="object"==typeof self&&self&&self.Object===Object&&self,z=j||$||Function("return this")(),H=t&&!t.nodeType&&t,W=H&&e&&!e.nodeType&&e,G=W&&W.exports===H,K=G&&j.process,q=function(){try{return K&&K.binding&&K.binding("util")}catch(e){}}(),J=q&&q.isTypedArray;function Q(e,t){for(var i=-1,r=null==e?0:e.length,n=0,o=[];++i<r;){var s=e[i];t(s,i,e)&&(o[n++]=s)}return o}function Z(e,t){for(var i=-1,r=t.length,n=e.length;++i<r;)e[n+i]=t[i];return e}function X(e,t){for(var i=-1,r=null==e?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}function Y(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}function ee(e){return function(t){return e(t)}}function et(e,t){return e.has(t)}function ei(e,t){return null==e?void 0:e[t]}function er(e){var t=-1,i=Array(e.size);return e.forEach(function(e,r){i[++t]=[r,e]}),i}function en(e,t){return function(i){return e(t(i))}}function eo(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i}var es=Array.prototype,ea=Function.prototype,el=Object.prototype,ed=z["__core-js_shared__"],ec=ea.toString,eu=el.hasOwnProperty,eh=function(){var e=/[^.]+$/.exec(ed&&ed.keys&&ed.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ef=el.toString,ep=RegExp("^"+ec.call(eu).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),em=G?z.Buffer:void 0,eg=z.Symbol,ev=z.Uint8Array,eb=el.propertyIsEnumerable,ey=es.splice,eS=eg?eg.toStringTag:void 0,ew=Object.getOwnPropertySymbols,eC=em?em.isBuffer:void 0,ek=en(Object.keys,Object),eT=tm(z,"DataView"),eI=tm(z,"Map"),eE=tm(z,"Promise"),eA=tm(z,"Set"),eM=tm(z,"WeakMap"),eO=tm(Object,"create"),eP=tI(eT),e_=tI(eI),ex=tI(eE),eR=tI(eA),eD=tI(eM),eN=eg?eg.prototype:void 0,eL=eN?eN.valueOf:void 0;function eF(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function eV(){this.__data__=eO?eO(null):{},this.size=0}function eB(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function eU(e){var t=this.__data__;if(eO){var i=t[e];return i===r?void 0:i}return eu.call(t,e)?t[e]:void 0}function ej(e){var t=this.__data__;return eO?void 0!==t[e]:eu.call(t,e)}function e$(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=eO&&void 0===t?r:t,this}function ez(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function eH(){this.__data__=[],this.size=0}function eW(e){var t=this.__data__,i=tt(t,e);return!(i<0)&&(i==t.length-1?t.pop():ey.call(t,i,1),--this.size,!0)}function eG(e){var t=this.__data__,i=tt(t,e);return i<0?void 0:t[i][1]}function eK(e){return tt(this.__data__,e)>-1}function eq(e,t){var i=this.__data__,r=tt(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this}function eJ(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function eQ(){this.size=0,this.__data__={hash:new eF,map:new(eI||ez),string:new eF}}function eZ(e){var t=tp(this,e).delete(e);return this.size-=t?1:0,t}function eX(e){return tp(this,e).get(e)}function eY(e){return tp(this,e).has(e)}function e0(e,t){var i=tp(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this}function e1(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new eJ;++t<i;)this.add(e[t])}function e2(e){return this.__data__.set(e,r),this}function e3(e){return this.__data__.has(e)}function e5(e){var t=this.__data__=new ez(e);this.size=t.size}function e4(){this.__data__=new ez,this.size=0}function e6(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function e8(e){return this.__data__.get(e)}function e7(e){return this.__data__.has(e)}function e9(e,t){var r=this.__data__;if(r instanceof ez){var n=r.__data__;if(!eI||n.length<i-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new eJ(n)}return r.set(e,t),this.size=r.size,this}function te(e,t){var i=tM(e),r=!i&&tA(e),n=!i&&!r&&tP(e),o=!i&&!r&&!n&&tL(e),s=i||r||n||o,a=s?Y(e.length,String):[],l=a.length;for(var d in e)(t||eu.call(e,d))&&!(s&&("length"==d||n&&("offset"==d||"parent"==d)||o&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||tS(d,l)))&&a.push(d);return a}function tt(e,t){for(var i=e.length;i--;)if(tE(e[i][0],t))return i;return -1}function ti(e,t,i){var r=t(e);return tM(e)?r:Z(r,i(e))}function tr(e){return null==e?void 0===e?I:v:eS&&eS in Object(e)?tg(e):tT(e)}function tn(e){return tN(e)&&tr(e)==a}function to(e,t,i,r,n){return e===t||(null!=e&&null!=t&&(tN(e)||tN(t))?ts(e,t,i,r,to,n):e!=e&&t!=t)}function ts(e,t,i,r,o,s){var d=tM(e),c=tM(t),u=d?l:ty(e),h=c?l:ty(t);u=u==a?b:u,h=h==a?b:h;var f=u==b,p=h==b,m=u==h;if(m&&tP(e)){if(!tP(t))return!1;d=!0,f=!1}if(m&&!f)return s||(s=new e5),d||tL(e)?tc(e,t,i,r,o,s):tu(e,t,u,i,r,o,s);if(!(i&n)){var g=f&&eu.call(e,"__wrapped__"),v=p&&eu.call(t,"__wrapped__");if(g||v){var y=g?e.value():e,S=v?t.value():t;return s||(s=new e5),o(y,S,i,r,s)}}return!!m&&(s||(s=new e5),th(e,t,i,r,o,s))}function ta(e){return!(!tD(e)||tC(e))&&(tx(e)?ep:V).test(tI(e))}function tl(e){return tN(e)&&tR(e.length)&&!!U[tr(e)]}function td(e){if(!tk(e))return ek(e);var t=[];for(var i in Object(e))eu.call(e,i)&&"constructor"!=i&&t.push(i);return t}function tc(e,t,i,r,s,a){var l=i&n,d=e.length,c=t.length;if(d!=c&&!(l&&c>d))return!1;var u=a.get(e);if(u&&a.get(t))return u==t;var h=-1,f=!0,p=i&o?new e1:void 0;for(a.set(e,t),a.set(t,e);++h<d;){var m=e[h],g=t[h];if(r)var v=l?r(g,m,h,t,e,a):r(m,g,h,e,t,a);if(void 0!==v){if(v)continue;f=!1;break}if(p){if(!X(t,function(e,t){if(!et(p,t)&&(m===e||s(m,e,i,r,a)))return p.push(t)})){f=!1;break}}else if(!(m===g||s(m,g,i,r,a))){f=!1;break}}return a.delete(e),a.delete(t),f}function tu(e,t,i,r,s,a,l){switch(i){case M:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case A:if(e.byteLength!=t.byteLength||!a(new ev(e),new ev(t)))break;return!0;case c:case u:case g:return tE(+e,+t);case h:return e.name==t.name&&e.message==t.message;case w:case k:return e==t+"";case m:var d=er;case C:var f=r&n;if(d||(d=eo),e.size!=t.size&&!f)break;var p=l.get(e);if(p)return p==t;r|=o,l.set(e,t);var v=tc(d(e),d(t),r,s,a,l);return l.delete(e),v;case T:if(eL)return eL.call(e)==eL.call(t)}return!1}function th(e,t,i,r,o,s){var a=i&n,l=tf(e),d=l.length;if(d!=tf(t).length&&!a)return!1;for(var c=d;c--;){var u=l[c];if(!(a?u in t:eu.call(t,u)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var f=!0;s.set(e,t),s.set(t,e);for(var p=a;++c<d;){var m=e[u=l[c]],g=t[u];if(r)var v=a?r(g,m,u,t,e,s):r(m,g,u,e,t,s);if(!(void 0===v?m===g||o(m,g,i,r,s):v)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var b=e.constructor,y=t.constructor;b!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y)&&(f=!1)}return s.delete(e),s.delete(t),f}function tf(e){return ti(e,tF,tb)}function tp(e,t){var i=e.__data__;return tw(t)?i["string"==typeof t?"string":"hash"]:i.map}function tm(e,t){var i=ei(e,t);return ta(i)?i:void 0}function tg(e){var t=eu.call(e,eS),i=e[eS];try{e[eS]=void 0;var r=!0}catch(e){}var n=ef.call(e);return r&&(t?e[eS]=i:delete e[eS]),n}eF.prototype.clear=eV,eF.prototype.delete=eB,eF.prototype.get=eU,eF.prototype.has=ej,eF.prototype.set=e$,ez.prototype.clear=eH,ez.prototype.delete=eW,ez.prototype.get=eG,ez.prototype.has=eK,ez.prototype.set=eq,eJ.prototype.clear=eQ,eJ.prototype.delete=eZ,eJ.prototype.get=eX,eJ.prototype.has=eY,eJ.prototype.set=e0,e1.prototype.add=e1.prototype.push=e2,e1.prototype.has=e3,e5.prototype.clear=e4,e5.prototype.delete=e6,e5.prototype.get=e8,e5.prototype.has=e7,e5.prototype.set=e9;var tb=ew?function(e){return null==e?[]:Q(ew(e=Object(e)),function(t){return eb.call(e,t)})}:tV,ty=tr;function tS(e,t){return!!(t=null==t?s:t)&&("number"==typeof e||B.test(e))&&e>-1&&e%1==0&&e<t}function tw(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function tC(e){return!!eh&&eh in e}function tk(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||el)}function tT(e){return ef.call(e)}function tI(e){if(null!=e){try{return ec.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function tE(e,t){return e===t||e!=e&&t!=t}(eT&&ty(new eT(new ArrayBuffer(1)))!=M||eI&&ty(new eI)!=m||eE&&ty(eE.resolve())!=y||eA&&ty(new eA)!=C||eM&&ty(new eM)!=E)&&(ty=function(e){var t=tr(e),i=t==b?e.constructor:void 0,r=i?tI(i):"";if(r)switch(r){case eP:return M;case e_:return m;case ex:return y;case eR:return C;case eD:return E}return t});var tA=tn(function(){return arguments}())?tn:function(e){return tN(e)&&eu.call(e,"callee")&&!eb.call(e,"callee")},tM=Array.isArray;function tO(e){return null!=e&&tR(e.length)&&!tx(e)}var tP=eC||tB;function t_(e,t){return to(e,t)}function tx(e){if(!tD(e))return!1;var t=tr(e);return t==f||t==p||t==d||t==S}function tR(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function tD(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function tN(e){return null!=e&&"object"==typeof e}var tL=J?ee(J):tl;function tF(e){return tO(e)?te(e):td(e)}function tV(){return[]}function tB(){return!1}e.exports=t_});let sR=(0,h.createContext)(null),sD=({spec:e,options:t,createMeetingResponse:i,children:r})=>{let n;let o=rg(),[s,a]=(0,h.useState)(void 0),[l,d]=(0,h.useState)(null),[c,u]=(0,h.useState)(null),f=sw(e,(e,t)=>{if(Object.is(e,t)||JSON.stringify(e)===JSON.stringify(t))return!0;let i=void 0===e||e&&0===Object.keys(e).length,r=void 0===t||t&&0===Object.keys(t).length;return!!i&&!!r}),p=e=>ev(void 0,void 0,void 0,function*(){if(o.info(`Add Amazon Voice Focus to the following audio input device ${e}`),!s)return o.debug("Not supported, not creating device."),e;try{let t=yield m(),i=yield null==t?void 0:t.createTransformDevice(e);if(i)return o.info("Created a new Amazon Voice Focus transform device."),d(i),i}catch(e){o.error(`Amazon Voice Focus is not supported. ${e}`)}return e});function m(){return ev(this,void 0,void 0,function*(){return c||n})}function g(e,t,i,r){return ev(this,void 0,void 0,function*(){let o=ea.VoiceFocusDeviceTransformer.create(e,t,void 0,r);return o.then(e=>{i()||(n=void 0,u(e),d(null),a(e&&e.isSupported()))}).catch(()=>{i()||(n=void 0,u(null),d(null),a(!1))}),n=o})}function v(e,t,i,r){return ev(this,void 0,void 0,function*(){null==l||l.stop(),c&&ea.VoiceFocusDeviceTransformer.destroyVoiceFocus(c),u(null),d(null),g(e,t,i,r)})}(0,h.useEffect)(()=>{let e=!1;return i&&v(f,t,()=>e,i),()=>{e=!0}},[f,t,i]),(0,h.useEffect)(()=>{void 0!==s&&(s?o.info("Amazon Voice Focus is supported."):o.warn("Amazon Voice Focus is not supported."))},[s]),(0,h.useEffect)(()=>(l&&o.info(`Current Amazon Voice Focus transform device: ${l}`),()=>{l?(o.info("Destroying voice focus device : "+JSON.stringify(l)),null==l||l.stop()):o.info("Voice focus device doesn't exist")}),[l]),(0,h.useEffect)(()=>()=>{c?(ea.VoiceFocusDeviceTransformer.destroyVoiceFocus(c),o.info("Destroying voice focus transformer : "+JSON.stringify(c))):o.info("VoiceFocusTransformer doesn't exist")},[c]);let b={isVoiceFocusSupported:s,addVoiceFocus:p};return h.createElement(sR.Provider,{value:b},r)},sN=()=>{let e=(0,h.useContext)(sR);if(!e)throw Error("useVoiceFocus must be used within VoiceFocusProvider");return e},sL=e=>{var{muteLabel:t="Mute",unmuteLabel:i="Unmute",mutedIconTitle:r,unmutedIconTitle:n,voiceFocusOnLabel:o="Amazon Voice Focus enabled",voiceFocusOffLabel:s="Enable Amazon Voice Focus"}=e,a=eg(e,["muteLabel","unmuteLabel","mutedIconTitle","unmutedIconTitle","voiceFocusOnLabel","voiceFocusOffLabel"]);let l=rg(),d=sn(),c=st(),[u,f]=(0,h.useState)(!1),[p,m]=(0,h.useState)(!1),[g,v]=(0,h.useState)(!1),[b,y]=(0,h.useState)(null),{muted:S,toggleMute:w}=sP(),{isVoiceFocusSupported:C,addVoiceFocus:k}=sN(),{devices:T,selectedDevice:I}=sa(),E=sw(T,(e,t)=>sx(e,t));return(0,h.useEffect)(()=>{l.info(`Amazon Voice Focus is ${g?"enabled":"disabled"}.`)},[g]),(0,h.useEffect)(()=>(I instanceof ea.VoiceFocusTransformDevice?v(!0):v(!1),()=>{I instanceof ea.VoiceFocusTransformDevice&&I.stop()}),[I]),(0,h.useEffect)(()=>{d&&I instanceof ea.VoiceFocusTransformDevice&&g&&I.observeMeetingAudio(d)},[d,g,I]),(0,h.useEffect)(()=>{let e=e=>ev(void 0,void 0,void 0,function*(){try{if(p&&!u){f(!0);let t=e,i=yield k(t);yield c.startAudioInputDevice(i)}else yield c.startAudioInputDevice(e)}catch(e){l.error("AudioInputVFControl failed to select audio input device")}finally{f(!1)}});ev(void 0,void 0,void 0,function*(){let t=yield Promise.all(E.map(t=>ev(void 0,void 0,void 0,function*(){return h.createElement(rf,{key:t.deviceId,checked:yield sm(I,t.deviceId),onClick:()=>ev(void 0,void 0,void 0,function*(){return yield e(t.deviceId)})},h.createElement("span",null,t.label))})));if(C){let e=h.createElement(rf,{key:"voicefocus",checked:g,disabled:u,onClick:()=>{f(!0),m(e=>!e)}},h.createElement(h.Fragment,null,u&&h.createElement(tt,{width:"1.5rem",height:"1.5rem"}),g?o:s));null==t||t.push(h.createElement(r7,{key:"separator"})),null==t||t.push(e)}y(t)})},[k,c,c.startAudioInputDevice,E,u,g,p,C,I]),(0,h.useEffect)(()=>{ev(void 0,void 0,void 0,function*(){if(I){try{let e=I;p?(l.info("User turned on Amazon Voice Focus."),"string"==typeof I&&(e=yield k(I))):(l.info("Amazon Voice Focus is off by default or user turned off Amazon Voice Focus."),I instanceof ea.VoiceFocusTransformDevice&&(e=I.getInnerDevice())),yield c.startAudioInputDevice(e)}catch(e){l.error("AudioInputVFControl failed to select audio input device onVFCheckboxChange change")}f(!1)}})},[p]),h.createElement(rO,Object.assign({icon:h.createElement(e6,{muted:S,mutedTitle:r,unmutedTitle:n}),onClick:w,label:S?i:t},a),b)},sF=e=>{var{label:t="Speaker"}=e,i=eg(e,["label"]);let r=rg(),n=st(),{devices:o,selectedDevice:s}=sc(),{isAudioOn:a,toggleAudio:l}=oX(),[d,c]=(0,h.useState)([]);return(0,h.useEffect)(()=>{let e=e=>ev(void 0,void 0,void 0,function*(){try{new ea.DefaultBrowserBehavior().supportsSetSinkId()?yield n.startAudioOutputDevice(e):r.error("AudioOutputControl cannot select audio output device because browser does not support setSinkId operation.")}catch(e){r.error("AudioOutputControl failed to select audio output device")}});ev(void 0,void 0,void 0,function*(){c((yield Promise.all(o.map(t=>ev(void 0,void 0,void 0,function*(){return{children:h.createElement("span",null,t.label),checked:yield sm(s,t.deviceId),onClick:()=>ev(void 0,void 0,void 0,function*(){return yield e(t.deviceId)})}})))))})},[o,s,n,n.startAudioOutputDevice]),h.createElement(h.Fragment,null,h.createElement(rO,Object.assign({icon:h.createElement(te,{disabled:!a}),onClick:l,label:t,popOver:d.length?d:null},i)))},sV=e=>{var{label:t="Content",pauseLabel:i="Pause",unpauseLabel:r="Unpause",iconTitle:n}=e,o=eg(e,["label","pauseLabel","unpauseLabel","iconTitle"]);let{isLocalUserSharing:s}=oV(),{paused:a,toggleContentShare:l,togglePauseContentShare:d}=oB(),c=[{children:h.createElement("span",null,a?r:i),onClick:d}];return h.createElement(h.Fragment,null,h.createElement(rO,Object.assign({icon:h.createElement(e0,{title:n}),onClick:l,label:t,popOver:s?c:null},o)))},sB=e=>{var{label:t="Video",backgroundBlurLabel:i="Enable Background Blur"}=e,r=eg(e,["label","backgroundBlurLabel"]);let n=rg(),o=st(),{devices:s,selectedDevice:a}=sf(),{isVideoEnabled:l,toggleVideo:d}=o1(),{isBackgroundBlurSupported:c,createBackgroundBlurDevice:u}=sT(),[f,p]=(0,h.useState)(!1),[m,g]=(0,h.useState)(null),v=sw(s,(e,t)=>sx(e,t)),b=()=>ev(void 0,void 0,void 0,function*(){if(!f&&a)try{let e;p(!0),(0,ea.isVideoTransformDevice)(a)?(e=yield a.intrinsicDevice(),n.info(`Video filter was turned off - selecting inner device: ${JSON.stringify(e)}`)):(e=yield u(a),n.info(`Video filter turned on - selecting video transform device: ${JSON.stringify(e)}`)),yield o.startVideoInputDevice(e)}catch(e){n.error("Failed to toggle Background Blur")}finally{p(!1)}});return(0,h.useEffect)(()=>{let e=e=>ev(void 0,void 0,void 0,function*(){try{let t=e;(0,ea.isVideoTransformDevice)(a)&&!f&&(p(!0),"chooseNewInnerDevice"in a?t=a.chooseNewInnerDevice(e):n.error("Transform device cannot choose new inner device")),l?yield o.startVideoInputDevice(t):o.selectVideoInputDevice(t)}catch(e){n.error("Failed to select video input device")}finally{p(!1)}});ev(void 0,void 0,void 0,function*(){let t=yield Promise.all(v.map(t=>ev(void 0,void 0,void 0,function*(){return h.createElement(rf,{key:t.deviceId,checked:yield sm(a,t.deviceId),onClick:()=>ev(void 0,void 0,void 0,function*(){return e(t.deviceId)})},h.createElement("span",null,t.label))})));if(c){let e=h.createElement(rf,{key:"videoinput",checked:(0,ea.isVideoTransformDevice)(a),disabled:f,onClick:b},h.createElement(h.Fragment,null,f&&h.createElement(tt,{width:"1.5rem",height:"1.5rem"}),i));t.push(h.createElement(r7,{key:"separator"})),t.push(e)}g(t)})},[u,o,o.startVideoInputDevice,v,f,l,a,c]),h.createElement(rO,Object.assign({icon:h.createElement(e$,{disabled:!l}),onClick:d,label:t},r),m)},sU=e=>{var{label:t="Video"}=e,i=eg(e,["label"]);let r=rg(),n=st(),{devices:o,selectedDevice:s}=sf(),{isVideoEnabled:a,toggleVideo:l}=o1(),[d,c]=(0,h.useState)([]);return(0,h.useEffect)(()=>{let e=e=>ev(void 0,void 0,void 0,function*(){try{a?yield n.startVideoInputDevice(e):n.selectVideoInputDevice(e)}catch(e){r.error("VideoInputControl failed to select video input device")}});ev(void 0,void 0,void 0,function*(){c((yield Promise.all(o.map(t=>ev(void 0,void 0,void 0,function*(){return{children:h.createElement("span",null,t.label),checked:yield sm(s,t.deviceId),onClick:()=>ev(void 0,void 0,void 0,function*(){return yield e(t.deviceId)})}})))))})},[o,s,a,n,n.startVideoInputDevice]),h.createElement(rO,Object.assign({icon:h.createElement(e$,{disabled:!a}),onClick:l,label:t,popOver:d},i))},sj=(0,f.ZP)(nY)`
  background-color: ${({theme:e})=>e.colors.greys.grey80};
`,s$=e=>{var{className:t,tileId:i}=e,r=eg(e,["className","tileId"]);let n=sn(),o=oV(),s=void 0!==i?i:o.tileId,a=s?o.tileIdToAttendeeId[s.toString()]:null,l=(0,h.useRef)(null);return(0,h.useEffect)(()=>{if(n&&l.current&&s)return n.bindVideoElement(s,l.current),()=>{n.getVideoTile(s)&&n.unbindVideoElement(s)}},[n,s]),s?h.createElement(sj,Object.assign({objectFit:"contain",className:`ch-content-share--${s} ${t||""}`},r,{ref:l,"data-content-share-attendee":a})):null};function sz(e){(0,h.useEffect)(()=>{var t;function i(){if(!e.current)return;let t=e.current.videoHeight,i=e.current.videoWidth;e.current.style.objectFit=t>i?"contain":"cover"}return null===(t=e.current)||void 0===t||t.addEventListener("loadedmetadata",i),()=>{var t;return null===(t=e.current)||void 0===t?void 0:t.removeEventListener("loadedmetadata",i)}},[e])}let sH=(0,f.ZP)(nY)`
  ${e=>e.active?"":"display: none"};
`,sW=e=>{var{nameplate:t}=e,i=eg(e,["nameplate"]);let{tileId:r,isVideoEnabled:n}=o1(),o=sn(),s=(0,h.useRef)(null);return sz(s),(0,h.useEffect)(()=>{if(o&&r&&s.current&&n)return o.bindVideoElement(r,s.current),()=>{o.getVideoTile(r)&&o.unbindVideoElement(r)}},[o,r,n]),h.createElement(sH,Object.assign({active:n,nameplate:t,ref:s},i))},sG=(0,f.ZP)(nY)`
  height: auto;
  background: unset;

  video {
    position: static;
  }
`,sK=e=>{let t=rg(),i=sn(),{selectedDevice:r}=sf(),n=(0,h.useRef)(null),o=st(),{setIsVideoEnabled:s}=o1();return(0,h.useEffect)(()=>{let e=n.current;return()=>{e&&(null==i||i.stopVideoPreviewForVideoInput(e),null==i||i.stopVideoInput(),s(!1))}},[i]),(0,h.useEffect)(()=>{(function(){ev(this,void 0,void 0,function*(){if(i&&r&&n.current)try{yield o.startVideoInputDevice(r),i.startVideoPreviewForVideoInput(n.current),s(!0)}catch(e){t.error("Failed to start video preview")}})})()},[i,r]),h.createElement(sG,Object.assign({},e,{ref:n}))},sq=e=>{var{name:t,className:i,tileId:r}=e,n=eg(e,["name","className","tileId"]);let o=sn(),s=(0,h.useRef)(null);return sz(s),(0,h.useEffect)(()=>{if(o&&s.current)return o.bindVideoElement(r,s.current),()=>{o.getVideoTile(r)&&o.unbindVideoElement(r)}},[o,r]),h.createElement(nY,Object.assign({},n,{ref:s,nameplate:t,className:`ch-remote-video--${r} ${i||""}`}))},sJ=e=>{let{roster:t}=o6(),{tiles:i,tileIdToAttendeeId:r}=oW();return h.createElement(h.Fragment,null,i.map(i=>{let{name:n}=t[r[i]]||{};return h.createElement(sq,Object.assign({},e,{key:i,tileId:i,name:n}))}))};(0,h.memo)(sJ);let sQ=e=>{let t=nZ(),{roster:i}=o6(),{tileId:r}=oJ(),{tiles:n}=oV(),{tiles:o,tileIdToAttendeeId:s}=oW();return h.createElement(h.Fragment,null,o.map(o=>{let a=!(n.length>0)&&r===o,l=t&&a?"grid-area: ft;":"",d=`${a?"ch-featured-tile":""} ${e.className||""}`,{name:c}=i[s[o]]||{};return h.createElement(sq,Object.assign({tileId:o,name:c},e,{className:d,key:o,css:l}))}))};(0,h.memo)(sQ);let sZ=`
  height: 100%;
  width: 100%;
`,sX=`
  display: flex;
  position: absolute;
  bottom: 1rem;
  right: 1rem;
  width: 20vw;
  max-height: 30vh;
  height: auto;

  video {
    position: static;
  }
`,sY=e=>{var{noRemoteVideoView:t,layout:i="featured"}=e,r=eg(e,["noRemoteVideoView","layout"]);let{tileId:n}=oJ(),{tiles:o}=oW(),{tiles:s}=oV(),{isVideoEnabled:a}=o1(),l=s.length>0,d=l?1:0,c=o.length+d,u=c>1&&a?c+1:c,f="featured"===i&&!!n||l;return h.createElement(nQ,Object.assign({},r,{size:u,layout:f?"featured":null}),h.createElement(s$,{css:"grid-area: ft;"}),"featured"===i?h.createElement(sQ,null):h.createElement(sJ,null),h.createElement(sW,{nameplate:"Me",css:u>1?sZ:sX}),0===c&&t)};function s0(e){let t=sn(),[i,r]=(0,h.useState)(!1),[n,o]=(0,h.useState)(1);return(0,h.useEffect)(()=>{if(!t)return;let i=(e,t,i,n)=>{null!==i&&r(i),null!==n&&o(n)};return t.realtimeSubscribeToVolumeIndicator(e,i),()=>t.realtimeUnsubscribeFromVolumeIndicator(e,i)},[t,e]),{muted:i,signalStrength:n}}let s1=f.ZP.div.withConfig(eI)`
  position: relative;
  height: inherit;
  line-height: 0;

  .ch-mic-icon {
    position: relative;
    z-index: 2;
    width: 100%;
  }

  .ch-bg-volume-wrapper {
    position: absolute;
    bottom: 41%;
    left: 40%;
    height: 38%;
    width: 21%;
    border-radius: 20%;
    overflow: hidden;
  }

  .ch-bg-volume-fill {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    transform-origin: bottom;
    will-change: transform;
    background-color: ${e=>e.signalStrength&&e.signalStrength<=.5?e.theme.colors.error.light:e.theme.colors.primary.light};
  }

  ${eA}
  ${eE}
`,s2=(0,h.forwardRef)((e,t)=>{var{muted:i=!1,signalStrength:r,className:n}=e,o=eg(e,["muted","signalStrength","className"]);let s=void 0!==r&&r<=.5,a=n?`${n} ch-mic-volume-indicator`:"ch-mic-volume-indicator";return h.createElement(s1,Object.assign({className:a,signalStrength:r,muted:i},o),h.createElement(e6,{muted:i,className:"ch-mic-icon",poorConnection:s}),h.createElement("div",{className:"ch-bg-volume-wrapper"},h.createElement("div",{ref:t,className:"ch-bg-volume-fill","data-testid":"volume-fill"})))}),s3=e=>{var{attendeeId:t}=e,i=eg(e,["attendeeId"]);let r=sn(),n=(0,h.useRef)(null),{signalStrength:o,muted:s}=s0(t);return(0,h.useEffect)(()=>{if(!r||!t||!n.current)return;let e=(e,t,i,r)=>{n.current&&(n.current.style.transform=`scaleY(${t})`)};return r.realtimeSubscribeToVolumeIndicator(t,e),()=>r.realtimeUnsubscribeFromVolumeIndicator(t,e)},[t]),h.createElement(s2,Object.assign({},i,{ref:n,muted:s,signalStrength:o}))};function s5(e){let t=sn(),i=s0(e),[r,n]=(0,h.useState)(()=>{var i,r,n;if(!t)return null;let o=e===(null===(n=null===(r=null===(i=t.audioVideoController)||void 0===i?void 0:i.realtimeController)||void 0===r?void 0:r.state)||void 0===n?void 0:n.localAttendeeId),s=t.getAllVideoTiles().find(t=>{let i=t.state();return!i.isContent&&(!o||!!i.active)&&i.boundAttendeeId===e});return s?s.state().tileId:null}),[o,s]=(0,h.useState)(()=>{if(!t)return null;let i=t.getAllVideoTiles().find(t=>{let i=t.state();return!!i.boundAttendeeId&&!!i.isContent&&new ea.DefaultModality(i.boundAttendeeId).base()===e});return i?i.state().tileId:null});(0,h.useEffect)(()=>{if(!t)return;let i={videoTileDidUpdate:t=>{if(t.boundAttendeeId===e){if(t.localTile&&r&&!t.boundVideoStream){n(null);return}r||!t.tileId||t.isContent||n(t.tileId)}},videoTileWasRemoved:e=>{e===r&&n(null)}};return t.addObserver(i),()=>t.removeObserver(i)},[t,r,e]),(0,h.useEffect)(()=>{if(!t)return;let i={videoTileDidUpdate:t=>{t.isContent&&t.boundAttendeeId&&!o&&new ea.DefaultModality(t.boundAttendeeId).base()===e&&s(t.tileId)},videoTileWasRemoved:e=>{e===o&&s(null)}};return t.addObserver(i),()=>t.removeObserver(i)},[t,o,e]);let a="number"==typeof r&&r>-1,l="number"==typeof o&&o>-1;return Object.assign(Object.assign({},i),{videoEnabled:a,sharingContent:l})}let s4=e=>{var t,{attendeeId:i}=e,r=eg(e,["attendeeId"]);let{muted:n,videoEnabled:o,sharingContent:s}=s5(i),{roster:a}=o6(),l=(null===(t=a[i])||void 0===t?void 0:t.name)||"";return h.createElement(os,Object.assign({name:l,muted:n,videoEnabled:o,sharingContent:s,microphone:h.createElement(s3,{attendeeId:i})},r))};(0,h.createContext)(void 0);let s6={body:"'Ember', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;",monospace:"Menlo, monospace"},s8={default:"0.25rem",circle:"50%"},s7={navigation:10,controlBar:15,modal:20,popOver:30,notificationGroup:40},s9=["20rem","35.5rem","48rem","64rem","90rem"];s9.xs=s9[0],s9.sm=s9[1],s9.md=s9[2],s9.lg=s9[3],s9.xl=s9[4];let ae={min:{xs:`@media screen and (min-width: ${s9.xs})`,sm:`@media screen and (min-width: ${s9.sm})`,md:`@media screen and (min-width: ${s9.md})`,lg:`@media screen and (min-width: ${s9.lg})`,xl:`@media screen and (min-width: ${s9.xl})`},max:{xs:`@media screen and (max-width: ${s9.xs})`,sm:`@media screen and (max-width: ${s9.sm})`,md:`@media screen and (max-width: ${s9.md})`,lg:`@media screen and (max-width: ${s9.lg})`,xl:`@media screen and (max-width: ${s9.xl})`}},at={breakpoints:s9,mediaQueries:ae,fonts:s6,fontSizes:{baseFontSize:"16px",fontWeight:"normal",h1:{fontSize:"5.3rem",fontWeight:"normal",lineHeight:"5.625rem",mobile:{fontSize:"3.8125rem",fontWeight:"normal",lineHeight:"5.625rem"}},h2:{fontSize:"3.925rem",fontWeight:"normal",lineHeight:"3.75rem",mobile:{fontSize:"3.05rem",fontWeight:"normal",lineHeight:"4.5rem"}},h3:{fontSize:"2.44125rem",fontWeight:"normal",lineHeight:"3.75rem",mobile:{fontSize:"2.90625rem",fontWeight:"normal",lineHeight:"3rem"}},h4:{fontSize:"1.953125rem",fontWeight:"normal",lineHeight:"3.75rem",mobile:{fontSize:"2.15rem",fontWeight:"normal",lineHeight:"3rem"}},h5:{fontSize:"1.5625rem",fontWeight:"normal",lineHeight:"3rem",mobile:{fontSize:"1.59375rem",fontWeight:"normal",lineHeight:"1.875rem"}},h6:{fontSize:"1.25rem",fontWeight:"normal",lineHeight:"1.875rem",mobile:{fontSize:"1.18125rem",fontWeight:"normal",lineHeight:"1.5rem"}},text:{fontSize:"0.875rem",lineHeight:"1.43"},label:{fontSize:"0.875rem",lineHeight:"1.43"},small:{fontSize:"0.75rem",lineHeight:"1.43"},footnote:{fontSize:"0.65rem",lineHeight:"1rem"}},radii:s8,zIndex:s7,modalSizes:{md:{width:"35rem",height:"94vh"},lg:{width:"50rem",height:"94vh"},fullscreen:{width:"98vw",height:"96vh"}},iconButtonSizes:{sm:"1.5rem",md:"2.5rem",lg:"4rem"}},ai={primary:{lightest:"#88b2ff",lighter:"#5d96ff",light:"#327aff",main:"#075fff",dark:"#004ddb",darker:"#0042bb",darkest:"#002f85"},secondary:{light:"#ff8e74",main:"#ff7654",dark:"#e86c4d"},error:{lightest:"#FCF7F6",lighter:"#F5DDD5",light:"#FF927C",primary:"#C52000",dark:"#9E3319",darker:"#89301A",darkest:"#791800"},success:{lightest:"#EBF1EA",lighter:"#CEE0C8",light:"#50CD49",primary:"#067000",dark:"#305D1D",darker:"#2C511D",darkest:"#184206"},info:{lightest:"#DADFE7",lighter:"#C4CCD9",light:"#418AFD",primary:"#2555A0",dark:"#264A82",darker:"#243F6B",darkest:"#123366"},warning:{lightest:"#FAF8EA",lighter:"#F7E79E",light:"#F9DC60",primary:"#F9CC09",dark:"#665A2A",darker:"#584E26",darkest:"#534201"},greys:{black:"#000000",grey100:"#1b1c20",grey90:"#2e2f34",grey80:"#3f4149",grey70:"#50545e",grey60:"#616672",grey50:"#7d818b",grey40:"#989da5",grey30:"#d4d5d8",grey20:"#e4e9f2",grey10:"#f0f1f2",white:"#ffffff"}},ar={bgd:ai.greys.white,text:ai.greys.grey80,fontSize:at.fontSizes.baseFontSize},an={none:"none",small:`0 0.09375rem 0.0625rem 0 ${eT(ai.greys.grey100,.15)}`,medium:`0 0.5rem 0.85rem 0 ${eT(ai.greys.black,.15)}`,large:`0 0.75rem 1.875rem 0 ${eT(ai.greys.black,.15)}`},ao={primary:{shadow:an.none,static:{bgd:ai.primary.light,border:`0.03125rem solid ${ai.primary.darker}`,text:ai.greys.white,shadow:"none"},hover:{bgd:ai.primary.dark,border:`0.03125rem solid ${ai.primary.darkest}`,text:ai.greys.white,shadow:"none"},focus:{bgd:ai.primary.dark,border:`0.03125rem solid ${ai.primary.darker}`,text:ai.greys.white,shadow:`0 0 0 0.25rem ${ai.primary.lightest}`},active:{bgd:ai.primary.darker,border:`0.03125rem solid ${ai.greys.black}`,text:ai.greys.white,shadow:`0 0 0 0.25rem ${ai.primary.lightest}`},selected:{bgd:ai.primary.light,border:`0.03125rem solid ${ai.primary.dark}`,text:ai.greys.white,shadow:"none"},disabled:{bgd:ai.greys.white,border:`0.03125rem solid ${ai.greys.grey10}`,text:ai.greys.grey40,shadow:"none"}},secondary:{shadow:an.none,static:{bgd:ai.greys.white,border:`0.03125rem solid ${ai.greys.grey30}`,text:ai.greys.grey80,shadow:"none"},hover:{bgd:ai.greys.grey10,border:`0.03125rem solid ${ai.greys.grey30}`,text:ai.greys.grey80,shadow:"none"},focus:{bgd:ai.greys.grey10,border:`0.03125rem solid ${ai.primary.dark}`,text:ai.greys.grey80,shadow:`0 0 0 0.25rem ${ai.primary.light}`},active:{bgd:ai.greys.grey20,border:`0.03125rem solid ${ai.greys.grey40}`,text:ai.greys.grey80,shadow:`0 0 0 0.25rem ${ai.primary.dark}`},selected:{bgd:ai.greys.grey10,border:`0.03125rem solid ${ai.greys.grey30}`,text:ai.greys.grey80,shadow:`0 0 0 0.25rem ${ai.primary.dark}`},disabled:{bgd:ai.greys.white,border:`0.03125rem solid ${ai.greys.grey10}`,text:ai.greys.grey40,shadow:"none"}},icon:{shadow:an.none,static:{bgd:"transparent",border:"0.03125rem  solid transparent",text:ai.greys.grey80,shadow:"none"},hover:{bgd:ai.primary.dark,border:"0.03125rem  solid transparent",text:ai.greys.white,shadow:"none"},focus:{bgd:"transparent",border:`0.03125rem  solid ${ai.primary.darker}`,text:ai.greys.grey80,shadow:`0 0 0 0.25rem ${ai.primary.lightest}`},active:{bgd:ai.primary.darker,border:`0.03125rem  solid ${ai.primary.darker}`,text:ai.greys.white,shadow:`0 0 0 0.25rem ${ai.primary.lightest}`},selected:{bgd:ai.primary.light,border:`0.03125rem  solid ${ai.primary.darker}`,text:ai.greys.white,shadow:"none"},disabled:{bgd:"transparent",border:"none",text:ai.greys.grey40,shadow:"none"}}},as={bgd:ai.greys.white,border:`0.03125rem solid ${ai.greys.grey30}`,borderRadius:at.radii.default,fontColor:ai.greys.grey80,placeholder:ai.greys.grey40,shadow:`0 0.0625rem 0.0625rem 0 ${eT(ai.greys.black,.1)}`,clearBg:ai.greys.grey50,focus:{bgd:ai.greys.white,border:`solid 0.03125rem ${ai.primary.lighter}`,shadow:`0 0 0 0.125rem ${ai.primary.lightest}`},error:{border:`0.03125rem solid ${ai.error.dark}`,fontColor:ai.error.primary,shadow:`0 0 0 0.125rem ${ai.error.light}`},checked:{bgd:ai.primary.main,border:`solid 0.03125rem ${ai.primary.main}`,fontColor:ai.greys.white,shadow:`0 0.03125rem 0.03125rem 0 ${eT(ai.primary.dark,.7)}`}},aa={bgd:ai.greys.white,text:ai.greys.grey80,wrapperBgd:eT(ai.greys.grey50,.9),titleSize:at.fontSizes.h5.fontSize,titleWeight:"normal",shadow:an.large,border:ai.greys.grey30},al={menuBgd:`${eT(ai.greys.grey10,.85)}`,menuBorder:`0.5px solid ${ai.greys.grey20}`,shadow:an.large,itemBgd:"transparent",itemText:ai.greys.grey70,titleText:ai.greys.grey60,active:{itemBgd:ai.primary.dark,itemText:ai.greys.white},disabled:ai.greys.grey40,separator:`${eT(ai.greys.grey40,.3)}`},ad={shadow:an.large,error:{text:ai.error.lightest,closeButton:{text:ai.error.lighter,hover:{bgd:ai.error.lighter,text:ai.error.dark},active:{bgd:ai.error.lightest,text:ai.error.darker}}},success:{text:ai.success.lightest,closeButton:{text:ai.success.lighter,hover:{bgd:ai.success.lighter,text:ai.success.dark},active:{bgd:ai.success.lightest,text:ai.success.darker}}},info:{text:ai.info.lightest,closeButton:{text:ai.info.lighter,hover:{bgd:ai.info.lighter,text:ai.info.dark},active:{bgd:ai.info.lightest,text:ai.info.darker}}},warning:{text:ai.warning.darker,closeButton:{text:ai.warning.dark,hover:{bgd:ai.warning.dark,text:ai.greys.white},active:{bgd:ai.warning.darker,text:ai.greys.white}}}},ac={fontColor:ai.primary.main,fontColorHover:ai.primary.dark,fontColorActive:ai.primary.darker,fontColorVisited:ai.primary.darkest},au={text:ai.greys.grey70,shadow:an.large,bgd:ai.greys.white,border:`0.03125rem solid ${ai.greys.grey20}`,opacity:1,selected:{text:ao.primary.selected.text,bgd:ao.primary.selected.bgd}},ah={title:ai.greys.grey100,primaryText:ai.greys.grey80,secondaryText:ai.greys.grey50,headerBorder:ai.greys.grey40,containerBorder:ai.greys.grey30,bgd:ai.greys.grey10,fgd:ai.greys.white,shadow:an.large,maxWidth:"18.5rem"},af={text:ai.greys.grey80,bgd:ai.greys.grey10,headerBorder:ai.greys.grey40,wrapperBgd:eT(ai.greys.grey50,.9)},ap={bgd:ai.greys.white},am={incoming:{bgd:ai.greys.white,fontColor:ai.greys.grey60,linkColor:ai.primary.main,linkColorHover:ai.primary.dark,linkColorActive:ai.primary.darker,linkColorVisited:ai.primary.darkest},outgoing:{bgd:ai.primary.main,fontColor:ai.greys.grey10,linkColor:ai.greys.white,linkColorHover:ai.greys.grey10,linkColorActive:ai.greys.grey20,linkColorVisited:ai.greys.grey30},container:{fontColor:ai.greys.grey70,bgd:ai.greys.grey10}},ag={size:{fontColor:ai.greys.grey40,bgd:ai.greys.white,letterSpacing:"-0.07px",lineHight:"16px",fontSize:"10.4px"},icon:{bgd:ai.greys.grey10,color:ai.greys.grey80},name:{fontColor:ai.greys.grey80},content:{letterSpacing:"-0.09px",bgd:ai.greys.white,fontColor:ai.greys.grey80}},av={bgd:ai.greys.white,fontColor:ai.greys.grey70,border:"1px solid transparent",active:{bgd:ai.primary.dark,fontColor:ai.greys.white},hover:{bgd:ai.greys.grey10},focus:{border:`1px solid ${ai.primary.dark}`,selectedBorder:`1px solid ${ai.greys.grey10}`},selected:{bgd:ai.primary.light,fontColor:ai.greys.white},iconButton:{activeBgd:ai.greys.white}},ab={bgd:ai.greys.grey60,fontColor:ai.greys.white},ay=Object.assign({name:"Light Theme",buttons:ao,colors:ai,globalStyle:ar,links:ac,shadows:an,inputs:as,modal:aa,popOver:al,notification:ad,controlBar:au,roster:ah,navbar:af,videoGrid:ap,chatBubble:am,channelList:av,chatDateHeader:ab,messageAttachment:ag},at),aS={primary:{lightest:"#9DEFFB",lighter:"#8AEBFA",light:"#62E5F9",main:"#4FE2F8",dark:"#29DCF8",darker:"#22B6CB",darkest:"#1FA1B5"},secondary:{light:"#FF8B70",main:"#FF9B83",dark:"#FFB4A1"},error:{lightest:"#FBC1C0",lighter:"#FDA8A6",light:"#FD9B99",primary:"#FF8B8A",dark:"#583A39",darker:"#452F2E",darkest:"#302020"},success:{lightest:"#F4FBF1",lighter:"#D2F1C5",light:"#BAF39E",primary:"#A3E881",dark:"#4F6444",darker:"#46573D",darkest:"#324129"},info:{lightest:"#F0F5FD",lighter:"#D8E6FB",light:"#C4DBFF",primary:"#BAD4FF",dark:"#555B69",darker:"#494F59",darkest:"#343C48"},warning:{lightest:"#FDFDF7",lighter:"#3F4149",light:"#FFEB96",primary:"#FBDF64",dark:"#6D653C",darker:"#5E5736",darkest:"#47422D"},greys:{black:"#000000",grey100:"#1b1c20",grey90:"#2e2f34",grey80:"#3f4149",grey70:"#50545e",grey60:"#616672",grey50:"#7d818b",grey40:"#989da5",grey30:"#d4d5d8",grey20:"#e4e9f2",grey10:"#f0f1f2",white:"#ffffff"}},aw={bgd:aS.greys.grey80,text:aS.greys.white,fontSize:at.fontSizes.baseFontSize},aC={none:"none",small:"",medium:"",large:`0 0.75rem 1.875rem 0 ${eT(aS.greys.black,.15)}`},ak={primary:{shadow:aC.none,static:{bgd:aS.primary.main,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:"none"},hover:{bgd:aS.primary.dark,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:"none"},focus:{bgd:aS.primary.dark,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:`0 0 0 0.25rem ${aS.primary.darkest}`},active:{bgd:aS.primary.darker,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:"none"},selected:{bgd:aS.primary.light,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:"none"},disabled:{bgd:aS.greys.grey80,border:`0.03125rem solid ${eT(aS.greys.black,.4)}`,text:aS.greys.grey40,shadow:"none"}},secondary:{shadow:aC.none,static:{bgd:aS.greys.grey50,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.white,shadow:"none"},hover:{bgd:aS.greys.grey60,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.white,shadow:"none"},focus:{bgd:aS.greys.grey60,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.white,shadow:`0 0 0 0.25rem ${aS.primary.lighter}`},active:{bgd:aS.greys.grey70,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.white,shadow:"none"},selected:{bgd:aS.greys.grey60,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.white,shadow:"none"},disabled:{bgd:aS.greys.grey80,border:`0.03125rem solid ${eT(aS.greys.black,.6)}`,text:aS.greys.grey40,shadow:"none"}},icon:{shadow:aC.none,static:{bgd:"transparent",border:"0.03125rem solid transparent",text:aS.greys.grey20,shadow:"none"},hover:{bgd:aS.primary.dark,border:`0.03125rem  solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:"none"},focus:{bgd:"transparent",border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:`0 0 0 0.25rem ${aS.primary.darker}`},active:{bgd:aS.primary.darker,border:`0.03125rem solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:"none"},selected:{bgd:aS.primary.light,border:`0 solid ${aS.greys.black}`,text:aS.greys.grey80,shadow:"none"},disabled:{bgd:"transparent",border:"none",text:aS.greys.grey40,shadow:"none"}}},aT={bgd:aS.greys.grey80,border:`0.03125rem solid ${aS.greys.black}`,borderRadius:at.radii.default,fontColor:aS.greys.white,placeholder:aS.greys.grey50,shadow:`0 0.0625rem 0.0625rem 0 ${eT(aS.greys.black,.1)}`,clearBg:aS.greys.white,focus:{bgd:aS.greys.white,border:`solid 0.03125rem ${aS.primary.main}`,shadow:`0 0 0 0.125rem ${aS.primary.lighter}`},error:{border:`0.03125rem solid ${aS.error.primary}`,fontColor:aS.error.primary,shadow:`0 0 0 0.125rem ${aS.error.light}`},checked:{bgd:aS.primary.main,border:`solid 0.03125rem ${aS.primary.dark}`,fontColor:aS.greys.grey80,shadow:`inset 0 0.03125rem 0 0 ${eT(aS.greys.white,.1)}`}},aI={bgd:aS.greys.grey80,text:aS.greys.white,wrapperBgd:eT(aS.greys.grey60,.9),titleSize:at.fontSizes.h5.fontSize,titleWeight:"normal",shadow:`0 1rem 2rem 0 rgba(0, 0, 0, ${eT(aS.greys.black,.15)})`,border:aS.greys.black},aE={menuBgd:`${eT(aS.greys.grey90,.85)}`,menuBorder:aS.greys.grey100,shadow:aC.large,itemBgd:"transparent",itemText:aS.greys.white,titleText:aS.greys.white,active:{itemBgd:aS.primary.dark,itemText:aS.greys.grey80},disabled:aS.greys.grey40,separator:aS.greys.grey100},aA={shadow:aC.large,error:{text:aS.error.darker,closeButton:{text:aS.error.dark,hover:{bgd:aS.error.dark,text:aS.greys.white},active:{bgd:aS.error.darker,text:aS.greys.white}}},success:{text:aS.success.darker,closeButton:{text:aS.success.dark,hover:{bgd:aS.success.dark,text:aS.greys.white},active:{bgd:aS.success.darker,text:aS.greys.white}}},info:{text:aS.info.darker,closeButton:{text:aS.info.dark,hover:{bgd:aS.info.dark,text:aS.greys.white},active:{bgd:aS.info.darker,text:aS.greys.white}}},warning:{text:aS.warning.darker,closeButton:{text:aS.warning.dark,hover:{bgd:aS.warning.dark,text:aS.greys.white},active:{bgd:aS.warning.darker,text:aS.greys.white}}}},aM={fontColor:aS.primary.main,fontColorHover:aS.primary.dark,fontColorActive:aS.primary.darker,fontColorVisited:aS.primary.darkest},aO={text:aS.greys.grey20,shadow:aC.large,bgd:aS.greys.grey100,border:"none",opacity:1,selected:{text:ak.primary.selected.text,bgd:ak.primary.selected.bgd}},aP={title:aS.greys.white,primaryText:aS.greys.white,secondaryText:aS.greys.grey20,headerBorder:aS.greys.black,containerBorder:aS.greys.black,bgd:aS.greys.grey100,fgd:aS.greys.grey60,shadow:aC.large,maxWidth:"18.5rem"},a_={text:aS.greys.white,bgd:aS.greys.grey100,headerBorder:aS.greys.black,wrapperBgd:eT(aS.greys.grey60,.9)},ax={bgd:aS.greys.grey90},aR={incoming:{bgd:aS.greys.grey80,fontColor:aS.greys.grey30,linkColor:aS.primary.main,linkColorHover:aS.primary.dark,linkColorActive:aS.primary.darker,linkColorVisited:aS.primary.darkest},outgoing:{bgd:aS.primary.dark,fontColor:aS.greys.grey70,linkColor:aS.greys.grey80,linkColorHover:aS.greys.grey70,linkColorActive:aS.greys.grey60,linkColorVisited:aS.greys.grey50},container:{fontColor:aS.greys.grey30,bgd:aS.greys.black}},aD={size:{fontColor:aS.greys.grey30,bgd:aS.greys.grey10,letterSpacing:"-0.07px",lineHight:"16px",fontSize:"10.4px"},icon:{bgd:aS.greys.grey40,color:aS.greys.grey10},name:{fontColor:aS.greys.white},content:{letterSpacing:"-0.09px",bgd:aS.greys.grey60,fontColor:aS.greys.white}},aN={bgd:aS.greys.grey80,fontColor:aS.greys.grey10,border:"1px solid transparent",active:{bgd:aS.primary.dark,fontColor:aS.greys.grey70},hover:{bgd:aS.greys.grey70},focus:{border:`1px solid ${aS.primary.dark}`,selectedBorder:`1px solid ${aS.greys.grey70}`},selected:{bgd:aS.primary.light,fontColor:aS.greys.grey70},iconButton:{activeBgd:aS.greys.grey80}},aL={bgd:aS.greys.grey10,fontColor:aS.greys.grey80};Object.assign({name:"Dark Theme",buttons:ak,colors:aS,globalStyle:aw,links:aM,shadows:aC,inputs:aT,modal:aI,popOver:aE,notification:aA,controlBar:aO,roster:aP,navbar:a_,videoGrid:ax,chatBubble:aR,channelList:aN,chatDateHeader:aL,messageAttachment:aD},at);let aF=(0,f.iv)`
  /* http://meyerweb.com/eric/tools/css/reset/
    v2.0 | 20110126
    License: none (public domain)
  */

  html,
  body,
  div,
  span,
  applet,
  object,
  iframe,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  blockquote,
  pre,
  a,
  abbr,
  acronym,
  address,
  big,
  cite,
  code,
  del,
  dfn,
  em,
  img,
  ins,
  kbd,
  q,
  s,
  samp,
  small,
  strike,
  strong,
  sub,
  sup,
  tt,
  var,
  b,
  u,
  i,
  center,
  dl,
  dt,
  dd,
  ol,
  ul,
  li,
  fieldset,
  form,
  label,
  legend,
  table,
  caption,
  tbody,
  tfoot,
  thead,
  tr,
  th,
  td,
  article,
  aside,
  canvas,
  details,
  embed,
  figure,
  figcaption,
  footer,
  header,
  hgroup,
  menu,
  nav,
  output,
  ruby,
  section,
  summary,
  time,
  mark,
  audio,
  video {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
  }
  /* HTML5 display-role reset for older browsers */
  article,
  aside,
  details,
  figcaption,
  figure,
  footer,
  header,
  hgroup,
  menu,
  nav,
  section {
    display: block;
  }
  body {
    line-height: 1;
  }
  ol,
  ul {
    list-style: none;
  }
  blockquote,
  q {
    quotes: none;
  }
  blockquote:before,
  blockquote:after,
  q:before,
  q:after {
    content: '';
    content: none;
  }
  table {
    border-collapse: collapse;
    border-spacing: 0;
  }
`,aV=(0,f.vJ)`
  ${aF};

  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  html {
    font-size: ${e=>e.theme.fontSizes.baseFontSize};
    font-family: ${e=>e.theme.fonts.body};;
    background-color: ${e=>e.theme.globalStyle.bgd};
    color: ${e=>e.theme.globalStyle.text};
    min-height: 100%;
  }
`},8320:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(3922));class s{constructor(e,t,i,r=1e3,n=200){this.realtimeController=e,this.selfAttendeeId=t,this.hasBandwidthPriorityCallback=i,this.waitIntervalMs=r,this.updateIntervalMs=n,this.speakerScores={},this.speakerMuteState={},this.detectorCallbackToHandler=new Map,this.detectorCallbackToScoresTimer=new Map,this.detectorCallbackToActivityTimer=new Map,this.hasBandwidthPriority=!1,this.mostRecentUpdateTimestamp={}}needUpdate(e){return!this.activeSpeakers||0===this.speakerScores[e]&&this.activeSpeakers.includes(e)||this.speakerScores[e]>0&&!this.activeSpeakers.includes(e)}updateActiveSpeakers(e,t,i){if(!this.needUpdate(i))return;let r=[],n=Object.keys(this.speakerScores);for(let e=0;e<n.length;e++){let t=n[e];r.push({attendeeId:t,activeScore:this.speakerScores[t]})}let o=r.sort((e,t)=>t.activeScore-e.activeScore).filter(function(e){return e.activeScore>0}).map(function(e){return e.attendeeId});this.activeSpeakers=o,t(o);let s=o.length>0&&o[0]===this.selfAttendeeId&&e.prioritizeVideoSendBandwidthForActiveSpeaker();this.hasBandwidthPriority!==s&&(this.hasBandwidthPriority=s,this.hasBandwidthPriorityCallback(s))}updateScore(e,t,i,r,n){let o=e.calculateScore(i,r,n);this.speakerScores[i]!==o&&(this.speakerScores[i]=o,this.mostRecentUpdateTimestamp[i]=Date.now(),this.updateActiveSpeakers(e,t,i))}subscribe(e,t,i,r){let n=(i,r)=>{if(!r){this.speakerScores[i]=0,this.mostRecentUpdateTimestamp[i]=Date.now(),this.updateActiveSpeakers(e,t,i);return}this.realtimeController.realtimeSubscribeToVolumeIndicator(i,(i,r,n,o)=>{this.mostRecentUpdateTimestamp[i]=Date.now(),null!==n&&(this.speakerMuteState[i]=n),this.updateScore(e,t,i,r,n)})};this.detectorCallbackToHandler.set(t,n);let s=new o.default(this.updateIntervalMs);if(s.start(()=>{for(let i in this.speakerScores)Date.now()-this.mostRecentUpdateTimestamp[i]>this.waitIntervalMs&&this.updateScore(e,t,i,0,this.speakerMuteState[i])}),this.detectorCallbackToActivityTimer.set(t,s),i&&r){let e=new o.default(r);e.start(()=>{i(this.speakerScores)}),this.detectorCallbackToScoresTimer.set(t,e)}this.realtimeController.realtimeSubscribeToAttendeeIdPresence(n)}unsubscribe(e){let t=this.detectorCallbackToHandler.get(e);this.detectorCallbackToHandler.delete(e),t&&this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(t);let i=this.detectorCallbackToActivityTimer.get(e);i&&(i.stop(),this.detectorCallbackToActivityTimer.delete(e));let r=this.detectorCallbackToScoresTimer.get(e);r&&(r.stop(),this.detectorCallbackToHandler.delete(e))}destroy(){return r(this,void 0,void 0,function*(){for(let e of this.detectorCallbackToHandler.values())this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(e);for(let e of this.detectorCallbackToActivityTimer.values())e.stop();for(let e of this.detectorCallbackToScoresTimer.values())e.stop();this.detectorCallbackToHandler.clear(),this.detectorCallbackToActivityTimer.clear(),this.detectorCallbackToScoresTimer.clear()})}}t.default=s},2363:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e=.9,t=.01,i=.2,r=.2){this.speakerWeight=e,this.cutoffThreshold=t,this.silenceThreshold=i,this.takeoverRate=r,this.volumes={}}calculateScore(e,t,i){(i||null===t)&&(t=0),this.volumes.hasOwnProperty(e)||(this.volumes[e]=0),t=t>this.silenceThreshold?1:0;let r=this.volumes[e]*this.speakerWeight+t*(1-this.speakerWeight);for(let i in this.volumes[e]=r,this.volumes)i!==e&&(this.volumes[i]=Math.max(this.volumes[i]-this.takeoverRate*t,0));return r<this.cutoffThreshold?0:r}prioritizeVideoSendBandwidthForActiveSpeaker(){return!0}}t.default=i},7535:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t){this.appName=e,this.appVersion=t}static create(e,t){let r=/^[a-zA-Z0-9]+[a-zA-Z0-9_-]*[a-zA-Z0-9]+$/g;if(!e||e.length>32)throw Error("appName should be a valid string and 1 to 32 characters in length");if(!r.test(e))throw Error(`appName must satisfy ${r} regular expression`);let n=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/gm;if(!t||t.length>32)throw Error("appVersion should be a valid string and 1 to 32 characters in length");if(!n.test(t))throw Error("appVersion must satisfy Semantic Versioning format");return new i(e,t)}}t.default=i},7602:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},6802:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(543)),s=n(i(7797));class a{constructor(e){this.logger=e,this.audioDevice=null,this.audioElement=null,this.audioStream=null,this.browserBehavior=new o.default,this.observers=new Set}bindAudioElement(e){return r(this,void 0,void 0,function*(){if(!e)throw Error(`Cannot bind audio element: ${e}`);return this.audioElement=e,this.audioElement.autoplay=!0,this.bindAudioMix()})}unbindAudioElement(){this.audioElement&&(this.audioElement.srcObject=null,this.audioElement=null,this.forEachObserver(e=>{this.audioStream&&e.meetingAudioStreamBecameInactive(this.audioStream)}))}bindAudioStream(e){return r(this,void 0,void 0,function*(){if(e){this.audioStream=e;try{yield this.bindAudioMix()}catch(e){this.logger&&this.logger.warn(`Failed to bind audio stream: ${e}`)}}})}bindAudioDevice(e){return r(this,void 0,void 0,function*(){if(e&&!this.browserBehavior.supportsSetSinkId())throw Error("Cannot select audio output device. This browser does not support setSinkId.");return this.audioDevice=e,this.bindAudioMix()})}forEachObserver(e){for(let t of this.observers)s.default.nextTick(()=>{e(t)})}bindAudioMix(){var e,t;return r(this,void 0,void 0,function*(){if(!this.audioElement)return;let i=this.audioElement.srcObject;this.audioStream&&(this.audioElement.srcObject=this.audioStream),i!==this.audioStream&&this.forEachObserver(e=>{i&&e.meetingAudioStreamBecameInactive(i),this.audioStream&&e.meetingAudioStreamBecameActive(this.audioStream)});let r=(null===(e=this.audioDevice)||void 0===e?void 0:e.deviceId)!==this.audioElement.sinkId;if(r&&void 0===this.audioElement.sinkId)throw Error("Cannot select audio output device. This browser does not support setSinkId.");let n=this.audioDevice?this.audioDevice.deviceId:"";if(n===this.audioElement.sinkId)return;let o=this.audioElement,s=this.audioStream;if(this.browserBehavior.hasChromiumWebRTC()&&(o.srcObject=null),r)try{yield o.setSinkId(n)}catch(e){throw null===(t=this.logger)||void 0===t||t.error(`Failed to set sinkId for audio element: ${e}`),e}this.browserBehavior.hasChromiumWebRTC()&&(o.srcObject=s)})}getCurrentMeetingAudioStream(){return r(this,void 0,void 0,function*(){return this.audioStream})}addAudioMixObserver(e){return r(this,void 0,void 0,function*(){this.observers.add(e)})}removeAudioMixObserver(e){return r(this,void 0,void 0,function*(){this.observers.delete(e)})}audioOutputDidChange(e){return r(this,void 0,void 0,function*(){return this.logger.info("Receive an audio output change event"),this.bindAudioDevice(e)})}}t.default=a},3765:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(543));class o{constructor(e=null,t=!0){this.audioBitrateBps=e,this.enableAudioRedundancy=new n.default().supportsAudioRedundancy()&&t}static fullbandSpeechMono(e=!0){return new o(4e4,e)}static fullbandMusicMono(e=!0){return new o(64e3,e)}static fullbandMusicStereo(e=!0){return new o(128e3,e)}isStereo(){return 128e3===this.audioBitrateBps}hasRedundancyEnabled(){return this.enableAudioRedundancy}}t.default=o},1876:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT=void 0,t.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT=25;class i{constructor(){this.logger=null,this.browserBehavior=null,this.meetingSessionConfiguration=null,this.signalingClient=null,this.peer=null,this.previousSdpOffer=null,this.sdpOfferInit=null,this.audioVideoController=null,this.realtimeController=null,this.videoTileController=null,this.mediaStreamBroker=null,this.activeAudioInput=void 0,this.activeVideoInput=void 0,this.audioMixController=null,this.transceiverController=null,this.indexFrame=null,this.iceCandidates=[],this.iceCandidateHandler=null,this.iceGatheringStateEventHandler=null,this.sdpAnswer=null,this.turnCredentials=null,this.reconnectController=null,this.removableObservers=[],this.audioProfile=null,this.videoStreamIndex=null,this.videoDownlinkBandwidthPolicy=null,this.videoUplinkBandwidthPolicy=null,this.lastKnownVideoAvailability=null,this.videoCaptureAndEncodeParameter=null,this.videosToReceive=null,this.lastVideosToReceive=null,this.videoSubscriptions=null,this.lastVideoSubscriptionConfiguration=new Map,this.videoSubscriptionLimit=t.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT,this.previousSdpAnswerAsString="",this.serverSupportsCompression=!1,this.videoSendCodecPreferences=[],this.currentVideoSendCodec=void 0,this.meetingSupportedVideoSendCodecPreferences=void 0,this.prioritizedSendVideoCodecCapabilities=[],this.degradedVideoSendCodecs=[],this.videosPaused=null,this.videoDuplexMode=null,this.volumeIndicatorAdapter=null,this.statsCollector=null,this.connectionMonitor=null,this.videoInputAttachedTimestampMs=0,this.audioDeviceInformation={},this.videoDeviceInformation={},this.enableSimulcast=!1,this.enableSVC=!1,this.eventController=null,this.signalingOpenDurationMs=null,this.iceGatheringDurationMs=null,this.startAudioVideoTimestamp=null,this.attendeePresenceDurationMs=null,this.meetingStartDurationMs=null,this.poorConnectionCount=0,this.maxVideoTileCount=0,this.startTimeMs=null,this.isSessionConnected=!1}resetConnectionSpecificState(){this.peer&&this.peer.close(),this.peer=null,this.previousSdpOffer=null,this.sdpOfferInit=null,void 0!==this.transceiverController&&this.transceiverController.reset(),this.indexFrame=null,this.iceCandidates=[],this.iceCandidateHandler=null,this.sdpAnswer=null,this.turnCredentials=null,this.videoDownlinkBandwidthPolicy.reset(),this.videoUplinkBandwidthPolicy.reset&&this.videoUplinkBandwidthPolicy.reset(),this.lastVideosToReceive=null,this.lastVideoSubscriptionConfiguration=new Map,this.videoSubscriptions=null,this.videoSubscriptionLimit=t.DEFAULT_VIDEO_SUBSCRIPTION_LIMIT,this.previousSdpAnswerAsString="",this.serverSupportsCompression=!1,this.currentVideoSendCodec=void 0,this.meetingSupportedVideoSendCodecPreferences=void 0,this.videoDuplexMode=null,this.isSessionConnected=!1}}t.default=i},9059:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},s=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let l=a(i(8320)),d=a(i(6802)),c=a(i(3765)),u=a(i(543)),h=a(i(6688)),f=a(i(8581)),p=a(i(4500)),m=a(i(3789)),g=a(i(5687)),v=a(i(5723)),b=a(i(214)),y=a(i(7947)),S=a(i(983)),w=a(i(7797)),C=a(i(2330)),k=a(i(9678)),T=a(i(3860)),I=a(i(9553)),E=a(i(3013)),A=a(i(1208)),M=o(i(7103)),O=a(i(9416)),P=a(i(9101)),_=i(289),x=a(i(8597)),R=a(i(8358)),D=a(i(3216)),N=a(i(7408)),L=a(i(5482)),F=a(i(1129)),V=a(i(6240)),B=a(i(1960)),U=a(i(6180)),j=a(i(2748)),$=a(i(1981)),z=a(i(4543)),H=a(i(8556)),W=a(i(9945)),G=a(i(1209)),K=a(i(6274)),q=a(i(120)),J=a(i(9560)),Q=a(i(9485)),Z=a(i(7079)),X=a(i(4833)),Y=a(i(5275)),ee=a(i(5924)),et=a(i(250)),ei=a(i(6171)),er=a(i(365)),en=a(i(7377)),eo=a(i(5785)),es=a(i(9354)),ea=i(8660),el=a(i(1133)),ed=a(i(5185)),ec=a(i(2880)),eu=i(1819),eh=a(i(1508)),ef=a(i(1318)),ep=a(i(4242)),em=a(i(2958)),eg=a(i(4922)),ev=a(i(4450)),eb=a(i(4442)),ey=a(i(9751)),eS=a(i(1876));class ew{constructor(e,t,i,r,n,o){this._audioProfile=new c.default,this.connectionHealthData=new h.default,this.observerQueue=new Set,this.meetingSessionContext=new eS.default,this.enableSimulcast=!1,this.enableSVC=!1,this.useUpdateTransceiverControllerForUplink=!1,this.totalRetryCount=0,this.startAudioVideoTimestamp=0,this.mayNeedRenegotiationForSimulcastLayerChange=!1,this.promotedToPrimaryMeeting=!1,this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent=!1,this.receiveIndexTask=void 0,this.monitorTask=void 0,this.receiveRemotePauseResumeTask=void 0,this.destroyed=!1,this._logger=t,this.sessionStateController=new k.default(this._logger),this._configuration=e,this._webSocketAdapter=i,this._realtimeController=new S.default(r),this._realtimeController.realtimeSetLocalAttendeeId(e.credentials.attendeeId,e.credentials.externalUserId),this._mediaStreamBroker=r,this._reconnectController=n,this._videoTileController=new em.default(new eg.default,this,this._logger),this._audioMixController=new d.default(this._logger),this._mediaStreamBroker.addMediaStreamBrokerObserver(this._audioMixController),this.meetingSessionContext.logger=this._logger,this._eventController=o,this.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers||(new b.default(this.configuration.credentials.attendeeId).hasModality(b.default.MODALITY_CONTENT)&&new u.default().hasChromiumWebRTC()?this.videoSendCodecPreferences=[C.default.av1Main(),C.default.vp9Profile0(),C.default.h264ConstrainedBaselineProfile(),C.default.vp8()]:this.videoSendCodecPreferences=[C.default.vp9Profile0(),C.default.h264ConstrainedBaselineProfile(),C.default.vp8()])}destroy(){return s(this,void 0,void 0,function*(){this.observerQueue.clear(),this._mediaStreamBroker.removeMediaStreamBrokerObserver(this._audioMixController),this.destroyed=!0})}get configuration(){return this._configuration}get realtimeController(){return this._realtimeController}get activeSpeakerDetector(){return this._activeSpeakerDetector||(this._activeSpeakerDetector=new l.default(this._realtimeController,this._configuration.credentials.attendeeId,this.handleHasBandwidthPriority.bind(this))),this._activeSpeakerDetector}get videoTileController(){return this._videoTileController}get audioMixController(){return this._audioMixController}get logger(){return this._logger}get rtcPeerConnection(){return this.meetingSessionContext&&this.meetingSessionContext.peer||null}get mediaStreamBroker(){return this._mediaStreamBroker}get eventController(){return this._eventController}getRTCPeerConnectionStats(e){return(this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent||(this.logger.warn("The `getRTCPeerConnectionStats()` is on its way to be deprecated. It makes an additional call to the `getStats` API and therefore may cause slight performance degradation. Please use the new API `clientMetricReport.getRTCStatsReport()` returned by `metricsDidReceive(clientMetricReport)` callback instead."),this.hasGetRTCPeerConnectionStatsDeprecationMessageBeenSent=!0),this.rtcPeerConnection)?this.rtcPeerConnection.getStats(e):null}setAudioProfile(e){this._audioProfile=e}addObserver(e){this.logger.info("adding meeting observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing meeting observer"),this.observerQueue.delete(e)}forEachObserver(e){for(let t of this.observerQueue)w.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}initSignalingClient(){this.connectionHealthData.reset(),this.meetingSessionContext.signalingClient||(this.meetingSessionContext=new eS.default,this.meetingSessionContext.logger=this.logger,this.meetingSessionContext.eventController=this.eventController,this.meetingSessionContext.browserBehavior=new u.default,this.meetingSessionContext.videoSendCodecPreferences=this.videoSendCodecPreferences,this.meetingSessionContext.audioProfile=this._audioProfile,this.meetingSessionContext.meetingSessionConfiguration=this.configuration,this.meetingSessionContext.signalingClient=new A.default(this._webSocketAdapter,this.logger))}uninstallPreStartObserver(){this.meetingSessionContext.signalingClient.removeObserver(this.preStartObserver),this.preStartObserver=void 0}prestart(){return this.logger.info("Pre-connecting signaling connection."),this.createOrReuseSignalingTask().run().then(()=>{let e=()=>s(this,void 0,void 0,function*(){this.logger.info("Early connection closed; discarding signaling task."),this.signalingTask=void 0,this.uninstallPreStartObserver()});this.preStartObserver={handleSignalingClientEvent(t){t.type===O.default.WebSocketClosed&&e()}},this.meetingSessionContext.signalingClient.registerObserver(this.preStartObserver)}).catch(e=>{this.logger.error(`Signaling task pre-start failed: ${e}`),this.signalingTask=void 0})}start(e){this.startReturningPromise(e).then(()=>{this.logger.info("start completed")}).catch(e=>{this.logger.error(`start failed: ${e}`)})}startReturningPromise(e){return(null==e?void 0:e.signalingOnly)===!0?this.prestart():(this.activeSpeakerDetector,new Promise((e,t)=>{this.sessionStateController.perform(T.default.Connect,()=>{this.actionConnect(!1).then(e).catch(t)})}))}connectWithPromises(e){let t=this.meetingSessionContext,i=(e,t)=>new et.default(this.logger,t,e);this.monitorTask=new $.default(t,this.configuration.connectionHealthPolicyConfiguration,this.connectionHealthData);let r=this.monitorTask.once(),n=new G.default(t).once();this.receiveIndexTask=new J.default(t),this.monitorTask.pauseResubscribeCheck(),this.receiveIndexTask.pauseIngestion();let o=new Z.default(this.logger,"Signaling",[this.createOrReuseSignalingTask(),new j.default(t),new Q.default(t),new B.default(t),this.receiveIndexTask]).once(),s=new L.default(t).once(o),a=new R.default(t).once(s,n),l=new F.default(t).once(a),d=new X.default(t).once(l),c=new V.default(t).once(d),u=new ee.default(t).once(c);return this.receiveRemotePauseResumeTask=new K.default(t),this.receiveRemotePauseResumeTask.once(u),new Z.default(this.logger,this.wrapTaskName("AudioVideoStart"),[r,i(this.configuration.connectionTimeoutMs,new Z.default(this.logger,"Peer",[u,this.receiveRemotePauseResumeTask,e?new et.default(this.logger,new H.default(this.logger,"FinalizeConnection",[new ei.default(t),new Y.default(t)]),this.meetingSessionContext.meetingSessionConfiguration.attendeePresenceTimeoutMs):new Y.default(t)]))])}actionConnect(e){var t;return s(this,void 0,void 0,function*(){this.initSignalingClient(),this.uninstallPreStartObserver(),this.meetingSessionContext.mediaStreamBroker=this._mediaStreamBroker,this.meetingSessionContext.realtimeController=this._realtimeController,this.meetingSessionContext.audioMixController=this._audioMixController,this.meetingSessionContext.audioVideoController=this,this.enableSimulcast=this.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers&&new u.default().hasChromiumWebRTC(),this.enableSimulcast&&this.configuration.enableSVC&&this.logger.warn("SVC cannot be enabled at the same time as simulcast. Disabling SVC, using simulcast."),this.enableSVC=!this.enableSimulcast&&this.configuration.enableSVC&&new u.default().supportsScalableVideoCoding();let i=!!this.configuration.urls.audioHostURL;if(i?this.enableSimulcast?(this.logger.info("Using transceiver controller with simulcast support"),new b.default(this.configuration.credentials.attendeeId).hasModality(b.default.MODALITY_CONTENT)?this.meetingSessionContext.transceiverController=new en.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext):this.meetingSessionContext.transceiverController=new eo.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)):(this.logger.info("Using default transceiver controller"),this.meetingSessionContext.transceiverController=new er.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)):(this.logger.info("Using video only transceiver controller"),this.meetingSessionContext.transceiverController=new es.default(this.logger,this.meetingSessionContext.browserBehavior,this.meetingSessionContext)),this.meetingSessionContext.volumeIndicatorAdapter=new ey.default(this.logger,this._realtimeController,ew.MIN_VOLUME_DECIBELS,ew.MAX_VOLUME_DECIBELS,this.configuration.credentials.attendeeId),this.meetingSessionContext.videoTileController=this._videoTileController,this.meetingSessionContext.videoDownlinkBandwidthPolicy=this.configuration.videoDownlinkBandwidthPolicy,this.meetingSessionContext.videoUplinkBandwidthPolicy=this.configuration.videoUplinkBandwidthPolicy,this.meetingSessionContext.enableSimulcast=this.enableSimulcast,this.meetingSessionContext.enableSVC=this.enableSVC,this.enableSimulcast){let e=this.meetingSessionContext.videoUplinkBandwidthPolicy;e||(e=new ev.default(this.configuration.credentials.attendeeId,this.meetingSessionContext.logger),this.meetingSessionContext.videoUplinkBandwidthPolicy=e),e.addObserver(this),this.meetingSessionContext.videoDownlinkBandwidthPolicy||(this.meetingSessionContext.videoDownlinkBandwidthPolicy=new ec.default(this.meetingSessionContext.logger)),this.meetingSessionContext.videoStreamIndex=new ep.default(this.logger)}else this.meetingSessionContext.enableSimulcast=!1,this.meetingSessionContext.videoStreamIndex=new ef.default(this.logger),this.meetingSessionContext.videoUplinkBandwidthPolicy||(this.meetingSessionContext.videoUplinkBandwidthPolicy=new eb.default(this.configuration.credentials.attendeeId,!this.meetingSessionContext.browserBehavior.disableResolutionScaleDown(),this.meetingSessionContext.logger,this.meetingSessionContext.browserBehavior),this.meetingSessionContext.videoUplinkBandwidthPolicy.setSVCEnabled(this.enableSVC)),this.meetingSessionContext.videoDownlinkBandwidthPolicy||(this.meetingSessionContext.videoDownlinkBandwidthPolicy=new ed.default(this.configuration.credentials.attendeeId)),this.meetingSessionContext.videoUplinkBandwidthPolicy.setTransceiverController&&this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController&&(this.useUpdateTransceiverControllerForUplink=!0,this.meetingSessionContext.videoUplinkBandwidthPolicy.setTransceiverController(this.meetingSessionContext.transceiverController)),this.meetingSessionContext.audioProfile=this._audioProfile;if(new b.default(this.configuration.credentials.attendeeId).hasModality(b.default.MODALITY_CONTENT)){let e=this.configuration.meetingFeatures.contentMaxResolution===p.default.VideoResolutionUHD;e&&this.setVideoMaxBandwidthKbps(2500),this.meetingSessionContext.videoUplinkBandwidthPolicy.setHighResolutionFeatureEnabled(e)}else{let e=this.configuration.meetingFeatures.videoMaxResolution===p.default.VideoResolutionFHD;this.meetingSessionContext.videoUplinkBandwidthPolicy.setHighResolutionFeatureEnabled(e)}this.meetingSessionContext.videoUplinkBandwidthPolicy&&this.maxUplinkBandwidthKbps&&this.meetingSessionContext.videoUplinkBandwidthPolicy.setIdealMaxBandwidthKbps(this.maxUplinkBandwidthKbps),this.meetingSessionContext.videoDownlinkBandwidthPolicy.bindToTileController&&this.meetingSessionContext.videoDownlinkBandwidthPolicy.bindToTileController(this._videoTileController),this.meetingSessionContext.videoDownlinkBandwidthPolicy.setWantsResubscribeObserver&&this.meetingSessionContext.videoDownlinkBandwidthPolicy.setWantsResubscribeObserver(()=>this.update({needsRenegotiation:!1})),this.meetingSessionContext.lastKnownVideoAvailability=new v.default,this.meetingSessionContext.videoCaptureAndEncodeParameter=new el.default(0,0,0,0,!1),this.meetingSessionContext.videosToReceive=new eh.default,this.meetingSessionContext.videosPaused=new eh.default,this.meetingSessionContext.statsCollector=new x.default(this,this.logger),this.meetingSessionContext.connectionMonitor=new f.default(this,this._realtimeController,this.connectionHealthData,new y.default(this.meetingSessionContext.signalingClient,ew.PING_PONG_INTERVAL_MS,this.logger),this.meetingSessionContext.statsCollector),this.meetingSessionContext.reconnectController=this._reconnectController,this.meetingSessionContext.videoDeviceInformation={},this._videoTileController.registerVideoTileResolutionObserver(this.meetingSessionContext.statsCollector),e||(this.totalRetryCount=0,this._reconnectController.reset(),this.startAudioVideoTimestamp=Date.now(),this.forEachObserver(e=>{ea.Maybe.of(e.audioVideoDidStartConnecting).map(t=>t.bind(e)(!1))}),null===(t=this.eventController)||void 0===t||t.publishEvent("meetingStartRequested")),this.meetingSessionContext.startAudioVideoTimestamp=this.startAudioVideoTimestamp,this._reconnectController.hasStartedConnectionAttempt()?this._reconnectController.startedConnectionAttempt(!1):this._reconnectController.startedConnectionAttempt(!0);let r=i&&this.meetingSessionContext.meetingSessionConfiguration.attendeePresenceTimeoutMs>0;this.logger.info("Needs to wait for attendee presence? "+r);let n=this.connectWithPromises(r);try{yield n.run(),this.connectionHealthData.setConnectionStartTime();let e=new b.default(this.configuration.credentials.attendeeId).hasModality(b.default.MODALITY_CONTENT);this.connectionHealthData.setIsContentShare(e),this._mediaStreamBroker.addMediaStreamBrokerObserver(this),this.sessionStateController.perform(T.default.FinishConnecting,()=>{this.eventController&&(this.meetingSessionContext.meetingStartDurationMs=Date.now()-this.startAudioVideoTimestamp,this.eventController.publishEvent("meetingStartSucceeded",{maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,poorConnectionCount:this.meetingSessionContext.poorConnectionCount,retryCount:this.totalRetryCount,signalingOpenDurationMs:this.meetingSessionContext.signalingOpenDurationMs,iceGatheringDurationMs:this.meetingSessionContext.iceGatheringDurationMs,meetingStartDurationMs:this.meetingSessionContext.meetingStartDurationMs})),this.meetingSessionContext.startTimeMs=Date.now(),this.actionFinishConnecting()})}catch(t){this.signalingTask=void 0;let e=new m.default(this.getMeetingStatusCode(t)||g.default.TaskFailed);if(this.logger.info(`Start failed: ${e} due to error ${t}.`),this.sessionStateController.state()===I.default.NotConnected){this.logger.info("Start failed and not connected. Not cleaning up.");return}this.sessionStateController.perform(T.default.Fail,()=>s(this,void 0,void 0,function*(){yield this.actionDisconnect(e,!0,t),this.handleMeetingSessionStatus(e,t)||this.notifyStop(e,t)}))}})}createOrReuseSignalingTask(){return this.signalingTask||(this.initSignalingClient(),this.signalingTask=new et.default(this.logger,new z.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs).once()),this.signalingTask}actionFinishConnecting(){this.signalingTask=void 0,this.meetingSessionContext.videoDuplexMode=_.SdkStreamServiceType.RX,this.meetingSessionContext.enableSimulcast||(this.useUpdateTransceiverControllerForUplink?this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController():this.enforceBandwidthLimitationForSender(this.meetingSessionContext.videoCaptureAndEncodeParameter.encodeBitrates()[0])),this.meetingSessionContext.isSessionConnected=!0,this.forEachObserver(e=>{ea.Maybe.of(e.audioVideoDidStart).map(t=>t.bind(e)())}),this._reconnectController.reset(),this.receiveIndexTask.resumeIngestion(),this.monitorTask.resumeResubscribeCheck()}stopReturningPromise(){var e;return(this._reconnectController.disableReconnect(),this.sessionStateController.state()===I.default.NotConnected)?(null===(e=this.meetingSessionContext.signalingClient)||void 0===e||e.closeConnection(),this.cleanUpMediaStreamsAfterStop(),Promise.resolve()):new Promise((e,t)=>{this.sessionStateController.perform(T.default.Disconnect,()=>{this.logger.info("attendee left meeting, session will not be reconnected"),this.actionDisconnect(new m.default(g.default.Left),!1,null).then(e).catch(t)})})}stop(){this.stopReturningPromise()}actionDisconnect(e,t,i){return s(this,void 0,void 0,function*(){try{yield new Z.default(this.logger,this.wrapTaskName("AudioVideoStop"),[new et.default(this.logger,new U.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs)]).run()}catch(e){this.logger.info("fail to stop")}try{let e=[new et.default(this.logger,new N.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs)];this.cleanUpMediaStreamsAfterStop(),yield new Z.default(this.logger,this.wrapTaskName("AudioVideoClean"),e).run()}catch(e){this.logger.info("fail to clean")}this.sessionStateController.perform(T.default.FinishDisconnecting,()=>{t||this.notifyStop(e,i)}),this._videoTileController.removeVideoTileResolutionObserver(this.meetingSessionContext.statsCollector)})}update(e={needsRenegotiation:!0}){let t=e.needsRenegotiation;if(t||(t=void 0===this.meetingSessionContext.peer),t||(t=!this.updateRemoteVideosFromPolicy()),t||(t=!this.updateLocalVideoFromPolicy()),this.meetingSessionContext.lastVideosToReceive=this.meetingSessionContext.videosToReceive,!t)return this.logger.info("Update request does not require resubscribe"),this.actionFinishUpdating(),!0;this.logger.info("Update request requires resubscribe"),this.updateNumberOfPublishedVideoSources();let i=this.sessionStateController.perform(T.default.Update,()=>{this.actionUpdateWithRenegotiation(!0)});return i===E.default.Transitioned||i===E.default.DeferredTransition}updateNumberOfPublishedVideoSources(){let e=this.configuration.credentials.attendeeId,t=this._videoTileController.hasStartedLocalVideoTile();if(null!==this.meetingSessionContext.videoStreamIndex){let i=this.meetingSessionContext.videoStreamIndex.numberOfVideoPublishingParticipantsExcludingSelf(e)+(t?1:0);this.connectionHealthData.setNumberOfPublishedVideoSources(i)}}updateRemoteVideosFromPolicy(){if(this.meetingSessionContext.videoDownlinkBandwidthPolicy&&void 0!==this.meetingSessionContext.videoDownlinkBandwidthPolicy.getVideoPreferences&&void 0!==this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption&&!M.serverSideNetworkAdaptionIsNoneOrDefault(this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption())){if(!this.sendRemoteVideoUpdate())return!1;if(this.meetingSessionContext.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption()===M.default.BandwidthProbingAndRemoteVideoQualityAdaption)return this.isNotAddingOrRemovingStreams()}return this.updateRemoteVideosIfNotAddingOrRemovingStreams()}updateRemoteVideosIfNotAddingOrRemovingStreams(){let e=this.detectChangesInVideosToReceive();if(void 0===e)return!1;let t=e.added,i=e.simulcastStreamUpdates,r=e.removed,n=this.meetingSessionContext,o=[];for(let[e,t]of i.entries()){let i=new P.default;if(i.streamId=t,i.attendeeId=n.videoStreamIndex.attendeeIdForStreamId(t),i.mid=n.transceiverController.getMidForStreamId(e),void 0===i.mid)return this.logger.info(`No MID found for stream ID ${e}, cannot update stream without renegotiation`),!1;if(o.push(i),n.transceiverController.setStreamIdForMid(i.mid,t),n.videoStreamIndex.overrideStreamIdMappings(e,t),n.videoTileController.haveVideoTileForAttendeeId(i.attendeeId)){let e=n.videoTileController.getVideoTileForAttendeeId(i.attendeeId);if(!e.setStreamId)return!1;e.setStreamId(t)}}return 0!==o.length&&n.signalingClient.remoteVideoUpdate(o,[]),0===t.length&&0===r.length&&(n.videoStreamIndex.remoteVideoUpdateSent(),!0)}detectChangesInVideosToReceive(){let e=this.meetingSessionContext;if(null===e.videosToReceive||!e.transceiverController||!e.transceiverController.getMidForStreamId||!e.transceiverController.setStreamIdForMid||!e.videosToReceive.forEach||!e.signalingClient.remoteVideoUpdate||!e.videoStreamIndex.overrideStreamIdMappings)return;let t=[],i=new Map,r=[];if(null===e.lastVideosToReceive)t=e.videosToReceive.array();else{let n=e.videoStreamIndex;e.videosToReceive.forEach(r=>{if(e.lastVideosToReceive.contain(r))return;let o=!1;e.lastVideosToReceive.forEach(e=>{!o&&n.StreamIdsInSameGroup(e,r)&&(i.set(e,r),o=!0)}),o||t.push(r)}),r=e.lastVideosToReceive.array().filter(t=>{let r=e.videosToReceive.contain(t),n=i.has(t);return!r&&!n})}return this.logger.info(`Request to update remote videos with added: [${t}], updated: [${Array.from(i.entries()).map(([e,t])=>`${e}->${t}`).join(",")}], removed: [${r}]`),{added:t,removed:r,simulcastStreamUpdates:i}}isNotAddingOrRemovingStreams(){let e=this.detectChangesInVideosToReceive();if(void 0===e)return!1;let t=e.added,i=e.removed;return 0===t.length&&0===i.length&&(this.meetingSessionContext.videoStreamIndex.remoteVideoUpdateSent(),!0)}sendRemoteVideoUpdate(){let e=this.meetingSessionContext;if(null===e.videosToReceive)return!1;let t=e.videosToReceive.array().map(t=>e.videoStreamIndex.groupIdForStreamId(t));this.receiveRemotePauseResumeTask.updateSubscribedGroupdIds(new Set(t));let i=eu.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration(e,t,e.videoDownlinkBandwidthPolicy.getVideoPreferences()),r=new Map,n=[];for(let t of i){let i=!1;if(e.lastVideoSubscriptionConfiguration.has(t.groupId)){let r=e.lastVideoSubscriptionConfiguration.get(t.groupId);t.equals(r)||(this.logger.debug(`${JSON.stringify(t)} does not equal ${JSON.stringify(r)}, sending update`),i=!0)}else i=!0;r.set(t.groupId,t),i&&n.push(t)}e.lastVideoSubscriptionConfiguration=r;let o=[];if(null!==e.lastVideosToReceive){let i=new Set(t);for(let t of e.lastVideosToReceive.array()){let r=e.videoStreamIndex.groupIdForStreamId(t);if(!i.has(r)){let t=e.transceiverController.getMidForGroupId(r);if(void 0===t){e.logger.warn(`Could not find MID for group ID to remove: ${r}`);continue}o.push(t)}}}return(0!==n.length||0!==o.length)&&e.signalingClient.remoteVideoUpdate(n,o),!0}updateLocalVideoFromPolicy(){if(this.meetingSessionContext.enableSimulcast){let e=this.meetingSessionContext.videoUplinkBandwidthPolicy.chooseEncodingParameters();if(this.mayNeedRenegotiationForSimulcastLayerChange&&this.meetingSessionContext.transceiverController.hasVideoInput()&&!this.negotiatedBitrateLayersAllocationRtpHeaderExtension())return this.logger.info("Needs regenotiation for local video simulcast layer change"),this.mayNeedRenegotiationForSimulcastLayerChange=!1,!1;this.meetingSessionContext.transceiverController.setEncodingParameters(e)}else this.meetingSessionContext.videoCaptureAndEncodeParameter=this.meetingSessionContext.videoUplinkBandwidthPolicy.chooseCaptureAndEncodeParameters();return this.logger.info("Updated local video from policy without renegotiation"),!0}negotiatedBitrateLayersAllocationRtpHeaderExtension(){if(!this.meetingSessionContext.transceiverController.localVideoTransceiver())return!1;let e=this.meetingSessionContext.transceiverController.localVideoTransceiver().sender.getParameters();return!!e&&!!e.headerExtensions&&e.headerExtensions.some(e=>"http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00"===e.uri)}restartLocalVideo(e){let t=()=>s(this,void 0,void 0,function*(){this._videoTileController.hasStartedLocalVideoTile()&&(this.logger.info("stopping local video tile prior to local video restart"),this._videoTileController.stopLocalVideoTile(),this.logger.info("preparing local video restart update"),yield this.actionUpdateWithRenegotiation(!1),this.logger.info("starting local video tile for local video restart"),this._videoTileController.startLocalVideoTile()),this.logger.info("finalizing local video restart update"),yield this.actionUpdateWithRenegotiation(!0),e()}),i=this.sessionStateController.perform(T.default.Update,()=>{t()});return i===E.default.Transitioned||i===E.default.DeferredTransition}replaceLocalVideo(e){return s(this,void 0,void 0,function*(){if(!e||e.getVideoTracks().length<1)throw Error("could not acquire video track");if(!this.meetingSessionContext||!this.meetingSessionContext.peer)throw Error("no active meeting and peer connection");let t=this.meetingSessionContext.videoTileController.getLocalVideoTile();if(t){let i=t.state(),r=e.getVideoTracks()[0].getSettings();t.bindVideoStream(i.boundAttendeeId,!0,e,r.width,r.height,i.streamId,i.boundExternalUserId)}yield this.meetingSessionContext.transceiverController.setVideoInput(e.getVideoTracks()[0]),this.meetingSessionContext.activeVideoInput=e,this.logger.info("Local video input is updated")})}replaceLocalAudio(e){return s(this,void 0,void 0,function*(){if(!e||e.getAudioTracks().length<1)throw Error("could not acquire audio track");if(!this.meetingSessionContext||!this.meetingSessionContext.peer)throw Error("no active meeting and peer connection");if(this.connectionHealthData.reset(),this.connectionHealthData.setConnectionStartTime(),!(yield this.meetingSessionContext.transceiverController.replaceAudioTrack(e.getAudioTracks()[0])))throw Error("Failed to replace audio track");this.meetingSessionContext.activeAudioInput=e,this.logger.info("Local audio input is updated")})}actionUpdateWithRenegotiation(e){return s(this,void 0,void 0,function*(){this.monitorTask.pauseResubscribeCheck(),this.receiveIndexTask.pauseIngestion();try{yield new Z.default(this.logger,this.wrapTaskName("AudioVideoUpdate"),[new q.default(this.meetingSessionContext),new et.default(this.logger,new Z.default(this.logger,"UpdateSession",[new R.default(this.meetingSessionContext),new F.default(this.meetingSessionContext),new X.default(this.meetingSessionContext),new V.default(this.meetingSessionContext),new ee.default(this.meetingSessionContext),new Y.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs)]).run(),e&&this.sessionStateController.perform(T.default.FinishUpdating,()=>{this.actionFinishUpdating()})}catch(e){this.sessionStateController.perform(T.default.FinishUpdating,()=>{let t=new m.default(this.getMeetingStatusCode(e)||g.default.TaskFailed);t.statusCode()!==g.default.IncompatibleSDP&&this.logger.info("failed to update audio-video session"),this.handleMeetingSessionStatus(t,e)})}})}notifyStop(e,t){var i;if(this.forEachObserver(t=>{ea.Maybe.of(t.audioVideoDidStop).map(i=>i.bind(t)(e))}),this.eventController){let{signalingOpenDurationMs:r,poorConnectionCount:n,startTimeMs:o,iceGatheringDurationMs:s,attendeePresenceDurationMs:a,meetingStartDurationMs:l}=this.meetingSessionContext,d={maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,meetingDurationMs:null===o?0:Math.round(Date.now()-o),meetingStatus:g.default[e.statusCode()],signalingOpenDurationMs:r,iceGatheringDurationMs:s,attendeePresenceDurationMs:a,poorConnectionCount:n,meetingStartDurationMs:l,retryCount:this.totalRetryCount},c=t&&t.message||(null===(i=e.toString)||void 0===i?void 0:i.call(e))||"";0===d.meetingDurationMs?(d.meetingErrorMessage=c,delete d.meetingDurationMs,delete d.attendeePresenceDurationMs,delete d.meetingStartDurationMs,this.eventController.publishEvent("meetingStartFailed",d)):e.isFailure()||e.isAudioConnectionFailure()?(d.meetingErrorMessage=c,this.eventController.publishEvent("meetingFailed",d)):this.eventController.publishEvent("meetingEnded",d)}}actionFinishUpdating(){if(!this.meetingSessionContext.enableSimulcast){if(this.useUpdateTransceiverControllerForUplink)this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController();else{let e=this.meetingSessionContext.videoCaptureAndEncodeParameter.encodeBitrates()[0];this.enforceBandwidthLimitationForSender(e)}}this.monitorTask.resumeResubscribeCheck(),this.receiveIndexTask.resumeIngestion(),this.logger.info("updated audio-video session")}reconnect(e,t){this.promotedToPrimaryMeeting&&(this.promotedToPrimaryMeeting=!1,this.forEachObserver(e=>{ea.Maybe.of(e.audioVideoWasDemotedFromPrimaryMeeting).map(t=>t.bind(e)(new m.default(g.default.AudioVideoDisconnectedWhilePromoted)))}));let i=this._reconnectController.retryWithBackoff(()=>s(this,void 0,void 0,function*(){this.sessionStateController.state()===I.default.NotConnected?this.sessionStateController.perform(T.default.Connect,()=>{this.actionConnect(!0)}):this.sessionStateController.perform(T.default.Reconnect,()=>{this.actionReconnect(e)}),this.totalRetryCount+=1}),()=>{this.logger.info("canceled retry")});return i||this.sessionStateController.perform(T.default.Fail,()=>{this.actionDisconnect(e,!1,t)}),i}actionReconnect(e){return s(this,void 0,void 0,function*(){this._reconnectController.hasStartedConnectionAttempt()||(this._reconnectController.startedConnectionAttempt(!1),this.forEachObserver(e=>{ea.Maybe.of(e.audioVideoDidStartConnecting).map(t=>t.bind(e)(!0))})),this.meetingSessionContext.volumeIndicatorAdapter.onReconnect(),this.connectionHealthData.reset(),this.receiveRemotePauseResumeTask=new K.default(this.meetingSessionContext);try{yield new Z.default(this.logger,this.wrapTaskName("AudioVideoReconnect"),[new et.default(this.logger,new Z.default(this.logger,"Media",[new D.default(this.meetingSessionContext),new Z.default(this.logger,"Signaling",[new z.default(this.meetingSessionContext),new B.default(this.meetingSessionContext)]),new L.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs),new q.default(this.meetingSessionContext),new et.default(this.logger,new Z.default(this.logger,"UpdateSession",[new R.default(this.meetingSessionContext),new F.default(this.meetingSessionContext),new X.default(this.meetingSessionContext),new V.default(this.meetingSessionContext),new ee.default(this.meetingSessionContext),new Y.default(this.meetingSessionContext),this.receiveRemotePauseResumeTask]),this.configuration.connectionTimeoutMs)]).run(),this.sessionStateController.perform(T.default.FinishConnecting,()=>{if(this.eventController){let{signalingOpenDurationMs:t,poorConnectionCount:i,startTimeMs:r,iceGatheringDurationMs:n,attendeePresenceDurationMs:o,meetingStartDurationMs:s}=this.meetingSessionContext,a={maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,meetingDurationMs:Math.round(Date.now()-r),meetingStatus:g.default[e.statusCode()],signalingOpenDurationMs:t,iceGatheringDurationMs:n,attendeePresenceDurationMs:o,poorConnectionCount:i,meetingStartDurationMs:s,retryCount:this.totalRetryCount};this.eventController.publishEvent("meetingReconnected",a)}this.actionFinishConnecting()})}catch(e){this.sessionStateController.perform(T.default.FinishConnecting,()=>{this.logger.info("failed to reconnect audio-video session");let t=new m.default(this.getMeetingStatusCode(e)||g.default.TaskFailed);this.handleMeetingSessionStatus(t,e)})}this.connectionHealthData.setConnectionStartTime()})}wrapTaskName(e){return`${e}/${this.configuration.meetingId}/${this.configuration.credentials.attendeeId}`}cleanUpMediaStreamsAfterStop(){this._mediaStreamBroker.removeMediaStreamBrokerObserver(this),this.meetingSessionContext.activeAudioInput=void 0,this.meetingSessionContext.activeVideoInput=void 0}getMeetingStatusCode(e){let t=/the meeting status code: (\d+)/.exec(e&&e.message);return t&&t.length>1?Number.parseInt(t[1],10):null}enforceBandwidthLimitationForSender(e){return s(this,void 0,void 0,function*(){yield this.meetingSessionContext.transceiverController.setVideoSendingBitrateKbps(e)})}handleMeetingSessionStatus(e,t){if(this.logger.info(`handling status: ${g.default[e.statusCode()]}`),!e.isTerminal()&&this.meetingSessionContext.statsCollector&&this.meetingSessionContext.statsCollector.logMeetingSessionStatus(e),e.statusCode()===g.default.IncompatibleSDP)return this.restartLocalVideo(()=>{this.logger.info("handled incompatible SDP by attempting to restart video")}),!0;if(e.statusCode()===g.default.VideoCallSwitchToViewOnly)return this._videoTileController.removeLocalVideoTile(),this.forEachObserver(e=>{ea.Maybe.of(e.videoSendDidBecomeUnavailable).map(t=>t.bind(e)())}),!1;if(e.statusCode()===g.default.AudioVideoWasRemovedFromPrimaryMeeting)return this.forEachObserver(t=>{ea.Maybe.of(t.audioVideoWasDemotedFromPrimaryMeeting).map(i=>i.bind(t)(e))}),!1;if(e.isTerminal()&&(this.logger.error("session will not be reconnected"),this.meetingSessionContext.reconnectController&&this.meetingSessionContext.reconnectController.disableReconnect()),(e.isFailure()||e.isTerminal())&&this.meetingSessionContext.reconnectController){let i=this.reconnect(e,t);return i?this.logger.warn(`The audio video controller will reconnect due to status code ${g.default[e.statusCode()]}${t?` and error: ${t.message}`:""}`):this.logger.error(`The audio video controller failed with status code ${g.default[e.statusCode()]}${t?` and error: ${t.message}`:""}`),i}return!1}setVideoMaxBandwidthKbps(e){if(e<=0)throw Error("Max bandwidth kbps has to be greater than 0");this.meetingSessionContext&&this.meetingSessionContext.videoUplinkBandwidthPolicy&&(this.logger.info(`video send has ideal max bandwidth ${e} kbps`),this.meetingSessionContext.videoUplinkBandwidthPolicy.setIdealMaxBandwidthKbps(e)),this.maxUplinkBandwidthKbps=e}handleHasBandwidthPriority(e){return s(this,void 0,void 0,function*(){if(this.meetingSessionContext&&this.meetingSessionContext.videoUplinkBandwidthPolicy&&!this.meetingSessionContext.enableSimulcast){if(this.useUpdateTransceiverControllerForUplink){this.meetingSessionContext.videoUplinkBandwidthPolicy.setHasBandwidthPriority(e),yield this.meetingSessionContext.videoUplinkBandwidthPolicy.updateTransceiverController();return}let t=this.meetingSessionContext.videoUplinkBandwidthPolicy.maxBandwidthKbps();this.meetingSessionContext.videoUplinkBandwidthPolicy.setHasBandwidthPriority(e);let i=this.meetingSessionContext.videoUplinkBandwidthPolicy.maxBandwidthKbps();t!==i&&(this.logger.info(`video send bandwidth priority ${e} max has changed from ${t} kbps to ${i} kbps`),yield this.enforceBandwidthLimitationForSender(i))}})}pauseReceivingStream(e){this.meetingSessionContext&&this.meetingSessionContext.signalingClient&&this.meetingSessionContext.signalingClient.pause([e])}resumeReceivingStream(e){this.meetingSessionContext&&this.meetingSessionContext.signalingClient&&this.meetingSessionContext.signalingClient.resume([e])}setVideoCodecSendPreferences(e){this.videoSendCodecPreferences=e,this.meetingSessionContext.videoSendCodecPreferences=e,this.sessionStateController.state()!==I.default.NotConnected&&this.update({needsRenegotiation:!0})}getRemoteVideoSources(){let{videoStreamIndex:e}=this.meetingSessionContext;if(!e)return this.logger.info("meeting has not started"),[];let t=this.configuration.credentials.attendeeId;return e.allVideoSendingSourcesExcludingSelf(t)}encodingSimulcastLayersDidChange(e){this.mayNeedRenegotiationForSimulcastLayerChange=!0,this.forEachObserver(t=>{ea.Maybe.of(t.encodingSimulcastLayersDidChange).map(i=>i.bind(t)(e))})}promoteToPrimaryMeeting(e){return this.actionPromoteToPrimaryMeeting(e)}actionPromoteToPrimaryMeeting(e){return s(this,void 0,void 0,function*(){let t=new m.default(g.default.SignalingRequestFailed);return yield new Z.default(this.logger,this.wrapTaskName("PromoteToPrimaryMeeting"),[new et.default(this.logger,new W.default(this.meetingSessionContext,e,e=>{t=e}),this.configuration.connectionTimeoutMs)]).run(),this.promotedToPrimaryMeeting=t.statusCode()===g.default.OK,t})}demoteFromPrimaryMeeting(){this.meetingSessionContext.signalingClient.demoteFromPrimaryMeeting(),this.forEachObserver(e=>{ea.Maybe.of(e.audioVideoWasDemotedFromPrimaryMeeting).map(t=>t.bind(e)(new m.default(g.default.OK)))})}videoInputDidChange(e){return s(this,void 0,void 0,function*(){if(this.logger.info("Receive a video input change event"),!this.meetingSessionContext||!this.meetingSessionContext.peer){this.logger.info("Skip updating video input because there is no active meeting and peer connection");return}this._videoTileController.hasStartedLocalVideoTile()&&(e?yield this.replaceLocalVideo(e):this._videoTileController.stopLocalVideoTile())})}audioInputDidChange(e){return s(this,void 0,void 0,function*(){if(this.logger.info("Receive an audio input change event"),!this.meetingSessionContext||!this.meetingSessionContext.peer){this.logger.info("Skip updating audio input because there is no active meeting and peer connection");return}if(!e)try{e=yield this.mediaStreamBroker.acquireAudioInputStream()}catch(e){this.logger.error("Could not acquire audio track from mediaStreamBroker");return}yield this.replaceLocalAudio(e)})}}t.default=ew,ew.MIN_VOLUME_DECIBELS=-42,ew.MAX_VOLUME_DECIBELS=-14,ew.PING_PONG_INTERVAL_MS=1e4},9836:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(8434)),o=r(i(3831)),s=r(i(209)),a=r(i(4015)),l=r(i(589)),d=r(i(8015)),c=r(i(3789)),u=r(i(5687)),h=r(i(6057)),f=r(i(9141)),p=r(i(7631)),m=r(i(9059));class g extends m.default{constructor(e){let t=new l.default;t.meetingId="",t.externalMeetingId="",t.credentials=new d.default,t.credentials.attendeeId="",t.credentials.joinToken="",t.urls=new h.default,t.urls.turnControlURL="",t.urls.audioHostURL="",t.urls.signalingURL="wss://localhost/";let i=new s.default;super(e||t,i,new p.default(new s.default),new a.default,new f.default(0,new n.default(0,0,0)),new o.default(e||t,i))}setAudioProfile(e){}start(){}stop(){}promoteToPrimaryMeeting(e){return Promise.resolve(new c.default(u.default.OK))}demoteFromPrimaryMeeting(){}}t.default=g},8538:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let n=i(7170);class o{constructor(e,t,i,r,n,o){this.audioVideoController=e,this.videoTileController=t,this.realtimeController=i,this.audioMixController=r,this.deviceController=n,this.contentShareController=o}addObserver(e){this.audioVideoController.addObserver(e),this.trace("addObserver")}removeObserver(e){this.audioVideoController.removeObserver(e),this.trace("removeObserver")}setAudioProfile(e){this.trace("setAudioProfile",e),this.audioVideoController.setAudioProfile(e)}start(e){this.audioVideoController.start(e),this.trace("start")}stop(){this.audioVideoController.stop(),this.trace("stop")}getRTCPeerConnectionStats(e){return this.trace("getRTCPeerConnectionStats",e?e.id:null),this.audioVideoController.getRTCPeerConnectionStats(e)}bindAudioElement(e){let t=this.audioMixController.bindAudioElement(e);return this.trace("bindAudioElement",e.id,t),t}unbindAudioElement(){this.audioMixController.unbindAudioElement(),this.trace("unbindAudioElement")}getCurrentMeetingAudioStream(){return this.trace("getCurrentConferenceStream"),this.audioMixController.getCurrentMeetingAudioStream()}addAudioMixObserver(e){this.trace("addAudioMixObserver"),this.audioMixController.addAudioMixObserver(e)}removeAudioMixObserver(e){this.trace("removeAudioMixObserver"),this.audioMixController.removeAudioMixObserver(e)}bindVideoElement(e,t){this.videoTileController.bindVideoElement(e,t),this.trace("bindVideoElement",{tileId:e,videoElementId:t.id})}unbindVideoElement(e,t=!0){this.videoTileController.unbindVideoElement(e,t),this.trace("unbindVideoElement",{tileId:e,cleanUpVideoElement:t})}startLocalVideoTile(){let e=this.videoTileController.startLocalVideoTile();return this.trace("startLocalVideoTile",null,e),e}stopLocalVideoTile(){this.videoTileController.stopLocalVideoTile(),this.trace("stopLocalVideoTile")}hasStartedLocalVideoTile(){let e=this.videoTileController.hasStartedLocalVideoTile();return this.trace("hasStartedLocalVideoTile",null,e),e}removeLocalVideoTile(){this.videoTileController.removeLocalVideoTile(),this.trace("removeLocalVideoTile")}getLocalVideoTile(){let e=this.videoTileController.getLocalVideoTile();return this.trace("getLocalVideoTile"),e}pauseVideoTile(e){this.videoTileController.pauseVideoTile(e),this.trace("pauseVideoTile",e)}unpauseVideoTile(e){this.videoTileController.unpauseVideoTile(e),this.trace("unpauseVideoTile",e)}getVideoTile(e){let t=this.videoTileController.getVideoTile(e);return this.trace("getVideoTile",e),t}getAllRemoteVideoTiles(){let e=this.videoTileController.getAllRemoteVideoTiles();return this.trace("getAllRemoteVideoTiles"),e}getAllVideoTiles(){let e=this.videoTileController.getAllVideoTiles();return this.trace("getAllVideoTiles"),e}addVideoTile(){let e=this.videoTileController.addVideoTile();return this.trace("addVideoTile",null,e.state()),e}removeVideoTile(e){this.videoTileController.removeVideoTile(e),this.trace("removeVideoTile",e)}removeVideoTilesByAttendeeId(e){let t=this.videoTileController.removeVideoTilesByAttendeeId(e);return this.trace("removeVideoTilesByAttendeeId",e,t),t}removeAllVideoTiles(){this.videoTileController.removeAllVideoTiles(),this.trace("removeAllVideoTiles")}captureVideoTile(e){let t=this.videoTileController.captureVideoTile(e);return this.trace("captureVideoTile",e),t}realtimeSubscribeToAttendeeIdPresence(e){this.realtimeController.realtimeSubscribeToAttendeeIdPresence(e),this.trace("realtimeSubscribeToAttendeeIdPresence")}realtimeUnsubscribeToAttendeeIdPresence(e){this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(e),this.trace("realtimeUnsubscribeToAttendeeIdPresence")}realtimeSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeSetCanUnmuteLocalAudio(e),this.trace("realtimeSetCanUnmuteLocalAudio",e)}realtimeSubscribeToSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeSubscribeToSetCanUnmuteLocalAudio(e),this.trace("realtimeSubscribeToSetCanUnmuteLocalAudio")}realtimeUnsubscribeToSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeUnsubscribeToSetCanUnmuteLocalAudio(e),this.trace("realtimeUnsubscribeToSetCanUnmuteLocalAudio")}realtimeCanUnmuteLocalAudio(){let e=this.realtimeController.realtimeCanUnmuteLocalAudio();return this.trace("realtimeCanUnmuteLocalAudio",null,e),e}realtimeMuteLocalAudio(){this.realtimeController.realtimeMuteLocalAudio(),this.trace("realtimeMuteLocalAudio")}realtimeUnmuteLocalAudio(){let e=this.realtimeController.realtimeUnmuteLocalAudio();return this.trace("realtimeUnmuteLocalAudio"),e}realtimeSubscribeToMuteAndUnmuteLocalAudio(e){this.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(e),this.trace("realtimeSubscribeToMuteAndUnmuteLocalAudio")}realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e){this.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e),this.trace("realtimeUnsubscribeToMuteAndUnmuteLocalAudio")}realtimeIsLocalAudioMuted(){let e=this.realtimeController.realtimeIsLocalAudioMuted();return this.trace("realtimeIsLocalAudioMuted"),e}realtimeSubscribeToVolumeIndicator(e,t){this.realtimeController.realtimeSubscribeToVolumeIndicator(e,t),this.trace("realtimeSubscribeToVolumeIndicator",e)}realtimeUnsubscribeFromVolumeIndicator(e,t){this.realtimeController.realtimeUnsubscribeFromVolumeIndicator(e,t),this.trace("realtimeUnsubscribeFromVolumeIndicator",e,t)}realtimeSubscribeToLocalSignalStrengthChange(e){this.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(e),this.trace("realtimeSubscribeToLocalSignalStrengthChange")}realtimeUnsubscribeToLocalSignalStrengthChange(e){this.realtimeController.realtimeUnsubscribeToLocalSignalStrengthChange(e),this.trace("realtimeUnsubscribeToLocalSignalStrengthChange")}realtimeSendDataMessage(e,t,i){this.realtimeController.realtimeSendDataMessage(e,t,i),this.trace("realtimeSendDataMessage")}realtimeSubscribeToReceiveDataMessage(e,t){this.realtimeController.realtimeSubscribeToReceiveDataMessage(e,t),this.trace("realtimeSubscribeToReceiveDataMessage")}realtimeUnsubscribeFromReceiveDataMessage(e){this.realtimeController.realtimeUnsubscribeFromReceiveDataMessage(e),this.trace("realtimeUnsubscribeFromReceiveDataMessage")}realtimeSubscribeToFatalError(e){this.realtimeController.realtimeSubscribeToFatalError(e),this.trace("realtimeSubscribeToFatalError")}realtimeUnsubscribeToFatalError(e){this.realtimeController.realtimeUnsubscribeToFatalError(e),this.trace("realtimeUnsubscribeToFatalError")}subscribeToActiveSpeakerDetector(e,t,i,r){this.audioVideoController.activeSpeakerDetector.subscribe(e,t,i,r),this.trace("subscribeToActiveSpeakerDetector")}unsubscribeFromActiveSpeakerDetector(e){this.audioVideoController.activeSpeakerDetector.unsubscribe(e),this.trace("unsubscribeFromActiveSpeakerDetector")}listAudioInputDevices(e=!1){return r(this,void 0,void 0,function*(){let t=yield this.deviceController.listAudioInputDevices(e);return this.trace("listAudioInputDevices",e,t),t})}listVideoInputDevices(e=!1){return r(this,void 0,void 0,function*(){let t=yield this.deviceController.listVideoInputDevices(e);return this.trace("listVideoInputDevices",e,t),t})}listAudioOutputDevices(e=!1){return r(this,void 0,void 0,function*(){let t=yield this.deviceController.listAudioOutputDevices(e);return this.trace("listAudioOutputDevices",e,t),t})}startAudioInput(e){return r(this,void 0,void 0,function*(){return this.trace("startAudioInput",e),this.deviceController.startAudioInput(e)})}stopAudioInput(){return r(this,void 0,void 0,function*(){return this.trace("stopAudioInput"),this.deviceController.stopAudioInput()})}startVideoInput(e){return r(this,void 0,void 0,function*(){return n.isVideoTransformDevice(e)?this.trace("startVideoInput with transform device"):this.trace("startVideoInput",e),this.deviceController.startVideoInput(e)})}stopVideoInput(){return r(this,void 0,void 0,function*(){return this.trace("stopVideoInput"),this.deviceController.stopVideoInput()})}chooseAudioOutput(e){let t=this.deviceController.chooseAudioOutput(e);return this.trace("chooseAudioOutput",e),t}addDeviceChangeObserver(e){this.deviceController.addDeviceChangeObserver(e),this.trace("addDeviceChangeObserver")}removeDeviceChangeObserver(e){this.deviceController.removeDeviceChangeObserver(e),this.trace("removeDeviceChangeObserver")}createAnalyserNodeForAudioInput(){let e=this.deviceController.createAnalyserNodeForAudioInput();return this.trace("createAnalyserNodeForAudioInput"),e}startVideoPreviewForVideoInput(e){this.deviceController.startVideoPreviewForVideoInput(e),this.trace("startVideoPreviewForVideoInput",e.id)}stopVideoPreviewForVideoInput(e){this.deviceController.stopVideoPreviewForVideoInput(e),this.trace("stopVideoPreviewForVideoInput",e.id)}setDeviceLabelTrigger(e){this.deviceController.setDeviceLabelTrigger(e),this.trace("setDeviceLabelTrigger")}mixIntoAudioInput(e){let t=this.deviceController.mixIntoAudioInput(e);return this.trace("mixIntoAudioInput",e.id),t}chooseVideoInputQuality(e,t,i){this.deviceController.chooseVideoInputQuality(e,t,i),this.trace("chooseVideoInputQuality",{width:e,height:t,frameRate:i})}setVideoMaxBandwidthKbps(e){this.audioVideoController.setVideoMaxBandwidthKbps(e),this.trace("setVideoMaxBandwidthKbps",e)}setVideoCodecSendPreferences(e){this.audioVideoController.setVideoCodecSendPreferences(e),this.trace("setVideoCodecSendPreferences",e)}getVideoInputQualitySettings(){let e=this.deviceController.getVideoInputQualitySettings();return this.trace("getVideoInputQualitySettings"),e}setContentAudioProfile(e){this.trace("setContentAudioProfile",e),this.contentShareController.setContentAudioProfile(e)}enableSimulcastForContentShare(e,t){this.trace("enableSimulcastForContentShare"),this.contentShareController.enableSimulcastForContentShare(e,t)}enableSVCForContentShare(e){this.trace("enableSVCForContentShare"),this.contentShareController.enableSVCForContentShare(e)}startContentShare(e){let t=this.contentShareController.startContentShare(e);return this.trace("startContentShare"),t}startContentShareFromScreenCapture(e,t){let i=this.contentShareController.startContentShareFromScreenCapture(e,t);return this.trace("startContentShareFromScreenCapture"),i}pauseContentShare(){this.contentShareController.pauseContentShare(),this.trace("pauseContentShare")}unpauseContentShare(){this.contentShareController.unpauseContentShare(),this.trace("unpauseContentShare")}stopContentShare(){this.contentShareController.stopContentShare(),this.trace("stopContentShare")}addContentShareObserver(e){this.contentShareController.addContentShareObserver(e),this.trace("addContentShareObserver")}removeContentShareObserver(e){this.contentShareController.removeContentShareObserver(e),this.trace("removeContentShareObserver")}setContentShareVideoCodecPreferences(e){this.contentShareController.setContentShareVideoCodecPreferences(e),this.trace("setContentShareVideoCodecPreferences")}trace(e,t,i){let r=this.audioVideoController.configuration.meetingId,n=this.audioVideoController.configuration.credentials.attendeeId,o=`API/DefaultAudioVideoFacade/${r}/${n}/${e}`;void 0!==t&&(o+=` ${JSON.stringify(t)}`),void 0!==i&&(o+=` -> ${JSON.stringify(i)}`),this.audioVideoController.logger.info(o)}getRemoteVideoSources(){let e=this.audioVideoController.getRemoteVideoSources();return this.trace("getRemoteVideoSources",null,e),e}get transcriptionController(){return this.realtimeController.transcriptionController}promoteToPrimaryMeeting(e){this.audioVideoController.removeObserver(this),this.audioVideoController.addObserver(this);let t=this.audioVideoController.promoteToPrimaryMeeting(e);return this.trace("promoteToPrimaryMeeting",null,t),t}demoteFromPrimaryMeeting(){this.trace("demoteFromPrimaryMeeting"),this.audioVideoController.demoteFromPrimaryMeeting()}audioVideoWasDemotedFromPrimaryMeeting(e){this.contentShareController.stopContentShare(),this.audioVideoController.removeObserver(this)}}t.default=o},179:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(8074)),s=i(9734);class a extends o.default{constructor(e,t){super(e,t),this.blurCanvas=document.createElement("canvas"),this.blurCanvasCtx=this.blurCanvas.getContext("2d"),this.blurCanvas.width=this.spec.model.input.width,this.blurCanvas.height=this.spec.model.input.height,this.logger.info("BackgroundBlur processor using builtin blur")}drawImageWithMask(e,t){let i=this.blurredImage,{canvasCtx:r,targetCanvas:n}=this,{width:o,height:s}=n;if(!t||!i){r.clearRect(0,0,o,s);return}this.scaledCanvas.getContext("2d").putImageData(t,0,0),this.blurCanvasCtx.putImageData(this.blurredImage,0,0),r.save(),r.clearRect(0,0,o,s),r.drawImage(this.scaledCanvas,0,0,o,s),r.globalCompositeOperation="source-in",r.drawImage(e,0,0,o,s),r.globalCompositeOperation="destination-over",r.drawImage(this.blurCanvas,0,0,o,s),r.restore()}setBlurStrength(e){if(super.setBlurStrength(e),this.worker){this.modelInitialized=!1,this.worker.postMessage({msg:"destroy"});let e=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:e.path,inputHeight:e.input.height,inputWidth:e.input.width,inputChannels:4,modelRangeMin:e.input.range[0],modelRangeMax:e.input.range[1],blurPixels:this.blurAmount}})}}setBlurPixels(){this.blurAmount=s.BlurStrengthMapper.getBlurAmount(this._blurStrength,{height:540}),this.logger.info(`background blur amount set to ${this.blurAmount}`)}handleInitialize(e){if(this.logger.info(`received initialize message: ${this.stringify(e)}`),!e.payload){this.logger.error("failed to initialize module"),this.initWorkerPromise.reject(Error("failed to initialize the module"));return}let t=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:t.path,inputHeight:t.input.height,inputWidth:t.input.width,inputChannels:4,modelRangeMin:t.input.range[0],modelRangeMax:t.input.range[1],blurPixels:this.blurAmount}}),this.initWorkerPromise.resolve({})}handlePredict(e){this.blurredImage=e.payload.blurOutput,super.handlePredict(e)}destroy(){var e;let t=Object.create(null,{destroy:{get:()=>super.destroy}});return r(this,void 0,void 0,function*(){t.destroy.call(this),null===(e=this.blurCanvas)||void 0===e||e.remove(),this.blurCanvas=void 0})}}t.default=a},8074:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1851)),s=i(9734),a=n(i(9852));class l extends o.default{constructor(e,t){super("background blur",e,t,new a.default),this.blurAmount=0,this.setBlurStrength(t.blurStrength),this.logger.info("BackgroundBlur processor successfully created"),this.logger.info(`BackgroundBlur spec: ${this.stringify(this.spec)}`),this.logger.info(`BackgroundBlur options: { blurStrength: ${t.blurStrength}, filterCPUUtilization: ${t.filterCPUUtilization}, reportingPeriodMillis: ${t.reportingPeriodMillis}}`)}validateOptions(e){if(super.validateOptions(e),!e.blurStrength)throw Error("processor has null options - blurStrength")}initOnFirstExecution(){this.setBlurPixels()}drawImageWithMask(e,t){t||(t=new ImageData(this.spec.model.input.width,this.spec.model.input.height)),this.scaledCanvas.getContext("2d").putImageData(t,0,0);let{canvasCtx:i,targetCanvas:r}=this,{width:n,height:o}=r;i.save(),i.clearRect(0,0,n,o),i.drawImage(this.scaledCanvas,0,0,n,o),i.globalCompositeOperation="source-in",i.drawImage(e,0,0,n,o),i.globalCompositeOperation="destination-over",i.filter=`blur(${this.blurAmount}px)`,i.drawImage(e,0,0,r.width,r.height),i.restore()}setBlurStrength(e){this._blurStrength=e,this.logger.info(`blur strength set to ${this._blurStrength}`),this.setBlurPixels()}setBlurPixels(){this.blurAmount=s.BlurStrengthMapper.getBlurAmount(this._blurStrength,{height:this.sourceHeight}),this.logger.info(`background blur amount set to ${this.blurAmount}`)}addObserver(e){this.delegate.addObserver(e)}removeObserver(e){this.delegate.removeObserver(e)}static isSupported(){return r(this,void 0,void 0,function*(){let e=document.createElement("canvas"),t=void 0!==e.getContext("2d").filter;return e.remove(),t})}setEventController(e){this.eventController?this.eventController=e:(this.eventController=e,this.publishBackgroundFilterEvent())}publishBackgroundFilterEvent(){let e={backgroundBlurEnabled:"true",backgroundBlurStrength:this._blurStrength,backgroundReplacementEnabled:"false",backgroundFilterVersion:1};this.eventController.publishEvent("backgroundFilterConfigSelected",e)}}t.default=l},9734:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlurStrengthMapper=void 0;let i={LOW:7,MEDIUM:15,HIGH:30};class r{static getBlurAmount(e,t){if(e<=0)throw Error(`invalid value for blur strength: ${e}`);return Math.round(e*t.height/this.BLUR_STRENGTH_DIVISOR)}}t.BlurStrengthMapper=r,r.BLUR_STRENGTH_DIVISOR=540,t.default=i},1260:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(4243)),s=n(i(8030)),a=n(i(813)),l=n(i(2801)),d=n(i(179)),c=n(i(8074)),u=n(i(9734));class h extends l.default{setBlurStrength(){}loadAssets(){return r(this,void 0,void 0,function*(){})}addObserver(){}removeObserver(){}}class f extends o.default{static create(e,t){return r(this,void 0,void 0,function*(){let i;e=f.resolveSpec(e);let{logger:r}=t=f.resolveOptions(t),n=yield f.isSupported(e,t);return(r.info(`processor is ${n?"":"not"} supported`),n)?((yield c.default.isSupported())?(r.info("Using browser-provided background blur"),i=new c.default(e,t)):(r.info("Using built-in background blur"),i=new d.default(e,t)),yield i.loadAssets(),i):(r.warn("Using no-op processor because background blur is not supported"),new h)})}static resolveOptions(e={}){let t=Object.assign({},e);return t.blurStrength||(t.blurStrength=u.default.MEDIUM),t.logger||(t.logger=new s.default("BackgroundBlurProcessor",a.default.INFO)),t=super.resolveOptions(t)}static isSupported(e,t){return e=f.resolveSpec(e),t=f.resolveOptions(t),super.isSupported(e,t)}}t.default=f},9852:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(4627));class o extends n.default{}t.default=o},22:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.path=null,this.input=null,this.output=null}static builder(){return new i}withDefaultModel(){return this.withSelfieSegmentationDefaults()}withSelfieSegmentationDefaults(){let e={height:144,width:256,range:[0,1],channels:3},t={height:144,width:256,range:[0,1],channels:1},i="https://static.sdkassets.chime.aws/bgblur/models/selfie_segmentation_landscape.tflite";return this.path=i,this.input=e,this.output=t,this}withPath(e){return this.path=e,this}withInput(e){return this.input=e,this}withOutput(e){return this.output=e,this}validate(){if(!this.path)throw Error("model spec path is not set");if(!this.input)throw Error("model spec input is not set");if(!this.output)throw Error("model spec output is not set")}build(){return this.validate(),{path:this.path,input:this.input,output:this.output}}}t.default=i},3368:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=.8;class r{constructor(e,t,i,r){this.delegate=e,this.reportingPeriodMillis=t,this.filterCPUUtilization=i,this.logger=r,this._processingFilter=!0,this.lastReportedEventTimestamp=0,this.lastFilterCompleteTimestamp=0,this.filterTotalMillis=0,this.filterCount=0,this.framerate=0,this.filterDurationNotifyMillis=0,this.setSegmentationDuration()}reportEvent(e){let t=e-this.lastReportedEventTimestamp;if(t>=this.reportingPeriodMillis){let i=this.filterCount,r=this.filterTotalMillis;if(this.filterCount=0,this.filterTotalMillis=0,this.lastReportedEventTimestamp=e,0===this.framerate||0===i)return;let n=Math.round(r/i),o=Math.round(this.framerate*(t/1e3))-i,s=Math.round(100*r/t);n>=this.filterDurationNotifyMillis&&this.delegate.filterFrameDurationHigh({framesDropped:o,avgFilterDurationMillis:n,framerate:this.framerate,periodMillis:t}),s>=this.filterCPUUtilization&&this.delegate.filterCPUUtilizationHigh({cpuUtilization:s,filterMillis:r,periodMillis:t})}}setSegmentationDuration(){this.filterDurationNotifyMillis=Math.round(1e3/this.framerate*i)}frameReceived(e){e!==this.framerate&&(this.framerate=e,this.logger.info(`frame counter setting frame rate to ${this.framerate}`),this.setSegmentationDuration());let t=Date.now();this.reportEvent(t)}filterSubmitted(){this._processingFilter=!0,this.lastFilterCompleteTimestamp=Date.now()}filterComplete(){this.filterTotalMillis+=Date.now()-this.lastFilterCompleteTimestamp,this._processingFilter=!1,this.filterCount++}get processingSegment(){return this._processingFilter}}t.default=r},1851:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundFilterMonitor=void 0;let o=i(5021),s=n(i(9807)),a=n(i(3368));class l{constructor(){this.value=void 0,this.resolve=null}whenNext(){return this.promise||(this.promise=new Promise(e=>this.resolve=e)),this.promise}next(e){this.value=e,this.resolve(e),delete this.promise}}class d{constructor(e,t,i,r,n){this.targetCanvas=document.createElement("canvas"),this.canvasCtx=this.targetCanvas.getContext("2d"),this.canvasVideoFrameBuffer=new s.default(this.targetCanvas),this.mask$=new l,this.sourceWidth=0,this.sourceHeight=0,this.frameNumber=0,this.videoFramesPerFilterUpdate=1,this.initWorkerPromise=d.createWorkerPromise(),this.loadModelPromise=d.createWorkerPromise(),this.modelInitialized=!1,this.destroyed=!1,this.filterType=e,this.validateSpec(t),this.validateOptions(i),this.spec=t,this.logger=i.logger,this.delegate=r,this.initCPUMonitor(i),this.eventController=n}static createWorkerPromise(){let e={resolve:null,reject:null,promise:null};return e.promise=new Promise((t,i)=>{e.resolve=t,e.reject=i}),e}validateSpec(e){if(!e)throw Error("processor has null spec");if(!e.model)throw Error("processor spec has null model");if(!e.paths)throw Error("processor spec has null paths")}validateOptions(e){if(!e)throw Error("processor has null options");if(!e.logger)throw Error("processor has null options - logger");if(!e.reportingPeriodMillis)throw Error("processor has null options - reportingPeriodMillis");if(!e.filterCPUUtilization)throw Error("processor has null options - filterCPUUtilization")}initCPUMonitor(e){let t=5e3,i=10,r=1;this.videoFramesPerFilterUpdate=1,this.frameCounter=new a.default(this.delegate,e.reportingPeriodMillis,e.filterCPUUtilization,this.logger),this.cpuMonitor=new c(t,{reduceCPUUtilization:()=>{this.updateVideoFramesPerFilterUpdate(Math.min(this.videoFramesPerFilterUpdate+1,i))},increaseCPUUtilization:()=>{this.updateVideoFramesPerFilterUpdate(Math.max(this.videoFramesPerFilterUpdate-1,r))}}),this.delegate.addObserver(this.cpuMonitor)}stringify(e){return JSON.stringify(e,null,2)}handleInitialize(e){if(this.logger.info(`received initialize message: ${this.stringify(e)}`),!e.payload){this.logger.error("failed to initialize module"),this.initWorkerPromise.reject(Error("failed to initialize the module"));return}let t=this.spec.model;this.worker.postMessage({msg:"loadModel",payload:{modelUrl:t.path,inputHeight:t.input.height,inputWidth:t.input.width,inputChannels:4,modelRangeMin:t.input.range[0],modelRangeMax:t.input.range[1],blurPixels:0}}),this.initWorkerPromise.resolve({})}handleLoadModel(e){if(this.logger.info(`received load model message: ${this.stringify(e)}`),2!==e.payload){this.logger.error("failed to load model! status: "+e.payload),this.loadModelPromise.reject(Error("failed to load model! status: "+e.payload));return}this.modelInitialized=!0,this.loadModelPromise.resolve({})}handlePredict(e){this.mask$.next(e.payload.output)}handleWorkerEvent(e){let t=e.data;switch(t.msg){case"initialize":this.handleInitialize(t);break;case"loadModel":this.handleLoadModel(t);break;case"predict":this.handlePredict(t);break;default:this.logger.info(`unexpected event msg: ${this.stringify(t)}`)}}loadAssets(){return r(this,void 0,void 0,function*(){this.logger.info("start initializing the processor");try{this.worker=yield o.loadWorker(this.spec.paths.worker,"BackgroundFilterWorker",{},null),this.worker.addEventListener("message",e=>this.handleWorkerEvent(e)),this.worker.postMessage({msg:"initialize",payload:{wasmPath:this.spec.paths.wasm,simdPath:this.spec.paths.simd}}),yield this.initWorkerPromise.promise,this.logger.info(`successfully initialized the ${this.filterType} worker`),yield this.loadModelPromise.promise,this.logger.info(`successfully loaded ${this.filterType} worker segmentation model`)}catch(e){throw Error(`could not initialize the ${this.filterType} video frame processor due to '${e.message}'`)}this.logger.info(`successfully initialized the ${this.filterType} processor`)})}process(e){return r(this,void 0,void 0,function*(){if(this.destroyed)return e;this.frameCounter.frameReceived(e[0].framerate),this.cpuMonitor.frameReceived();let t=e[0].asCanvasElement();if(!t)return e;if(!this.modelInitialized)return e[0]=this.canvasVideoFrameBuffer,e;let i=t.width,r=t.height;if(0===i||0===r)return e;0===this.sourceWidth&&(this.sourceWidth=i,this.sourceHeight=r,this.targetCanvas.width=this.sourceWidth,this.targetCanvas.height=this.sourceHeight,this.logger.info(`${this.filterType} source width: ${this.sourceWidth}`),this.logger.info(`${this.filterType} source height: ${this.sourceHeight}`),this.initOnFirstExecution()),(this.sourceWidth!==i||this.sourceHeight!==r)&&(this.sourceWidth=i,this.sourceHeight=r,this.targetCanvas.width=this.sourceWidth,this.targetCanvas.height=this.sourceHeight);try{this.frameCounter.filterSubmitted();let e=this.mask$.value,i=this.spec.model.input.width/t.width,r=this.spec.model.input.height/t.height;void 0===this.scaledCanvas&&(this.scaledCanvas=document.createElement("canvas"),this.scaledCanvas.width=this.spec.model.input.width,this.scaledCanvas.height=this.spec.model.input.height);let n=this.scaledCanvas.getContext("2d");n.save(),n.scale(i,r),n.drawImage(t,0,0),n.restore();let o=n.getImageData(0,0,this.scaledCanvas.width,this.scaledCanvas.height);if(this.frameNumber%this.videoFramesPerFilterUpdate==0){let t=this.mask$.whenNext();this.worker.postMessage({msg:"predict",payload:o},[o.data.buffer]),e=yield t}this.destroyed||this.drawImageWithMask(t,e)}catch(t){return this.logger.error(`could not process ${this.filterType} frame buffer due to ${t}`),e}finally{this.frameCounter.filterComplete(),this.frameNumber++}return e[0]=this.canvasVideoFrameBuffer,e})}updateVideoFramesPerFilterUpdate(e){e!==this.videoFramesPerFilterUpdate&&(this.videoFramesPerFilterUpdate=e,this.logger.info(`Adjusting filter rate to compensate for CPU utilization. Filter rate is ${this.videoFramesPerFilterUpdate} video frames per filter.`))}destroy(){var e,t,i,n;return r(this,void 0,void 0,function*(){this.destroyed=!0,this.delegate.removeObserver(this.cpuMonitor),this.canvasVideoFrameBuffer.destroy(),null===(e=this.worker)||void 0===e||e.postMessage({msg:"destroy"}),null===(t=this.worker)||void 0===t||t.postMessage({msg:"stop"}),null===(i=this.targetCanvas)||void 0===i||i.remove(),this.targetCanvas=void 0,null===(n=this.scaledCanvas)||void 0===n||n.remove(),this.scaledCanvas=void 0,this.logger.info(`${this.filterType} frame process destroyed`)})}}t.default=d;class c{constructor(e,t){this.monitoringPeriodMillis=e,this.observer=t,this.lastCPUChangeTimestamp=0}filterCPUUtilizationHigh(){let e=Date.now();e-this.lastCPUChangeTimestamp>=this.monitoringPeriodMillis&&(this.lastCPUChangeTimestamp=e,this.observer.reduceCPUUtilization())}frameReceived(){let e=Date.now();e-this.lastCPUChangeTimestamp>=2*this.monitoringPeriodMillis&&(this.lastCPUChangeTimestamp=e,this.observer.increaseCPUUtilization())}}t.BackgroundFilterMonitor=c},4243:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=i(5021),s=i(9424),a=n(i(22)),l=n(i(543)),d=n(i(4046)),c=()=>a.default.builder().withSelfieSegmentationDefaults().build(),u="https://static.sdkassets.chime.aws",h={worker:`${u}/bgblur/workers/worker.js`,wasm:`${u}/bgblur/wasm/_cwt-wasm.wasm`,simd:`${u}/bgblur/wasm/_cwt-wasm-simd.wasm`};class f{static defaultAssetSpec(){let e=d.default.sdkVersionSemVer;return{assetGroup:`sdk-${e.major}.${e.minor}`}}static createUrlWithParams(e,t){let i=new URL(e);for(let e of Object.keys(t))void 0!==t[e]&&i.searchParams.set(e,t[e]);return i.toString()}static resolveSpec(e){let{paths:t=h,model:i=c(),assetGroup:r=this.defaultAssetSpec().assetGroup,revisionID:n=this.defaultAssetSpec().revisionID}=e||{},o={assetGroup:r,revisionID:n,sdk:encodeURIComponent(d.default.sdkVersion),ua:encodeURIComponent(d.default.sdkUserAgentLowResolution)};return t.worker=this.createUrlWithParams(t.worker,o),t.wasm=this.createUrlWithParams(t.wasm,o),t.simd=this.createUrlWithParams(t.simd,o),i.path=this.createUrlWithParams(i.path,o),{paths:t,model:i,assetGroup:r,revisionID:n}}static resolveOptions(e){e.reportingPeriodMillis||(e.reportingPeriodMillis=1e3);let t=30;return e.filterCPUUtilization?(e.filterCPUUtilization<0||e.filterCPUUtilization>100)&&(e.logger.warn(`filterCPUUtilization must be set to a range between 0 and 100 percent. Falling back to default of ${t} percent`),e.filterCPUUtilization=t):e.filterCPUUtilization=t,e}static isSupported(e,t){let{logger:i}=t;return"undefined"==typeof globalThis?(i.info("Browser does not have globalThis."),Promise.resolve(!1)):new l.default().supportsBackgroundFilter()?s.supportsWASM(globalThis,i)?this.supportsBackgroundFilter(globalThis,e,i):(i.info("Browser does not support WASM."),Promise.resolve(!1)):(i.info("Browser is not supported."),Promise.resolve(!1))}static supportsBackgroundFilter(e=globalThis,t,i){return r(this,void 0,void 0,function*(){if(!s.supportsWorker(e,i))return i.info("Browser does not support web workers."),!1;let r=t.paths.worker;try{let e=yield o.loadWorker(r,"BackgroundFilterWorker",{},null);try{e.terminate()}catch(e){i.info(`Failed to terminate worker. ${e.message}`)}return!0}catch(e){return i.info(`Failed to fetch and instantiate test worker ${e.message}`),!1}})}}t.default=f},4627:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.observers=new Set}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}filterFrameDurationHigh(e){var t;for(let i of this.observers)null===(t=i.filterFrameDurationHigh)||void 0===t||t.call(i,e)}filterCPUUtilizationHigh(e){var t;for(let i of this.observers)null===(t=i.filterCPUUtilizationHigh)||void 0===t||t.call(i,e)}}t.default=i},9392:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1851)),s=n(i(1447));class a extends o.default{constructor(e,t){super("background replacement",e,t,new s.default),this.replacementBlob=t.imageBlob,this.logger.info("BackgroundReplacement processor successfully created"),this.logger.info(`BackgroundReplacement spec: ${this.stringify(this.spec)}`),this.logger.info(`BackgroundReplacement options: { filterCPUUtilization: ${t.filterCPUUtilization}, reportingPeriodMillis: ${t.reportingPeriodMillis}}`)}setImageBlob(e){return r(this,void 0,void 0,function*(){this.replacementBlob=e,this.replacementImage=yield a.loadImage(this.createReplacementObjectUrl())})}initOnFirstExecution(){}drawImageWithMask(e,t){t||(t=new ImageData(this.spec.model.input.width,this.spec.model.input.height)),this.scaledCanvas.getContext("2d").putImageData(t,0,0);let{canvasCtx:i,targetCanvas:r}=this,{width:n,height:o}=r;i.save(),i.clearRect(0,0,n,o),i.drawImage(this.scaledCanvas,0,0,n,o),i.globalCompositeOperation="source-in",i.drawImage(e,0,0,n,o),i.globalCompositeOperation="destination-over",i.drawImage(this.replacementImage,0,0,r.width,r.height),i.restore()}static loadImageExecutor(e,t,i){let r=new Image;r.crossOrigin="Anonymous",r.addEventListener("load",()=>{e(r)},!1),r.addEventListener("error",e=>{t(Error(`Could not load replacement image ${r.src}: ${e.message}`))},!1),r.src=i}static loadImage(e){return r(this,void 0,void 0,function*(){return new Promise((t,i)=>this.loadImageExecutor(t,i,e))})}revokeReplacementObjectUrl(){this.replacementObjectUrl&&URL.revokeObjectURL(this.replacementObjectUrl)}createReplacementObjectUrl(){return this.revokeReplacementObjectUrl(),this.replacementObjectUrl=URL.createObjectURL(this.replacementBlob),this.replacementObjectUrl}loadAssets(){let e=Object.create(null,{loadAssets:{get:()=>super.loadAssets}});return r(this,void 0,void 0,function*(){this.replacementImage=yield a.loadImage(this.createReplacementObjectUrl()),e.loadAssets.call(this)})}addObserver(e){this.delegate.addObserver(e)}removeObserver(e){this.delegate.removeObserver(e)}destroy(){let e=Object.create(null,{destroy:{get:()=>super.destroy}});return r(this,void 0,void 0,function*(){e.destroy.call(this),this.revokeReplacementObjectUrl()})}setEventController(e){this.eventController?this.eventController=e:(this.eventController=e,this.publishBackgroundFilterEvent())}publishBackgroundFilterEvent(){let e={backgroundBlurEnabled:"false",backgroundBlurStrength:"low",backgroundReplacementEnabled:"true",backgroundFilterVersion:1};this.eventController.publishEvent("backgroundFilterConfigSelected",e)}}t.default=a},9854:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(4243)),s=n(i(8030)),a=n(i(813)),l=n(i(2801)),d=n(i(9392));class c extends l.default{loadAssets(){return r(this,void 0,void 0,function*(){})}addObserver(){}removeObserver(){}setImageBlob(){return r(this,void 0,void 0,function*(){})}}class u extends o.default{static create(e,t){return r(this,void 0,void 0,function*(){e=this.resolveSpec(e),t=this.resolveOptions(t),yield this.resolveOptionsAsync(t);let{logger:i}=t;if(!(yield u.isSupported(e,t)))return i.warn("Using no-op processor because background replacement is not supported"),new c;i.info("Using background replacement filter");let r=new d.default(e,t);return yield r.loadAssets(),r})}static resolveOptions(e={}){let t=Object.assign({},e);return t.logger||(t.logger=new s.default("BackgroundReplacementProcessor",a.default.INFO)),super.resolveOptions(t)}static resolveOptionsAsync(e){return r(this,void 0,void 0,function*(){if(!e.imageBlob){let t=document.createElement("canvas");t.width=100,t.height=100;let i=t.getContext("2d");i.fillStyle="blue",i.fillRect(0,0,100,100);let r=yield new Promise(e=>{t.toBlob(e)});e.imageBlob=r}})}static isSupported(e,t){let i=Object.create(null,{isSupported:{get:()=>super.isSupported}});return r(this,void 0,void 0,function*(){e=this.resolveSpec(e),t=this.resolveOptions(t),yield this.resolveOptionsAsync(t);let r=t.imageBlob,n=URL.createObjectURL(r);try{yield d.default.loadImage(n)}catch(e){return t.logger.info(`Failed to fetch load replacement image ${e.message}`),!1}finally{URL.revokeObjectURL(n)}return i.isSupported.call(this,e,t)})}}t.default=u},1447:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(4627));class o extends n.default{}t.default=o},8434:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i){this.fixedWaitMs=e,this.shortBackoffMs=t,this.longBackoffMs=i,this.currentRetry=0,this.fixedWaitMs<0&&(this.fixedWaitMs=0),this.shortBackoffMs<0&&(this.shortBackoffMs=0),this.longBackoffMs<0&&(this.longBackoffMs=0),this.reset()}reset(){this.currentRetry=0}nextBackoffAmountMs(){let e=Math.random()*Math.min(this.longBackoffMs,this.shortBackoffMs*Math.pow(2,this.currentRetry))+this.fixedWaitMs;return this.currentRetry+=1,e}}t.default=i},5640:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(8434)),o=r(i(7300));class s{constructor(e,t,i){this.fixedWaitMs=e,this.shortBackoffMs=t,this.longBackoffMs=i}create(){return new n.default(this.fixedWaitMs,this.shortBackoffMs,this.longBackoffMs)}createWithLimit(e){return new o.default(this.fixedWaitMs,this.shortBackoffMs,this.longBackoffMs,e)}}t.default=s},7300:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(8434));class o extends n.default{constructor(e,t,i,r){super(e,t,i),this.limit=r,this.attempts=0}nextBackoffAmountMs(){if(this.attempts++,this.attempts>this.limit)throw Error("retry limit exceeded");return super.nextBackoffAmountMs()}}t.default=o},543:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let n=i(3631),o=i(2238);class s{constructor(){this.FALLBACK_BROWSER={type:"browser",name:"unknown",version:"unknown",os:"unknown"},this.browser=n.detect()||this.FALLBACK_BROWSER,this.uaParserResult=navigator&&navigator.userAgent?new o.UAParser(navigator.userAgent).getResult():null,this.browserSupport={chrome:78,"edge-chromium":79,electron:7,firefox:75,ios:13,safari:13,opera:66,samsung:12,crios:86,fxios:23,"ios-webview":605,"chromium-webview":92},this.browserName={chrome:"Google Chrome","edge-chromium":"Microsoft Edge",electron:"Electron",firefox:"Mozilla Firefox",ios:"Safari iOS",safari:"Safari",opera:"Opera",samsung:"Samsung Internet",crios:"Chrome iOS",fxios:"Firefox iOS","ios-webview":"WKWebView iOS","chromium-webview":"Chrome WebView"},this.chromeLike=["chrome","edge-chromium","chromium-webview","opera","samsung"],this.webkitBrowsers=["crios","fxios","safari","ios","ios-webview","edge-ios"]}version(){return this.browser.version}majorVersion(){return null!==this.version()?parseInt(this.version().split(".")[0]):-1}osMajorVersion(){return parseInt(this.uaParserResult.os.version.split(".")[0])}engine(){return this.uaParserResult.engine.name}engineMajorVersion(){return parseInt(this.uaParserResult.engine.version.split(".")[0])}name(){return this.browser.name}hasChromiumWebRTC(){for(let e of this.chromeLike)if(e===this.browser.name)return!0;return!1}hasWebKitWebRTC(){for(let e of this.webkitBrowsers)if(e===this.browser.name)return!0;return!1}hasFirefoxWebRTC(){return this.isFirefox()}requiresPlaybackLatencyHintForAudioContext(){return -1!==navigator.userAgent.indexOf("Windows")}supportsCanvasCapturedStreamPlayback(){return!this.isIOSSafari()&&!this.isIOSChrome()&&!this.isIOSFirefox()&&!this.isIOSEdge()||this.isIOSSafari()&&this.majorVersion()>=s.MIN_IOS_SUPPORT_CANVAS_STREAM_PLAYBACK||this.majorVersion()>=s.MIN_IOS_NON_SAFARI_SUPPORT_CANVAS_STREAM_PLAYBACK}supportsBackgroundFilter(){return!!(("safari"!==this.name()||15!==this.majorVersion())&&this.supportsCanvasCapturedStreamPlayback())}supportsVideoLayersAllocationRtpHeaderExtension(){return this.hasChromiumWebRTC()}supportsDependencyDescriptorRtpHeaderExtension(){return this.hasChromiumWebRTC()}supportsScalableVideoCoding(){return this.hasChromiumWebRTC()&&"Blink"===this.engine()&&this.engineMajorVersion()>=111}supportsAudioRedundancy(){return this.hasChromiumWebRTC()?this.engineMajorVersion()>=107:!this.hasFirefoxWebRTC()}requiresResolutionAlignment(e,t){return this.isAndroid()&&this.isPixel3()?[64*Math.ceil(e/64),64*Math.ceil(t/64)]:[e,t]}requiresCheckForSdpConnectionAttributes(){return!this.isIOSSafari()&&!this.isIOSChrome()&&!this.isIOSFirefox()}requiresIceCandidateGatheringTimeoutWorkaround(){return this.hasChromiumWebRTC()}requiresBundlePolicy(){return"max-bundle"}requiresNoExactMediaStreamConstraints(){return this.isSamsungInternet()}requiresGroupIdMediaStreamConstraints(){return this.isSamsungInternet()}getDisplayMediaAudioCaptureSupport(){return this.isChrome()||this.isEdge()}doesNotSupportMediaDeviceLabels(){return"chromium-webview"===this.browser.name}isSupported(){return!(!this.browserSupport[this.browser.name]||this.majorVersion()<this.browserSupport[this.browser.name]||"firefox"===this.browser.name&&this.isAndroid())}isSimulcastSupported(){return this.hasChromiumWebRTC()}supportDownlinkBandwidthEstimation(){return!this.isFirefox()}supportString(){if(this.isAndroid())return`${this.browserName.chrome} ${this.browserSupport.chrome}+, ${this.browserName.samsung} ${this.browserSupport.samsung}+`;let e=[];for(let t in this.browserSupport)e.push(`${this.browserName[t]} ${this.browserSupport[t]}+`);return e.join(", ")}supportedVideoCodecs(){return r(this,void 0,void 0,function*(){let e=new RTCPeerConnection;return e.addTransceiver("video",{direction:"inactive",streams:[]}),(yield e.createOffer({offerToReceiveVideo:!0})).sdp.split("\r\n").filter(e=>e.includes("a=rtpmap:")).map(e=>e.replace(/.* /,"").replace(/\/.*/,"")).filter((e,t,i)=>i.indexOf(e)===t).filter(e=>"rtx"!==e&&"red"!==e&&"ulpfec"!==e)})}supportsSetSinkId(){return"setSinkId"in HTMLAudioElement.prototype}disableResolutionScaleDown(){return this.isAndroid()}disable480pResolutionScaleDown(){return/( Chrome\/98\.)/i.test(navigator.userAgent)&&this.browser.os.startsWith("Windows")}requiresDisablingH264Encoding(){return this.isIOS()&&("15.1.0"===this.version()||/( OS 15_1)/i.test(navigator.userAgent))}requiresVideoPlayWorkaround(){return this.isSafari()}requiresAudioContextResetOnDeviceFailureForWebAudio(){return this.isIOS()}isVideoFxSupportedBrowser(){return this.supportsBackgroundFilter()}isIOSSafari(){return"ios"===this.browser.name||"ios-webview"===this.browser.name||"safari"===this.browser.name&&/( Mac )/i.test(navigator.userAgent)&&navigator.maxTouchPoints>1}isSafari(){return"safari"===this.browser.name||this.isIOSSafari()}isFirefox(){return"firefox"===this.browser.name}isIOSFirefox(){return"fxios"===this.browser.name}isIOSChrome(){return"crios"===this.browser.name}isChrome(){return"chrome"===this.browser.name}isEdge(){return"edge-chromium"===this.browser.name}isIOSEdge(){return"edge-ios"===this.browser.name}isSamsungInternet(){return"samsung"===this.browser.name}isAndroid(){return/(android)/i.test(navigator.userAgent)}isPixel3(){return/( pixel 3)/i.test(navigator.userAgent)}isIOS(){return this.isIOSSafari()||this.isIOSChrome()||this.isIOSFirefox()}}t.default=s,s.MIN_IOS_SUPPORT_CANVAS_STREAM_PLAYBACK=16,s.MIN_IOS_NON_SAFARI_SUPPORT_CANVAS_STREAM_PLAYBACK=106},4571:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(289),o=r(i(6196)),s=r(i(9496)),a=r(i(2306));class l{constructor(e,t,i){this.logger=e,this.videoStreamIndex=t,this.selfAttendeeId=i,this.globalMetricReport=new a.default,this.streamMetricReports={},this.rtcStatsReport={},this.customStatsReports=[],this.currentTimestampMs=0,this.previousTimestampMs=0,this.currentSsrcs={},this.overriddenObservableMetrics=new Map,this.identityValue=(e,t)=>Number((t?this.streamMetricReports[t]:this.globalMetricReport).currentMetrics[e]),this.decoderLossPercent=(e,t)=>{let i=this.streamMetricReports[t],r=i.currentMetrics.concealedSamples-(i.previousMetrics.concealedSamples||0),n=i.currentMetrics.totalSamplesReceived-(i.previousMetrics.totalSamplesReceived||0);return n<=0||n-r<=0?0:r/n*100},this.packetLossPercent=(e,t)=>{let i=this.streamMetricReports[t],r=i.currentMetrics[e]-(i.previousMetrics[e]||0),n=i.currentMetrics.packetsLost-(i.previousMetrics.packetsLost||0),o=r+n;return o<=0||n<=0?0:100*n/o},this.jitterBufferMs=(e,t)=>{let i=this.streamMetricReports[t],r=i.currentMetrics.jitterBufferDelay-(i.previousMetrics.jitterBufferDelay||0),n=i.currentMetrics.jitterBufferEmittedCount-(i.previousMetrics.jitterBufferEmittedCount||0);return r<=0||n<=0?0:r/n*1e3},this.countPerSecond=(e,t)=>{let i=t?this.streamMetricReports[t]:this.globalMetricReport,r=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(r<=0)return 0;this.previousTimestampMs<=0&&(r=1);let n=i.currentMetrics[e]-(i.previousMetrics[e]||0);return n<=0?0:Math.trunc(n/r)},this.bitsPerSecond=(e,t)=>{let i=t?this.streamMetricReports[t]:this.globalMetricReport,r=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(r<=0)return 0;this.previousTimestampMs<=0&&(r=1);let n=(i.currentMetrics[e]-(i.previousMetrics[e]||0))*8;return n<=0?0:Math.trunc(n/r)},this.secondsToMilliseconds=(e,t)=>Number(1e3*(t?this.streamMetricReports[t]:this.globalMetricReport).currentMetrics[e]),this.averageTimeSpentPerSecondInMilliseconds=(e,t)=>{let i=t?this.streamMetricReports[t]:this.globalMetricReport,r=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(r<=0)return 0;this.previousTimestampMs<=0&&(r=1);let n=i.currentMetrics[e]-(i.previousMetrics[e]||0);return n<=0?0:1e3*n/r},this.averageCpuQualityLimitationDurationPerSecondInMilliseconds=(e,t)=>{let i=this.streamMetricReports[t];if(void 0===i.previousObjectMetrics[e]||void 0===i.currentObjectMetrics[e])return NaN;let r=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(r<=0)return 0;this.previousTimestampMs<=0&&(r=1);let n=0,o=0;for(let[t,r]of Object.entries(i.previousObjectMetrics[e]))"cpu"===t&&(n=r);for(let[t,r]of Object.entries(i.currentObjectMetrics[e]))"cpu"===t&&(o=r);let s=o-n;return s<=0?0:1e3*s/r},this.isHardwareImplementation=(e,t)=>{let i=this.streamMetricReports[t];if(void 0===i.currentStringMetrics[e])return NaN;let r=String(i.currentStringMetrics[e]),n=r.includes("ExternalDecoder")||r.includes("ExternalEncoder")||r.includes("EncodeAccelerator")||r.includes("DecodeAccelerator"),o=r.includes("fallback from");return n&&!o?1:0},this.globalMetricMap={retransmittedBytesSent:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_RETRANSMIT_BITRATE},totalEncodedBytesTarget:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_TARGET_ENCODER_BITRATE},totalPacketSendDelay:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_BUCKET_DELAY_MS},packetsDiscardedOnSend:{transform:this.countPerSecond,type:n.SdkMetric.Type.SOCKET_DISCARDED_PPS},availableIncomingBitrate:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_AVAILABLE_RECEIVE_BANDWIDTH},availableOutgoingBitrate:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_AVAILABLE_SEND_BANDWIDTH},currentRoundTripTime:{transform:this.secondsToMilliseconds,type:n.SdkMetric.Type.STUN_RTT_MS},audioLevel:{transform:this.identityValue,type:n.SdkMetric.Type.RTC_MIC_AUDIO_LEVEL,source:"audioLevel"}},this.audioUpstreamMetricMap={jitter:{transform:this.secondsToMilliseconds,type:n.SdkMetric.Type.RTC_MIC_JITTER_MS},packetsSent:{transform:this.countPerSecond,type:n.SdkMetric.Type.RTC_MIC_PPS},bytesSent:{transform:this.bitsPerSecond,type:n.SdkMetric.Type.RTC_MIC_BITRATE},roundTripTime:{transform:this.secondsToMilliseconds,type:n.SdkMetric.Type.RTC_MIC_RTT_MS},packetsLost:{transform:this.packetLossPercent,type:n.SdkMetric.Type.RTC_MIC_FRACTION_PACKET_LOST_PERCENT,source:"packetsSent"}},this.audioDownstreamMetricMap={concealedSamples:{transform:this.countPerSecond},totalSamplesReceived:{transform:this.countPerSecond},decoderLoss:{transform:this.decoderLossPercent,type:n.SdkMetric.Type.RTC_SPK_FRACTION_DECODER_LOSS_PERCENT},packetsReceived:{transform:this.countPerSecond,type:n.SdkMetric.Type.RTC_SPK_PPS},packetsLost:{transform:this.packetLossPercent,type:n.SdkMetric.Type.RTC_SPK_FRACTION_PACKET_LOST_PERCENT,source:"packetsReceived"},jitter:{transform:this.secondsToMilliseconds,type:n.SdkMetric.Type.RTC_SPK_JITTER_MS},jitterBufferDelay:{transform:this.countPerSecond},jitterBufferEmittedCount:{transform:this.countPerSecond},jitterBufferMs:{transform:this.jitterBufferMs,type:n.SdkMetric.Type.RTC_SPK_JITTER_BUFFER_MS},bytesReceived:{transform:this.bitsPerSecond,type:n.SdkMetric.Type.RTC_SPK_BITRATE},audioLevel:{transform:this.identityValue,type:n.SdkMetric.Type.RTC_SPK_AUDIO_LEVEL},totalAudioPacketsLost:{transform:this.identityValue,type:n.SdkMetric.Type.RTC_SPK_TOTAL_LOST},totalAudioPacketsExpected:{transform:this.identityValue,type:n.SdkMetric.Type.RTC_SPK_TOTAL_EXPECTED},totalAudioPacketsRecoveredRed:{transform:this.identityValue,type:n.SdkMetric.Type.RTC_SPK_TOTAL_RECOVERED_RED},totalAudioPacketsRecoveredFec:{transform:this.identityValue,type:n.SdkMetric.Type.RTC_SPK_TOTAL_RECOVERED_FEC}},this.videoUpstreamMetricMap={roundTripTime:{transform:this.secondsToMilliseconds,type:n.SdkMetric.Type.VIDEO_SENT_RTT_MS},nackCount:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_NACKS_RECEIVED},pliCount:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_PLIS_RECEIVED},firCount:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_FIRS_RECEIVED},framesPerSecond:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_INPUT_FPS},framesEncoded:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_ENCODE_FPS},packetsSent:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_SENT_PPS},packetsLost:{transform:this.packetLossPercent,type:n.SdkMetric.Type.VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT,source:"packetsSent"},bytesSent:{transform:this.bitsPerSecond,type:n.SdkMetric.Type.VIDEO_SENT_BITRATE},qpSum:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_SENT_QP_SUM},frameHeight:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_ENCODE_HEIGHT},frameWidth:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_ENCODE_WIDTH},jitter:{transform:this.secondsToMilliseconds,type:n.SdkMetric.Type.VIDEO_SENT_JITTER_MS},totalEncodeTime:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:n.SdkMetric.Type.VIDEO_ENCODE_MS},encoderImplementation:{transform:this.isHardwareImplementation,type:n.SdkMetric.Type.VIDEO_ENCODER_IS_HARDWARE},qualityLimitationDurations:{transform:this.averageCpuQualityLimitationDurationPerSecondInMilliseconds,type:n.SdkMetric.Type.VIDEO_QUALITY_LIMITATION_DURATION_CPU},videoCodecDegradationHighEncodeCpu:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_CODEC_DEGRADATION_HIGH_ENCODE_CPU},videoCodecDegradationEncodeFailure:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_CODEC_DEGRADATION_ENCODE_FAILURE},videoInputWidth:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_INPUT_WIDTH},videoInputHeight:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_INPUT_HEIGHT}},this.videoDownstreamMetricMap={packetsReceived:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_RECEIVED_PPS},packetsLost:{transform:this.packetLossPercent,type:n.SdkMetric.Type.VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT,source:"packetsReceived"},framesReceived:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_RECEIVED_FPS},framesDecoded:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_DECODE_FPS},nackCount:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_NACKS_SENT},firCount:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_FIRS_SENT},pliCount:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_PLIS_SENT},bytesReceived:{transform:this.bitsPerSecond,type:n.SdkMetric.Type.VIDEO_RECEIVED_BITRATE},jitter:{transform:this.secondsToMilliseconds,type:n.SdkMetric.Type.VIDEO_RECEIVED_JITTER_MS},jitterBufferDelay:{transform:this.countPerSecond},jitterBufferEmittedCount:{transform:this.countPerSecond},jitterBufferMs:{transform:this.jitterBufferMs,type:n.SdkMetric.Type.VIDEO_JITTER_BUFFER_MS},qpSum:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_RECEIVED_QP_SUM},frameHeight:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_DECODE_HEIGHT},frameWidth:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_DECODE_WIDTH},totalDecodeTime:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:n.SdkMetric.Type.VIDEO_DECODE_MS},decoderImplementation:{transform:this.isHardwareImplementation,type:n.SdkMetric.Type.VIDEO_DECODER_IS_HARDWARE},totalFreezesDuration:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:n.SdkMetric.Type.VIDEO_FREEZE_DURATION},freezeCount:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_FREEZE_COUNT},totalPausesDuration:{transform:this.averageTimeSpentPerSecondInMilliseconds,type:n.SdkMetric.Type.VIDEO_PAUSE_DURATION},pauseCount:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_PAUSE_COUNT},framesDropped:{transform:this.countPerSecond,type:n.SdkMetric.Type.VIDEO_DROPPED_FPS},videoRenderWidth:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_RENDER_WIDTH},videoRenderHeight:{transform:this.identityValue,type:n.SdkMetric.Type.VIDEO_RENDER_HEIGHT}},this.streamDimensionMap={encoderImplementation:n.SdkStreamDimension.Type.VIDEO_ENCODER_NAME,decoderImplementation:n.SdkStreamDimension.Type.VIDEO_DECODER_NAME},this.observableVideoMetricSpec={videoUpstreamBitrate:{source:"bytesSent",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamPacketsSent:{source:"packetsSent",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamPacketLossPercent:{source:"packetsLost",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamFramesEncodedPerSecond:{source:"framesEncoded",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamFramesInputPerSecond:{source:"framesPerSecond",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamFrameHeight:{source:"frameHeight",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamFrameWidth:{source:"frameWidth",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamJitterMs:{source:"jitter",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamRoundTripTimeMs:{source:"roundTripTime",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamEncoderImplementation:{source:"encoderImplementation",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamTotalEncodeTimePerSecond:{source:"totalEncodeTime",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoUpstreamCpuQualityLimitationDurationPerSecond:{source:"qualityLimitationDurations",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoDownstreamBitrate:{source:"bytesReceived",media:s.default.VIDEO,dir:o.default.DOWNSTREAM},videoDownstreamPacketLossPercent:{source:"packetsLost",media:s.default.VIDEO,dir:o.default.DOWNSTREAM},videoDownstreamPacketsReceived:{source:"packetsReceived",media:s.default.VIDEO,dir:o.default.DOWNSTREAM},videoDownstreamFramesDecodedPerSecond:{source:"framesDecoded",media:s.default.VIDEO,dir:o.default.DOWNSTREAM},videoDownstreamFrameHeight:{source:"frameHeight",media:s.default.VIDEO,dir:o.default.DOWNSTREAM},videoDownstreamFrameWidth:{source:"frameWidth",media:s.default.VIDEO,dir:o.default.DOWNSTREAM},videoDownstreamJitterMs:{source:"jitter",media:s.default.VIDEO,dir:o.default.DOWNSTREAM},videoDownstreamDelayMs:{source:"jitterBufferMs",media:s.default.VIDEO,dir:o.default.DOWNSTREAM}},this.observableMetricSpec={audioPacketsReceived:{source:"packetsReceived",media:s.default.AUDIO,dir:o.default.DOWNSTREAM},audioPacketsReceivedFractionLoss:{source:"packetsLost",media:s.default.AUDIO,dir:o.default.DOWNSTREAM},audioDecoderLoss:{source:"decoderLoss",media:s.default.AUDIO,dir:o.default.DOWNSTREAM},audioPacketsSent:{source:"packetsSent",media:s.default.AUDIO,dir:o.default.UPSTREAM},audioPacketLossPercent:{source:"packetsLost",media:s.default.AUDIO,dir:o.default.UPSTREAM},audioUpstreamRoundTripTimeMs:{source:"roundTripTime",media:s.default.AUDIO,dir:o.default.UPSTREAM},videoUpstreamBitrate:{source:"bytesSent",media:s.default.VIDEO,dir:o.default.UPSTREAM},videoPacketSentPerSecond:{source:"packetsSent",media:s.default.VIDEO,dir:o.default.UPSTREAM},audioSpeakerDelayMs:{source:"jitterBufferMs",media:s.default.AUDIO,dir:o.default.DOWNSTREAM},audioUpstreamJitterMs:{source:"jitter",media:s.default.AUDIO,dir:o.default.UPSTREAM},audioDownstreamJitterMs:{source:"jitter",media:s.default.AUDIO,dir:o.default.DOWNSTREAM},nackCountReceivedPerSecond:{source:"nackCount",media:s.default.VIDEO,dir:o.default.UPSTREAM},availableOutgoingBitrate:{source:"availableOutgoingBitrate"},availableIncomingBitrate:{source:"availableIncomingBitrate"},currentRoundTripTimeMs:{source:"currentRoundTripTime"},audioDownstreamLevel:{source:"audioLevel",media:s.default.AUDIO,dir:o.default.DOWNSTREAM},audioUpstreamLevel:{source:"audioLevel"}}}getMetricMap(e,t){switch(e){case s.default.AUDIO:switch(t){case o.default.UPSTREAM:return this.audioUpstreamMetricMap;case o.default.DOWNSTREAM:return this.audioDownstreamMetricMap}case s.default.VIDEO:switch(t){case o.default.UPSTREAM:return this.videoUpstreamMetricMap;case o.default.DOWNSTREAM:return this.videoDownstreamMetricMap}default:return this.globalMetricMap}}getStreamDimensionMap(){return this.streamDimensionMap}getObservableMetricValue(e){if(this.overriddenObservableMetrics.has(e))return this.overriddenObservableMetrics.get(e);let t=this.observableMetricSpec[e],{transform:i,source:r}=this.getMetricMap(t.media,t.dir)[t.source];if(!t.hasOwnProperty("media"))return i(r||t.source);for(let e in this.streamMetricReports){let n=this.streamMetricReports[e];if(n.direction===t.dir&&n.mediaType===t.media)return i(r||t.source,Number(e))}return 0}getObservableVideoMetricValue(e,t){let i=this.observableVideoMetricSpec[e],{transform:r,source:n}=this.getMetricMap(i.media,i.dir)[i.source];return r(n||i.source,t)}getVideoUpstreamSsrcs(){let e=[];for(let t in this.streamMetricReports)this.streamMetricReports[t].mediaType===s.default.VIDEO&&this.streamMetricReports[t].direction===o.default.UPSTREAM&&e.push(Number(t));return e}getObservableMetrics(){let e={};for(let t in this.observableMetricSpec)e[t]=this.getObservableMetricValue(t);return e}getObservableVideoMetrics(){let e={};if(!this.videoStreamIndex||!this.selfAttendeeId)return this.logger.error("Need to define VideoStreamIndex and selfAttendeeId if using getObservableVideoMetrics API"),e;for(let t in this.streamMetricReports)if(this.streamMetricReports[t].mediaType===s.default.VIDEO){let i={};for(let e in this.observableVideoMetricSpec)if(this.observableVideoMetricSpec[e].dir===this.streamMetricReports[t].direction){let r=this.getObservableVideoMetricValue(e,Number(t));isNaN(r)||(i[e]=r)}let r=this.streamMetricReports[t].groupId,n=this.streamMetricReports[t].streamId,o="";e[o=void 0!==this.videoStreamIndex.attendeeIdForGroupId?r?this.videoStreamIndex.attendeeIdForGroupId(r):this.selfAttendeeId:n?this.videoStreamIndex.attendeeIdForStreamId(n):this.selfAttendeeId]=e[o]?e[o]:{},e[o][t]=i}return e}getRTCStatsReport(){return this.rtcStatsReport}clone(){let e=new l(this.logger,this.videoStreamIndex,this.selfAttendeeId);return e.globalMetricReport=this.globalMetricReport,e.streamMetricReports=this.streamMetricReports,e.rtcStatsReport=this.rtcStatsReport,e.customStatsReports=this.customStatsReports,e.currentTimestampMs=this.currentTimestampMs,e.previousTimestampMs=this.previousTimestampMs,e.overriddenObservableMetrics=this.overriddenObservableMetrics,e}print(){let e={globalMetricReport:this.globalMetricReport,streamMetricReports:this.streamMetricReports,currentTimestampMs:this.currentTimestampMs,previousTimestampMs:this.previousTimestampMs};this.logger.debug(()=>`Client Metric Report: ${JSON.stringify(e)}`)}removeDestroyedSsrcs(){for(let e in this.streamMetricReports)this.currentSsrcs[e]||delete this.streamMetricReports[e]}overrideObservableMetric(e,t){this.overriddenObservableMetrics.set(e,t)}}t.default=l},6196:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientMetricReportDirection=void 0,function(e){e[e.UPSTREAM=0]="UPSTREAM",e[e.DOWNSTREAM=1]="DOWNSTREAM"}(i=t.ClientMetricReportDirection||(t.ClientMetricReportDirection={})),t.default=i},9496:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientMetricReportMediaType=void 0,function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO"}(i=t.ClientMetricReportMediaType||(t.ClientMetricReportMediaType={})),t.default=i},2770:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},2306:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.previousMetrics={},this.currentMetrics={},this.currentStringMetrics={},this.previousObjectMetrics={},this.currentObjectMetrics={}}}t.default=i},2353:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.currentTimestampMs=0,this.ssrc=0,this.totalAudioPacketsLost=0,this.totalAudioPacketsExpected=0,this.totalAudioPacketsRecoveredRed=0,this.totalAudioPacketsRecoveredFec=0}}t.default=i},2811:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.previousMetrics={},this.currentMetrics={},this.currentStringMetrics={},this.previousObjectMetrics={},this.currentObjectMetrics={}}}t.default=i},3940:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i){this.minHealth=e.minHealth,this.maxHealth=e.maxHealth,this.currentHealth=e.initialHealth,this.currentData=t.clone(),this.name=i}minimumHealth(){return this.minHealth}maximumHealth(){return this.maxHealth}health(){return this.maximumHealth()}update(e){this.currentData=e}getConnectionHealthData(){return this.currentData.clone()}healthy(){return this.health()>this.minimumHealth()}healthIfChanged(){let e=this.health();return e!==this.currentHealth?(this.currentHealth=e,e):null}}t.default=i},6688:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.connectionStartTimestampMs=0,this.consecutiveStatsWithNoPackets=0,this.consecutiveStatsWithNoAudioPacketsSent=0,this.lastPacketLossInboundTimestampMs=0,this.lastGoodSignalTimestampMs=0,this.lastWeakSignalTimestampMs=0,this.lastNoSignalTimestampMs=0,this.consecutiveMissedPongs=0,this.packetsReceivedInLastMinute=[],this.fractionPacketsLostInboundInLastMinute=[],this.audioSpeakerDelayMs=0,this.isVideoEncoderHardware=!1,this.videoEncodingTimeInMs=0,this.videoEncodingTimePerFrameInMs=0,this.cpuLimitationDuration=0,this.videoInputFps=0,this.videoEncodeFps=0,this.isContentShare=!1,this.numberOfPublishedVideoSources=0,this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}static isTimestampRecent(e,t){return Date.now()<e+t}setConnectionStartTime(){this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}reset(){this.connectionStartTimestampMs=0,this.consecutiveStatsWithNoPackets=0,this.consecutiveStatsWithNoAudioPacketsSent=0,this.lastPacketLossInboundTimestampMs=0,this.lastGoodSignalTimestampMs=0,this.lastWeakSignalTimestampMs=0,this.lastNoSignalTimestampMs=0,this.consecutiveMissedPongs=0,this.packetsReceivedInLastMinute=[],this.fractionPacketsLostInboundInLastMinute=[],this.audioSpeakerDelayMs=0,this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now(),this.isVideoEncoderHardware=!1,this.videoEncodingTimeInMs=0,this.videoEncodingTimePerFrameInMs=0,this.cpuLimitationDuration=0,this.videoInputFps=0,this.videoEncodeFps=0,this.isContentShare=!1,this.numberOfPublishedVideoSources=0}isConnectionStartRecent(e){return i.isTimestampRecent(this.connectionStartTimestampMs,e)}isLastPacketLossRecent(e){return i.isTimestampRecent(this.lastPacketLossInboundTimestampMs,e)}isGoodSignalRecent(e){return i.isTimestampRecent(this.lastGoodSignalTimestampMs,e)}isWeakSignalRecent(e){return i.isTimestampRecent(this.lastWeakSignalTimestampMs,e)}isNoSignalRecent(e){return i.isTimestampRecent(this.lastNoSignalTimestampMs,e)}clone(){let e=new i;return e.connectionStartTimestampMs=this.connectionStartTimestampMs,e.consecutiveStatsWithNoPackets=this.consecutiveStatsWithNoPackets,e.consecutiveStatsWithNoAudioPacketsSent=this.consecutiveStatsWithNoAudioPacketsSent,e.lastPacketLossInboundTimestampMs=this.lastPacketLossInboundTimestampMs,e.lastGoodSignalTimestampMs=this.lastGoodSignalTimestampMs,e.lastWeakSignalTimestampMs=this.lastWeakSignalTimestampMs,e.lastNoSignalTimestampMs=this.lastNoSignalTimestampMs,e.consecutiveMissedPongs=this.consecutiveMissedPongs,e.packetsReceivedInLastMinute=this.packetsReceivedInLastMinute.slice(0),e.fractionPacketsLostInboundInLastMinute=this.fractionPacketsLostInboundInLastMinute.slice(0),e.audioSpeakerDelayMs=this.audioSpeakerDelayMs,e.isVideoEncoderHardware=this.isVideoEncoderHardware,e.videoEncodingTimeInMs=this.videoEncodingTimeInMs,e.videoEncodingTimePerFrameInMs=this.videoEncodingTimePerFrameInMs,e.cpuLimitationDuration=this.cpuLimitationDuration,e.videoInputFps=this.videoInputFps,e.videoEncodeFps=this.videoEncodeFps,e.isContentShare=this.isContentShare,e.numberOfPublishedVideoSources=this.numberOfPublishedVideoSources,e}setConsecutiveMissedPongs(e){this.consecutiveMissedPongs=e}setConsecutiveStatsWithNoPackets(e){this.consecutiveStatsWithNoPackets=e}setConsecutiveStatsWithNoAudioPacketsSent(e){this.consecutiveStatsWithNoAudioPacketsSent=e}setLastPacketLossInboundTimestampMs(e){this.lastPacketLossInboundTimestampMs=e}setLastNoSignalTimestampMs(e){this.lastNoSignalTimestampMs=e}setLastWeakSignalTimestampMs(e){this.lastWeakSignalTimestampMs=e}setLastGoodSignalTimestampMs(e){this.lastGoodSignalTimestampMs=e}setAudioSpeakerDelayMs(e){this.audioSpeakerDelayMs=e}setIsVideoEncoderHardware(e){this.isVideoEncoderHardware=e}setVideoEncodingTimeInMs(e){this.videoEncodingTimeInMs=e}setVideoEncodingTimePerFrameInMs(e){this.videoEncodingTimePerFrameInMs=e}setCpuLimitationDuration(e){this.cpuLimitationDuration=e}setVideoInputFps(e){this.videoInputFps=e}setVideoEncodeFps(e){this.videoEncodeFps=e}setIsContentShare(e){this.isContentShare=e}setNumberOfPublishedVideoSources(e){this.numberOfPublishedVideoSources=e}}t.default=i},3731:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(7272)),o=r(i(8971)),s=r(i(5521));class a{constructor(){this.minHealth=0,this.maxHealth=1,this.initialHealth=1,this.connectionUnhealthyThreshold=25,this.noSignalThresholdTimeMs=1e4,this.connectionWaitTimeMs=1e4,this.zeroBarsNoSignalTimeMs=5e3,this.oneBarWeakSignalTimeMs=5e3,this.twoBarsTimeMs=5e3,this.threeBarsTimeMs=1e4,this.fourBarsTimeMs=2e4,this.fiveBarsTimeMs=6e4,this.cooldownTimeMs=6e4,this.pastSamplesToConsider=15,this.goodSignalTimeMs=15e3,this.fractionalLoss=.5,this.packetsExpected=50,this.maximumTimesToWarn=2,this.missedPongsLowerThreshold=1,this.missedPongsUpperThreshold=4,this.maximumAudioDelayMs=6e4,this.maximumAudioDelayDataPoints=10,this.sendingAudioFailureSamplesToConsider=2,this.sendingAudioFailureInitialWaitTimeMs=3e3,this.videoEncodingHealthPolicies=[n.default,o.default,s.default],this.consecutiveHighEncodeCpuThreshold=10,this.highEncodeCpuMsThreshold=500,this.highEncodeCpuMsPerFrameThreshold=15,this.consecutiveVideoEncodingFailureThreshold=5,this.concurrentVideoSendersThreshold=15}}t.default=a},9708:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(3940));class o extends n.default{constructor(e,t,i){super(t,i,"Reconnection Health"),this.logger=e,this.audioDelayPointsOverMaximum=0,o.CONNECTION_UNHEALTHY_THRESHOLD=t.connectionUnhealthyThreshold,o.CONNECTION_WAIT_TIME_MS=t.connectionWaitTimeMs,o.MISSED_PONGS_THRESHOLD=t.missedPongsUpperThreshold,o.MAXIMUM_AUDIO_DELAY_MS=t.maximumAudioDelayMs,o.MAXIMUM_AUDIO_DELAY_DATA_POINTS=t.maximumAudioDelayDataPoints}health(){if(this.currentData.isConnectionStartRecent(o.CONNECTION_WAIT_TIME_MS))return 1;let e=this.currentData.consecutiveStatsWithNoPackets>=o.CONNECTION_UNHEALTHY_THRESHOLD,t=this.currentData.consecutiveMissedPongs>=o.MISSED_PONGS_THRESHOLD;this.currentData.audioSpeakerDelayMs>o.MAXIMUM_AUDIO_DELAY_MS?this.audioDelayPointsOverMaximum+=1:this.audioDelayPointsOverMaximum=0;let i=this.audioDelayPointsOverMaximum>o.MAXIMUM_AUDIO_DELAY_DATA_POINTS;return(i&&(this.audioDelayPointsOverMaximum=0),e||t||i)?(this.logger.warn(`reconnection recommended due to: no packets received: ${e}, missed pongs: ${t}, bad audio delay: ${i}`),0):1}}t.default=o},2977:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(3940));class o extends n.default{constructor(e,t,i){super(t,i,"Sending Audio Health"),this.logger=e,this.sendingAudioFailureSamplesToConsider=t.sendingAudioFailureSamplesToConsider>0?t.sendingAudioFailureSamplesToConsider:1,this.sendingAudioFailureInitialWaitTimeMs=t.sendingAudioFailureInitialWaitTimeMs,this.maximumTimesToWarn=t.maximumTimesToWarn,this.coolDownTimeMs=t.cooldownTimeMs,this.lastWarnTimestampMs=0,this.warnCount=0}isSendingAudioUnhealthy(){let e=!this.currentData.isConnectionStartRecent(this.sendingAudioFailureInitialWaitTimeMs),t=this.currentData.consecutiveStatsWithNoAudioPacketsSent>=this.sendingAudioFailureSamplesToConsider;return e&&t}health(){if(this.isSendingAudioUnhealthy()){let e=Date.now()-this.lastWarnTimestampMs<this.coolDownTimeMs;return!(this.currentHealth>this.minimumHealth())||e?this.currentHealth:(this.logger.warn(`Sending Audio is unhealthy for ${this.sendingAudioFailureSamplesToConsider} seconds consecutively.`),this.warnCount++,this.warnCount>this.maximumTimesToWarn)?(this.logger.warn("SendingAudioFailure health policy maximum warnings breached. Falling back to reporting healthy."),this.maximumHealth()):(this.lastWarnTimestampMs=Date.now(),this.minimumHealth())}return this.maximumHealth()}}t.default=o},1922:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(3940));class o extends n.default{constructor(e,t){super(e,t,"Unusable Audio Warning"),this.coolDownTimeMs=e.cooldownTimeMs,this.pastSamplesToConsider=e.pastSamplesToConsider,this.fractionalLoss=e.fractionalLoss,this.packetsExpected=e.packetsExpected,this.maximumTimesToWarn=e.maximumTimesToWarn,this.lastWarnTimestampMs=0,this.warnCount=0}calculateFractionalLoss(){if(this.currentData.packetsReceivedInLastMinute.length<this.pastSamplesToConsider)return 0;let e=this.pastSamplesToConsider,t=e*this.packetsExpected,i=0;for(let t=0;t<e;t++)i+=this.currentData.packetsReceivedInLastMinute[t];return Math.min(Math.max(1-i/t,0),1)}health(){return Date.now()-this.lastWarnTimestampMs<this.coolDownTimeMs?this.currentHealth:this.calculateFractionalLoss()>=this.fractionalLoss?0!==this.currentHealth&&(this.lastWarnTimestampMs=Date.now(),this.warnCount++,this.warnCount>this.maximumTimesToWarn)?1:0:1}}t.default=o},7272:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(3940)),o=r(i(7752));class s extends n.default{constructor(e,t){super(e,t,o.default.VideoConcurrentSendersHealth),this.concurrentVideoSendersThreshold=e.concurrentVideoSendersThreshold}health(){return this.currentData.isContentShare?this.maximumHealth():this.currentData.numberOfPublishedVideoSources>this.concurrentVideoSendersThreshold?this.minimumHealth():this.maximumHealth()}}t.default=s},7752:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoEncodingConnectionHealthPolicyName=void 0,function(e){e.VideoEncodingCpuHealth="Video Encoding CPU Health",e.VideoEncodingFramerateHealth="Video Encoding framerate Health",e.VideoConcurrentSendersHealth="Video Concurrent Senders Health"}(i=t.VideoEncodingConnectionHealthPolicyName||(t.VideoEncodingConnectionHealthPolicyName={})),t.default=i},8971:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(3940)),o=r(i(7752));class s extends n.default{constructor(e,t){super(e,t,o.default.VideoEncodingCpuHealth),this.consecutiveHighEncodeCpuCnt=0,this.consecutiveHighEncodeCpuThreshold=e.consecutiveHighEncodeCpuThreshold,this.highEncodeCpuMsThreshold=e.highEncodeCpuMsThreshold,this.highEncodeCpuMsPerFrameThreshold=e.highEncodeCpuMsPerFrameThreshold}health(){let e=this.currentData.videoEncodingTimeInMs>=this.highEncodeCpuMsThreshold&&this.currentData.videoEncodingTimePerFrameInMs>=this.highEncodeCpuMsPerFrameThreshold;if(!this.currentData.isVideoEncoderHardware&&(e||this.currentData.cpuLimitationDuration>0)){if(this.consecutiveHighEncodeCpuCnt++,this.consecutiveHighEncodeCpuCnt>this.consecutiveHighEncodeCpuThreshold)return this.consecutiveHighEncodeCpuCnt=0,this.minimumHealth()}else this.consecutiveHighEncodeCpuCnt=0;return this.maximumHealth()}}t.default=s},5521:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(3940)),o=r(i(7752));class s extends n.default{constructor(e,t){super(e,t,o.default.VideoEncodingFramerateHealth),this.consecutiveEncodeFailureCnt=0,this.consecutiveVideoEncodingFailureThreshold=e.consecutiveVideoEncodingFailureThreshold}health(){if(0===this.currentData.videoEncodeFps&&this.currentData.videoInputFps>0){if(this.consecutiveEncodeFailureCnt++,this.consecutiveEncodeFailureCnt>this.consecutiveVideoEncodingFailureThreshold)return this.consecutiveEncodeFailureCnt=0,this.minimumHealth()}else this.consecutiveEncodeFailureCnt=0;return this.maximumHealth()}}t.default=s},8581:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=i(8660);class n{constructor(e,t,i,r,n){this.audioVideoController=e,this.realtimeController=t,this.connectionHealthData=i,this.pingPong=r,this.statsCollector=n,this.isActive=!1,this.hasSeenValidCandidatePairMetricsBefore=!1,this.lastTotalBytesReceived=0,this.lastTotalStunMessagesReceived=0,this.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(e=>{this.isActive&&this.receiveSignalStrengthChange(e)})}start(){this.isActive=!0,this.pingPong.addObserver(this),this.pingPong.start(),this.audioVideoController.addObserver(this)}stop(){this.isActive=!1,this.pingPong.removeObserver(this),this.pingPong.stop(),this.audioVideoController.removeObserver(this)}receiveSignalStrengthChange(e){0===e?this.connectionHealthData.setLastNoSignalTimestampMs(Date.now()):e<=.5?this.connectionHealthData.setLastWeakSignalTimestampMs(Date.now()):this.connectionHealthData.setLastGoodSignalTimestampMs(Date.now()),this.updateConnectionHealth()}didReceivePong(e,t,i){this.connectionHealthData.setConsecutiveMissedPongs(0),this.statsCollector.logLatency("ping_pong",t),this.statsCollector.logLatency("ping_pong_clock_skew",i),this.updateConnectionHealth()}didMissPongs(){this.connectionHealthData.setConsecutiveMissedPongs(this.connectionHealthData.consecutiveMissedPongs+1),this.updateConnectionHealth()}metricsDidReceive(e){let t=0,i=0,r=e.getObservableMetrics(),n=r.audioPacketsReceived,o=r.audioPacketsReceivedFractionLoss,s=r.audioSpeakerDelayMs;"number"!=typeof s||isNaN(s)||this.connectionHealthData.setAudioSpeakerDelayMs(s);let a=e.getRTCStatsReport(),l=0,d=0;a.forEach(e=>{"candidate-pair"===e.type&&(e.bytesReceived&&(l+=e.bytesReceived),e.requestsReceived&&(d+=e.requestsReceived),e.responsesReceived&&(d+=e.responsesReceived))});let c=l-this.lastTotalBytesReceived;this.lastTotalBytesReceived=l;let u=d-this.lastTotalStunMessagesReceived;this.lastTotalStunMessagesReceived=d,"number"==typeof n&&"number"==typeof o&&(t=n,i=o,t<0||i<0||c<0||u<0||(this.addToMinuteWindow(this.connectionHealthData.packetsReceivedInLastMinute,t),this.addToMinuteWindow(this.connectionHealthData.fractionPacketsLostInboundInLastMinute,i),c>0||u>0?(this.hasSeenValidCandidatePairMetricsBefore=!0,this.connectionHealthData.setConsecutiveStatsWithNoPackets(0)):this.hasSeenValidCandidatePairMetricsBefore&&this.connectionHealthData.setConsecutiveStatsWithNoPackets(this.connectionHealthData.consecutiveStatsWithNoPackets+1),(0===t||i>0)&&this.connectionHealthData.setLastPacketLossInboundTimestampMs(Date.now()),"number"==typeof r.audioPacketsSent&&this.updateAudioPacketsSentInConnectionHealth(r.audioPacketsSent),this.updateVideoEncodingHealth(e),this.updateConnectionHealth()))}updateAudioPacketsSentInConnectionHealth(e){e>0?this.connectionHealthData.setConsecutiveStatsWithNoAudioPacketsSent(0):this.connectionHealthData.setConsecutiveStatsWithNoAudioPacketsSent(this.connectionHealthData.consecutiveStatsWithNoAudioPacketsSent+1)}updateVideoEncodingHealth(e){let t=this.audioVideoController.videoTileController.hasStartedLocalVideoTile(),i=e.getVideoUpstreamSsrcs();if(!t||0===i.length){this.connectionHealthData.setIsVideoEncoderHardware(!1),this.connectionHealthData.setVideoEncodingTimePerFrameInMs(0),this.connectionHealthData.setCpuLimitationDuration(0),this.connectionHealthData.setVideoInputFps(0),this.connectionHealthData.setVideoEncodeFps(0);return}let r=!1,n=0,o=0,s=0,a=0;for(let t of i)r||(r=!!e.getObservableVideoMetricValue("videoUpstreamEncoderImplementation",t)),n+=e.getObservableVideoMetricValue("videoUpstreamTotalEncodeTimePerSecond",t),o+=e.getObservableVideoMetricValue("videoUpstreamCpuQualityLimitationDurationPerSecond",t),s+=e.getObservableVideoMetricValue("videoUpstreamFramesInputPerSecond",t),a+=e.getObservableVideoMetricValue("videoUpstreamFramesEncodedPerSecond",t);let l=a>0?n/a:0;this.connectionHealthData.setIsVideoEncoderHardware(!!r),this.connectionHealthData.setVideoEncodingTimeInMs(n),this.connectionHealthData.setVideoEncodingTimePerFrameInMs(l),this.connectionHealthData.setCpuLimitationDuration(o),this.connectionHealthData.setVideoInputFps(s),this.connectionHealthData.setVideoEncodeFps(a)}addToMinuteWindow(e,t){e.unshift(t),e.length>60&&e.pop()}updateConnectionHealth(){this.audioVideoController.forEachObserver(e=>{r.Maybe.of(e.connectionHealthDidChange).map(t=>t.bind(e)(this.connectionHealthData.clone()))})}}t.default=n},8890:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Modality="#content"}(i||(i={})),t.default=i},8370:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(543)),s=n(i(4142));class a{constructor(e){this.logger=e}get mediaStream(){return this._mediaStream}set mediaStream(e){this._mediaStream=e}acquireAudioInputStream(){return r(this,void 0,void 0,function*(){return 0===this._mediaStream.getAudioTracks().length?(this.logger.info("No audio stream available. Synthesizing an audio stream."),s.default.synthesizeAudioDevice(0)):this._mediaStream})}acquireVideoInputStream(){return r(this,void 0,void 0,function*(){return this._mediaStream})}acquireDisplayInputStream(e){return r(this,void 0,void 0,function*(){return e&&e.video&&e.video.mandatory&&e.video.mandatory.chromeMediaSource&&e.video.mandatory.chromeMediaSourceId?navigator.mediaDevices.getUserMedia(e):navigator.mediaDevices.getDisplayMedia(e)})}acquireScreenCaptureDisplayInputStream(e,t){return r(this,void 0,void 0,function*(){return this.acquireDisplayInputStream(this.screenCaptureDisplayMediaConstraints(e,t))})}screenCaptureDisplayMediaConstraints(e,t){return{audio:!!(!e&&new o.default().getDisplayMediaAudioCaptureSupport()),video:Object.assign(Object.assign({},!e&&{frameRate:{max:t||a.defaultFrameRate}}),e&&{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:t||a.defaultFrameRate}})}}toggleMediaStream(e){let t=!1;if(this.mediaStream)for(let i=0;i<this.mediaStream.getTracks().length;i++)this.mediaStream.getTracks()[i].enabled!==e&&(this.mediaStream.getTracks()[i].enabled=e,t=!0);return t}cleanup(){if(this.mediaStream)for(let e=0;e<this.mediaStream.getTracks().length;e++)this.mediaStream.getTracks()[e].stop();this.mediaStream=null}muteLocalAudioInputStream(){throw Error("unsupported")}unmuteLocalAudioInputStream(){throw Error("unsupported")}addMediaStreamBrokerObserver(e){}removeMediaStreamBrokerObserver(e){}}t.default=a,a.defaultFrameRate=15},8023:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(4500)),s=n(i(589)),a=n(i(8015)),l=n(i(214)),d=n(i(7797)),c=i(8660),u=n(i(5319)),h=n(i(3879)),f=n(i(8890));class p{constructor(e,t,i){this.mediaStreamBroker=e,this.contentAudioVideo=t,this.attendeeAudioVideo=i,this.observerQueue=new Set,this.destroyed=!1,this.contentAudioVideo.addObserver(this),this.setupContentShareEvents()}static createContentShareMeetingSessionConfigure(e){let t=new s.default;return t.meetingId=e.meetingId,t.externalMeetingId=e.externalMeetingId,t.urls=e.urls,t.disablePeriodicKeyframeRequestOnContentSender=e.disablePeriodicKeyframeRequestOnContentSender,t.credentials=new a.default,t.credentials.attendeeId=e.credentials.attendeeId+f.default.Modality,t.credentials.externalUserId=e.credentials.externalUserId,t.credentials.joinToken=e.credentials.joinToken+f.default.Modality,t.meetingFeatures=e.meetingFeatures.clone(),t.videoDownlinkBandwidthPolicy=new u.default,t}setContentAudioProfile(e){this.contentAudioVideo.setAudioProfile(e)}enableSimulcastForContentShare(e,t){e?(this.contentAudioVideo.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!0,this.contentAudioVideo.configuration.videoUplinkBandwidthPolicy=new h.default(this.contentAudioVideo.logger,t)):(this.contentAudioVideo.configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.contentAudioVideo.configuration.videoUplinkBandwidthPolicy=void 0)}enableSVCForContentShare(e){e?this.contentAudioVideo.configuration.enableSVC=!0:this.contentAudioVideo.configuration.enableSVC=!1}startContentShare(e){return r(this,void 0,void 0,function*(){if(e){if(this.contentAudioVideo.configuration.meetingFeatures.contentMaxResolution===o.default.VideoDisabled){this.contentAudioVideo.logger.info("Could not start content because max content resolution was set to None");return}this.mediaStreamBroker.mediaStream=e;for(let e=0;e<this.mediaStreamBroker.mediaStream.getTracks().length;e++)this.mediaStreamBroker.mediaStream.getTracks()[e].addEventListener("ended",()=>{this.stopContentShare()});this.contentAudioVideo.start()}})}startContentShareFromScreenCapture(e,t){return r(this,void 0,void 0,function*(){let i=yield this.mediaStreamBroker.acquireScreenCaptureDisplayInputStream(e,t);return yield this.startContentShare(i),i})}pauseContentShare(){this.mediaStreamBroker.toggleMediaStream(!1)&&this.forEachContentShareObserver(e=>{c.Maybe.of(e.contentShareDidPause).map(t=>t.call(e))})}unpauseContentShare(){this.mediaStreamBroker.toggleMediaStream(!0)&&this.forEachContentShareObserver(e=>{c.Maybe.of(e.contentShareDidUnpause).map(t=>t.call(e))})}setContentShareVideoCodecPreferences(e){this.contentAudioVideo.setVideoCodecSendPreferences(e)}destroy(){return r(this,void 0,void 0,function*(){this.contentAudioVideo&&(this.destroyed=!0,this.contentAudioVideo.removeObserver(this),this.stopContentShare(),this.observerQueue.clear(),this.contentAudioVideo=void 0,this.attendeeAudioVideo=void 0,this.mediaStreamBroker=void 0)})}stopContentShare(){this.contentAudioVideo.stop(),this.mediaStreamBroker.cleanup()}addContentShareObserver(e){this.observerQueue.add(e)}removeContentShareObserver(e){this.observerQueue.delete(e)}forEachContentShareObserver(e){for(let t of this.observerQueue)d.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}audioVideoDidStart(){var e;(null===(e=this.mediaStreamBroker.mediaStream)||void 0===e?void 0:e.getVideoTracks().length)>0&&this.contentAudioVideo.videoTileController.startLocalVideoTile()}audioVideoDidStop(e){this.mediaStreamBroker.cleanup(),this.contentShareTile&&(this.attendeeAudioVideo.videoTileController.removeVideoTile(this.contentShareTile.id()),this.contentShareTile=null),this.forEachContentShareObserver(e=>{c.Maybe.of(e.contentShareDidStop).map(t=>t.call(e))})}setupContentShareEvents(){this.attendeeAudioVideo.realtimeController.realtimeSubscribeToAttendeeIdPresence((e,t,i,r)=>{let n=new l.default(e).hasModality(l.default.MODALITY_CONTENT),o=new l.default(e).base()===this.attendeeAudioVideo.configuration.credentials.attendeeId;if(!n||!o||!t||this.contentShareTile)return;let s=this.mediaStreamBroker.mediaStream;if(null==s?void 0:s.getVideoTracks().length){let e,t;this.contentShareTile=this.attendeeAudioVideo.videoTileController.addVideoTile();let i=s.getVideoTracks()[0];if(i.getSettings){let r=i.getSettings();e=r.width,t=r.height}else{let r=i.getCapabilities();e=r.width,t=r.height}this.contentShareTile.bindVideoStream(this.contentAudioVideo.configuration.credentials.attendeeId,!1,s,e,t,null,this.contentAudioVideo.configuration.credentials.externalUserId)}this.forEachContentShareObserver(e=>{c.Maybe.of(e.contentShareDidStart).map(t=>t.call(e))})})}}t.default=p},7237:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{static register(){"document"in i.g&&document.addEventListener&&r.shouldRegisterCSPMonitor&&!r.added&&(document.addEventListener("securitypolicyviolation",r.listener),r.added=!0)}static unregister(){"document"in i.g&&document.removeEventListener&&(document.removeEventListener("securitypolicyviolation",r.listener),r.loggers=new Set,r.added=!1)}static disable(){r.shouldRegisterCSPMonitor=!1,r.unregister()}static addLogger(e){e&&r.loggers.add(e)}static removeLogger(e){e&&r.loggers.delete(e)}}t.default=r,r.loggers=new Set,r.shouldRegisterCSPMonitor=!0,r.added=!1,r.listener=e=>{let t=`Security Policy Violation
Blocked URI: ${e.blockedURI}
Violated Directive: ${e.violatedDirective}
Original Policy: ${e.originalPolicy}
Document URI: ${e.documentURI}
Source File: ${e.sourceFile}
Line No.: ${e.lineNumber}
`;for(let e of r.loggers)e.error(t);0===r.loggers.size&&console.error(t)}},1018:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,r,n,o){this.timestampMs=e,this.topic=t,this.data=i,this.senderAttendeeId=r,this.senderExternalUserId=n,this.throttled=!!o}text(){return new TextDecoder().decode(this.data)}json(){return JSON.parse(new TextDecoder().decode(this.data))}}t.default=i},146:function(e,t){"use strict";function i(e){return e&&"destroy"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isDestroyable=void 0,t.isDestroyable=i},1746:function(e,t){"use strict";function i(e){return!!e&&"object"==typeof e&&"mute"in e&&"stop"in e&&"intrinsicDevice"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isAudioTransformDevice=void 0,t.isAudioTransformDevice=i},4142:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(543)),s=n(i(6354)),a=n(i(7797)),l=n(i(5804)),d=i(8660),c=n(i(7673)),u=n(i(3327)),h=i(1746),f=n(i(8128)),p=n(i(5348)),m=n(i(1238)),g=n(i(3110)),v=n(i(4842)),b=n(i(6991)),y=n(i(6950)),S=n(i(4500)),w=i(7170);class C{constructor(e,t,i=new o.default,r){this.logger=e,this.browserBehavior=i,this.eventController=r,this.deviceInfoCache=null,this.activeDevices={audio:null,video:null},this.chosenVideoTransformDevice=null,this.audioOutputDeviceId=void 0,this.deviceChangeObservers=new Set,this.mediaStreamBrokerObservers=new Set,this.deviceLabelTrigger=()=>navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),this.audioInputDestinationNode=null,this.audioInputSourceNode=null,this.videoInputQualitySettings=null,this.useWebAudio=!1,this.useMediaConstraintsFallback=!0,this.audioInputTaskQueue=new l.default,this.videoInputTaskQueue=new l.default,this.muted=!1,this.mediaStreamMuteObserver=(e,t)=>{for(let i of this.deviceChangeObservers)a.default.nextTick(()=>{this.deviceChangeObservers.has(i)&&i.audioInputMuteStateChanged&&i.audioInputMuteStateChanged(e,t)})},this.alreadyHandlingDeviceChange=!1;let{enableWebAudio:n=!1,useMediaConstraintsFallback:d=!0}=t||{};this.useWebAudio=n,this.useMediaConstraintsFallback=d,this.videoInputQualitySettings=new S.default(C.defaultVideoWidth,C.defaultVideoHeight,C.defaultVideoFrameRate);let c=this.browserBehavior.requiresResolutionAlignment(this.videoInputQualitySettings.videoWidth,this.videoInputQualitySettings.videoHeight);this.videoInputQualitySettings.videoWidth=c[0],this.videoInputQualitySettings.videoHeight=c[1],this.logger.info(`DefaultDeviceController video dimension ${this.videoInputQualitySettings.videoWidth} x ${this.videoInputQualitySettings.videoHeight}`);try{this.mediaDeviceWrapper=new s.default().create();let e=navigator.mediaDevices.getSupportedConstraints();this.logger.info(`Supported Constraints in this browser ${JSON.stringify(e)}`)}catch(t){e.error(t.message)}}isWatchingForDeviceChanges(){return!!this.onDeviceChangeCallback}ensureWatchingDeviceChanges(){var e;this.isWatchingForDeviceChanges()||(this.logger.info("Starting devicechange listener."),this.onDeviceChangeCallback=()=>{this.logger.info("Device change event callback is triggered"),this.handleDeviceChange()},null===(e=this.mediaDeviceWrapper)||void 0===e||e.addEventListener("devicechange",this.onDeviceChangeCallback))}stopWatchingDeviceChanges(){var e;this.isWatchingForDeviceChanges()&&(this.logger.info("Stopping devicechange listener."),null===(e=this.mediaDeviceWrapper)||void 0===e||e.removeEventListener("devicechange",this.onDeviceChangeCallback),this.onDeviceChangeCallback=void 0)}shouldObserveDeviceChanges(){return!!this.deviceChangeObservers.size||this.activeDevices.audio&&null!==this.activeDevices.audio.constraints||this.activeDevices.video&&null!==this.activeDevices.video.constraints||!!this.audioOutputDeviceId}watchForDeviceChangesIfNecessary(){this.shouldObserveDeviceChanges()?this.ensureWatchingDeviceChanges():this.stopWatchingDeviceChanges()}destroy(){return r(this,void 0,void 0,function*(){this.stopWatchingDeviceChanges(),yield this.stopAudioInput(),yield this.stopVideoInput()})}listAudioInputDevices(e=!1){return r(this,void 0,void 0,function*(){let t=yield this.listDevicesOfKind("audioinput",e);return this.trace("listAudioInputDevices",e,t),t})}listVideoInputDevices(e=!1){return r(this,void 0,void 0,function*(){let t=yield this.listDevicesOfKind("videoinput",e);return this.trace("listVideoInputDevices",e,t),t})}listAudioOutputDevices(e=!1){return r(this,void 0,void 0,function*(){let t=yield this.listDevicesOfKind("audiooutput",e);return this.trace("listAudioOutputDevices",e,t),t})}pushAudioMeetingStateForPermissions(e){var t;null===(t=this.eventController)||void 0===t||t.publishEvent(void 0===e?"audioInputUnselected":"audioInputSelected")}pushVideoMeetingStateForPermissions(e){var t;null===(t=this.eventController)||void 0===t||t.publishEvent(void 0===e?"videoInputUnselected":"videoInputSelected")}startAudioInput(e){return r(this,void 0,void 0,function*(){return yield this.audioInputTaskQueue.add(()=>this.startAudioInputTask(e))})}startAudioInputTask(e){var t;return r(this,void 0,void 0,function*(){if(void 0===e){this.logger.error("Audio input device cannot be undefined");return}try{if(h.isAudioTransformDevice(e)?(this.logger.info(`Choosing transform input device ${e}`),yield this.chooseAudioTransformInputDevice(e)):(this.logger.info(`Choosing intrinsic audio input device ${e}`),this.removeTransform(),yield this.chooseInputIntrinsicDevice("audio",e)),this.trace("startAudioInputDevice",e,"success"),this.useWebAudio)return this.attachAudioInputStreamToAudioContext(this.activeDevices.audio.stream),this.pushAudioMeetingStateForPermissions(this.getMediaStreamDestinationNode().stream),yield null===(t=this.transform)||void 0===t?void 0:t.device.mute(this.muted),this.getMediaStreamDestinationNode().stream;return this.publishAudioInputDidChangeEvent(this.activeDevices.audio.stream),this.activeDevices.audio.stream}catch(e){throw e}})}stopAudioInput(){return r(this,void 0,void 0,function*(){return this.audioInputTaskQueue.add(()=>this.stopAudioInputTask())})}stopAudioInputTask(){return r(this,void 0,void 0,function*(){try{if(this.useWebAudio){this.releaseAudioTransformStream();return}this.stopTracksAndRemoveCallbacks("audio")}finally{this.watchForDeviceChangesIfNecessary(),this.publishAudioInputDidChangeEvent(void 0)}})}chooseAudioTransformInputDevice(e){var t;return r(this,void 0,void 0,function*(){let i;if((null===(t=this.transform)||void 0===t?void 0:t.device)===e)return;if(!this.useWebAudio)throw Error("Cannot apply transform device without enabling Web Audio.");let r=C.getAudioContext();if(r instanceof OfflineAudioContext);else switch(r.state){case"running":break;case"closed":throw Error("Cannot choose a transform device with a closed audio context.");case"suspended":yield r.resume()}try{i=yield e.createAudioNode(r)}catch(e){throw this.logger.error(`Unable to create transform device node: ${e}.`),e}let n=yield e.intrinsicDevice();yield this.chooseInputIntrinsicDevice("audio",n),this.logger.debug(`Got inner stream: ${n}.`),this.setTransform(e,i)})}chooseVideoTransformInputDevice(e){var t;return r(this,void 0,void 0,function*(){if(this.eventController&&e instanceof c.default&&e.passEventControllerToProcessors(this.eventController),e===this.chosenVideoTransformDevice){this.logger.info("Reselecting same VideoTransformDevice");return}let i=this.chosenVideoTransformDevice;i&&this.logger.info("Switched from previous VideoTransformDevice");let r=!!i,n=yield e.intrinsicDevice();if(!this.isMediaStreamReusableByDeviceId(null===(t=this.activeDevices.video)||void 0===t?void 0:t.stream,n)){this.logger.info("video transform device needs new intrinsic device"),r&&i.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=e,this.activeDevices.video=null,yield this.chooseInputIntrinsicDevice("video",n),this.logger.info("apply processors to transform"),yield this.chosenVideoTransformDevice.transformStream(this.activeDevices.video.stream);return}this.chosenVideoTransformDevice=e,this.logger.info("video transform device uses previous stream"),this.logger.info("apply processors to transform"),yield e.transformStream(this.activeDevices.video.stream)})}startVideoInput(e){return r(this,void 0,void 0,function*(){return yield this.videoInputTaskQueue.add(()=>this.startVideoInputTask(e))})}startVideoInputTask(e){return r(this,void 0,void 0,function*(){if(!e){this.logger.error("Invalid video input device");return}try{if(w.isVideoTransformDevice(e))return this.logger.info(`Choosing video transform device ${e}`),yield this.chooseVideoTransformInputDevice(e),this.publishVideoInputDidChangeEvent(this.chosenVideoTransformDevice.outputMediaStream),this.chosenVideoTransformDevice.outputMediaStream;return this.chosenVideoInputIsTransformDevice()&&(this.chosenVideoTransformDevice.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=null),yield this.chooseInputIntrinsicDevice("video",e),this.trace("startVideoInputDevice",e),this.publishVideoInputDidChangeEvent(this.activeDevices.video.stream),this.activeDevices.video.stream}catch(e){throw e}})}stopVideoInput(){return r(this,void 0,void 0,function*(){return this.videoInputTaskQueue.add(()=>this.stopVideoInputTask())})}stopVideoInputTask(){return r(this,void 0,void 0,function*(){try{if(this.chosenVideoInputIsTransformDevice()){this.releaseVideoTransformStream();return}this.stopTracksAndRemoveCallbacks("video")}finally{this.watchForDeviceChangesIfNecessary(),this.publishVideoInputDidChangeEvent(void 0)}})}chooseAudioOutput(e){return r(this,void 0,void 0,function*(){this.audioOutputDeviceId=e,this.watchForDeviceChangesIfNecessary();let t=this.deviceInfoFromDeviceId("audiooutput",this.audioOutputDeviceId);this.publishAudioOutputDidChangeEvent(t),this.trace("chooseAudioOutput",e,null)})}addDeviceChangeObserver(e){this.logger.info("adding device change observer"),this.deviceChangeObservers.add(e),this.watchForDeviceChangesIfNecessary(),this.trace("addDeviceChangeObserver")}removeDeviceChangeObserver(e){this.logger.info("removing device change observer"),this.deviceChangeObservers.delete(e),this.watchForDeviceChangesIfNecessary(),this.trace("removeDeviceChangeObserver")}createAnalyserNodeForAudioInput(){var e,t;if(!this.activeDevices.audio)return null;let i=null===(t=null===(e=this.transform)||void 0===e?void 0:e.nodes)||void 0===t?void 0:t.end;if(i){let e=i.context.createAnalyser();return e.removeOriginalInputs=()=>{try{i.disconnect(e)}catch(e){}},i.connect(e),e}return this.createAnalyserNodeForRawAudioInput()}createAnalyserNodeForRawAudioInput(){return this.activeDevices.audio?this.createAnalyserNodeForStream(this.activeDevices.audio.stream):null}createAnalyserNodeForStream(e){let t=C.getAudioContext(),i=t.createAnalyser(),r=t.createMediaStreamSource(e);return r.connect(i),this.trace("createAnalyserNodeForAudioInput"),i.removeOriginalInputs=()=>{try{r.disconnect(i)}catch(e){}},i}startVideoPreviewForVideoInput(e){if(!this.activeDevices.video){this.logger.warn("cannot bind video preview since video input device has not been chosen"),this.trace("startVideoPreviewForVideoInput",e.id);return}u.default.connectVideoStreamToVideoElement(this.chosenVideoTransformDevice?this.chosenVideoTransformDevice.outputMediaStream:this.activeDevices.video.stream,e,!0),this.trace("startVideoPreviewForVideoInput",e.id)}stopVideoPreviewForVideoInput(e){u.default.disconnectVideoStreamFromVideoElement(e,!1),this.trace("stopVideoPreviewForVideoInput",e.id)}setDeviceLabelTrigger(e){if(this.deviceInfoCache){for(let e of this.deviceInfoCache)if(!e.label){this.deviceInfoCache=null;break}}this.deviceLabelTrigger=e,this.trace("setDeviceLabelTrigger")}mixIntoAudioInput(e){let t=null;return this.useWebAudio?(t=C.getAudioContext().createMediaStreamSource(e)).connect(this.getMediaStreamOutputNode()):this.logger.warn("WebAudio is not enabled, mixIntoAudioInput will not work"),this.trace("mixIntoAudioInput",e.id),t}chooseVideoInputQuality(e,t,i){let r=this.browserBehavior.requiresResolutionAlignment(e,t);this.videoInputQualitySettings=new S.default(r[0],r[1],i)}getVideoInputQualitySettings(){return this.videoInputQualitySettings}acquireAudioInputStream(){return r(this,void 0,void 0,function*(){return(this.activeDevices.audio||(this.logger.info("No audio device chosen, creating empty audio device"),yield this.startAudioInput(null)),this.useWebAudio)?this.getMediaStreamDestinationNode().stream:this.activeDevices.audio.stream})}acquireVideoInputStream(){return r(this,void 0,void 0,function*(){if(!this.activeDevices.video)throw Error("No video device chosen");return this.chosenVideoInputIsTransformDevice()?this.chosenVideoTransformDevice.outputMediaStream:this.activeDevices.video.stream})}acquireDisplayInputStream(e){return r(this,void 0,void 0,function*(){throw Error("unsupported")})}releaseAudioTransformStream(){this.logger.info("Stopping audio track for Web Audio graph"),this.stopTracksAndRemoveCallbacks("audio"),this.logger.info("Removing audio transform, if there is one."),this.removeTransform(),this.audioInputSourceNode&&(this.audioInputSourceNode.disconnect(),this.audioInputSourceNode=void 0),this.audioInputDestinationNode&&(this.audioInputDestinationNode.disconnect(),this.audioInputDestinationNode=void 0)}releaseVideoTransformStream(){this.logger.info("Stopping video track for transform"),this.stopTracksAndRemoveCallbacks("video"),this.logger.info("Disconnecting video transform"),this.chosenVideoTransformDevice.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=null}stopTracksAndRemoveCallbacks(e){let t=this.activeDevices[e];if(!t)return;let i=t.endedCallback,r=t.trackMuteCallback,n=t.trackUnmuteCallback;for(let o of t.stream.getTracks())o.stop(),i&&o.removeEventListener("ended",i),r&&o.removeEventListener("mute",r),n&&o.removeEventListener("unmute",n),delete t.endedCallback,delete t.trackMuteCallback,delete t.trackUnmuteCallback,delete this.activeDevices[e]}chosenVideoInputIsTransformDevice(){return!!this.chosenVideoTransformDevice}muteLocalAudioInputStream(){this.toggleLocalAudioInputStream(!1)}unmuteLocalAudioInputStream(){this.toggleLocalAudioInputStream(!0)}toggleLocalAudioInputStream(e){var t;let i=this.activeDevices.audio;if(this.useWebAudio&&(i=this.getMediaStreamDestinationNode()),i){for(let t of i.stream.getTracks())t.enabled!==e&&(t.enabled=e);!e!==this.muted&&(this.muted=!e,null===(t=this.transform)||void 0===t||t.device.mute(this.muted))}}static getIntrinsicDeviceId(e){if(!e)return;if("string"==typeof e)return e;if(e.id)return e.id;let t=e.deviceId;if(!t)return;if("string"==typeof t||Array.isArray(t))return t;let i=t;if("string"==typeof i.exact||Array.isArray(i.exact))return i.exact}static createEmptyAudioDevice(){return C.synthesizeAudioDevice(0)}static synthesizeAudioDevice(e){let t=C.getAudioContext(),i=t.createMediaStreamDestination();if(e){let r=t.createGain();r.gain.value=.1,r.connect(i);let n=t.createOscillator();n.frequency.value=e,n.connect(r),n.start()}else{let e=t.createBufferSource();try{e.buffer=t.createBuffer(1,5*t.sampleRate,t.sampleRate)}catch(i){if(i&&"NotSupportedError"===i.name)e.buffer=t.createBuffer(1,5*C.defaultSampleRate,C.defaultSampleRate);else throw i}e.buffer.getChannelData(0)[0]=3e-4,e.loop=!0,e.connect(i),e.start()}return i.stream}listDevicesOfKind(e,t){return r(this,void 0,void 0,function*(){return(t||null===this.deviceInfoCache||!this.isWatchingForDeviceChanges())&&(yield this.updateDeviceInfoCacheFromBrowser()),this.listCachedDevicesOfKind(e)})}updateDeviceInfoCacheFromBrowser(){var e;return r(this,void 0,void 0,function*(){if("undefined"==typeof MediaDeviceInfo){this.deviceInfoCache=[];return}let t=yield navigator.mediaDevices.enumerateDevices(),i=!0;for(let e of t)if(!e.label){i=!1;break}if(!i)try{this.logger.info("attempting to trigger media device labels since they are hidden");let e=yield this.deviceLabelTrigger();for(let i of(t=yield navigator.mediaDevices.enumerateDevices(),e.getTracks()))i.stop()}catch(t){this.logger.info("unable to get media device labels"),null===(e=this.eventController)||void 0===e||e.publishEvent("deviceLabelTriggerFailed",{deviceLabelTriggerErrorMessage:this.getErrorMessage(t)})}this.logger.debug(`Update device info cache with devices: ${JSON.stringify(t)}`),this.deviceInfoCache=t})}listCachedDevicesOfKind(e){let t=[];if(this.deviceInfoCache)for(let i of this.deviceInfoCache)i.kind===e&&t.push(i);return t}handleDeviceChange(){return r(this,void 0,void 0,function*(){if(null===this.deviceInfoCache)return;if(this.alreadyHandlingDeviceChange){a.default.nextTick(()=>{this.handleDeviceChange()});return}this.alreadyHandlingDeviceChange=!0;let e=this.listCachedDevicesOfKind("audioinput"),t=this.listCachedDevicesOfKind("videoinput"),i=this.listCachedDevicesOfKind("audiooutput");yield this.updateDeviceInfoCacheFromBrowser();let r=this.listCachedDevicesOfKind("audioinput"),n=this.listCachedDevicesOfKind("videoinput"),o=this.listCachedDevicesOfKind("audiooutput");this.forEachObserver(s=>{this.areDeviceListsEqual(e,r)||d.Maybe.of(s.audioInputsChanged).map(e=>e.bind(s)(r)),this.areDeviceListsEqual(t,n)||d.Maybe.of(s.videoInputsChanged).map(e=>e.bind(s)(n)),this.areDeviceListsEqual(i,o)||d.Maybe.of(s.audioOutputsChanged).map(e=>e.bind(s)(o))}),this.alreadyHandlingDeviceChange=!1})}handleDeviceStreamEnded(e,t){return r(this,void 0,void 0,function*(){try{"audio"===e?(this.useWebAudio&&this.browserBehavior.requiresAudioContextResetOnDeviceFailureForWebAudio()?(this.logger.warn("Audio input device which was active is no longer available, suspending and resuming audio context before resetting to empty device to ensure packets are sent"),yield this.stopAudioInput(),C.suspendAudioContext(),C.resumeAudioContext()):this.logger.warn("Audio input device which was active is no longer available, resetting to empty device to ensure packets are sent"),yield this.startAudioInput(null)):(this.logger.warn("Video input device which was active is no longer available, stopping video"),yield this.stopVideoInput())}catch(e){this.logger.error("Failed to choose null device after stream ended.")}"audio"===e?this.forEachObserver(e=>{d.Maybe.of(e.audioInputStreamEnded).map(i=>i.bind(e)(t))}):this.forEachObserver(e=>{d.Maybe.of(e.videoInputStreamEnded).map(i=>i.bind(e)(t))})})}forEachObserver(e){for(let t of this.deviceChangeObservers)a.default.nextTick(()=>{this.deviceChangeObservers.has(t)&&e(t)})}forEachMediaStreamBrokerObserver(e){for(let t of this.mediaStreamBrokerObservers)a.default.nextTick(()=>{this.mediaStreamBrokerObservers.has(t)&&e(t)})}areDeviceListsEqual(e,t){return JSON.stringify(e.map(e=>JSON.stringify(e)).sort())===JSON.stringify(t.map(e=>JSON.stringify(e)).sort())}intrinsicDeviceAsMediaStream(e){return e&&e.id?e:null}hasSameMediaStreamId(e,t,i){var r,n,o,s;let a;return"audio"===e?!!(a=null==i?void 0:i.audio.streamId)&&a===(null===(n=null===(r=t.constraints)||void 0===r?void 0:r.audio)||void 0===n?void 0:n.streamId):!!(a=null==i?void 0:i.video.streamId)&&a===(null===(s=null===(o=null==t?void 0:t.constraints)||void 0===o?void 0:o.video)||void 0===s?void 0:s.streamId)}hasSameGroupId(e,t,i){if(""===e)return!0;let r=C.getIntrinsicDeviceId(i);return this.logger.debug(`Checking deviceIds ${r} of type ${typeof r} with groupId ${e}`),"string"==typeof r&&e===this.getGroupIdFromDeviceId(t,r)}getGroupIdFromDeviceId(e,t){if(null!==this.deviceInfoCache){let i=this.listCachedDevicesOfKind(`${e}input`).find(e=>e.deviceId===t);if(i&&i.groupId)return this.logger.debug(`GroupId of deviceId ${t} found in cache is ${i.groupId}`),i.groupId}return this.logger.debug(`GroupId of deviceId ${t} found in cache is empty`),""}handleGetUserMediaError(e,t){if(!e)throw new p.default(e);switch(e.name){case"NotReadableError":case"TrackStartError":throw new g.default(e);case"NotFoundError":case"DevicesNotFoundError":throw new m.default(e);case"NotAllowedError":case"PermissionDeniedError":case"SecurityError":if(t&&t<C.permissionDeniedOriginDetectionThresholdMs)throw new b.default(e,"Permission denied by browser");throw new b.default(e,"Permission denied by user");case"OverconstrainedError":case"ConstraintNotSatisfiedError":throw new v.default(e);case"TypeError":throw new y.default(e);default:throw new p.default(e)}}matchesDeviceSelection(e,t,i,r){return!!(i&&i.stream.active&&(this.hasSameMediaStreamId(e,i,r)||null!==i.groupId&&this.hasSameGroupId(i.groupId,e,t)))&&(this.logger.debug(`Compare current device constraint ${JSON.stringify(i.constraints)} to proposed constraints ${JSON.stringify(r)}`),i.matchesConstraints(r))}chooseInputIntrinsicDevice(e,t){var i,n;return r(this,void 0,void 0,function*(){let r=this.getMediaStreamConstraints(e,t);if(this.matchesDeviceSelection(e,t,this.activeDevices[e],r)){this.logger.info(`reusing existing ${e} input device`);return}this.activeDevices[e]&&this.activeDevices[e].stream&&this.stopTracksAndRemoveCallbacks(e);let o=Date.now(),s=new f.default;try{this.logger.info(`requesting new ${e} device with constraint ${JSON.stringify(r)}`);let i=this.intrinsicDeviceAsMediaStream(t);"audio"===e&&null===t?(s.stream=C.createEmptyAudioDevice(),s.constraints=null):(i?(this.logger.info(`using media stream ${i.id} for ${e} device`),s.stream=i):s.stream=yield navigator.mediaDevices.getUserMedia(r),s.constraints=r),yield this.handleNewInputDevice(e,s)}catch(d){let a=this.getErrorMessage(d);"audio"===e?null===(i=this.eventController)||void 0===i||i.publishEvent("audioInputFailed",{audioInputErrorMessage:a}):null===(n=this.eventController)||void 0===n||n.publishEvent("videoInputFailed",{videoInputErrorMessage:a}),this.logger.error(`failed to get ${e} device for constraints ${JSON.stringify(r)}: ${a}`);let l=!0;if(d&&"constraint"in d&&(this.logger.error(`Over-constrained by constraint: ${d.constraint}`),this.useMediaConstraintsFallback)){let i=this.getMediaStreamConstraints(e,t,!0),n=JSON.stringify(i);if(n!==JSON.stringify(r)){this.logger.info(`retry requesting new ${e} device with minimal constraint ${n}`);try{s.stream=yield navigator.mediaDevices.getUserMedia(i),s.constraints=i,yield this.handleNewInputDevice(e,s),l=!1}catch(t){this.logger.error(`failed to get ${e} device for constraints ${n}: ${this.getErrorMessage(t)}`)}}}if(l){if("audio"===e){this.logger.info(`choosing null ${e} device instead`);try{s.stream=C.createEmptyAudioDevice(),s.constraints=null,yield this.handleNewInputDevice(e,s)}catch(t){this.logger.error(`failed to choose null ${e} device. ${t.name}: ${t.message}`)}}this.handleGetUserMediaError(d,Date.now()-o)}}finally{this.watchForDeviceChangesIfNecessary()}})}getErrorMessage(e){return e?e.name&&e.message?`${e.name}: ${e.message}`:e.name?e.name:e.message?e.message:"UnknownError":"UnknownError"}handleNewInputDevice(e,t){var i;return r(this,void 0,void 0,function*(){this.logger.info(`got ${e} device for constraints ${JSON.stringify(t.constraints)}`);let r=null===(i=this.getMediaTrackSettings(t.stream))||void 0===i?void 0:i.deviceId;t.groupId=r?this.getGroupIdFromDeviceId(e,r):"",this.activeDevices[e]=t,this.logger.debug(`Set activeDevice to ${JSON.stringify(t)}`),this.watchForDeviceChangesIfNecessary();let n=t.stream.getTracks()[0];if(n&&(t.endedCallback=()=>{this.activeDevices[e]&&this.activeDevices[e].stream===t.stream&&(this.handleDeviceStreamEnded(e,r),delete t.endedCallback)},n.addEventListener("ended",t.endedCallback,{once:!0})),"audio"===e){let e=t.stream.getAudioTracks()[0];if(e){let i=e.getSettings().deviceId||t.stream;t.trackMuteCallback=()=>{this.mediaStreamMuteObserver(i,!0)},t.trackUnmuteCallback=()=>{this.mediaStreamMuteObserver(i,!1)},e.addEventListener("mute",t.trackMuteCallback,{once:!1}),e.addEventListener("unmute",t.trackUnmuteCallback,{once:!1}),this.logger.debug("Notifying mute state after selection"),e.muted?t.trackMuteCallback():t.trackUnmuteCallback()}}})}calculateMediaStreamConstraints(e,t,i,r){if(r&&1===this.listCachedDevicesOfKind(`${e}input`).length)return!0;let n={};return(this.browserBehavior.requiresNoExactMediaStreamConstraints()?n.deviceId=t:n.deviceId={exact:t},i&&(n.groupId=i),r)?n:"video"===e?(n.width={ideal:this.videoInputQualitySettings.videoWidth},n.height={ideal:this.videoInputQualitySettings.videoHeight},n.frameRate={ideal:this.videoInputQualitySettings.videoFrameRate},n):(this.supportSampleRateConstraint()&&(n.sampleRate={ideal:C.defaultSampleRate}),this.supportSampleSizeConstraint()&&(n.sampleSize={ideal:C.defaultSampleSize}),this.supportChannelCountConstraint()&&(n.channelCount={ideal:C.defaultChannelCount}),Object.assign({echoCancellation:!0,googEchoCancellation:!0,googEchoCancellation2:!0,googAutoGainControl:!0,googAutoGainControl2:!0,googNoiseSuppression:!0,googNoiseSuppression2:!0,googHighpassFilter:!0},n))}getMediaStreamConstraintsFromTrackConstraints(e,t){return"audio"===e?{audio:t}:{video:t}}getMediaStreamConstraints(e,t,i=!1){let r={};if(!t)return null;let n=this.intrinsicDeviceAsMediaStream(t);if(n)return r.streamId=n.id,this.getMediaStreamConstraintsFromTrackConstraints(e,r);if("string"==typeof t){let n="";return this.browserBehavior.requiresGroupIdMediaStreamConstraints()&&(null!==this.deviceInfoCache?n=this.getGroupIdFromDeviceId(e,t):this.logger.error("Device cache is not populated. Please make sure to call list devices first")),r=this.calculateMediaStreamConstraints(e,t,n,i),this.getMediaStreamConstraintsFromTrackConstraints(e,r)}return r=k(t)?this.calculateMediaStreamConstraints(e,t.deviceId,t.groupId,i):t,this.getMediaStreamConstraintsFromTrackConstraints(e,r)}deviceInfoFromDeviceId(e,t){if(null===this.deviceInfoCache)return null;for(let i of this.deviceInfoCache)if(i.kind===e&&i.deviceId===t)return i;return null}hasAppliedTransform(){return!!this.transform}isMediaStreamReusableByDeviceId(e,t){if(!e||!e.active||!t)return!1;if(t.id)return e.id===t.id;let i=this.getMediaTrackSettings(e);if(!i.deviceId)return!1;let r=C.getIntrinsicDeviceId(t);return"string"==typeof r&&i.deviceId===r}getMediaTrackSettings(e){var t;return null===(t=e.getTracks()[0])||void 0===t?void 0:t.getSettings()}reconnectAudioInputs(){if(!this.audioInputSourceNode)return;this.audioInputSourceNode.disconnect();let e=this.getMediaStreamOutputNode();this.audioInputSourceNode.connect(e)}setTransform(e,t){var i,r;null===(r=null===(i=this.transform)||void 0===i?void 0:i.nodes)||void 0===r||r.end.disconnect(),this.transform={nodes:t,device:e};let n=null==t?void 0:t.end,o=this.getMediaStreamDestinationNode();this.logger.debug(`Connecting transform node ${n} to destination ${o}.`),null==n||n.connect(o),this.reconnectAudioInputs()}removeTransform(){var e;let t=this.transform;if(t)return null===(e=this.transform.nodes)||void 0===e||e.end.disconnect(),this.transform=void 0,this.reconnectAudioInputs(),t}attachAudioInputStreamToAudioContext(e){var t;null===(t=this.audioInputSourceNode)||void 0===t||t.disconnect(),this.audioInputSourceNode=C.getAudioContext().createMediaStreamSource(e);let i=this.getMediaStreamOutputNode();this.audioInputSourceNode.connect(i)}getMediaStreamDestinationNode(){return this.audioInputDestinationNode||(this.audioInputDestinationNode=C.getAudioContext().createMediaStreamDestination()),this.audioInputDestinationNode}getMediaStreamOutputNode(){var e,t;return(null===(t=null===(e=this.transform)||void 0===e?void 0:e.nodes)||void 0===t?void 0:t.start)||this.getMediaStreamDestinationNode()}static setDefaultLatencyHint(e){C.defaultLatencyHint=e}static getAudioContext(){if(!C.audioContext){let e={};navigator.mediaDevices.getSupportedConstraints().sampleRate&&(e.sampleRate=C.defaultSampleRate),new o.default().requiresPlaybackLatencyHintForAudioContext()&&(e.latencyHint="playback"),C.defaultLatencyHint&&(e.latencyHint=C.defaultLatencyHint),C.audioContext=new(window.AudioContext||window.webkitAudioContext)(e)}return C.audioContext}static suspendAudioContext(){return r(this,void 0,void 0,function*(){return C.audioContext?C.audioContext.suspend():Promise.resolve()})}static resumeAudioContext(){return r(this,void 0,void 0,function*(){return C.audioContext?C.audioContext.resume():Promise.resolve()})}static closeAudioContext(){if(C.audioContext)try{C.audioContext.close()}catch(e){}C.audioContext=null}addMediaStreamBrokerObserver(e){this.mediaStreamBrokerObservers.add(e)}removeMediaStreamBrokerObserver(e){this.mediaStreamBrokerObservers.delete(e)}publishVideoInputDidChangeEvent(e){this.forEachMediaStreamBrokerObserver(t=>{t.videoInputDidChange&&t.videoInputDidChange(e)}),this.pushVideoMeetingStateForPermissions(e)}publishAudioInputDidChangeEvent(e){this.forEachMediaStreamBrokerObserver(t=>{t.audioInputDidChange&&t.audioInputDidChange(e)}),this.pushAudioMeetingStateForPermissions(e)}publishAudioOutputDidChangeEvent(e){this.forEachMediaStreamBrokerObserver(t=>{t.audioOutputDidChange&&t.audioOutputDidChange(e)})}supportSampleRateConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().sampleRate}supportSampleSizeConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().sampleSize}supportChannelCountConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().channelCount}trace(e,t,i){let r=`API/DefaultDeviceController/${e}`;void 0!==t&&(r+=` ${JSON.stringify(t)}`),void 0!==i&&(r+=` -> ${JSON.stringify(i)}`),this.logger.info(r)}}function k(e){return"object"==typeof e&&"deviceId"in e&&"groupId"in e&&"kind"in e&&"label"in e}t.default=C,C.permissionDeniedOriginDetectionThresholdMs=500,C.defaultVideoWidth=960,C.defaultVideoHeight=540,C.defaultVideoFrameRate=15,C.defaultSampleRate=48e3,C.defaultSampleSize=16,C.defaultChannelCount=1,C.audioContext=null},8128:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.groupId=""}matchesConstraints(e){return JSON.stringify(this.constraints)===JSON.stringify(e)}}t.default=i},5348:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(t||"Error fetching device."),this.cause=e,this.name="GetUserMediaError"}}t.default=i},6154:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NoOpDeviceControllerWithEventController=void 0;let o=n(i(4015)),s=n(i(4500));class a extends o.default{constructor(e){super(),this.destroyed=!1}destroy(){return r(this,void 0,void 0,function*(){this.destroyed=!0})}listAudioInputDevices(){return Promise.resolve([])}listVideoInputDevices(){return Promise.resolve([])}listAudioOutputDevices(){return Promise.resolve([])}startAudioInput(e){return Promise.reject()}stopAudioInput(){return Promise.resolve()}startVideoInput(e){return Promise.reject()}stopVideoInput(){return Promise.resolve()}chooseAudioOutput(e){return Promise.reject()}addDeviceChangeObserver(e){}removeDeviceChangeObserver(e){}createAnalyserNodeForAudioInput(){return null}startVideoPreviewForVideoInput(e){}stopVideoPreviewForVideoInput(e){}setDeviceLabelTrigger(e){}mixIntoAudioInput(e){return null}chooseVideoInputQuality(e,t,i){}getVideoInputQualitySettings(){return s.default.VideoDisabled}}t.default=a;class l extends a{constructor(e){super(),this.eventController=e}}t.NoOpDeviceControllerWithEventController=l},1238:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(5348));class o extends n.default{constructor(e){super(e),this.name="NotFoundError"}}t.default=o},3110:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(5348));class o extends n.default{constructor(e){super(e),this.name="NotReadableError"}}t.default=o},4842:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(5348));class o extends n.default{constructor(e,t){super(e),this.constraint=t,this.name="OverconstrainedError"}}t.default=o},6991:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(5348));class o extends n.default{constructor(e,t){super(e,t),this.name="PermissionDeniedError"}}t.default=o},7786:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.inner=e}mute(e){return i(this,void 0,void 0,function*(){})}stop(){var e;return i(this,void 0,void 0,function*(){null===(e=this.node)||void 0===e||e.disconnect()})}intrinsicDevice(){return i(this,void 0,void 0,function*(){return this.inner})}createAudioNode(e){var t;return i(this,void 0,void 0,function*(){return null===(t=this.node)||void 0===t||t.disconnect(),this.node=yield this.createSingleAudioNode(e),{start:this.node,end:this.node}})}}t.default=r},6950:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(5348));class o extends n.default{constructor(e){super(e),this.name="TypeError"}}t.default=o},4500:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i){this.videoWidth=e,this.videoHeight=t,this.videoFrameRate=i}equals(e){return this.videoWidth===e.videoWidth&&this.videoHeight===e.videoHeight&&this.videoFrameRate===e.videoFrameRate}}t.default=i,i.VideoDisabled=new i(0,0,0),i.VideoResolutionHD=new i(1280,720,30),i.VideoResolutionFHD=new i(1920,1080,30),i.VideoResolutionUHD=new i(3840,2160,30)},7170:function(e,t){"use strict";function i(e){return!!e&&"object"==typeof e&&"transformStream"in e&&"stop"in e&&"intrinsicDevice"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isVideoTransformDevice=void 0,t.isVideoTransformDevice=i},8236:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t){if(this.devicePixelRatioSource=e,this.observerQueue=new Set,this.mediaQueryListener=()=>{this.observerQueue.forEach(e=>{e.devicePixelRatioChanged(this.devicePixelRatioSource.devicePixelRatio())})},"undefined"==typeof window)return;let i=matchMedia(`(resolution: ${this.devicePixelRatioSource.devicePixelRatio()}dppx)`);"function"==typeof i.addEventListener?(i.addEventListener("change",this.mediaQueryListener),this.mediaQueryList=i):"function"==typeof i.addListener?(i.addListener(this.mediaQueryListener),this.mediaQueryList=i):t.warn("ignoring DefaultDevicePixelRatioMonitor")}destroy(){return i(this,void 0,void 0,function*(){this.mediaQueryList&&("function"==typeof this.mediaQueryList.addEventListener?this.mediaQueryList.removeEventListener("change",this.mediaQueryListener):this.mediaQueryList.removeListener(this.mediaQueryListener)),delete this.mediaQueryListener,this.observerQueue.clear()})}registerObserver(e){this.observerQueue.add(e),e.devicePixelRatioChanged(this.devicePixelRatioSource.devicePixelRatio())}removeObserver(e){this.observerQueue.delete(e)}}t.default=r},9190:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{devicePixelRatio(){return"undefined"!=typeof window&&window&&window.devicePixelRatio?window.devicePixelRatio:1}}t.default=i},3520:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__rest||function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)0>t.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]]);return i},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=o(i(8434)),a=o(i(3922)),l=o(i(8627)),d=i(8690);class c{constructor(e,t,i,o,s){this.buffer=[],this.bufferSize=0,this.maxBufferItemCapacityBytes=0,this.ingestionEventSize=0,this.flushIntervalMs=0,this.flushSize=0,this.failedIngestionEvents=[],this.retryCountLimit=15,this.lock=!1,this.cancellableEvents=new Map,this.attributesToFilter=["externalUserId","externalMeetingId","timestampMs"],this.deepCopyCurrentIngestionEvent=e=>({type:e.type,v:e.v,payloads:[...e.payloads]}),this.sendEvents=()=>r(this,void 0,void 0,function*(){if(this.lock)return;let e=this.getItems(this.flushSize);if(0===e.length)return;this.lock=!0;let t=this.makeRequestBody(e),i=!1,r=Date.now();"firefox"===this.metadata.browserName.toLowerCase()&&this.cancellableEvents.set(r,e);try{this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - sending body ${t}`);let e=yield this.send(t);if(this.cancellableEvents.delete(r),e.ok)try{let i=yield e.json();this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - send successful events: ${t} message: ${JSON.stringify(i)}`)}catch(e){this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEvents error reading OK response ${e} for events ${t}`)}else this.logger.error(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - Failed to send events ${t} with response status ${e.status}`),i=!0}catch(e){i=!0,this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEvents - Error in sending events ${t} to the ingestion endpoint ${e}`)}finally{this.lock=!1}i&&(this.cancellableEvents.delete(r),this.failedIngestionEvents.push(...e))});let a=new l.default(s).getParserResult(),{browserMajorVersion:d}=a,c=n(a,["browserMajorVersion"]),u=t.toJSON(),{type:h,v:f}=u,p=n(u,["type","v"]);this.authenticationToken=t.getAuthenticationToken(),this.metadata=Object.assign(Object.assign({},c),p),Object.keys(this.metadata).forEach(e=>this.attributesToFilter.push(e)),this.type=h,this.v=f,this.ingestionURL=i,this.logger=s,this.importantEvents=new Set(o);let{maxBufferCapacityKb:m,totalBufferItems:g,flushSize:v,flushIntervalMs:b,retryCountLimit:y}=e;this.maxBufferCapacityBytes=1024*m,this.totalBufferItems=g,this.maxBufferItemCapacityBytes=Math.round(this.maxBufferCapacityBytes/g),this.flushIntervalMs=b,this.flushSize=v,this.retryCountLimit=y,this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent(),this.beaconEventListener=e=>this.beaconEventHandler(e),this.addEventListeners()}addEventListeners(){this.beaconEventListener&&"window"in i.g&&window.addEventListener&&"document"in i.g&&document.addEventListener&&(this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - addEventListeners - adding pagehide and visibility change event listeners"),window.addEventListener("pagehide",this.beaconEventListener),document.addEventListener("visibilitychange",this.beaconEventListener))}beaconEventHandler(e){("visibilitychange"===e.type&&"hidden"===document.visibilityState||"pagehide"===e.type)&&(this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - beaconEventHandler is triggered calling sendBeacon"),this.sendBeacon())}removeEventListeners(){this.beaconEventListener&&"window"in i.g&&window.removeEventListener&&"document"in i.g&&document.removeEventListener&&(window.removeEventListener("pagehide",this.beaconEventListener),document.removeEventListener("visibilitychange",this.beaconEventListener),this.logger.debug("Event Reporting - InMemoryJSONEventBuffer - removeEventListeners - removing pagehide and visibility change event listeners"))}start(){var e;this.removeEventListeners(),this.addEventListeners(),null===(e=this.intervalScheduler)||void 0===e||e.stop(),this.intervalScheduler=new a.default(this.flushIntervalMs),this.intervalScheduler.start(()=>this.sendEvents())}stop(){var e;null===(e=this.intervalScheduler)||void 0===e||e.stop(),this.intervalScheduler=void 0,this.sendBeacon(),this.removeEventListeners()}addItem(e){return r(this,void 0,void 0,function*(){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - received event ${JSON.stringify(e)}`);let{name:t,ts:i,attributes:r}=e,n=r&&this.filterAttributes(r,this.attributesToFilter),o=Object.assign({name:t,ts:i},n);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - event after filtering attributes ${JSON.stringify(o)}`);let s=this.getSize(o);if(s>c.MAX_ITEM_SIZE_BYTES_ALLOWED)throw Error(`Event Reporting - Item to be added has size ${s} bytes. Item cannot exceed max item size allowed of ${c.MAX_ITEM_SIZE_BYTES_ALLOWED} bytes.`);if(this.importantEvents.has(t)){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - sending important event ${JSON.stringify(o)}`),this.sendEventImmediately({name:t,ts:i,attributes:n});return}if(this.isFull())throw this.logger.warn("Event Reporting - Event buffer is full"),Error("Buffer full");if(this.currentIngestionEvent.payloads.push(o),this.ingestionEventSize+=s,this.bufferItemThresholdReached(s)){let e=this.deepCopyCurrentIngestionEvent(this.currentIngestionEvent);this.buffer.push(e),this.bufferSize+=this.ingestionEventSize,this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent(),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - addItem - buffer item threshold reached updated buffer ${JSON.stringify(this.buffer)}`)}})}filterAttributes(e,t){let i=new Set(t);return Object.keys(e).filter(e=>i.has(e)).forEach(t=>delete e[t]),e}initializeAndGetCurrentIngestionEvent(){let e={type:this.type,v:this.v,payloads:[]};return this.ingestionEventSize=this.getSize(e),e}bufferItemThresholdReached(e){return e+this.ingestionEventSize>=this.maxBufferItemCapacityBytes||this.currentIngestionEvent.payloads.length===c.MAX_PAYLOAD_ITEMS}getSize(e){let t=0;if("object"==typeof e)for(let[i,r]of Object.entries(e))t+=this.getPrimitiveSize(i)+this.getSize(r);else t+=this.getPrimitiveSize(e);return t}getPrimitiveSize(e){let t=0;return"string"==typeof e?t+=2*e.length:"number"==typeof e&&(t+=8),t}isFull(){return this.bufferSize===this.maxBufferCapacityBytes||this.buffer.length===this.totalBufferItems}isEmpty(){return 0===this.buffer.length||0===this.bufferSize}getItems(e,t=0){return this.isEmpty()?[]:(e=Math.min(this.buffer.length,e+1),this.buffer.splice(t,e))}makeBeaconRequestBody(e){return JSON.stringify({metadata:this.metadata,events:e,authorization:this.authenticationToken})}makeRequestBody(e){return JSON.stringify({metadata:this.metadata,events:e})}sendEventImmediately(e){return r(this,void 0,void 0,function*(){this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - important event received ${JSON.stringify(e)}`);let{name:t,ts:i,attributes:r}=e,n={type:this.type,v:this.v,payloads:[Object.assign({name:t,ts:i},r)]},o=!1,s=null,a=this.makeRequestBody([n]);try{if((s=yield this.send(a)).ok){try{let e=yield s.json();this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - send successful event: ${a}, message: ${JSON.stringify(e)}`)}catch(e){this.logger.warn(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - Error reading OK response ${e} for event ${a}`)}return}this.logger.error(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - Failed to send an important event ${a} with response status ${s.status}`),o=!0}catch(e){this.logger.warn(`Event Reporting - There may be a failure in sending an important event ${a} to the ingestion endpoint ${e}.`),o=!0;try{if("firefox"===this.metadata.browserName.toLowerCase()){let e=this.makeBeaconRequestBody([n]);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - beaconing data out ${e}`),navigator.sendBeacon(`${this.ingestionURL}?beacon=1`,e)?o=!1:o=!0}}catch(e){this.logger.warn(`Event Reporting - Error sending beacon for an important event ${a}`),o=!0}}o&&(this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendEventImmediately - pushing to failed events ${a}`),this.failedIngestionEvents.push(n))})}send(e){return r(this,void 0,void 0,function*(){let t=new s.default(c.RETRY_FIXED_BACKOFF_WAIT_MS,c.RETRY_SHORT_BACKOFF_MS,c.RETRY_LONG_BACKOFF_MS);try{let i=0;for(;i<this.retryCountLimit;){let r=yield fetch(this.ingestionURL,{method:"POST",headers:{Authorization:`Bearer ${this.authenticationToken}`},body:e});if(r.ok||!c.SENDING_FAILURE_CODES.has(r.status))return r;if(this.logger.warn(`Will retry sending failure for ${e} due to status code ${r.status}.`),++i<this.retryCountLimit){let e=t.nextBackoffAmountMs();yield d.wait(e)}}if(i===this.retryCountLimit)throw Error(`Retry count limit reached for ${e}`)}catch(e){throw e}})}sendBeacon(){return r(this,void 0,void 0,function*(){let e=this.buffer;if(this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out buffer events ${JSON.stringify(e)}`),this.buffer=[],this.currentIngestionEvent.payloads.length>0){let t=this.deepCopyCurrentIngestionEvent(this.currentIngestionEvent);e.push(t),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out current ingestion event ${JSON.stringify(t)}`),this.currentIngestionEvent=this.initializeAndGetCurrentIngestionEvent()}if(this.failedIngestionEvents.length>0){let t=this.failedIngestionEvents.map(e=>this.deepCopyCurrentIngestionEvent(e));e.push(...t),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out any failed ingestion event ${JSON.stringify(t)}`),this.failedIngestionEvents=[]}if(this.cancellableEvents.size>0&&(this.cancellableEvents.forEach(t=>{e.push(...t),this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - clearing out each cancellable event ${JSON.stringify(t)}`)}),this.cancellableEvents.clear()),0===e.length)return;let t=this.makeBeaconRequestBody(e);this.logger.debug(`Event Reporting - InMemoryJSONEventBuffer - sendBeacon - beacon data to send ${t}`);try{navigator.sendBeacon(`${this.ingestionURL}?beacon=1`,t)||this.logger.warn(`Event Reporting - Browser failed to queue beacon data ${t}`)}catch(e){this.logger.warn(`Event Reporting - Sending beacon data ${t} failed with error ${e}`)}})}reset(){this.maxBufferCapacityBytes=0,this.totalBufferItems=0,this.buffer=[],this.bufferSize=0,this.maxBufferItemCapacityBytes=0,this.ingestionEventSize=0,this.flushIntervalMs=0,this.flushSize=0,this.failedIngestionEvents=[],this.lock=!1,this.beaconEventListener=void 0,this.cancellableEvents.clear()}destroy(){return r(this,void 0,void 0,function*(){this.stop(),this.reset()})}}t.default=c,c.SENDING_FAILURE_CODES=new Set([408,429,500,502,503,504]),c.RETRY_FIXED_BACKOFF_WAIT_MS=0,c.RETRY_SHORT_BACKOFF_MS=1e3,c.RETRY_LONG_BACKOFF_MS=15e3,c.MAX_PAYLOAD_ITEMS=2,c.MAX_ITEM_SIZE_BYTES_ALLOWED=3e3},7700:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e=5e3,t=2,i=64,r=100,n=15){this.flushIntervalMs=e,this.flushSize=t,this.maxBufferCapacityKb=i,this.totalBufferItems=r,this.retryCountLimit=n}}t.default=i},3831:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=i(2238),s=i(146),a=n(i(5680)),l=n(i(6366)),d=n(i(9385)),c=n(i(7797)),u=n(i(4046)),h=n(i(731));class f{constructor(e,t,i){var r,n,s,a,l,d,c;this.meetingHistoryStates=[],this.observerSet=new Set,this.destroyed=!1,this.logger=t,this.configuration=e,this.setupEventReporter(e,t,i);try{this.parserResult=navigator&&navigator.userAgent?new o.UAParser(navigator.userAgent).getResult():null}catch(e){this.logger.error(e.message)}this.browserMajorVersion=(null===(s=null===(n=null===(r=this.parserResult)||void 0===r?void 0:r.browser)||void 0===n?void 0:n.version)||void 0===s?void 0:s.split(".")[0])||f.UNAVAILABLE,this.browserName=(null===(a=this.parserResult)||void 0===a?void 0:a.browser.name)||f.UNAVAILABLE,this.browserVersion=(null===(l=this.parserResult)||void 0===l?void 0:l.browser.version)||f.UNAVAILABLE,this.deviceName=[(null===(d=this.parserResult)||void 0===d?void 0:d.device.vendor)||"",(null===(c=this.parserResult)||void 0===c?void 0:c.device.model)||""].join(" ").trim()||f.UNAVAILABLE}addObserver(e){this.observerSet.add(e)}removeObserver(e){this.observerSet.delete(e)}forEachObserver(e){for(let t of this.observerSet)c.default.nextTick(()=>{this.observerSet.has(t)&&e(t)})}publishEvent(e,t){return r(this,void 0,void 0,function*(){let i=Date.now();this.meetingHistoryStates.push({name:e,timestampMs:i});let r=Object.freeze(Object.assign(this.getAttributes(i),t));this.forEachObserver(t=>{t.eventDidReceive(e,r)}),this.reportEvent(e,i,t)})}reportEvent(e,t,i){var n;return r(this,void 0,void 0,function*(){let r;try{i&&(r=h.default(i)),yield null===(n=this.eventReporter)||void 0===n?void 0:n.reportEvent(t,e,r)}catch(e){this.logger.error(`Error reporting event ${e}`)}})}setupEventReporter(e,t,i){if(i)this._eventReporter=i;else if(e.urls){let i=e.urls.eventIngestionURL;if(i){this.logger.info("Event ingestion URL is present in the configuration");let{meetingId:r,credentials:{attendeeId:n,joinToken:o}}=e,s=new d.default(r,n,o),c=new a.default(s,i);this._eventReporter=new l.default(c,t)}}}getAttributes(e){var t,i;return{attendeeId:this.configuration.credentials.attendeeId,browserMajorVersion:this.browserMajorVersion,browserName:this.browserName,browserVersion:this.browserVersion,deviceName:this.deviceName,externalMeetingId:"string"==typeof this.configuration.externalMeetingId?this.configuration.externalMeetingId:"",externalUserId:this.configuration.credentials.externalUserId,meetingHistory:this.meetingHistoryStates,meetingId:this.configuration.meetingId,osName:(null===(t=this.parserResult)||void 0===t?void 0:t.os.name)||f.UNAVAILABLE,osVersion:(null===(i=this.parserResult)||void 0===i?void 0:i.os.version)||f.UNAVAILABLE,sdkVersion:u.default.sdkVersion,sdkName:u.default.sdkName,timestampMs:e}}get eventReporter(){return this._eventReporter}destroy(){return r(this,void 0,void 0,function*(){s.isDestroyable(this.eventReporter)&&(yield this.eventReporter.destroy()),this.logger=void 0,this.configuration=void 0,this._eventReporter=void 0,this.destroyed=!0})}}t.default=f,f.UNAVAILABLE="Unavailable"},731:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=e=>{let t={};for(let[i,r]of Object.entries(e))if(null!=r&&""!==r){if("number"==typeof r||"string"==typeof r)t[i]=r;else throw TypeError("Unhandled type received while flattening attributes.")}return t};t.default=i},5680:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(7700));class o{constructor(e,t,i=new n.default){this.eventsClientConfiguration=e,this.ingestionURL=t,this.eventBufferConfiguration=i}}t.default=o},6366:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=i(146),s=n(i(3520));class a{constructor(e,t){this.reportingEvents=!1,this.importantEvents=["meetingEnded","meetingFailed","meetingStartFailed","audioInputFailed","videoInputFailed","meetingStartSucceeded","deviceLabelTriggerFailed"],this.destroyed=!1;let{eventsClientConfiguration:i,ingestionURL:r,eventBufferConfiguration:n}=e,{eventsToIgnore:o}=i;this.eventBuffer=new s.default(n,i,r,this.importantEvents,t),this.logger=t,this.eventsToIgnore=o,this.start()}start(){if(!this.reportingEvents)try{this.eventBuffer.start(),this.logger.info("Event reporting started"),this.reportingEvents=!0}catch(e){this.logger.error(`Event Reporting - Error starting the event buffer ${e}`)}}stop(){if(this.reportingEvents)try{this.eventBuffer.stop(),this.logger.info("Event reporting stopped"),this.reportingEvents=!1}catch(e){this.logger.error(`Event Reporting - Error stopping the event buffer ${e}`)}}reportEvent(e,t,i){return r(this,void 0,void 0,function*(){if(this.logger.debug(`Event Reporting - DefaultMeetingEventReporter - event received in reportEvent ${e}, ${t}, ${JSON.stringify(i)}`),this.eventsToIgnore.includes(t)){this.logger.debug(`Event Reporting - DefaultMeetingEventReporter - ${t} event will be ignored as it is in events to ignore`);return}try{this.logger.debug("Event Reporting - DefaultMeetingEventReporter - adding item to event buffer"),yield this.eventBuffer.addItem({ts:e,name:t,attributes:i})}catch(e){this.logger.error(`Event Reporting - Error adding event to buffer ${e}`)}})}destroy(){return r(this,void 0,void 0,function*(){this.destroyed=!0,this.stop(),o.isDestroyable(this.eventBuffer)&&this.eventBuffer.destroy(),this.eventBuffer=void 0})}}t.default=a},732:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){}reportEvent(e,t,i){}start(){}stop(){}}t.default=i},9385:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,r=[]){this.type="Meet",this.v=1,this.meetingId=e,this.attendeeId=t,this.eventsToIgnore=r,this.authenticationToken=i}getAuthenticationToken(){return this.authenticationToken}toJSON(){let e={};return e.type=this.type,e.v=this.v,e.meetingId=this.meetingId,e.attendeeId=this.attendeeId,e}}t.default=i},3204:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultEventController=t.DefaultDevicePixelRatioMonitor=t.DefaultDeviceController=t.DefaultContentShareController=t.DefaultBrowserBehavior=t.DefaultAudioVideoFacade=t.DefaultAudioVideoController=t.DefaultAudioMixController=t.DefaultActiveSpeakerPolicy=t.DefaultActiveSpeakerDetector=t.DataMessage=t.CreateSDPTask=t.CreatePeerConnectionTask=t.ContentShareMediaStreamBroker=t.ContentShareConstants=t.ConsoleLogger=t.ConnectionHealthPolicyConfiguration=t.ConnectionHealthData=t.ClientVideoStreamReceivingReport=t.ClientMetricReportMediaType=t.ClientMetricReportDirection=t.ClientMetricReport=t.CleanStoppedSessionTask=t.CleanRestartedSessionTask=t.CheckVideoInputFeedback=t.CheckVideoConnectivityFeedback=t.CheckNetworkUDPConnectivityFeedback=t.CheckNetworkTCPConnectivityFeedback=t.CheckContentShareConnectivityFeedback=t.CheckCameraResolutionFeedback=t.CheckAudioOutputFeedback=t.CheckAudioInputFeedback=t.CheckAudioConnectivityFeedback=t.CanvasVideoFrameBuffer=t.CSPMonitor=t.BitrateParameters=t.BaseTask=t.BaseConnectionHealthPolicy=t.BackgroundReplacementVideoFrameProcessor=t.BackgroundFilterVideoFrameProcessor=t.BackgroundBlurVideoFrameProcessor=t.BackgroundBlurStrength=t.AudioVideoControllerState=t.AudioProfile=t.AudioLogEvent=t.Attendee=t.AttachMediaInputTask=t.AsyncScheduler=t.ApplicationMetadata=t.AllHighestVideoBandwidthPolicy=void 0,t.MeetingFeatures=t.MeetingEventsClientConfiguration=t.MediaDeviceProxyHandler=t.Maybe=t.LogLevel=t.Log=t.ListenForVolumeIndicatorsTask=t.LeaveAndReceiveLeaveAckTask=t.JoinAndReceiveIndexTask=t.IntervalScheduler=t.InMemoryJSONEventBuffer=t.GlobalMetricReport=t.GetUserMediaError=t.FullJitterLimitedBackoff=t.FullJitterBackoffFactory=t.FullJitterBackoff=t.FinishGatheringICECandidatesTask=t.EventIngestionConfiguration=t.EventBufferConfiguration=t.DeviceSelection=t.DevicePixelRatioWindowSource=t.DefaultWebSocketAdapter=t.DefaultVolumeIndicatorAdapter=t.DefaultVideoTransformDevice=t.DefaultVideoTileFactory=t.DefaultVideoTileController=t.DefaultVideoTile=t.DefaultVideoStreamIndex=t.DefaultVideoStreamIdSet=t.DefaultVideoFrameProcessorTimer=t.DefaultVideoFrameProcessorPipeline=t.DefaultVideoElementResolutionMonitor=t.DefaultVideoCaptureAndEncodeParameter=t.DefaultUserAgentParser=t.DefaultTranscriptionController=t.DefaultTransceiverController=t.DefaultSimulcastUplinkPolicyForContentShare=t.DefaultSimulcastUplinkPolicy=t.DefaultSignalingClient=t.DefaultSigV4=t.DefaultSessionStateController=t.DefaultReconnectController=t.DefaultRealtimeController=t.DefaultPingPong=t.DefaultModality=t.DefaultMessagingSession=t.DefaultMeetingSession=t.DefaultMeetingReadinessChecker=t.DefaultMeetingEventReporter=t.DefaultMediaDeviceFactory=void 0,t.RedundantAudioEncoder=t.ReconnectionHealthPolicy=t.ReceiveVideoStreamIndexTask=t.ReceiveVideoInputTask=t.ReceiveRemoteVideoPauseResumeTask=t.ReceiveAudioInputTask=t.RealtimeVolumeIndicator=t.RealtimeState=t.RealtimeAttendeePositionInFrame=t.PromoteToPrimaryMeetingTask=t.PromiseQueue=t.PrefetchSortBy=t.PrefetchOn=t.PermissionDeniedError=t.ParallelGroupTask=t.POSTLogger=t.OverconstrainedError=t.OpenSignalingConnectionTask=t.OnceTask=t.NotReadableError=t.NotFoundError=t.None=t.NoVideoUplinkBandwidthPolicy=t.NoVideoDownlinkBandwidthPolicy=t.NoOpVideoFrameProcessor=t.NoOpVideoElementFactory=t.NoOpTask=t.NoOpMediaStreamBroker=t.NoOpLogger=t.NoOpEventReporter=t.NoOpDeviceController=t.NoOpDebugLogger=t.NoOpAudioVideoController=t.NScaleVideoUplinkBandwidthPolicy=t.MutableVideoPreferences=t.MultiLogger=t.MonitorTask=t.ModelSpecBuilder=t.MessagingSessionConfiguration=t.Message=t.MeetingSessionVideoAvailability=t.MeetingSessionURLs=t.MeetingSessionTURNCredentials=t.MeetingSessionStatusCode=t.MeetingSessionStatus=t.MeetingSessionLifecycleEventCondition=t.MeetingSessionLifecycleEvent=t.MeetingSessionCredentials=t.MeetingSessionConfiguration=t.MeetingReadinessCheckerConfiguration=void 0,t.VideoEncodingConcurrentSendersHealthPolicy=t.VideoCodecCapability=t.VideoAdaptiveProbePolicy=t.Versioning=t.UnusableAudioWarningConnectionHealthPolicy=t.TypeError=t.TranscriptionStatusType=t.TranscriptionStatus=t.TranscriptResult=t.TranscriptLanguageWithScore=t.TranscriptItemType=t.TranscriptItem=t.TranscriptEntity=t.TranscriptAlternative=t.Transcript=t.TimeoutTask=t.TimeoutScheduler=t.TaskStatus=t.TargetDisplaySize=t.SubscribeAndReceiveSubscribeAckTask=t.StreamMetricReport=t.Some=t.SingleNodeAudioTransformDevice=t.SimulcastVideoStreamIndex=t.SimulcastTransceiverController=t.SimulcastLayers=t.SimulcastContentShareTransceiverController=t.SignalingClientVideoSubscriptionConfiguration=t.SignalingClientSubscribe=t.SignalingClientJoin=t.SignalingClientEventType=t.SignalingClientEvent=t.SignalingClientConnectionRequest=t.SignalingAndMetricsConnectionMonitor=t.SetRemoteDescriptionTask=t.SetLocalDescriptionTask=t.SessionStateControllerTransitionResult=t.SessionStateControllerState=t.SessionStateControllerDeferPriority=t.SessionStateControllerAction=t.ServerSideNetworkAdaption=t.SerialGroupTask=t.SendingAudioFailureConnectionHealthPolicy=t.SendAndReceiveDataMessagesTask=t.SDPMediaSection=t.SDPCandidateType=t.SDP=t.RunnableTask=t.RedundantAudioRecoveryMetricReport=t.RedundantAudioEncoderWorkerCode=void 0,t.isVideoTransformDevice=t.isDestroyable=t.isAudioTransformDevice=t.ZLIBTextCompressor=t.WebSocketReadyState=t.WaitForAttendeePresenceTask=t.VoiceFocusTransformDevice=t.VoiceFocusDeviceTransformer=t.VideoTileState=t.VideoStreamDescription=t.VideoSource=t.VideoQualitySettings=t.VideoQualityAdaptationPreference=t.VideoPriorityBasedPolicyConfig=t.VideoPriorityBasedPolicy=t.VideoPreferences=t.VideoPreference=t.VideoOnlyTransceiverController=t.VideoLogEvent=t.VideoFxProcessor=t.VideoEncodingFramerateConnectionHealthPolicy=t.VideoEncodingCpuConnectionHealthPolicy=t.VideoEncodingConnectionHealthPolicyName=void 0;let n=r(i(5185));t.AllHighestVideoBandwidthPolicy=n.default;let o=r(i(7535));t.ApplicationMetadata=o.default;let s=r(i(7797));t.AsyncScheduler=s.default;let a=r(i(8358));t.AttachMediaInputTask=a.default;let l=r(i(7602));t.Attendee=l.default;let d=r(i(9880));t.AudioLogEvent=d.default;let c=r(i(3765));t.AudioProfile=c.default;let u=r(i(1876));t.AudioVideoControllerState=u.default;let h=r(i(9734));t.BackgroundBlurStrength=h.default;let f=r(i(1260));t.BackgroundBlurVideoFrameProcessor=f.default;let p=r(i(4243));t.BackgroundFilterVideoFrameProcessor=p.default;let m=r(i(9854));t.BackgroundReplacementVideoFrameProcessor=m.default;let g=r(i(3940));t.BaseConnectionHealthPolicy=g.default;let v=r(i(1789));t.BaseTask=v.default;let b=r(i(9394));t.BitrateParameters=b.default;let y=r(i(7237));t.CSPMonitor=y.default;let S=r(i(9807));t.CanvasVideoFrameBuffer=S.default;let w=r(i(2084));t.CheckAudioConnectivityFeedback=w.default;let C=r(i(8892));t.CheckAudioInputFeedback=C.default;let k=r(i(9333));t.CheckAudioOutputFeedback=k.default;let T=r(i(1087));t.CheckCameraResolutionFeedback=T.default;let I=r(i(2606));t.CheckContentShareConnectivityFeedback=I.default;let E=r(i(7415));t.CheckNetworkTCPConnectivityFeedback=E.default;let A=r(i(4299));t.CheckNetworkUDPConnectivityFeedback=A.default;let M=r(i(6818));t.CheckVideoConnectivityFeedback=M.default;let O=r(i(1737));t.CheckVideoInputFeedback=O.default;let P=r(i(3216));t.CleanRestartedSessionTask=P.default;let _=r(i(7408));t.CleanStoppedSessionTask=_.default;let x=r(i(4571));t.ClientMetricReport=x.default;let R=r(i(6196));t.ClientMetricReportDirection=R.default;let D=r(i(9496));t.ClientMetricReportMediaType=D.default;let N=r(i(2770));t.ClientVideoStreamReceivingReport=N.default;let L=r(i(6688));t.ConnectionHealthData=L.default;let F=r(i(3731));t.ConnectionHealthPolicyConfiguration=F.default;let V=r(i(8030));t.ConsoleLogger=V.default;let B=r(i(8890));t.ContentShareConstants=B.default;let U=r(i(8370));t.ContentShareMediaStreamBroker=U.default;let j=r(i(5482));t.CreatePeerConnectionTask=j.default;let $=r(i(1129));t.CreateSDPTask=$.default;let z=r(i(1018));t.DataMessage=z.default;let H=r(i(8320));t.DefaultActiveSpeakerDetector=H.default;let W=r(i(2363));t.DefaultActiveSpeakerPolicy=W.default;let G=r(i(6802));t.DefaultAudioMixController=G.default;let K=r(i(9059));t.DefaultAudioVideoController=K.default;let q=r(i(8538));t.DefaultAudioVideoFacade=q.default;let J=r(i(543));t.DefaultBrowserBehavior=J.default;let Q=r(i(8023));t.DefaultContentShareController=Q.default;let Z=r(i(4142));t.DefaultDeviceController=Z.default;let X=r(i(8236));t.DefaultDevicePixelRatioMonitor=X.default;let Y=r(i(3831));t.DefaultEventController=Y.default;let ee=r(i(6354));t.DefaultMediaDeviceFactory=ee.default;let et=r(i(6366));t.DefaultMeetingEventReporter=et.default;let ei=r(i(3980));t.DefaultMeetingReadinessChecker=ei.default;let er=r(i(4202));t.DefaultMeetingSession=er.default;let en=r(i(8947));t.DefaultMessagingSession=en.default;let eo=r(i(214));t.DefaultModality=eo.default;let es=r(i(7947));t.DefaultPingPong=es.default;let ea=r(i(983));t.DefaultRealtimeController=ea.default;let el=r(i(9141));t.DefaultReconnectController=el.default;let ed=r(i(9678));t.DefaultSessionStateController=ed.default;let ec=r(i(334));t.DefaultSigV4=ec.default;let eu=r(i(1208));t.DefaultSignalingClient=eu.default;let eh=r(i(4450));t.DefaultSimulcastUplinkPolicy=eh.default;let ef=r(i(3879));t.DefaultSimulcastUplinkPolicyForContentShare=ef.default;let ep=r(i(365));t.DefaultTransceiverController=ep.default;let em=r(i(5308));t.DefaultTranscriptionController=em.default;let eg=r(i(8627));t.DefaultUserAgentParser=eg.default;let ev=r(i(1133));t.DefaultVideoCaptureAndEncodeParameter=ev.default;let eb=r(i(2447));t.DefaultVideoElementResolutionMonitor=eb.default;let ey=r(i(8919));t.DefaultVideoFrameProcessorPipeline=ey.default;let eS=r(i(7989));t.DefaultVideoFrameProcessorTimer=eS.default;let ew=r(i(1508));t.DefaultVideoStreamIdSet=ew.default;let eC=r(i(1318));t.DefaultVideoStreamIndex=eC.default;let ek=r(i(3327));t.DefaultVideoTile=ek.default;let eT=r(i(2958));t.DefaultVideoTileController=eT.default;let eI=r(i(4922));t.DefaultVideoTileFactory=eI.default;let eE=r(i(7673));t.DefaultVideoTransformDevice=eE.default;let eA=r(i(9751));t.DefaultVolumeIndicatorAdapter=eA.default;let eM=r(i(7631));t.DefaultWebSocketAdapter=eM.default;let eO=r(i(9190));t.DevicePixelRatioWindowSource=eO.default;let eP=r(i(8128));t.DeviceSelection=eP.default;let e_=r(i(7700));t.EventBufferConfiguration=e_.default;let ex=r(i(5680));t.EventIngestionConfiguration=ex.default;let eR=r(i(6240));t.FinishGatheringICECandidatesTask=eR.default;let eD=r(i(8434));t.FullJitterBackoff=eD.default;let eN=r(i(5640));t.FullJitterBackoffFactory=eN.default;let eL=r(i(7300));t.FullJitterLimitedBackoff=eL.default;let eF=r(i(5348));t.GetUserMediaError=eF.default;let eV=r(i(2306));t.GlobalMetricReport=eV.default;let eB=r(i(3520));t.InMemoryJSONEventBuffer=eB.default;let eU=r(i(3922));t.IntervalScheduler=eU.default;let ej=r(i(1960));t.JoinAndReceiveIndexTask=ej.default;let e$=r(i(6180));t.LeaveAndReceiveLeaveAckTask=e$.default;let ez=r(i(2748));t.ListenForVolumeIndicatorsTask=ez.default;let eH=r(i(293));t.Log=eH.default;let eW=r(i(813));t.LogLevel=eW.default;let eG=r(i(4236));t.MediaDeviceProxyHandler=eG.default;let eK=r(i(9385));t.MeetingEventsClientConfiguration=eK.default;let eq=r(i(6833));t.MeetingFeatures=eq.default;let eJ=r(i(3990));t.MeetingReadinessCheckerConfiguration=eJ.default;let eQ=r(i(589));t.MeetingSessionConfiguration=eQ.default;let eZ=r(i(8015));t.MeetingSessionCredentials=eZ.default;let eX=r(i(7604));t.MeetingSessionLifecycleEvent=eX.default;let eY=r(i(1296));t.MeetingSessionLifecycleEventCondition=eY.default;let e0=r(i(3789));t.MeetingSessionStatus=e0.default;let e1=r(i(5687));t.MeetingSessionStatusCode=e1.default;let e2=r(i(7215));t.MeetingSessionTURNCredentials=e2.default;let e3=r(i(6057));t.MeetingSessionURLs=e3.default;let e5=r(i(5723));t.MeetingSessionVideoAvailability=e5.default;let e4=r(i(9358));t.Message=e4.default;let e6=r(i(4323));t.MessagingSessionConfiguration=e6.default;let e8=r(i(22));t.ModelSpecBuilder=e8.default;let e7=r(i(1981));t.MonitorTask=e7.default;let e9=r(i(9938));t.MultiLogger=e9.default;let te=r(i(4442));t.NScaleVideoUplinkBandwidthPolicy=te.default;let tt=r(i(9836));t.NoOpAudioVideoController=tt.default;let ti=r(i(209));t.NoOpDebugLogger=ti.default;let tr=r(i(6154));t.NoOpDeviceController=tr.default;let tn=r(i(732));t.NoOpEventReporter=tn.default;let to=r(i(7434));t.NoOpLogger=to.default;let ts=r(i(4015));t.NoOpMediaStreamBroker=ts.default;let ta=r(i(8831));t.NoOpTask=ta.default;let tl=r(i(3663));t.NoOpVideoElementFactory=tl.default;let td=r(i(2801));t.NoOpVideoFrameProcessor=td.default;let tc=r(i(5319));t.NoVideoDownlinkBandwidthPolicy=tc.default;let tu=r(i(657));t.NoVideoUplinkBandwidthPolicy=tu.default;let th=r(i(1238));t.NotFoundError=th.default;let tf=r(i(3110));t.NotReadableError=tf.default;let tp=r(i(1124));t.OnceTask=tp.default;let tm=r(i(4543));t.OpenSignalingConnectionTask=tm.default;let tg=r(i(4842));t.OverconstrainedError=tg.default;let tv=r(i(5013));t.POSTLogger=tv.default;let tb=r(i(8556));t.ParallelGroupTask=tb.default;let ty=r(i(6991));t.PermissionDeniedError=ty.default;let tS=r(i(106));t.PrefetchOn=tS.default;let tw=r(i(3938));t.PrefetchSortBy=tw.default;let tC=r(i(5804));t.PromiseQueue=tC.default;let tk=r(i(9945));t.PromoteToPrimaryMeetingTask=tk.default;let tT=r(i(5910));t.RealtimeAttendeePositionInFrame=tT.default;let tI=r(i(9825));t.RealtimeState=tI.default;let tE=r(i(9576));t.RealtimeVolumeIndicator=tE.default;let tA=r(i(1209));t.ReceiveAudioInputTask=tA.default;let tM=r(i(6274));t.ReceiveRemoteVideoPauseResumeTask=tM.default;let tO=r(i(120));t.ReceiveVideoInputTask=tO.default;let tP=r(i(9560));t.ReceiveVideoStreamIndexTask=tP.default;let t_=r(i(9708));t.ReconnectionHealthPolicy=t_.default;let tx=r(i(4773));t.RedundantAudioEncoder=tx.default;let tR=r(i(1044));t.RedundantAudioEncoderWorkerCode=tR.default;let tD=r(i(2353));t.RedundantAudioRecoveryMetricReport=tD.default;let tN=r(i(4191));t.RunnableTask=tN.default;let tL=r(i(326));t.SDP=tL.default;let tF=r(i(4076));t.SDPCandidateType=tF.default;let tV=r(i(1944));t.SDPMediaSection=tV.default;let tB=r(i(9485));t.SendAndReceiveDataMessagesTask=tB.default;let tU=r(i(2977));t.SendingAudioFailureConnectionHealthPolicy=tU.default;let tj=r(i(7079));t.SerialGroupTask=tj.default;let t$=r(i(7103));t.ServerSideNetworkAdaption=t$.default;let tz=r(i(3860));t.SessionStateControllerAction=tz.default;let tH=r(i(6850));t.SessionStateControllerDeferPriority=tH.default;let tW=r(i(9553));t.SessionStateControllerState=tW.default;let tG=r(i(3013));t.SessionStateControllerTransitionResult=tG.default;let tK=r(i(4833));t.SetLocalDescriptionTask=tK.default;let tq=r(i(5275));t.SetRemoteDescriptionTask=tq.default;let tJ=r(i(8581));t.SignalingAndMetricsConnectionMonitor=tJ.default;let tQ=r(i(3920));t.SignalingClientConnectionRequest=tQ.default;let tZ=r(i(2902));t.SignalingClientEvent=tZ.default;let tX=r(i(9416));t.SignalingClientEventType=tX.default;let tY=r(i(2168));t.SignalingClientJoin=tY.default;let t0=r(i(6729));t.SignalingClientSubscribe=t0.default;let t1=r(i(9101));t.SignalingClientVideoSubscriptionConfiguration=t1.default;let t2=r(i(7377));t.SimulcastContentShareTransceiverController=t2.default;let t3=r(i(7606));t.SimulcastLayers=t3.default;let t5=r(i(5785));t.SimulcastTransceiverController=t5.default;let t4=r(i(4242));t.SimulcastVideoStreamIndex=t4.default;let t6=r(i(7786));t.SingleNodeAudioTransformDevice=t6.default;let t8=r(i(2811));t.StreamMetricReport=t8.default;let t7=r(i(5924));t.SubscribeAndReceiveSubscribeAckTask=t7.default;let t9=r(i(2721));t.TargetDisplaySize=t9.default;let ie=r(i(4456));t.TaskStatus=ie.default;let it=r(i(4929));t.TimeoutScheduler=it.default;let ii=r(i(250));t.TimeoutTask=ii.default;let ir=r(i(4739));t.Transcript=ir.default;let io=r(i(2471));t.TranscriptAlternative=io.default;let is=r(i(7210));t.TranscriptEntity=is.default;let ia=r(i(1741));t.TranscriptItem=ia.default;let il=r(i(6864));t.TranscriptItemType=il.default;let id=r(i(9063));t.TranscriptLanguageWithScore=id.default;let ic=r(i(5323));t.TranscriptResult=ic.default;let iu=r(i(1288));t.TranscriptionStatus=iu.default;let ih=r(i(1326));t.TranscriptionStatusType=ih.default;let ip=r(i(6950));t.TypeError=ip.default;let im=r(i(1922));t.UnusableAudioWarningConnectionHealthPolicy=im.default;let ig=r(i(4046));t.Versioning=ig.default;let iv=r(i(2880));t.VideoAdaptiveProbePolicy=iv.default;let ib=r(i(2330));t.VideoCodecCapability=ib.default;let iy=r(i(7272));t.VideoEncodingConcurrentSendersHealthPolicy=iy.default;let iS=r(i(7752));t.VideoEncodingConnectionHealthPolicyName=iS.default;let iw=r(i(8971));t.VideoEncodingCpuConnectionHealthPolicy=iw.default;let iC=r(i(5521));t.VideoEncodingFramerateConnectionHealthPolicy=iC.default;let ik=r(i(7746));t.VideoFxProcessor=ik.default;let iT=r(i(155));t.VideoLogEvent=iT.default;let iI=r(i(9354));t.VideoOnlyTransceiverController=iI.default;let iE=r(i(1754));t.VideoPreference=iE.default;let iA=r(i(1819));t.VideoPreferences=iA.default;let iM=r(i(4992));t.VideoPriorityBasedPolicy=iM.default;let iO=r(i(1034));t.VideoPriorityBasedPolicyConfig=iO.default;let iP=r(i(5992));t.VideoQualityAdaptationPreference=iP.default;let i_=r(i(4500));t.VideoQualitySettings=i_.default;let ix=r(i(60));t.VideoSource=ix.default;let iR=r(i(6876));t.VideoStreamDescription=iR.default;let iD=r(i(7804));t.VideoTileState=iD.default;let iN=r(i(2497));t.VoiceFocusDeviceTransformer=iN.default;let iL=r(i(8878));t.VoiceFocusTransformDevice=iL.default;let iF=r(i(6171));t.WaitForAttendeePresenceTask=iF.default;let iV=r(i(7387));t.WebSocketReadyState=iV.default;let iB=r(i(3320));t.ZLIBTextCompressor=iB.default;let iU=i(1819);Object.defineProperty(t,"MutableVideoPreferences",{enumerable:!0,get:function(){return iU.MutableVideoPreferences}});let ij=i(8660);Object.defineProperty(t,"Some",{enumerable:!0,get:function(){return ij.Some}}),Object.defineProperty(t,"None",{enumerable:!0,get:function(){return ij.None}}),Object.defineProperty(t,"Maybe",{enumerable:!0,get:function(){return ij.Maybe}});let i$=i(1746);Object.defineProperty(t,"isAudioTransformDevice",{enumerable:!0,get:function(){return i$.isAudioTransformDevice}});let iz=i(146);Object.defineProperty(t,"isDestroyable",{enumerable:!0,get:function(){return iz.isDestroyable}});let iH=i(7170);Object.defineProperty(t,"isVideoTransformDevice",{enumerable:!0,get:function(){return iH.isVideoTransformDevice}})},8030:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(813));class o{constructor(e,t=n.default.WARN){this.name=e,this.level=t}info(e){this.log(n.default.INFO,e)}warn(e){this.log(n.default.WARN,e)}error(e){this.log(n.default.ERROR,e)}debug(e){n.default.DEBUG<this.level||("string"==typeof e?this.log(n.default.DEBUG,e):e?this.log(n.default.DEBUG,e()):this.log(n.default.DEBUG,""+e))}setLogLevel(e){this.level=e}getLogLevel(){return this.level}log(e,t){if(e<this.level)return;let i=new Date().toISOString(),r=`${i} [${n.default[e]}] ${this.name} - ${t}`;switch(e){case n.default.ERROR:console.error(r);break;case n.default.WARN:console.warn(r);break;case n.default.DEBUG:console.debug(r.replace(/\\r\\n/g,"\n"));break;case n.default.INFO:console.info(r)}}}t.default=o},293:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,r){this.sequenceNumber=e,this.message=t,this.timestampMs=i,this.logLevel=r}}t.default=i},813:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e[e.OFF=4]="OFF"}(i=t.LogLevel||(t.LogLevel={})),t.default=i},9938:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(813));class o{constructor(...e){this._loggers=e}info(e){for(let t of this._loggers)t.info(e)}warn(e){for(let t of this._loggers)t.warn(e)}error(e){for(let t of this._loggers)t.error(e)}debug(e){let t,i;for(let r of(i="string"==typeof e?e:e?()=>(t||(t=e()),t):""+e,this._loggers))r.debug(i)}setLogLevel(e){for(let t of this._loggers)t.setLogLevel(e)}getLogLevel(){for(let e of this._loggers)return e.getLogLevel();return n.default.OFF}}t.default=o},209:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(813)),o=r(i(7434));class s extends o.default{constructor(){super(n.default.DEBUG)}}t.default=s},7434:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(813));class o{constructor(e=n.default.OFF){this.level=e}info(e){}warn(e){}error(e){}debug(e){n.default.DEBUG<this.level||"string"==typeof e||e()}setLogLevel(e){this.level=e}getLogLevel(){return this.level}}t.default=o},5013:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(3922)),s=n(i(293)),a=n(i(813));class l{constructor(e){this.logCapture=[],this.lock=!1,this.sequenceNumber=0;let{url:t,batchSize:i=l.BATCH_SIZE,intervalMs:r=l.INTERVAL_MS,logLevel:n=a.default.WARN,metadata:o,headers:s}=e;this.url=t,this.batchSize=i,this.intervalMs=r,this.logLevel=n,this.metadata=o,this.headers=s,this.start(),this.eventListener=()=>{this.stop()},this.addEventListener()}addEventListener(){this.eventListener&&"window"in i.g&&window.addEventListener&&window.addEventListener("unload",this.eventListener)}removeEventListener(){this.eventListener&&"window"in i.g&&window.removeEventListener&&window.removeEventListener("unload",this.eventListener)}debug(e){a.default.DEBUG<this.logLevel||("string"==typeof e?this.log(a.default.DEBUG,e):e?this.log(a.default.DEBUG,e()):this.log(a.default.DEBUG,""+e))}info(e){this.log(a.default.INFO,e)}warn(e){this.log(a.default.WARN,e)}error(e){this.log(a.default.ERROR,e)}setLogLevel(e){this.logLevel=e}getLogLevel(){return this.logLevel}getLogCaptureSize(){return this.logCapture.length}start(){this.addEventListener(),this.intervalScheduler=new o.default(this.intervalMs),this.intervalScheduler.start(()=>r(this,void 0,void 0,function*(){if(!0===this.lock||0===this.getLogCaptureSize())return;this.lock=!0;let e=this.logCapture.slice(0,this.batchSize),t=this.makeRequestBody(e);try{let i=yield fetch(this.url,Object.assign({method:"POST",body:t},this.headers?{headers:this.headers}:{}));200===i.status&&(this.logCapture=this.logCapture.slice(e.length))}catch(e){console.warn("[POSTLogger] "+e.message)}finally{this.lock=!1}}))}stop(){var e;null===(e=this.intervalScheduler)||void 0===e||e.stop(),this.intervalScheduler=void 0,this.removeEventListener();let t=this.makeRequestBody(this.logCapture);navigator.sendBeacon(this.url,t)}destroy(){return r(this,void 0,void 0,function*(){this.stop(),this.metadata=void 0,this.headers=void 0,this.logCapture=[],this.sequenceNumber=0,this.lock=!1,this.batchSize=0,this.intervalMs=0,this.url=void 0})}makeRequestBody(e){return JSON.stringify(Object.assign(Object.assign({},this.metadata),{logs:e}))}log(e,t){if(e<this.logLevel)return;let i=Date.now();this.logCapture.push(new s.default(this.sequenceNumber,t,i,a.default[e])),this.sequenceNumber+=1}}t.default=l,l.BATCH_SIZE=85,l.INTERVAL_MS=2e3},6354:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(4236));class o{constructor(){this.isMediaDevicesSupported="undefined"!=typeof navigator&&!!navigator.mediaDevices}create(){if(this.isMediaDevicesSupported)return new Proxy(navigator.mediaDevices,new n.default);throw Error("navigator.mediaDevices is not supported")}}t.default=o},4236:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(7797)),s=n(i(3922));class a{constructor(){this.scheduler=null,this.devices=null,this.deviceChangeListeners=new Set,this.get=(e,t,i)=>{if(!Reflect.has(e,t))return;if(!("ondevicechange"in navigator.mediaDevices)){if("addEventListener"===t)return this.patchAddEventListener(e,t,i);if("removeEventListener"===t)return this.patchRemoveEventListener(e,t,i)}let r=Reflect.get(e,t,i);return"function"==typeof r?r.bind(e):r},this.patchAddEventListener=(e,t,i)=>{let r=Reflect.get(e,t,i);return(t,i,n)=>{if("devicechange"!==t)return Reflect.apply(r,e,[t,i,n]);this.deviceChangeListeners.add(i),this.scheduler||(this.scheduler=new s.default(a.INTERVAL_MS),this.scheduler.start(this.pollDeviceLists))}},this.patchRemoveEventListener=(e,t,i)=>{let r=Reflect.get(e,t,i);return(t,i,n)=>{if("devicechange"!==t)return Reflect.apply(r,e,[t,i,n]);this.deviceChangeListeners.delete(i),0===this.deviceChangeListeners.size&&this.scheduler&&(this.scheduler.stop(),this.scheduler=null)}},this.pollDeviceLists=()=>r(this,void 0,void 0,function*(){let e=yield this.sortedDeviceList();this.devices&&(e.length!==this.devices.length||e.some((e,t)=>e.deviceId!==this.devices[t].deviceId))&&this.handleDeviceChangeEvent(),this.devices=e})}sortedDeviceList(){return r(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).sort((e,t)=>e.deviceId<t.deviceId?1:e.deviceId>t.deviceId?-1:0)})}handleDeviceChangeEvent(){for(let e of this.deviceChangeListeners)o.default.nextTick(()=>{if(this.deviceChangeListeners.has(e)){let t=new Event("devicechange");"function"==typeof e?e(t):e.handleEvent(t)}})}}t.default=a,a.INTERVAL_MS=1e3},4015:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{acquireAudioInputStream(){return Promise.reject()}acquireVideoInputStream(){return Promise.reject()}acquireDisplayInputStream(e){return Promise.reject()}muteLocalAudioInputStream(){}unmuteLocalAudioInputStream(){}addMediaStreamBrokerObserver(e){}removeMediaStreamBrokerObserver(e){}}t.default=i},2084:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.AudioInputRequestFailed=1]="AudioInputRequestFailed",e[e.AudioInputPermissionDenied=2]="AudioInputPermissionDenied",e[e.ConnectionFailed=3]="ConnectionFailed",e[e.AudioNotReceived=4]="AudioNotReceived"}(i=t.CheckAudioConnectivityFeedback||(t.CheckAudioConnectivityFeedback={})),t.default=i},8892:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioInputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied"}(i=t.CheckAudioInputFeedback||(t.CheckAudioInputFeedback={})),t.default=i},9333:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioOutputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(i=t.CheckAudioOutputFeedback||(t.CheckAudioOutputFeedback={})),t.default=i},1087:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckCameraResolutionFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.ResolutionNotSupported=2]="ResolutionNotSupported",e[e.PermissionDenied=3]="PermissionDenied"}(i=t.CheckCameraResolutionFeedback||(t.CheckCameraResolutionFeedback={})),t.default=i},2606:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckContentShareConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied",e[e.TimedOut=3]="TimedOut",e[e.ConnectionFailed=4]="ConnectionFailed"}(i=t.CheckContentShareConnectivityFeedback||(t.CheckContentShareConnectivityFeedback={})),t.default=i},7415:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckNetworkTCPConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.MeetingSessionURLsNotInitialized=1]="MeetingSessionURLsNotInitialized",e[e.ConnectionFailed=2]="ConnectionFailed",e[e.ICENegotiationFailed=3]="ICENegotiationFailed"}(i=t.CheckNetworkTCPConnectivityFeedback||(t.CheckNetworkTCPConnectivityFeedback={})),t.default=i},4299:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckNetworkUDPConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.MeetingSessionURLsNotInitialized=1]="MeetingSessionURLsNotInitialized",e[e.ConnectionFailed=2]="ConnectionFailed",e[e.ICENegotiationFailed=3]="ICENegotiationFailed"}(i=t.CheckNetworkUDPConnectivityFeedback||(t.CheckNetworkUDPConnectivityFeedback={})),t.default=i},6818:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckVideoConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.VideoInputRequestFailed=1]="VideoInputRequestFailed",e[e.VideoInputPermissionDenied=2]="VideoInputPermissionDenied",e[e.ConnectionFailed=3]="ConnectionFailed",e[e.VideoNotSent=4]="VideoNotSent"}(i=t.CheckVideoConnectivityFeedback||(t.CheckVideoConnectivityFeedback={})),t.default=i},1737:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckVideoInputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied"}(i=t.CheckVideoInputFeedback||(t.CheckVideoInputFeedback={})),t.default=i},3980:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(6802)),s=n(i(543)),a=n(i(4142)),l=n(i(6991)),d=n(i(1789)),c=n(i(250)),u=n(i(2084)),h=n(i(8892)),f=n(i(9333)),p=n(i(1087)),m=n(i(2606)),g=n(i(7415)),v=n(i(4299)),b=n(i(6818)),y=n(i(1737)),S=n(i(3990));class w{constructor(e,t,i=new S.default){this.logger=e,this.meetingSession=t,this.configuration=i,this.browserBehavior=new s.default}static delay(e){return r(this,void 0,void 0,function*(){return new Promise(t=>setTimeout(t,e))})}checkAudioInput(e){return r(this,void 0,void 0,function*(){try{return yield this.meetingSession.audioVideo.startAudioInput(e),yield this.meetingSession.audioVideo.stopAudioInput(),h.default.Succeeded}catch(e){if(this.logger.error(`MeetingReadinessChecker: Audio input check failed with error ${e}`),e instanceof l.default)return h.default.PermissionDenied;return h.default.Failed}})}checkAudioOutput(e,t,i=null){return r(this,void 0,void 0,function*(){try{let r=e?a.default.getIntrinsicDeviceId(e):"";if(yield this.playTone(r,this.configuration.audioOutputFrequency,i),yield t())return f.default.Succeeded;return f.default.Failed}catch(e){return this.logger.error(`MeetingReadinessChecker: Audio output check failed with error: ${e}`),f.default.Failed}finally{this.stopTone()}})}playTone(e,t,i){return r(this,void 0,void 0,function*(){let r=.1,n=this.configuration.audioOutputGain;this.oscillatorNode&&this.stopTone(),this.audioContext=a.default.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.oscillatorNode=this.audioContext.createOscillator(),this.oscillatorNode.frequency.value=t,this.oscillatorNode.connect(this.gainNode),this.destinationStream=this.audioContext.createMediaStreamDestination(),this.gainNode.connect(this.destinationStream);let s=this.audioContext.currentTime+.1;this.gainNode.gain.linearRampToValueAtTime(0,s),this.gainNode.gain.linearRampToValueAtTime(n,s+r),this.oscillatorNode.start();let l=new o.default(this.logger);try{this.browserBehavior.supportsSetSinkId()&&(yield l.bindAudioDevice({deviceId:e}))}catch(e){this.logger.error(`Failed to bind audio device: ${e}`)}try{yield l.bindAudioElement(i||new Audio)}catch(e){this.logger.error(`Failed to bind audio element: ${e}`)}yield l.bindAudioStream(this.destinationStream.stream)})}stopTone(){if(!this.audioContext||!this.gainNode||!this.oscillatorNode||!this.destinationStream)return;let e=1,t=.1,i=this.configuration.audioOutputGain,r=this.audioContext.currentTime;this.gainNode.gain.linearRampToValueAtTime(i,r+t+e),this.gainNode.gain.linearRampToValueAtTime(0,r+2*t+e),this.oscillatorNode.stop(),this.oscillatorNode.disconnect(this.gainNode),this.gainNode.disconnect(this.destinationStream),this.oscillatorNode=null,this.gainNode=null,this.destinationStream=null}checkVideoInput(e){return r(this,void 0,void 0,function*(){try{return yield this.meetingSession.audioVideo.startVideoInput(e),yield this.meetingSession.audioVideo.stopVideoInput(),y.default.Succeeded}catch(e){if(this.logger.error(`MeetingReadinessChecker: Video check failed with error ${e}`),e instanceof l.default)return y.default.PermissionDenied;return y.default.Failed}})}checkCameraResolution(e,t,i){return r(this,void 0,void 0,function*(){let r;try{let n=a.default.getIntrinsicDeviceId(e),o={video:this.calculateVideoConstraint(n,t,i)};r=yield navigator.mediaDevices.getUserMedia(o)}catch(e){if(this.logger.error(`MeetingReadinessChecker: Camera resolution check with width: ${t} height ${i} failed with error ${e}`),e&&"OverconstrainedError"===e.name)return p.default.ResolutionNotSupported;if(e&&"NotAllowedError"===e.name)return p.default.PermissionDenied;return p.default.Failed}finally{r&&r.getTracks().forEach(function(e){e.stop()})}return p.default.Succeeded})}calculateVideoConstraint(e,t,i){let r=this.browserBehavior.requiresResolutionAlignment(t,i),n={};return this.browserBehavior.requiresNoExactMediaStreamConstraints()?(n.deviceId=e,n.width=t,n.height=i):(n.deviceId={exact:e},n.width={exact:r[0]},n.height={exact:r[1]}),n}checkContentShareConnectivity(e){return r(this,void 0,void 0,function*(){let t=!1,i=!1,n={contentShareDidStart:()=>{t=!0}},o={audioVideoDidStart:()=>{i=!0}};try{if(this.meetingSession.audioVideo.addObserver(o),this.meetingSession.audioVideo.start(),this.meetingSession.audioVideo.addContentShareObserver(n),yield this.meetingSession.audioVideo.startContentShareFromScreenCapture(e),yield this.executeTimeoutTask(()=>r(this,void 0,void 0,function*(){return i&&t})),!i)return m.default.ConnectionFailed;return yield this.stopMeeting(),t?m.default.Succeeded:m.default.TimedOut}catch(e){if(this.logger.error(`MeetingReadinessChecker: Content share check failed with error ${e}`),"NotAllowedError"===e.name)return m.default.PermissionDenied;return m.default.Failed}finally{this.meetingSession.audioVideo.removeObserver(o),this.meetingSession.audioVideo.stopContentShare(),this.meetingSession.audioVideo.removeContentShareObserver(n)}})}checkAudioConnectivity(e){return r(this,void 0,void 0,function*(){let t=!1,i={packetsReceived:0},n=this.meetingSession.audioVideo,o={metricsDidReceive(e){e.getRTCStatsReport().forEach(e=>{"inbound-rtp"===e.type&&("audio"===e.mediaType||"audio"===e.kind)&&(i.packetsReceived=e.packetsReceived)})}},s=(e,i,r,n)=>{e===this.meetingSession.configuration.credentials.attendeeId&&i&&(t=!0)};try{yield n.startAudioInput(e)}catch(e){if(this.logger.error(`MeetingReadinessChecker: Failed to get audio input device with error ${e}`),e instanceof l.default)return u.default.AudioInputPermissionDenied;return u.default.AudioInputRequestFailed}return(n.realtimeSubscribeToAttendeeIdPresence(s),n.addObserver(o),yield this.startMeeting())?(yield this.executeTimeoutTask(()=>r(this,void 0,void 0,function*(){return this.isAudioConnectionSuccessful(t,i)})),n.removeObserver(o),n.realtimeUnsubscribeToAttendeeIdPresence(s),yield this.stopMeeting(),yield this.meetingSession.audioVideo.stopAudioInput(),this.isAudioConnectionSuccessful(t,i)?u.default.Succeeded:u.default.AudioNotReceived):(n.removeObserver(o),n.realtimeUnsubscribeToAttendeeIdPresence(s),yield this.meetingSession.audioVideo.stopAudioInput(),u.default.ConnectionFailed)})}checkVideoConnectivity(e){return r(this,void 0,void 0,function*(){let t=this.meetingSession.audioVideo,i=0,n={metricsDidReceive(e){e.getRTCStatsReport().forEach(e=>{"outbound-rtp"===e.type&&("video"===e.mediaType||"video"===e.kind)&&(i=e.packetsSent)})}};try{yield t.startVideoInput(e)}catch(e){if(this.logger.error(`MeetingReadinessChecker: Failed to get video input device with error ${e}`),e instanceof l.default)return b.default.VideoInputPermissionDenied;return b.default.VideoInputRequestFailed}return(t.addObserver(n),yield this.startMeeting())?(t.startLocalVideoTile(),yield this.executeTimeoutTask(()=>r(this,void 0,void 0,function*(){return i>0})),yield t.stopVideoInput(),yield this.stopMeeting(),t.removeObserver(n),i<=0)?b.default.VideoNotSent:b.default.Succeeded:b.default.ConnectionFailed})}checkNetworkUDPConnectivity(){return r(this,void 0,void 0,function*(){let e=!1,t={metricsDidReceive(t){t.getRTCStatsReport().forEach(t=>{"candidate-pair"===t.type&&"succeeded"===t.state&&(e=!0)})}};try{this.originalURLRewriter=this.meetingSession.configuration.urls.urlRewriter}catch(e){return this.logger.error(`MeetingSessionConfiguration.urls doesn't exist. Error: ${e}`),v.default.MeetingSessionURLsNotInitialized}this.meetingSession.configuration.urls.urlRewriter=e=>{let t=this.originalURLRewriter(e);return t.includes("transport=tcp")?"":t};let i=this.meetingSession.audioVideo;return(i.addObserver(t),yield this.startMeeting())?(yield this.executeTimeoutTask(()=>r(this,void 0,void 0,function*(){return e})),this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,yield this.stopMeeting(),i.removeObserver(t),e)?v.default.Succeeded:v.default.ICENegotiationFailed:(this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,v.default.ConnectionFailed)})}checkNetworkTCPConnectivity(){return r(this,void 0,void 0,function*(){let e=!1,t={metricsDidReceive(t){t.getRTCStatsReport().forEach(t=>{"candidate-pair"===t.type&&"succeeded"===t.state&&(e=!0)})}};try{this.originalURLRewriter=this.meetingSession.configuration.urls.urlRewriter}catch(e){return this.logger.error(`MeetingSessionConfiguration.urls doesn't exist. Error: ${e}`),g.default.MeetingSessionURLsNotInitialized}this.meetingSession.configuration.urls.urlRewriter=e=>{let t=this.originalURLRewriter(e);return t.includes("transport=udp")?"":t};let i=this.meetingSession.audioVideo;return(i.addObserver(t),yield this.startMeeting())?(yield this.executeTimeoutTask(()=>r(this,void 0,void 0,function*(){return e})),this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,yield this.stopMeeting(),i.removeObserver(t),e)?g.default.Succeeded:g.default.ICENegotiationFailed:(this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,g.default.ConnectionFailed)})}startMeeting(){return r(this,void 0,void 0,function*(){let e=!1,t={audioVideoDidStart:()=>{e=!0}};return this.meetingSession.audioVideo.addObserver(t),this.meetingSession.audioVideo.start(),yield this.executeTimeoutTask(()=>r(this,void 0,void 0,function*(){return e})),this.meetingSession.audioVideo.removeObserver(t),e})}stopMeeting(){return r(this,void 0,void 0,function*(){let e=!1,t={audioVideoDidStop:t=>{e=!0}};return this.meetingSession.audioVideo.addObserver(t),this.meetingSession.audioVideo.stop(),yield this.executeTimeoutTask(()=>r(this,void 0,void 0,function*(){return e})),this.meetingSession.audioVideo.removeObserver(t),e})}executeTimeoutTask(e){return r(this,void 0,void 0,function*(){let t=!1;class i extends d.default{constructor(e,t){super(e),this.waitDurationMs=t,this.isCancelled=!1}cancel(){this.isCancelled=!0}run(){return r(this,void 0,void 0,function*(){for(;!this.isCancelled;){if(yield e()){t=!0;break}yield w.delay(this.waitDurationMs)}})}}let n=new c.default(this.logger,new i(this.logger,this.configuration.waitDurationMs),this.configuration.timeoutMs);return yield n.run(),t})}isAudioConnectionSuccessful(e,t){return e&&t.packetsReceived>0}}t.default=w},3990:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.timeoutMs=1e4,this.waitDurationMs=3e3,this.audioOutputFrequency=440,this.audioOutputGain=.1}}t.default=i},4202:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(9059)),s=n(i(8538)),a=n(i(8434)),l=n(i(543)),d=n(i(8370)),c=n(i(8023)),u=n(i(7237)),h=i(146),f=n(i(3831)),p=n(i(9141)),m=n(i(7631));class g{constructor(e,t,i,r){this._eventController=r,this._configuration=e,this._logger=t,this.checkBrowserSupportAndFeatureConfiguration(),u.default.addLogger(this._logger),u.default.register(),this._eventController||(this._eventController=new f.default(e,t)),i.eventController||(i.eventController=this.eventController),this.audioVideoController=new o.default(this._configuration,this._logger,new m.default(this._logger),i,new p.default(this._configuration.reconnectTimeoutMs,new a.default(this._configuration.reconnectFixedWaitMs,this._configuration.reconnectShortBackOffMs,this._configuration.reconnectLongBackOffMs)),this.eventController),this._deviceController=i,this.logger.info(`MeetingFeatures: ${JSON.stringify(e.meetingFeatures)}`);let n=new d.default(this._logger);this.contentShareController=new c.default(n,new o.default(c.default.createContentShareMeetingSessionConfigure(this._configuration),this._logger,new m.default(this._logger),n,new p.default(this._configuration.reconnectTimeoutMs,new a.default(this._configuration.reconnectFixedWaitMs,this._configuration.reconnectShortBackOffMs,this._configuration.reconnectLongBackOffMs))),this.audioVideoController),this.audioVideoFacade=new s.default(this.audioVideoController,this.audioVideoController.videoTileController,this.audioVideoController.realtimeController,this.audioVideoController.audioMixController,this._deviceController,this.contentShareController)}get configuration(){return this._configuration}get logger(){return this._logger}get audioVideo(){return this.audioVideoFacade}get contentShare(){return this.contentShareController}get deviceController(){return this._deviceController}get eventController(){return this._eventController}destroy(){return r(this,void 0,void 0,function*(){h.isDestroyable(this.contentShareController)&&(yield this.contentShareController.destroy()),h.isDestroyable(this.audioVideoController)&&(yield this.audioVideoController.destroy()),h.isDestroyable(this.eventController)&&(yield this.eventController.destroy()),u.default.removeLogger(this._logger),this._logger=void 0,this._configuration=void 0,this._deviceController=void 0,this.audioVideoFacade=void 0,this.audioVideoController=void 0,this.contentShareController=void 0,this._eventController=void 0})}checkBrowserSupportAndFeatureConfiguration(){let e=new l.default,t=`${e.name()} ${e.majorVersion()} (${e.version()})`;if(this.logger.info(`browser is ${t}`),e.isSupported()||this.logger.warn(`this browser is not currently supported. Stability may suffer. Supported browsers are: ${e.supportString()}.`),this._configuration.videoUplinkBandwidthPolicy){if(this.isSimulcastUplinkPolicy(this._configuration.videoUplinkBandwidthPolicy)){if(!e.hasChromiumWebRTC())throw Error("Simulcast is only supported on Chromium-based browsers");this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!0}else this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1}this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers&&(e.hasChromiumWebRTC()?this.logger.info(`Simulcast is enabled for ${e.name()}`):(this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.logger.info("Simulcast is only supported on Chromium-based browsers")),this._configuration.enableSVC&&(this._configuration.enableSVC=!1,this.logger.info("SVC is not successfully enabled since simulcast is enabled"))),this._configuration.enableSVC&&!e.supportsScalableVideoCoding()&&(this._configuration.enableSVC=!1,this.logger.info("SVC is only supported on Chromium-based browsers with version 111 or above"))}isSimulcastUplinkPolicy(e){return!!(e&&e.addObserver)}}t.default=g},6833:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(4500));class o{constructor(e=n.default.VideoResolutionHD,t=n.default.VideoResolutionFHD){this.videoMaxResolution=e,this.contentMaxResolution=t}clone(){return new o(this.videoMaxResolution,this.contentMaxResolution)}}t.default=o},589:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(3731)),o=r(i(4500)),s=i(8690),a=r(i(6833)),l=r(i(8015)),d=r(i(6057));class c{constructor(e,t){var i,r;if(this.meetingId=null,this.externalMeetingId=null,this.credentials=null,this.urls=null,this.connectionTimeoutMs=15e3,this.attendeePresenceTimeoutMs=0,this.connectionHealthPolicyConfiguration=new n.default,this.reconnectTimeoutMs=12e4,this.reconnectFixedWaitMs=0,this.reconnectShortBackOffMs=1e3,this.reconnectLongBackOffMs=5e3,this.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.enableSVC=!1,this.videoDownlinkBandwidthPolicy=null,this.videoUplinkBandwidthPolicy=null,this.keepLastFrameWhenPaused=!1,this.disablePeriodicKeyframeRequestOnContentSender=!1,this.meetingFeatures=new a.default,e){(e=s.toLowerCasePropertyNames(e)).meeting&&(e=e.meeting),this.meetingId=e.meetingid,this.externalMeetingId=e.externalmeetingid,this.urls=new d.default,this.urls.audioHostURL=e.mediaplacement.audiohosturl,this.urls.signalingURL=e.mediaplacement.signalingurl,this.urls.turnControlURL=e.mediaplacement.turncontrolurl,e.mediaplacement.eventingestionurl&&(this.urls.eventIngestionURL=e.mediaplacement.eventingestionurl);let t=(e,t)=>{switch(e){case"None":return o.default.VideoDisabled;case"HD":return o.default.VideoResolutionHD;case"FHD":return o.default.VideoResolutionFHD;case"UHD":return o.default.VideoResolutionUHD;default:return t}};if((null===(i=e.meetingfeatures)||void 0===i?void 0:i.video)!==void 0||(null===(r=e.meetingfeatures)||void 0===r?void 0:r.content)!==void 0){let i=void 0===e.meetingfeatures.video?"HD":e.meetingfeatures.video.maxresolution,r=void 0===e.meetingfeatures.content?"FHD":e.meetingfeatures.content.maxresolution;this.meetingFeatures=new a.default(t(i,o.default.VideoResolutionHD),t(r,o.default.VideoResolutionFHD))}}t&&((t=s.toLowerCasePropertyNames(t)).attendee&&(t=t.attendee),this.credentials=new l.default,this.credentials.attendeeId=t.attendeeid,this.credentials.externalUserId=t.externaluserid,this.credentials.joinToken=t.jointoken)}}t.default=c},8015:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.attendeeId=null,this.externalUserId=null,this.joinToken=null}toJSON(){return{attendeeId:this.attendeeId,joinToken:null===this.joinToken?null:"<redacted>"}}}t.default=i},7604:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionLifecycleEvent=void 0,function(e){e[e.Connecting=0]="Connecting",e[e.Started=1]="Started",e[e.Stopped=2]="Stopped"}(i=t.MeetingSessionLifecycleEvent||(t.MeetingSessionLifecycleEvent={})),t.default=i},1296:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionLifecycleEventCondition=void 0,function(e){e[e.ConnectingNew=0]="ConnectingNew",e[e.ReconnectingExisting=1]="ReconnectingExisting",e[e.StartedNew=2]="StartedNew",e[e.StartedExisting=3]="StartedExisting",e[e.StartedAfterReconnect=4]="StartedAfterReconnect",e[e.StoppedCleanly=5]="StoppedCleanly",e[e.StoppedWithFailure=6]="StoppedWithFailure"}(i=t.MeetingSessionLifecycleEventCondition||(t.MeetingSessionLifecycleEventCondition={})),t.default=i},3789:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(289),o=r(i(5687));class s{constructor(e){this._statusCode=e}statusCode(){return this._statusCode}isFailure(){switch(this._statusCode){case o.default.AudioAuthenticationRejected:case o.default.AudioCallAtCapacity:case o.default.AudioInternalServerError:case o.default.AudioServiceUnavailable:case o.default.AudioDisconnected:case o.default.VideoCallAtSourceCapacity:case o.default.SignalingBadRequest:case o.default.SignalingInternalServerError:case o.default.SignalingRequestFailed:case o.default.ICEGatheringTimeoutWorkaround:case o.default.ConnectionHealthReconnect:case o.default.RealtimeApiFailed:case o.default.TaskFailed:case o.default.NoAttendeePresent:case o.default.SignalingChannelClosedUnexpectedly:return!0;default:return!1}}isTerminal(){switch(this._statusCode){case o.default.Left:case o.default.AudioJoinedFromAnotherDevice:case o.default.AudioAuthenticationRejected:case o.default.AudioCallAtCapacity:case o.default.MeetingEnded:case o.default.AudioDisconnected:case o.default.TURNCredentialsForbidden:case o.default.SignalingBadRequest:case o.default.SignalingRequestFailed:case o.default.VideoCallAtSourceCapacity:case o.default.RealtimeApiFailed:case o.default.AudioAttendeeRemoved:return!0;default:return!1}}isAudioConnectionFailure(){switch(this._statusCode){case o.default.AudioAuthenticationRejected:case o.default.AudioInternalServerError:case o.default.AudioServiceUnavailable:case o.default.ICEGatheringTimeoutWorkaround:case o.default.SignalingBadRequest:case o.default.SignalingInternalServerError:case o.default.SignalingRequestFailed:case o.default.RealtimeApiFailed:case o.default.NoAttendeePresent:return!0;default:return!1}}toString(){switch(this._statusCode){case o.default.OK:return"Everything is OK so far.";case o.default.Left:return"The attendee left the meeting.";case o.default.AudioJoinedFromAnotherDevice:return"The attendee joined from another device.";case o.default.AudioAuthenticationRejected:return"The meeting rejected the attendee.";case o.default.AudioCallAtCapacity:return"The attendee couldn't join because the meeting was at capacity.";case o.default.MeetingEnded:return"The meeting ended.";case o.default.AudioInternalServerError:case o.default.AudioServiceUnavailable:case o.default.AudioDisconnected:return"The audio connection failed.";case o.default.VideoCallSwitchToViewOnly:return"The attendee couldn't start the local video because the maximum video capacity was reached.";case o.default.VideoCallAtSourceCapacity:return"The connection failed due to an internal server error.";case o.default.SignalingBadRequest:case o.default.SignalingInternalServerError:case o.default.SignalingRequestFailed:return"The signaling connection failed.";case o.default.ICEGatheringTimeoutWorkaround:return"Gathering ICE candidates timed out. In Chrome, this might indicate that the browser is in a bad state after reconnecting to VPN.";case o.default.ConnectionHealthReconnect:return"The meeting was reconnected.";case o.default.RealtimeApiFailed:return"The real-time API failed. This status code might indicate that the callback you passed to the real-time API threw an exception.";case o.default.TaskFailed:return"The connection failed. See the error message for more details.";case o.default.IncompatibleSDP:return"The connection failed due to incompatible SDP.";case o.default.TURNCredentialsForbidden:return"The meeting ended, or the attendee was removed.";case o.default.NoAttendeePresent:return"The attendee was not present.";case o.default.AudioAttendeeRemoved:return"The meeting ended because attendee removed.";case o.default.AudioVideoWasRemovedFromPrimaryMeeting:return"The Primary meeting credentials provided are no longer valid. chime::DeleteAttendee may have been called on them.";case o.default.AudioVideoDisconnectedWhilePromoted:return"The client disconnected while promoted, which will automatically demote. The attendee must promote again to participate.";case o.default.AudioDisconnectAudio:return"The audio connection failed.";case o.default.SignalingChannelClosedUnexpectedly:return"The signaling channel was closed unexpectedly. This may be due to a network change or backend detected failure.";default:{let e=this._statusCode;throw Error(`Unhandled case: ${e}`)}}}static fromSignalFrame(e){return e.error&&e.error.status?this.fromSignalingStatus(e.error.status):e.type===n.SdkSignalFrame.Type.AUDIO_STATUS?e.audioStatus?this.fromAudioStatus(e.audioStatus.audioStatus):new s(o.default.SignalingRequestFailed):new s(e.type===n.SdkSignalFrame.Type.PRIMARY_MEETING_LEAVE?o.default.AudioVideoWasRemovedFromPrimaryMeeting:o.default.OK)}static fromAudioStatus(e){switch(e){case 200:return new s(o.default.OK);case 301:return new s(o.default.AudioJoinedFromAnotherDevice);case 302:return new s(o.default.AudioDisconnectAudio);case 403:return new s(o.default.AudioAuthenticationRejected);case 409:return new s(o.default.AudioCallAtCapacity);case 410:return new s(o.default.MeetingEnded);case 411:return new s(o.default.AudioAttendeeRemoved);case 500:return new s(o.default.AudioInternalServerError);case 503:return new s(o.default.AudioServiceUnavailable);default:if(2===Math.floor(e/100))return new s(o.default.OK);return new s(o.default.AudioDisconnected)}}static fromSignalingStatus(e){switch(e){case 206:return new s(o.default.VideoCallSwitchToViewOnly);case 509:return new s(o.default.VideoCallAtSourceCapacity);case 403:return new s(o.default.AudioAuthenticationRejected);case 409:return new s(o.default.AudioCallAtCapacity);default:switch(Math.floor(e/100)){case 2:return new s(o.default.OK);case 4:return new s(o.default.SignalingBadRequest);case 5:return new s(o.default.SignalingInternalServerError);default:return new s(o.default.SignalingRequestFailed)}}}}t.default=s},5687:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionStatusCode=void 0,function(e){e[e.OK=0]="OK",e[e.Left=1]="Left",e[e.AudioJoinedFromAnotherDevice=2]="AudioJoinedFromAnotherDevice",e[e.AudioAuthenticationRejected=3]="AudioAuthenticationRejected",e[e.AudioCallAtCapacity=4]="AudioCallAtCapacity",e[e.MeetingEnded=5]="MeetingEnded",e[e.AudioInternalServerError=6]="AudioInternalServerError",e[e.AudioServiceUnavailable=7]="AudioServiceUnavailable",e[e.AudioDisconnected=8]="AudioDisconnected",e[e.VideoCallSwitchToViewOnly=9]="VideoCallSwitchToViewOnly",e[e.VideoCallAtSourceCapacity=10]="VideoCallAtSourceCapacity",e[e.SignalingBadRequest=11]="SignalingBadRequest",e[e.SignalingInternalServerError=12]="SignalingInternalServerError",e[e.SignalingRequestFailed=13]="SignalingRequestFailed",e[e.SignalingChannelClosedUnexpectedly=14]="SignalingChannelClosedUnexpectedly",e[e.ICEGatheringTimeoutWorkaround=15]="ICEGatheringTimeoutWorkaround",e[e.ConnectionHealthReconnect=16]="ConnectionHealthReconnect",e[e.RealtimeApiFailed=17]="RealtimeApiFailed",e[e.TaskFailed=18]="TaskFailed",e[e.IncompatibleSDP=19]="IncompatibleSDP",e[e.TURNCredentialsForbidden=20]="TURNCredentialsForbidden",e[e.NoAttendeePresent=21]="NoAttendeePresent",e[e.AudioAttendeeRemoved=22]="AudioAttendeeRemoved",e[e.AudioVideoWasRemovedFromPrimaryMeeting=23]="AudioVideoWasRemovedFromPrimaryMeeting",e[e.AudioVideoDisconnectedWhilePromoted=24]="AudioVideoDisconnectedWhilePromoted",e[e.AudioDisconnectAudio=25]="AudioDisconnectAudio"}(i=t.MeetingSessionStatusCode||(t.MeetingSessionStatusCode={})),t.default=i},7215:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.username=null,this.password=null,this.ttl=null,this.uris=null}}t.default=i},6057:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this._audioHostURL=null,this._signalingURL=null,this._turnControlURL=null,this._eventIngestionURL=null,this.urlRewriter=e=>e}get audioHostURL(){return this.urlRewriter(this._audioHostURL)}set audioHostURL(e){this._audioHostURL=e}get signalingURL(){return this.urlRewriter(this._signalingURL)}set signalingURL(e){this._signalingURL=e}get turnControlURL(){return this.urlRewriter(this._turnControlURL)}set turnControlURL(e){this._turnControlURL=e}get eventIngestionURL(){return this.urlRewriter(this._eventIngestionURL)}set eventIngestionURL(e){this._eventIngestionURL=e}}t.default=i},5723:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.remoteVideoAvailable=!1,this.canStartLocalVideo=!1}equal(e){return this.remoteVideoAvailable===e.remoteVideoAvailable&&this.canStartLocalVideo===e.canStartLocalVideo}clone(){let e=new i;return e.remoteVideoAvailable=this.remoteVideoAvailable,e.canStartLocalVideo=this.canStartLocalVideo,e}}t.default=i},9358:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i){this.type=e,this.headers=t,this.payload=i}}t.default=i},8947:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=i(6117),s=n(i(8434)),a=n(i(7237)),l=n(i(9358)),d=n(i(9141)),c=n(i(7797)),u=n(i(334)),h=n(i(7631)),f=n(i(7387)),p=n(i(106));class m{constructor(e,t,i,r,n){this.configuration=e,this.logger=t,this.webSocket=i,this.reconnectController=r,this.sigV4=n,this.observerQueue=new Set,this.webSocket||(this.webSocket=new h.default(this.logger)),this.reconnectController||(this.reconnectController=new d.default(e.reconnectTimeoutMs,new s.default(e.reconnectFixedWaitMs,e.reconnectShortBackoffMs,e.reconnectLongBackoffMs))),this.sigV4||(this.sigV4=new u.default(this.configuration.chimeClient)),a.default.addLogger(this.logger),a.default.register(),this.preBootstrapMessages=[]}addObserver(e){this.logger.info("adding messaging observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing messaging observer"),this.observerQueue.delete(e)}start(){return r(this,void 0,void 0,function*(){this.isClosed()?yield this.startConnecting(!1):this.logger.info("messaging session already started")})}stop(){this.isClosed()?this.logger.info("no existing messaging session needs closing"):(this.isClosing=!0,this.webSocket.close(),a.default.removeLogger(this.logger))}forEachObserver(e){for(let t of this.observerQueue)c.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}setUpEventListeners(){this.webSocket.addEventListener("open",()=>{this.openEventHandler()}),this.webSocket.addEventListener("message",e=>{this.receiveMessageHandler(e.data)}),this.webSocket.addEventListener("close",e=>{this.closeEventHandler(e)}),this.webSocket.addEventListener("error",()=>{this.logger.error("WebSocket error")})}startConnecting(e){return r(this,void 0,void 0,function*(){return yield this.startConnectingInternal(e),yield new Promise((e,t)=>{this.bootstrapResolved=e,this.bootstrapRejected=t})})}startConnectingInternal(e){var t;return r(this,void 0,void 0,function*(){let i=this.configuration.endpointUrl;if(e||this.reconnectController.reset(),this.reconnectController.hasStartedConnectionAttempt()?this.reconnectController.startedConnectionAttempt(!1):this.reconnectController.startedConnectionAttempt(!0),e||void 0===i)try{if(this.configuration.chimeClient.getMessagingSessionEndpoint instanceof Function){let e=yield this.configuration.chimeClient.getMessagingSessionEndpoint();i=(null===(t=e.Endpoint)||void 0===t?void 0:t.Url)?e.Endpoint.Url:(yield this.configuration.chimeClient.getMessagingSessionEndpoint().promise()).Endpoint.Url}else i=(yield this.configuration.chimeClient.send(new o.GetMessagingSessionEndpointCommand({}))).Endpoint.Url;this.logger.debug(`Messaging endpoint resolved to: ${i}`)}catch(t){this.logger.error(`Messaging Session failed to resolve endpoint: ${t}`);let e=new CloseEvent("close",{wasClean:!1,code:4999,reason:"Failed to get messaging session endpoint URL",bubbles:!1});this.closeEventHandler(e);return}let r=yield this.prepareWebSocketUrl(i);this.logger.info(`opening connection to ${r}`),e||this.reconnectController.reset(),this.reconnectController.hasStartedConnectionAttempt()?this.reconnectController.startedConnectionAttempt(!1):this.reconnectController.startedConnectionAttempt(!0),this.webSocket.create(r,[],!0),this.forEachObserver(t=>{t.messagingSessionDidStartConnecting&&t.messagingSessionDidStartConnecting(e)}),this.setUpEventListeners()})}prepareWebSocketUrl(e){return r(this,void 0,void 0,function*(){let t=new Map;return t.set("userArn",[this.configuration.userArn]),t.set("sessionId",[this.configuration.messagingSessionId]),this.configuration.prefetchOn===p.default.Connect&&t.set("prefetch-on",[p.default.Connect]),this.configuration.prefetchSortBy&&t.set("prefetch-sort-by",[this.configuration.prefetchSortBy]),yield this.sigV4.signURL("GET","wss","chime",e,"/connect","",t)})}isClosed(){return this.webSocket.readyState()===f.default.None||this.webSocket.readyState()===f.default.Closed}openEventHandler(){this.reconnectController.reset(),this.isSessionEstablished=!1}receiveMessageHandler(e){try{let t=JSON.parse(e),i=t.Headers["x-amz-chime-event-type"],r=new l.default(i,t.Headers,t.Payload||null);if(this.isSessionEstablished||"SESSION_ESTABLISHED"!==i){if(!this.isSessionEstablished){this.preBootstrapMessages.push(r);return}}else{this.forEachObserver(e=>{e.messagingSessionDidStart&&e.messagingSessionDidStart()}),this.bootstrapResolved(),this.isSessionEstablished=!0;let e=this.preBootstrapMessages.length;for(let t=0;t<e;t++){let e=this.preBootstrapMessages.shift();this.forEachObserver(t=>{this.sendMessageToObserver(t,e)})}}this.forEachObserver(e=>{this.sendMessageToObserver(e,r)})}catch(e){this.logger.error(`Messaging parsing failed: ${e}`)}}sendMessageToObserver(e,t){e.messagingSessionDidReceiveMessage&&e.messagingSessionDidReceiveMessage(t)}retryConnection(){return this.reconnectController.retryWithBackoff(()=>r(this,void 0,void 0,function*(){yield this.startConnecting(!0)}),null)}closeEventHandler(e){this.logger.info(`WebSocket close: ${e.code} ${e.reason}`),4999!==e.code&&this.webSocket.destroy(),!this.isClosing&&this.canReconnect(e.code)&&this.retryConnection()||(this.isClosing=!1,this.isSessionEstablished?this.forEachObserver(t=>{t.messagingSessionDidStop&&t.messagingSessionDidStop(e)}):this.bootstrapRejected(e))}canReconnect(e){return 1001===e||1006===e||e>=1011&&e<=1014||e>4e3&&4002!==e&&4003!==e&&4401!==e}}t.default=m},4323:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=i(8690);class n{constructor(e,t,i,r){this.userArn=e,this.messagingSessionId=t,this.endpointUrl=i,this.chimeClient=r,this.reconnectTimeoutMs=1e4,this.reconnectFixedWaitMs=0,this.reconnectShortBackoffMs=1e3,this.reconnectLongBackoffMs=5e3,this.prefetchOn=void 0,this.prefetchSortBy=void 0,this.messagingSessionId||(this.messagingSessionId=this.generateSessionId())}generateSessionId(){let e=new Uint32Array(1);return r.getRandomValues(e),e[0].toString()}}t.default=n},106:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Connect="connect"}(i||(i={})),t.default=i},3938:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Unread="unread",e.LastMessageTimestamp="last-message-timestamp"}(i||(i={})),t.default=i},214:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(8890));class o{constructor(e){this._id=e}id(){return this._id}base(){return this._id?this._id.split(o.MODALITY_SEPARATOR)[0]:""}modality(){if(!this._id)return"";let e=this._id.split(o.MODALITY_SEPARATOR);return 2===e.length?e[1]:""}hasModality(e){return""!==e&&this.modality()===e}withModality(e){let t=new o(this.base()+o.MODALITY_SEPARATOR+e);return""===e||""===this.base()||new o(t._id).modality()!==e?new o(this.base()):t}}t.default=o,o.MODALITY_SEPARATOR=n.default.Modality[0],o.MODALITY_CONTENT=n.default.Modality.substring(1)},7947:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(7797)),o=r(i(3922)),s=r(i(9416)),a=i(289),l=i(8660);class d{constructor(e,t,i){this.signalingClient=e,this.intervalMs=t,this.logger=i,this.observerQueue=new Set,this.consecutivePongsUnaccountedFor=0,this.intervalScheduler=new o.default(this.intervalMs),this.pingId=0}addObserver(e){this.logger.info("adding a ping-pong observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing a ping-pong observer"),this.observerQueue.delete(e)}forEachObserver(e){for(let t of this.observerQueue)n.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}start(){this.stop(),this.signalingClient.registerObserver(this),this.signalingClient.ready()&&this.startPingInterval()}stop(){this.stopPingInterval(),this.signalingClient.removeObserver(this)}startPingInterval(){this.intervalScheduler.start(()=>{this.ping()}),this.ping()}stopPingInterval(){this.intervalScheduler.stop(),this.pingId=0,this.consecutivePongsUnaccountedFor=0}ping(){this.consecutivePongsUnaccountedFor>0&&(this.logger.warn(`missed pong ${this.consecutivePongsUnaccountedFor} time(s)`),this.forEachObserver(e=>{l.Maybe.of(e.didMissPongs).map(t=>t.bind(e)(this.consecutivePongsUnaccountedFor))})),this.consecutivePongsUnaccountedFor+=1,this.pingId=this.pingId+1&4294967295;let e=a.SdkPingPongFrame.create();e.pingId=this.pingId,e.type=a.SdkPingPongType.PING,this.pingTimestampLocalMs=this.signalingClient.pingPong(e),this.logger.debug(()=>`sent ping ${this.pingId}`)}pong(e){let t=a.SdkPingPongFrame.create();t.pingId=e,t.type=a.SdkPingPongType.PONG,this.signalingClient.pingPong(t)}handleSignalingClientEvent(e){switch(e.type){case s.default.WebSocketOpen:this.startPingInterval();break;case s.default.WebSocketFailed:case s.default.WebSocketError:this.logger.warn(`stopped pinging (${s.default[e.type]})`),this.stopPingInterval();break;case s.default.WebSocketClosing:case s.default.WebSocketClosed:this.logger.info(`stopped pinging (${s.default[e.type]})`),this.stopPingInterval();break;case s.default.ReceivedSignalFrame:if(e.message.type!==a.SdkSignalFrame.Type.PING_PONG)break;if(e.message.pingPong.type===a.SdkPingPongType.PONG){let t;let i=e.message.pingPong.pingId;if(i!==this.pingId){this.logger.warn(`unexpected ping id ${i} (expected ${this.pingId})`);break}if(this.consecutivePongsUnaccountedFor=0,"number"==typeof e.message.timestampMs)t=e.message.timestampMs;else break;this.logger.debug(()=>`received pong ${i} with timestamp ${t}`);let r=e.timestampMs-this.pingTimestampLocalMs,n=Math.round(t-r/2),o=this.pingTimestampLocalMs-n;this.logger.info(`local clock skew estimate=${o}ms from ping-pong time=${r}ms`),this.forEachObserver(e=>{l.Maybe.of(e.didReceivePong).map(t=>t.bind(e)(i,o,r))})}else this.pong(e.message.pingPong.pingId)}}}t.default=d},983:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(5308)),o=i(8690),s=r(i(9825)),a=r(i(9576));class l{constructor(e,t){this.mediaStreamBroker=e,this.state=new s.default,this._transcriptionController=t||new n.default(this)}realtimeSetLocalAttendeeId(e,t){this.state.localAttendeeId=e,this.state.localExternalUserId=t}realtimeSetAttendeeIdPresence(e,t,i,r,n){try{for(let o of(t&&(this.state.attendeeIdToExternalUserId[e]=i),this.state.attendeeIdChangesCallbacks))o(e,t,i,r,n)}catch(e){this.onError(e)}}realtimeSubscribeToAttendeeIdPresence(e){try{this.state.attendeeIdChangesCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToAttendeeIdPresence(e){try{let t=this.state.attendeeIdChangesCallbacks.indexOf(e);-1!==t&&this.state.attendeeIdChangesCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSetCanUnmuteLocalAudio(e){try{if(this.state.canUnmute===e)return;for(let t of(this.state.canUnmute=e,this.state.setCanUnmuteLocalAudioCallbacks))t(e)}catch(e){this.onError(e)}}realtimeSubscribeToSetCanUnmuteLocalAudio(e){try{this.state.setCanUnmuteLocalAudioCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToSetCanUnmuteLocalAudio(e){try{let t=this.state.setCanUnmuteLocalAudioCallbacks.indexOf(e);-1!==t&&this.state.setCanUnmuteLocalAudioCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeCanUnmuteLocalAudio(){return this.state.canUnmute}realtimeMuteLocalAudio(){if(!this.state.muted)try{for(let e of(this.setAudioInputEnabled(!1),this.state.muted=!0,this.realtimeUpdateVolumeIndicator(this.state.localAttendeeId,null,null,null,this.state.localExternalUserId),this.state.muteAndUnmuteLocalAudioCallbacks))e(!0)}catch(e){this.onError(e)}}realtimeUnmuteLocalAudio(){if(!this.state.muted)return!0;if(!this.state.canUnmute)return!1;try{for(let e of(this.setAudioInputEnabled(!0),this.state.muted=!1,this.realtimeUpdateVolumeIndicator(this.state.localAttendeeId,null,null,null,this.state.localExternalUserId),this.state.muteAndUnmuteLocalAudioCallbacks))e(!1);return!0}catch(e){return this.onError(e),!1}}realtimeSubscribeToMuteAndUnmuteLocalAudio(e){try{this.state.muteAndUnmuteLocalAudioCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e){try{let t=this.state.muteAndUnmuteLocalAudioCallbacks.indexOf(e);-1!==t&&this.state.muteAndUnmuteLocalAudioCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeIsLocalAudioMuted(){return this.state.muted}realtimeSubscribeToVolumeIndicator(e,t){try{this.state.volumeIndicatorCallbacks.hasOwnProperty(e)||(this.state.volumeIndicatorCallbacks[e]=[]),this.state.volumeIndicatorCallbacks[e].push(t),this.sendVolumeIndicatorChange(e,!0,!0,!0,this.state.attendeeIdToExternalUserId[e])}catch(e){this.onError(e)}}realtimeUnsubscribeFromVolumeIndicator(e,t){if(this.state.volumeIndicatorCallbacks[e]){if(t){let i=this.state.volumeIndicatorCallbacks[e].indexOf(t);i>=0&&this.state.volumeIndicatorCallbacks[e].splice(i,1)}else delete this.state.volumeIndicatorCallbacks[e]}}realtimeUpdateVolumeIndicator(e,t,i,r,n){try{i=this.applyLocalMuteOverride(e,i);let o=this.getVolumeIndicatorState(e),s=!1,a=!1,l=!1;null!==i&&o.muted!==i&&(o.muted=i,a=!0,o.muted&&0!==o.volume&&(o.volume=0,s=!0)),o.muted||null===t||(o.volume!==t&&(o.volume=t,s=!0),null!==o.muted||(o.muted=!1,a=!0)),null!==r&&o.signalStrength!==r&&(o.signalStrength=r,l=!0),this.sendVolumeIndicatorChange(e,s,a,l,n)}catch(e){this.onError(e)}}realtimeSubscribeToLocalSignalStrengthChange(e){try{if(this.state.localSignalStrengthChangeCallbacks.push(e),null===this.state.localAttendeeId)return;this.sendLocalSignalStrengthChange(this.state.localAttendeeId,!0)}catch(e){this.onError(e)}}realtimeUnsubscribeToLocalSignalStrengthChange(e){try{let t=this.state.localSignalStrengthChangeCallbacks.indexOf(e);-1!==t&&this.state.localSignalStrengthChangeCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSubscribeToSendDataMessage(e){try{this.state.sendDataMessageCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeFromSendDataMessage(e){try{let t=this.state.sendDataMessageCallbacks.indexOf(e);-1!==t&&this.state.sendDataMessageCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSendDataMessage(e,t,i){try{for(let r of this.state.sendDataMessageCallbacks)r(e,t,i)}catch(e){this.onError(e)}}realtimeSubscribeToReceiveDataMessage(e,t){try{this.state.receiveDataMessageCallbacks.has(e)?this.state.receiveDataMessageCallbacks.get(e).push(t):this.state.receiveDataMessageCallbacks.set(e,[t])}catch(e){this.onError(e)}}realtimeUnsubscribeFromReceiveDataMessage(e){try{this.state.receiveDataMessageCallbacks.delete(e)}catch(e){this.onError(e)}}realtimeReceiveDataMessage(e){try{o.iterateEvery(this.state.receiveDataMessageCallbacks.get(e.topic),t=>{t(e)})}catch(e){Promise.reject(e)}}realtimeSubscribeToFatalError(e){try{this.state.fatalErrorCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToFatalError(e){try{let t=this.state.fatalErrorCallbacks.indexOf(e);-1!==t&&this.state.fatalErrorCallbacks.splice(t,1)}catch(e){this.onError(e)}}get transcriptionController(){return this._transcriptionController}setAudioInputEnabled(e){e?this.mediaStreamBroker.unmuteLocalAudioInputStream():this.mediaStreamBroker.muteLocalAudioInputStream()}applyLocalMuteOverride(e,t){let i=this.state.localAttendeeId,r=this.state.muted;return e===i&&"activeDevices"in this.mediaStreamBroker&&this.mediaStreamBroker.activeDevices.audio?r:t}sendVolumeIndicatorChange(e,t,i,r,n){if(this.sendLocalSignalStrengthChange(e,r),!this.state.volumeIndicatorCallbacks.hasOwnProperty(e))return;let o=this.getVolumeIndicatorState(e),s=new a.default;if(t&&(s.volume=o.volume),i&&(s.muted=o.muted),r&&(s.signalStrength=o.signalStrength),!this.stateIsEmpty(s))for(let t of this.state.volumeIndicatorCallbacks[e])t(e,s.volume,s.muted,s.signalStrength,n)}sendLocalSignalStrengthChange(e,t){if(!t||e!==this.state.localAttendeeId)return;let i=this.getVolumeIndicatorState(e).signalStrength;if(null!==i)for(let e of this.state.localSignalStrengthChangeCallbacks)e(i)}getVolumeIndicatorState(e){return this.state.volumeIndicatorState.hasOwnProperty(e)||(this.state.volumeIndicatorState[e]=new a.default),this.state.volumeIndicatorState[e]}stateIsEmpty(e){return null===e.volume&&null===e.muted&&null===e.signalStrength}onError(e){try{for(let t of this.state.fatalErrorCallbacks)t(e)}catch(t){try{console.error(e),console.error(t)}catch(e){}}}}t.default=l},5910:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.attendeeIndex=null,this.attendeesInFrame=null}}t.default=i},9825:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.localAttendeeId=null,this.localExternalUserId=null,this.attendeeIdChangesCallbacks=[],this.canUnmute=!0,this.setCanUnmuteLocalAudioCallbacks=[],this.muted=!1,this.muteAndUnmuteLocalAudioCallbacks=[],this.volumeIndicatorState={},this.attendeeIdToExternalUserId={},this.volumeIndicatorCallbacks={},this.localSignalStrengthChangeCallbacks=[],this.fatalErrorCallbacks=[],this.sendDataMessageCallbacks=[],this.receiveDataMessageCallbacks=new Map}}t.default=i},9576:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.volume=null,this.muted=null,this.signalStrength=null}}t.default=i},9141:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(4929));class o{constructor(e,t){this.reconnectTimeoutMs=e,this.backoffPolicy=t,this.shouldReconnect=!0,this.onlyRestartPeerConnection=!1,this.firstConnectionAttempted=!1,this.firstConnectionAttemptTimestampMs=0,this.lastActiveTimestampMs=1/0,this._isFirstConnection=!0,this.backoffTimer=null,this.backoffCancel=null,this.reset()}timeSpentReconnectingMs(){return this.firstConnectionAttempted?Date.now()-this.firstConnectionAttemptTimestampMs:0}hasPastReconnectDeadline(){return Date.now()-this.lastActiveTimestampMs>=this.reconnectTimeoutMs||this.timeSpentReconnectingMs()>=this.reconnectTimeoutMs}reset(){this.cancel(),this.shouldReconnect=!0,this.onlyRestartPeerConnection=!1,this.firstConnectionAttempted=!1,this.firstConnectionAttemptTimestampMs=0,this.lastActiveTimestampMs=1/0,this.backoffPolicy.reset()}startedConnectionAttempt(e){this._isFirstConnection=e,this.firstConnectionAttempted||(this.firstConnectionAttempted=!0,this.firstConnectionAttemptTimestampMs=Date.now())}hasStartedConnectionAttempt(){return this.firstConnectionAttempted}isFirstConnection(){return this._isFirstConnection}disableReconnect(){this.shouldReconnect=!1}enableRestartPeerConnection(){this.onlyRestartPeerConnection=!0}cancel(){this.disableReconnect(),this.backoffTimer&&(this.backoffTimer.stop(),this.backoffCancel&&(this.backoffCancel(),this.backoffCancel=null))}retryWithBackoff(e,t){let i=this.shouldReconnect&&!this.hasPastReconnectDeadline();return i&&(this.backoffCancel=t,this.backoffTimer=new n.default(this.backoffPolicy.nextBackoffAmountMs()),this.backoffTimer.start(()=>{this.backoffCancel=null,e()})),i}shouldOnlyRestartPeerConnection(){return this.onlyRestartPeerConnection}clone(){return new o(this.reconnectTimeoutMs,this.backoffPolicy)}setLastActiveTimestampMs(e){this.lastActiveTimestampMs=e}}t.default=o},4773:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.maxRedPacketSizeBytes=1024,this.maxAudioPayloadSizeBytes=1e3,this.maxRedTimestampOffset=16384,this.redHeaderSizeBytes=4,this.redLastHeaderSizeBytes=1,this.redPacketizationTime=960,this.redPacketDistance=2,this.maxRedEncodings=2,this.redMaxRecoveryDistance=this.redPacketDistance*this.maxRedEncodings+1,this.maxEncodingHistorySize=10,this.numRedundantEncodings=0,this.redundancyEnabled=!0,this.lossReportInterval=24e4,this.maxOutOfOrderPacketDistance=16,this.OPUS_BAD_ARG=-1,this.OPUS_INVALID_PACKET=-4,this.OPUS_MAX_OPUS_FRAMES=48,this.OPUS_MAX_FRAME_SIZE_BYTES=1275,this.encodingHistory=[],this.opusPayloadType=0,this.redPayloadType=0,this.initializePacketLogs()}static initializeWorker(){i.log("Initializing RedundantAudioEncoder");let e=new i;self.RTCRtpScriptTransformer&&(self.onrtctransform=t=>{"SenderTransform"===t.transformer.options.type?e.setupSenderTransform(t.transformer.readable,t.transformer.writable):"ReceiverTransform"===t.transformer.options.type?e.setupReceiverTransform(t.transformer.readable,t.transformer.writable):"PassthroughTransform"===t.transformer.options.type&&e.setupPassthroughTransform(t.transformer.readable,t.transformer.writable)}),self.onmessage=t=>{"StartRedWorker"===t.data.msgType?(e.setupSenderTransform(t.data.send.readable,t.data.send.writable),e.setupReceiverTransform(t.data.receive.readable,t.data.receive.writable)):"PassthroughTransform"===t.data.msgType?(e.setupPassthroughTransform(t.data.send.readable,t.data.send.writable),e.setupPassthroughTransform(t.data.receive.readable,t.data.receive.writable)):"RedPayloadType"===t.data.msgType?e.setRedPayloadType(t.data.payloadType):"OpusPayloadType"===t.data.msgType?e.setOpusPayloadType(t.data.payloadType):"UpdateNumRedundantEncodings"===t.data.msgType?e.setNumRedundantEncodings(t.data.numRedundantEncodings):"Enable"===t.data.msgType?e.setRedundancyEnabled(!0):"Disable"===t.data.msgType&&e.setRedundancyEnabled(!1)}}static log(e){i.shouldLog&&self.postMessage({type:"REDWorkerLog",log:`[AudioRed] ${e}`})}static getNumRedundantEncodingsForPacketLoss(e){let t=0,i=!1;return e<=8?t=0:e<=18?t=1:e<=75?t=2:(t=0,i=!0),[t,i]}setupPassthroughTransform(e,t){i.log("Setting up passthrough transform"),e.pipeTo(t)}setupSenderTransform(e,t){i.log("Setting up sender RED transform");let r=new TransformStream({transform:this.senderTransform.bind(this)});e.pipeThrough(r).pipeTo(t)}setupReceiverTransform(e,t){i.log("Setting up receiver RED transform");let r=new TransformStream({transform:this.receivePacketLogTransform.bind(this)});e.pipeThrough(r).pipeTo(t)}setRedPayloadType(e){this.redPayloadType=e,i.log(`red payload type set to ${this.redPayloadType}`)}setOpusPayloadType(e){this.opusPayloadType=e,i.log(`opus payload type set to ${this.opusPayloadType}`)}setNumRedundantEncodings(e){this.numRedundantEncodings=e,this.numRedundantEncodings>this.maxRedEncodings&&(this.numRedundantEncodings=this.maxRedEncodings),i.log(`Updated numRedundantEncodings to ${this.numRedundantEncodings}`)}setRedundancyEnabled(e){this.redundancyEnabled=e,i.log(`redundancy ${this.redundancyEnabled?"enabled":"disabled"}`)}enqueueAudioFrameIfPayloadSizeIsValid(e,t){e.data.byteLength>this.maxAudioPayloadSizeBytes||t.enqueue(e)}senderTransform(e,t){if(e.getMetadata().payloadType!==this.redPayloadType){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}let i=this.getPrimaryPayload(e.timestamp,e.data);if(!i){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}let r=this.encode(e.timestamp,i);if(!r){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}e.data=r,this.enqueueAudioFrameIfPayloadSizeIsValid(e,t)}getPrimaryPayload(e,t){let i=this.splitEncodings(e,t);return!i||i.length<1?null:i[i.length-1].payload}splitEncodings(e,t,i=!1,r){let n=new DataView(t),o=n.byteLength,s=0,a=0,l=0,d=0,c=!1,u=[],h=[],f=[];for(;o>0;){if(c=(128&n.getUint8(d))==0){if((127&n.getUint8(d))!==this.opusPayloadType||(s+=this.redLastHeaderSizeBytes,a+=this.redLastHeaderSizeBytes,s>=n.byteLength))return null;l=n.byteLength-s;break}{if(o<this.redHeaderSizeBytes)return null;let t=((3&n.getUint8(d+2))<<8)+n.getUint8(d+3);h.push(t);let i=e-(n.getUint16(d+1)>>2);f.push(i),s+=t+this.redHeaderSizeBytes,a+=this.redHeaderSizeBytes,d+=this.redHeaderSizeBytes,o-=this.redHeaderSizeBytes}}if(!c)return void 0!==r?(u.push({payload:t,isRedundant:!1,seq:r}),u):null;let p=a;for(let e=0;e<f.length;e++){let t=new ArrayBuffer(h[e]);new Uint8Array(t).set(new Uint8Array(n.buffer,p,h[e]),0);let r={timestamp:f[e],payload:t,isRedundant:!0};i&&(r.hasFec=this.opusPacketHasFec(new DataView(t),t.byteLength)),u.push(r),p+=h[e]}let m=n.byteLength-l,g=new ArrayBuffer(l);new Uint8Array(g).set(new Uint8Array(n.buffer,m,l),0);let v={timestamp:e,payload:g,isRedundant:!1,seq:r};return i&&(v.hasFec=this.opusPacketHasFec(new DataView(g),g.byteLength)),u.push(v),u}encode(e,t){let i=t.byteLength;if(0===i||i>=this.maxRedPacketSizeBytes||i>=this.maxAudioPayloadSizeBytes)return null;let r=this.numRedundantEncodings,n=this.redLastHeaderSizeBytes,o=i,s=this.maxAudioPayloadSizeBytes-i-n,a=[],l=[];if(this.redundancyEnabled){let t=this.uint32WrapAround(e-this.redPacketizationTime*this.redPacketDistance);for(let i=0;i<r&&!(this.uint32WrapAround(e-t)>=this.maxRedTimestampOffset);i++){let e=t,i=this.encodingHistory.find(t=>t.timestamp===e);if(i||(e=this.uint32WrapAround(t-this.redPacketizationTime),i=this.encodingHistory.find(t=>t.timestamp===e)),i){let e=i.payload.byteLength;if(s<this.redHeaderSizeBytes+e)break;s-=this.redHeaderSizeBytes+e,n+=this.redHeaderSizeBytes,o+=e,a.unshift(i.timestamp),l.unshift(i.payload)}t-=this.redPacketizationTime*this.redPacketDistance,t=this.uint32WrapAround(t)}}let d=new ArrayBuffer(n+o),c=new DataView(d),u=0;for(let t=0;t<a.length;t++){let i=e-a[t];c.setUint8(u,128|this.opusPayloadType),c.setUint16(u+1,i<<2|l[t].byteLength>>8),c.setUint8(u+3,255&l[t].byteLength),u+=this.redHeaderSizeBytes}c.setUint8(u,this.opusPayloadType),u+=this.redLastHeaderSizeBytes;let h=new Uint8Array(d);for(let e=0;e<l.length;e++)h.set(new Uint8Array(l[e]),u),u+=l[e].byteLength;return(h.set(new Uint8Array(t),u),(u+=t.byteLength)!==n+o)?null:(this.updateEncodingHistory(e,t),d)}updateEncodingHistory(e,t){for(let t of this.encodingHistory){let i=this.redPacketizationTime*this.redMaxRecoveryDistance;if(e-t.timestamp>=i)this.encodingHistory.shift();else break}let i=new DataView(t);(this.opusPacketIsCeltOnly(i)||this.opusPacketHasVoiceActivity(i,i.byteLength)>0)&&(this.encodingHistory.length+1>this.maxEncodingHistorySize&&(this.encodingHistory.length=0),this.encodingHistory.push({timestamp:e,payload:t}))}initializePacketLogs(){let e=this.maxOutOfOrderPacketDistance+this.redMaxRecoveryDistance;this.primaryPacketLog={window:Array(e),index:0,windowSize:e},this.redRecoveryLog={window:Array(e),index:0,windowSize:e},this.fecRecoveryLog={window:Array(e),index:0,windowSize:e},this.totalAudioPacketsExpected=0,this.totalAudioPacketsLost=0,this.totalAudioPacketsRecoveredRed=0,this.totalAudioPacketsRecoveredFec=0}receivePacketLogTransform(e,t){let i=e.getMetadata();if(i.payloadType!==this.redPayloadType){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}let r=this.splitEncodings(e.timestamp,e.data,!0,i.sequenceNumber);if(!r){this.enqueueAudioFrameIfPayloadSizeIsValid(e,t);return}for(let e=r.length-1;e>=0;e--)this.updateLossStats(r[e])&&(this.updateRedStats(r[e]),this.updateFecStats(r[e]));this.maybeReportLossStats(i.synchronizationSource,r[r.length-1].timestamp),this.enqueueAudioFrameIfPayloadSizeIsValid(e,t)}updateLossStats(e){if(e.isRedundant)return!0;let t=e.timestamp,i=e.seq;if(0===this.totalAudioPacketsExpected)return this.totalAudioPacketsExpected=1,this.newestSequenceNumber=i,this.addTimestamp(this.primaryPacketLog,t),!0;let r=this.int16(i-this.newestSequenceNumber);return!(r<-this.maxOutOfOrderPacketDistance)&&(r<0?this.hasTimestamp(this.primaryPacketLog,t)||(this.totalAudioPacketsLost>0&&this.totalAudioPacketsLost--,this.addTimestamp(this.primaryPacketLog,t),this.removeFromRecoveryWindows(t)):r>1&&(this.totalAudioPacketsLost+=r-1),r>0&&(this.totalAudioPacketsExpected+=r,this.newestSequenceNumber=e.seq,this.addTimestamp(this.primaryPacketLog,t)),!0)}updateRedStats(e){if(!e.isRedundant||0===this.totalAudioPacketsLost)return;let t=e.timestamp;!this.hasTimestamp(this.primaryPacketLog,t)&&(this.hasTimestamp(this.redRecoveryLog,t)||(this.totalAudioPacketsRecoveredRed++,this.addTimestamp(this.redRecoveryLog,t)),this.removeTimestamp(this.fecRecoveryLog,t)&&this.totalAudioPacketsRecoveredFec>0&&this.totalAudioPacketsRecoveredFec--)}updateFecStats(e){if(!e.hasFec||0===this.totalAudioPacketsLost)return;let t=e.timestamp-this.redPacketizationTime;this.hasTimestamp(this.primaryPacketLog,t)||this.hasTimestamp(this.redRecoveryLog,t)||this.hasTimestamp(this.fecRecoveryLog,t)||(this.totalAudioPacketsRecoveredFec++,this.addTimestamp(this.fecRecoveryLog,t))}maybeReportLossStats(e,t){void 0===t||t-this.lastLossReportTimestamp<this.lossReportInterval||(i.shouldReportStats&&self.postMessage({type:"RedundantAudioEncoderStats",ssrc:e,totalAudioPacketsLost:this.totalAudioPacketsLost,totalAudioPacketsExpected:this.totalAudioPacketsExpected,totalAudioPacketsRecoveredRed:this.totalAudioPacketsRecoveredRed,totalAudioPacketsRecoveredFec:this.totalAudioPacketsRecoveredFec}),this.lastLossReportTimestamp=t)}addTimestamp(e,t){void 0!==t&&(e.window[e.index]=t,e.index=(e.index+1)%e.windowSize)}hasTimestamp(e,t){return!!e.window.find(e=>e===t)}removeTimestamp(e,t){let i=e.window.indexOf(t);return i>=0&&(e.window[i]=void 0,!0)}removeFromRecoveryWindows(e){let t=this.removeTimestamp(this.redRecoveryLog,e);t&&this.totalAudioPacketsRecoveredRed>0&&this.totalAudioPacketsRecoveredRed--,(t=this.removeTimestamp(this.fecRecoveryLog,e))&&this.totalAudioPacketsRecoveredFec>0&&this.totalAudioPacketsRecoveredFec--}uint32WrapAround(e){let t=4294967296,i=e;return e>=4294967296?i=e-t:e<0&&(i=t+e),i}int16(e){return e<<16>>16}opusPacketIsCeltOnly(e){return!!(128&e.getUint8(0))}opusPacketGetSamplesPerFrame(e,t){let i,r;return t=Math.min(Math.max(t=Math.round(t),-4294967296),4294967295),this.opusPacketIsCeltOnly(e)?(r=e.getUint8(0)>>3&3,i=(t<<r)/400):i=(96&e.getUint8(0))==96?8&e.getUint8(0)?t/50:t/100:3==(r=e.getUint8(0)>>3&3)?60*t/1e3:(t<<r)/100,i}opusNumSilkFrames(e){let t=this.opusPacketGetSamplesPerFrame(e,48e3)/48;switch(t<10&&(t=10),t){case 10:case 20:return 1;case 40:return 2;case 60:return 3;default:return 0}}opusPacketGetNumChannels(e){return 4&e.getUint8(0)?2:1}opusParseSize(e,t,i,r){return i<1?(r[0]=-1,-1):252>e.getUint8(t)?(r[0]=e.getUint8(t),1):i<2?(r[0]=-1,-1):(r[0]=4*e.getUint8(t+1)+e.getUint8(t),2)}opusPacketParseImpl(e,t,i,r,n,o,s,a){let l,d;if(!o||t<0)return this.OPUS_BAD_ARG;if(0===t)return this.OPUS_INVALID_PACKET;let c=0,u=!1,h=e.getUint8(0);r&&(r[0]=h);let f=t-1,p=1,m=f;switch(3&h){case 0:l=1;break;case 1:if(l=2,u=!0,!i){if(1&f)return this.OPUS_INVALID_PACKET;m=f/2,o[0][0]=m}break;case 2:if(l=2,d=this.opusParseSize(e,p,f,o[0]),f-=d,o[0][0]<0||o[0][0]>f)return this.OPUS_INVALID_PACKET;p+=d,m=f-o[0][0];break;default:if(f<1)return this.OPUS_INVALID_PACKET;let g=e.getUint8(p++);if(--f,(l=63&g)<=0||this.opusPacketGetSamplesPerFrame(e,48e3)*l>5760)return this.OPUS_INVALID_PACKET;if(64&g){let t,i;do{if(f<=0)return this.OPUS_INVALID_PACKET;t=e.getUint8(p++),--f,f-=i=255===t?254:t,c+=i}while(255===t)}if(f<0)return this.OPUS_INVALID_PACKET;if(u=!(128&g)){if(!i){if((m=Math.trunc(f/l))*l!==f)return this.OPUS_INVALID_PACKET;for(let e=0;e<l-1;++e)o[e][0]=m}}else{m=f;for(let t=0;t<l-1;++t){if(d=this.opusParseSize(e,p,f,o[t]),f-=d,o[t][0]<0||o[t][0]>f)return this.OPUS_INVALID_PACKET;p+=d,m-=d+o[t][0]}if(m<0)return this.OPUS_INVALID_PACKET}}if(i){if(d=this.opusParseSize(e,p,f,o[l-1]),f-=d,o[l-1][0]<0||o[l-1][0]>f)return this.OPUS_INVALID_PACKET;if(p+=d,u){if(o[l-1][0]*l>f)return this.OPUS_INVALID_PACKET;for(let e=0;e<l-1;++e)o[e][0]=o[l-1][0]}else if(!(d+o[l-1][0]<=m))return this.OPUS_INVALID_PACKET}else{if(m>this.OPUS_MAX_FRAME_SIZE_BYTES)return this.OPUS_INVALID_PACKET;o[l-1][0]=m}s&&(s[0]=p);for(let e=0;e<l;++e)n&&(n[e][0]=p),p+=o[e][0];return a&&(a[0]=p+c),l}opusPacketParse(e,t,i,r,n,o){return this.opusPacketParseImpl(e,t,!1,i,r,n,o,null)}opusPacketHasVoiceActivity(e,t){if(!e||t<=0)return 0;if(this.opusPacketIsCeltOnly(e))return -1;let i=this.opusNumSilkFrames(e);if(0===i)return -1;let r=Array(this.OPUS_MAX_OPUS_FRAMES),n=Array(this.OPUS_MAX_OPUS_FRAMES);for(let e=0;e<this.OPUS_MAX_OPUS_FRAMES;++e)r[e]=[void 0],n[e]=[void 0];let o=this.opusPacketParse(e,t,null,r,n,null);if(o<0)return -1;for(let t=0;t<o;++t)if(!(n[t][0]<1)&&(e.getUint8(r[t][0])>>8-i||2===this.opusPacketGetNumChannels(e)&&e.getUint8(r[t][0])<<i+1>>8-i))return 1;return 0}opusPacketHasFec(e,t){if(!e||t<=0||this.opusPacketIsCeltOnly(e))return!1;let i=Array(this.OPUS_MAX_OPUS_FRAMES),r=Array(this.OPUS_MAX_OPUS_FRAMES);for(let e=0;e<this.OPUS_MAX_OPUS_FRAMES;++e)i[e]=[void 0],r[e]=[void 0];if(0>this.opusPacketParse(e,t,null,i,r,null)||r[0][0]<=1)return!1;let n=this.opusNumSilkFrames(e);if(0===n)return!1;let o=this.opusPacketGetNumChannels(e);if(1!==o&&2!==o)return!1;for(let t=0;t<o;t++)if(e.getUint8(i[0][0])&128>>(t+1)*(n+1)-1)return!0;return!1}}t.default=i,i.shouldLog=!1,i.shouldReportStats=!1},1044:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i="class RedundantAudioEncoder {\n    constructor() {\n        // Each payload must be less than 1024 bytes to fit the 10 bit block length\n        this.maxRedPacketSizeBytes = 1 << 10;\n        // Limit payload to 1000 bytes to handle small MTU. 1000 is chosen because in Chromium-based browsers, writing audio\n        // payloads larger than 1000 bytes using the WebRTC Insertable Streams API (which is used to enable dynamic audio\n        // redundancy) will cause an error to be thrown and cause audio flow to permanently stop. See\n        // https://crbug.com/1248479.\n        this.maxAudioPayloadSizeBytes = 1000;\n        // Each payload can encode a timestamp delta of 14 bits\n        this.maxRedTimestampOffset = 1 << 14;\n        // 4 byte RED header\n        this.redHeaderSizeBytes = 4;\n        // reduced size for last RED header\n        this.redLastHeaderSizeBytes = 1;\n        // P-Time for Opus 20 msec packets\n        // We do not support other p-times or clock rates\n        this.redPacketizationTime = 960;\n        // distance between redundant payloads, Opus FEC handles a distance of 1\n        // TODO(https://issues.amazon.com/issues/ChimeSDKAudio-55):\n        // Consider making this dynamic\n        this.redPacketDistance = 2;\n        // maximum number of redundant payloads per RTP packet\n        this.maxRedEncodings = 2;\n        // Maximum number of encodings that can be recovered with a single RED packet, assuming the primary and redundant\n        // payloads have FEC.\n        this.redMaxRecoveryDistance = this.redPacketDistance * this.maxRedEncodings + 1;\n        // maximum history of prior payloads to keep\n        // generally we will expire old entries based on timestamp\n        // this limit is in place just to make sure the history does not\n        // grow too large in the case of erroneous timestamp inputs\n        this.maxEncodingHistorySize = 10;\n        // Current number of encodings we want to send\n        // to the remote end. This will be dynamically\n        // updated through the setNumEncodingsFromPacketloss API\n        this.numRedundantEncodings = 0;\n        // Used to enable or disable redundancy\n        // in response to very high packet loss events\n        this.redundancyEnabled = true;\n        // Loss stats are reported to the main thread every 5 seconds.\n        // Since timestamp differences between 2 consecutive packets\n        // give us the number of samples in each channel, 1 second\n        // is equivalent to 48000 samples:\n        // P-time * (1000ms/1s)\n        // = (960 samples/20ms) * (1000ms/1s)\n        // = 48000 samples/s\n        this.lossReportInterval = 48000 * 5;\n        // Maximum distance of a packet from the most recent packet timestamp\n        // that we will consider for recovery.\n        this.maxOutOfOrderPacketDistance = 16;\n        /**\n         * Below are Opus helper methods and constants.\n         */\n        this.OPUS_BAD_ARG = -1;\n        this.OPUS_INVALID_PACKET = -4;\n        // Max number of Opus frames in an Opus packet is 48 (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.5).\n        this.OPUS_MAX_OPUS_FRAMES = 48;\n        // Max number of bytes that any individual Opus frame can have.\n        this.OPUS_MAX_FRAME_SIZE_BYTES = 1275;\n        this.encodingHistory = new Array();\n        this.opusPayloadType = 0;\n        this.redPayloadType = 0;\n        this.initializePacketLogs();\n    }\n    /**\n     * Creates an instance of RedundantAudioEncoder and sets up callbacks.\n     */\n    static initializeWorker() {\n        RedundantAudioEncoder.log('Initializing RedundantAudioEncoder');\n        const encoder = new RedundantAudioEncoder();\n        // RED encoding is done using WebRTC Encoded Transform\n        // https://github.com/w3c/webrtc-encoded-transform/blob/main/explainer.md\n        // Check the DedicatedWorkerGlobalScope for existence of\n        // RTCRtpScriptTransformer interface. If exists, then\n        // RTCRtpScriptTransform is supported by this browser.\n        // @ts-ignore\n        if (self.RTCRtpScriptTransformer) {\n            // @ts-ignore\n            self.onrtctransform = (event) => {\n                if (event.transformer.options.type === 'SenderTransform') {\n                    encoder.setupSenderTransform(event.transformer.readable, event.transformer.writable);\n                }\n                else if (event.transformer.options.type === 'ReceiverTransform') {\n                    encoder.setupReceiverTransform(event.transformer.readable, event.transformer.writable);\n                }\n                else if (event.transformer.options.type === 'PassthroughTransform') {\n                    encoder.setupPassthroughTransform(event.transformer.readable, event.transformer.writable);\n                }\n            };\n        }\n        self.onmessage = (event) => {\n            if (event.data.msgType === 'StartRedWorker') {\n                encoder.setupSenderTransform(event.data.send.readable, event.data.send.writable);\n                encoder.setupReceiverTransform(event.data.receive.readable, event.data.receive.writable);\n            }\n            else if (event.data.msgType === 'PassthroughTransform') {\n                encoder.setupPassthroughTransform(event.data.send.readable, event.data.send.writable);\n                encoder.setupPassthroughTransform(event.data.receive.readable, event.data.receive.writable);\n            }\n            else if (event.data.msgType === 'RedPayloadType') {\n                encoder.setRedPayloadType(event.data.payloadType);\n            }\n            else if (event.data.msgType === 'OpusPayloadType') {\n                encoder.setOpusPayloadType(event.data.payloadType);\n            }\n            else if (event.data.msgType === 'UpdateNumRedundantEncodings') {\n                encoder.setNumRedundantEncodings(event.data.numRedundantEncodings);\n            }\n            else if (event.data.msgType === 'Enable') {\n                encoder.setRedundancyEnabled(true);\n            }\n            else if (event.data.msgType === 'Disable') {\n                encoder.setRedundancyEnabled(false);\n            }\n        };\n    }\n    /**\n     * Post logs to the main thread\n     */\n    static log(msg) {\n        if (RedundantAudioEncoder.shouldLog) {\n            // @ts-ignore\n            self.postMessage({\n                type: 'REDWorkerLog',\n                log: `[AudioRed] ${msg}`,\n            });\n        }\n    }\n    /**\n     * Returns the number of encodings based on packetLoss value. This is used by `DefaultTransceiverController` to\n     * determine when to alert the encoder to update the number of encodings. It also determines if we need to\n     * turn off red in cases of very high packet loss to avoid congestion collapse.\n     */\n    static getNumRedundantEncodingsForPacketLoss(packetLoss) {\n        let recommendedRedundantEncodings = 0;\n        let shouldTurnOffRed = false;\n        if (packetLoss <= 8) {\n            recommendedRedundantEncodings = 0;\n        }\n        else if (packetLoss <= 18) {\n            recommendedRedundantEncodings = 1;\n        }\n        else if (packetLoss <= 75) {\n            recommendedRedundantEncodings = 2;\n        }\n        else {\n            recommendedRedundantEncodings = 0;\n            shouldTurnOffRed = true;\n        }\n        return [recommendedRedundantEncodings, shouldTurnOffRed];\n    }\n    /**\n     * Sets up a passthrough (no-op) transform for the given streams.\n     */\n    setupPassthroughTransform(readable, writable) {\n        RedundantAudioEncoder.log('Setting up passthrough transform');\n        readable.pipeTo(writable);\n    }\n    /**\n     * Sets up the transform stream and pipes the outgoing encoded audio frames through the transform function.\n     */\n    setupSenderTransform(readable, writable) {\n        RedundantAudioEncoder.log('Setting up sender RED transform');\n        const transformStream = new TransformStream({\n            transform: this.senderTransform.bind(this),\n        });\n        readable.pipeThrough(transformStream).pipeTo(writable);\n        return;\n    }\n    /**\n     * Sets up the transform stream and pipes the received encoded audio frames through the transform function.\n     */\n    setupReceiverTransform(readable, writable) {\n        RedundantAudioEncoder.log('Setting up receiver RED transform');\n        const transformStream = new TransformStream({\n            transform: this.receivePacketLogTransform.bind(this),\n        });\n        readable.pipeThrough(transformStream).pipeTo(writable);\n        return;\n    }\n    /**\n     * Set the RED payload type ideally obtained from local offer.\n     */\n    setRedPayloadType(payloadType) {\n        this.redPayloadType = payloadType;\n        RedundantAudioEncoder.log(`red payload type set to ${this.redPayloadType}`);\n    }\n    /**\n     * Set the opus payload type ideally obtained from local offer.\n     */\n    setOpusPayloadType(payloadType) {\n        this.opusPayloadType = payloadType;\n        RedundantAudioEncoder.log(`opus payload type set to ${this.opusPayloadType}`);\n    }\n    /**\n     * Set the number of redundant encodings\n     */\n    setNumRedundantEncodings(numRedundantEncodings) {\n        this.numRedundantEncodings = numRedundantEncodings;\n        if (this.numRedundantEncodings > this.maxRedEncodings) {\n            this.numRedundantEncodings = this.maxRedEncodings;\n        }\n        RedundantAudioEncoder.log(`Updated numRedundantEncodings to ${this.numRedundantEncodings}`);\n    }\n    /**\n     * Enable or disable redundancy in response to\n     * high packet loss event.\n     */\n    setRedundancyEnabled(enabled) {\n        this.redundancyEnabled = enabled;\n        RedundantAudioEncoder.log(`redundancy ${this.redundancyEnabled ? 'enabled' : 'disabled'}`);\n    }\n    /**\n     * Helper function to only enqueue audio frames if they do not exceed the audio payload byte limit imposed by\n     * Chromium-based browsers. Chromium will throw an error (https://crbug.com/1248479) if an audio payload larger than\n     * 1000 bytes is enqueued. Any controller that attempts to enqueue an audio payload larger than 1000 bytes will\n     * encounter this error and will permanently stop sending or receiving audio.\n     */\n    enqueueAudioFrameIfPayloadSizeIsValid(\n    // @ts-ignore\n    frame, controller) {\n        if (frame.data.byteLength > this.maxAudioPayloadSizeBytes)\n            return;\n        controller.enqueue(frame);\n    }\n    /**\n     * Receives encoded frames and modifies as needed before sending to transport.\n     */\n    senderTransform(\n    // @ts-ignore\n    frame, controller) {\n        const frameMetadata = frame.getMetadata();\n        // @ts-ignore\n        if (frameMetadata.payloadType !== this.redPayloadType) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        const primaryPayloadBuffer = this.getPrimaryPayload(frame.timestamp, frame.data);\n        if (!primaryPayloadBuffer) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        const encodedBuffer = this.encode(frame.timestamp, primaryPayloadBuffer);\n        /* istanbul ignore next */\n        if (!encodedBuffer) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        frame.data = encodedBuffer;\n        this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n        return;\n    }\n    /**\n     * Get the primary payload from encoding\n     */\n    getPrimaryPayload(primaryTimestamp, frame) {\n        const encodings = this.splitEncodings(primaryTimestamp, frame);\n        if (!encodings || encodings.length < 1)\n            return null;\n        return encodings[encodings.length - 1].payload;\n    }\n    /**\n     * Split up the encoding received into primary and redundant encodings\n     * These will be ordered oldest to newest which is the same ordering\n     * in the RTP red payload.\n     */\n    splitEncodings(primaryTimestamp, frame, getFecInfo = false, primarySequenceNumber = undefined) {\n        // process RED headers (according to RFC 2198)\n        //   0                   1                   2                   3\n        //   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n        //  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        //  |F|   block PT  |  timestamp offset         |   block length    |\n        //  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        //\n        // last header\n        //   0 1 2 3 4 5 6 7\n        //  +-+-+-+-+-+-+-+-+\n        //  |0|   Block PT  |\n        //  +-+-+-+-+-+-+-+-+\n        const payload = new DataView(frame);\n        let payloadSizeBytes = payload.byteLength;\n        let totalPayloadSizeBytes = 0;\n        let totalHeaderSizeBytes = 0;\n        let primaryPayloadSizeBytes = 0;\n        let payloadOffset = 0;\n        let gotLastBlock = false;\n        const encodings = new Array();\n        const redundantEncodingBlockLengths = new Array();\n        const redundantEncodingTimestamps = new Array();\n        while (payloadSizeBytes > 0) {\n            gotLastBlock = (payload.getUint8(payloadOffset) & 0x80) === 0;\n            if (gotLastBlock) {\n                // Bits 1 through 7 are payload type\n                const payloadType = payload.getUint8(payloadOffset) & 0x7f;\n                // Unexpected payload type. This is a bad packet.\n                if (payloadType !== this.opusPayloadType) {\n                    return null;\n                }\n                totalPayloadSizeBytes += this.redLastHeaderSizeBytes;\n                totalHeaderSizeBytes += this.redLastHeaderSizeBytes;\n                // Accumulated block lengths are equal to or larger than the buffer, which means there is no primary block. This\n                // is a bad packet.\n                if (totalPayloadSizeBytes >= payload.byteLength) {\n                    return null;\n                }\n                primaryPayloadSizeBytes = payload.byteLength - totalPayloadSizeBytes;\n                break;\n            }\n            else {\n                if (payloadSizeBytes < this.redHeaderSizeBytes) {\n                    return null;\n                }\n                // Bits 22 through 31 are payload length\n                const blockLength = ((payload.getUint8(payloadOffset + 2) & 0x03) << 8) + payload.getUint8(payloadOffset + 3);\n                redundantEncodingBlockLengths.push(blockLength);\n                const timestampOffset = payload.getUint16(payloadOffset + 1) >> 2;\n                const timestamp = primaryTimestamp - timestampOffset;\n                redundantEncodingTimestamps.push(timestamp);\n                totalPayloadSizeBytes += blockLength + this.redHeaderSizeBytes;\n                totalHeaderSizeBytes += this.redHeaderSizeBytes;\n                payloadOffset += this.redHeaderSizeBytes;\n                payloadSizeBytes -= this.redHeaderSizeBytes;\n            }\n        }\n        // The last block was never found. The packet we received\n        // does not have a good RED payload.\n        if (!gotLastBlock) {\n            // Note that sequence numbers only exist for\n            // incoming audio frames.\n            if (primarySequenceNumber !== undefined) {\n                // This could be a possible padding packet used\n                // for BWE with a good sequence number.\n                // Create a dummy encoding to make sure loss values\n                // are calculated correctly by consuming sequence number.\n                // Note that for the receive side, we process packets only\n                // for loss/recovery calculations and forward the original\n                // packet without changing it even in the error case.\n                encodings.push({\n                    payload: frame,\n                    isRedundant: false,\n                    seq: primarySequenceNumber,\n                });\n                return encodings;\n            }\n            // This is a bad packet.\n            return null;\n        }\n        let redundantPayloadOffset = totalHeaderSizeBytes;\n        for (let i = 0; i < redundantEncodingTimestamps.length; i++) {\n            const redundantPayloadBuffer = new ArrayBuffer(redundantEncodingBlockLengths[i]);\n            const redundantPayloadArray = new Uint8Array(redundantPayloadBuffer);\n            redundantPayloadArray.set(new Uint8Array(payload.buffer, redundantPayloadOffset, redundantEncodingBlockLengths[i]), 0);\n            const encoding = {\n                timestamp: redundantEncodingTimestamps[i],\n                payload: redundantPayloadBuffer,\n                isRedundant: true,\n            };\n            if (getFecInfo) {\n                encoding.hasFec = this.opusPacketHasFec(new DataView(redundantPayloadBuffer), redundantPayloadBuffer.byteLength);\n            }\n            encodings.push(encoding);\n            redundantPayloadOffset += redundantEncodingBlockLengths[i];\n        }\n        const primaryPayloadOffset = payload.byteLength - primaryPayloadSizeBytes;\n        const primaryPayloadBuffer = new ArrayBuffer(primaryPayloadSizeBytes);\n        const primaryArray = new Uint8Array(primaryPayloadBuffer);\n        primaryArray.set(new Uint8Array(payload.buffer, primaryPayloadOffset, primaryPayloadSizeBytes), 0);\n        const encoding = {\n            timestamp: primaryTimestamp,\n            payload: primaryPayloadBuffer,\n            isRedundant: false,\n            seq: primarySequenceNumber,\n        };\n        if (getFecInfo) {\n            encoding.hasFec = this.opusPacketHasFec(new DataView(primaryPayloadBuffer), primaryPayloadBuffer.byteLength);\n        }\n        encodings.push(encoding);\n        return encodings;\n    }\n    /**\n     * Create a new encoding with current primary payload and the older payloads of choice.\n     */\n    encode(primaryTimestamp, primaryPayload) {\n        const primaryPayloadSize = primaryPayload.byteLength;\n        // Payload size needs to be valid.\n        if (primaryPayloadSize === 0 ||\n            primaryPayloadSize >= this.maxRedPacketSizeBytes ||\n            primaryPayloadSize >= this.maxAudioPayloadSizeBytes) {\n            return null;\n        }\n        const numRedundantEncodings = this.numRedundantEncodings;\n        let headerSizeBytes = this.redLastHeaderSizeBytes;\n        let payloadSizeBytes = primaryPayloadSize;\n        let bytesAvailable = this.maxAudioPayloadSizeBytes - primaryPayloadSize - headerSizeBytes;\n        const redundantEncodingTimestamps = new Array();\n        const redundantEncodingPayloads = new Array();\n        // If redundancy is disabled then only send the primary payload\n        if (this.redundancyEnabled) {\n            // Determine how much redundancy we can fit into our packet\n            let redundantTimestamp = this.uint32WrapAround(primaryTimestamp - this.redPacketizationTime * this.redPacketDistance);\n            for (let i = 0; i < numRedundantEncodings; i++) {\n                // Do not add redundant encodings that are beyond the maximum timestamp offset.\n                if (this.uint32WrapAround(primaryTimestamp - redundantTimestamp) >= this.maxRedTimestampOffset) {\n                    break;\n                }\n                let findTimestamp = redundantTimestamp;\n                let encoding = this.encodingHistory.find(e => e.timestamp === findTimestamp);\n                if (!encoding) {\n                    // If not found or not important then look for the previous packet.\n                    // The current packet may have included FEC for the previous, so just\n                    // use the previous packet instead provided that it has voice activity.\n                    findTimestamp = this.uint32WrapAround(redundantTimestamp - this.redPacketizationTime);\n                    encoding = this.encodingHistory.find(e => e.timestamp === findTimestamp);\n                }\n                if (encoding) {\n                    const redundantEncodingSizeBytes = encoding.payload.byteLength;\n                    // Only add redundancy if there are enough bytes available.\n                    if (bytesAvailable < this.redHeaderSizeBytes + redundantEncodingSizeBytes)\n                        break;\n                    bytesAvailable -= this.redHeaderSizeBytes + redundantEncodingSizeBytes;\n                    headerSizeBytes += this.redHeaderSizeBytes;\n                    payloadSizeBytes += redundantEncodingSizeBytes;\n                    redundantEncodingTimestamps.unshift(encoding.timestamp);\n                    redundantEncodingPayloads.unshift(encoding.payload);\n                }\n                redundantTimestamp -= this.redPacketizationTime * this.redPacketDistance;\n                redundantTimestamp = this.uint32WrapAround(redundantTimestamp);\n            }\n        }\n        const redPayloadBuffer = new ArrayBuffer(headerSizeBytes + payloadSizeBytes);\n        const redPayloadView = new DataView(redPayloadBuffer);\n        // Add redundant encoding header(s) to new buffer\n        let redPayloadOffset = 0;\n        for (let i = 0; i < redundantEncodingTimestamps.length; i++) {\n            const timestampDelta = primaryTimestamp - redundantEncodingTimestamps[i];\n            redPayloadView.setUint8(redPayloadOffset, this.opusPayloadType | 0x80);\n            redPayloadView.setUint16(redPayloadOffset + 1, (timestampDelta << 2) | (redundantEncodingPayloads[i].byteLength >> 8));\n            redPayloadView.setUint8(redPayloadOffset + 3, redundantEncodingPayloads[i].byteLength & 0xff);\n            redPayloadOffset += this.redHeaderSizeBytes;\n        }\n        // Add primary encoding header to new buffer\n        redPayloadView.setUint8(redPayloadOffset, this.opusPayloadType);\n        redPayloadOffset += this.redLastHeaderSizeBytes;\n        // Add redundant payload(s) to new buffer\n        const redPayloadArray = new Uint8Array(redPayloadBuffer);\n        for (let i = 0; i < redundantEncodingPayloads.length; i++) {\n            redPayloadArray.set(new Uint8Array(redundantEncodingPayloads[i]), redPayloadOffset);\n            redPayloadOffset += redundantEncodingPayloads[i].byteLength;\n        }\n        // Add primary payload to new buffer\n        redPayloadArray.set(new Uint8Array(primaryPayload), redPayloadOffset);\n        redPayloadOffset += primaryPayload.byteLength;\n        /* istanbul ignore next */\n        // Sanity check that we got the expected total payload size.\n        if (redPayloadOffset !== headerSizeBytes + payloadSizeBytes)\n            return null;\n        this.updateEncodingHistory(primaryTimestamp, primaryPayload);\n        return redPayloadBuffer;\n    }\n    /**\n     * Update the encoding history with the latest primary encoding\n     */\n    updateEncodingHistory(primaryTimestamp, primaryPayload) {\n        // Remove encodings from the history if they are too old.\n        for (const encoding of this.encodingHistory) {\n            const maxTimestampDelta = this.redPacketizationTime * this.redMaxRecoveryDistance;\n            if (primaryTimestamp - encoding.timestamp >= maxTimestampDelta) {\n                this.encodingHistory.shift();\n            }\n            else {\n                break;\n            }\n        }\n        // Only add an encoding to the history if the encoding is deemed to be important. An encoding is important if it is\n        // a CELT-only packet or contains voice activity.\n        const packet = new DataView(primaryPayload);\n        if (this.opusPacketIsCeltOnly(packet) ||\n            this.opusPacketHasVoiceActivity(packet, packet.byteLength) > 0) {\n            // Check if adding an encoding will cause the length of the encoding history to exceed the maximum history size.\n            // This is not expected to happen but could occur if we get incorrect timestamps. We want to make sure our memory\n            // usage is bounded. In this case, just clear the history and start over from empty.\n            if (this.encodingHistory.length + 1 > this.maxEncodingHistorySize)\n                this.encodingHistory.length = 0;\n            this.encodingHistory.push({ timestamp: primaryTimestamp, payload: primaryPayload });\n        }\n    }\n    /**\n     * Initialize packet logs and metric values.\n     */\n    initializePacketLogs() {\n        // The extra space from the max RED recovery distance is to ensure that we do not incorrectly count recovery for\n        // packets that have already been received but are outside of the max out-of-order distance.\n        const packetLogSize = this.maxOutOfOrderPacketDistance + this.redMaxRecoveryDistance;\n        this.primaryPacketLog = {\n            window: new Array(packetLogSize),\n            index: 0,\n            windowSize: packetLogSize,\n        };\n        this.redRecoveryLog = {\n            window: new Array(packetLogSize),\n            index: 0,\n            windowSize: packetLogSize,\n        };\n        this.fecRecoveryLog = {\n            window: new Array(packetLogSize),\n            index: 0,\n            windowSize: packetLogSize,\n        };\n        this.totalAudioPacketsExpected = 0;\n        this.totalAudioPacketsLost = 0;\n        this.totalAudioPacketsRecoveredRed = 0;\n        this.totalAudioPacketsRecoveredFec = 0;\n    }\n    /**\n     * Receives encoded frames from the server\n     * and adds the timestamps to a packet log\n     * to calculate an approximate recovery metric.\n     */\n    receivePacketLogTransform(\n    // @ts-ignore\n    frame, controller) {\n        const frameMetadata = frame.getMetadata();\n        // @ts-ignore\n        if (frameMetadata.payloadType !== this.redPayloadType) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        // @ts-ignore\n        const encodings = this.splitEncodings(frame.timestamp, frame.data, \n        /*getFecInfo*/ true, frameMetadata.sequenceNumber);\n        if (!encodings) {\n            this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n            return;\n        }\n        for (let i = encodings.length - 1; i >= 0; i--) {\n            if (this.updateLossStats(encodings[i])) {\n                this.updateRedStats(encodings[i]);\n                this.updateFecStats(encodings[i]);\n            }\n        }\n        this.maybeReportLossStats(frameMetadata.synchronizationSource, encodings[encodings.length - 1].timestamp);\n        this.enqueueAudioFrameIfPayloadSizeIsValid(frame, controller);\n    }\n    /**\n     * Adds a timestamp to the primary packet log.\n     * This also updates totalAudioPacketsLost and totalAudioPacketsExpected by looking\n     * at the difference between timestamps.\n     *\n     * @param encoding : The encoding to be analyzed\n     * @returns false if sequence number was greater than max out of order distance\n     *          true otherwise\n     */\n    updateLossStats(encoding) {\n        if (encoding.isRedundant)\n            return true;\n        const timestamp = encoding.timestamp;\n        const seq = encoding.seq;\n        if (this.totalAudioPacketsExpected === 0) {\n            this.totalAudioPacketsExpected = 1;\n            this.newestSequenceNumber = seq;\n            this.addTimestamp(this.primaryPacketLog, timestamp);\n            return true;\n        }\n        const diff = this.int16(seq - this.newestSequenceNumber);\n        if (diff < -this.maxOutOfOrderPacketDistance)\n            return false;\n        if (diff < 0) {\n            if (!this.hasTimestamp(this.primaryPacketLog, timestamp)) {\n                if (this.totalAudioPacketsLost > 0)\n                    this.totalAudioPacketsLost--;\n                this.addTimestamp(this.primaryPacketLog, timestamp);\n                this.removeFromRecoveryWindows(timestamp);\n            }\n        }\n        else if (diff > 1) {\n            this.totalAudioPacketsLost += diff - 1;\n        }\n        if (diff > 0) {\n            this.totalAudioPacketsExpected += diff;\n            this.newestSequenceNumber = encoding.seq;\n            this.addTimestamp(this.primaryPacketLog, timestamp);\n        }\n        return true;\n    }\n    /**\n     * Adds a timestamp to the red recovery log if it is not present in\n     * the primary packet log and if it's not too old.\n     *\n     * @param encoding : The encoding to be analyzed\n     */\n    updateRedStats(encoding) {\n        if (!encoding.isRedundant || this.totalAudioPacketsLost === 0)\n            return;\n        const timestamp = encoding.timestamp;\n        if (!this.hasTimestamp(this.primaryPacketLog, timestamp)) {\n            if (!this.hasTimestamp(this.redRecoveryLog, timestamp)) {\n                this.totalAudioPacketsRecoveredRed++;\n                this.addTimestamp(this.redRecoveryLog, timestamp);\n            }\n            if (this.removeTimestamp(this.fecRecoveryLog, timestamp)) {\n                /* istanbul ignore else */\n                if (this.totalAudioPacketsRecoveredFec > 0)\n                    this.totalAudioPacketsRecoveredFec--;\n            }\n        }\n    }\n    /**\n     * Adds a timestamp to the fec recovery log if it is not present in\n     * the primary packet log and red recovery log and if it is not too old.\n     *\n     * @param encoding : The encoding to be analyzed\n     */\n    updateFecStats(encoding) {\n        if (!encoding.hasFec || this.totalAudioPacketsLost === 0)\n            return;\n        const fecTimestamp = encoding.timestamp - this.redPacketizationTime;\n        if (this.hasTimestamp(this.primaryPacketLog, fecTimestamp) ||\n            this.hasTimestamp(this.redRecoveryLog, fecTimestamp) ||\n            this.hasTimestamp(this.fecRecoveryLog, fecTimestamp)) {\n            return;\n        }\n        this.totalAudioPacketsRecoveredFec++;\n        this.addTimestamp(this.fecRecoveryLog, fecTimestamp);\n    }\n    /**\n     * Reports loss metrics to DefaultTransceiverController\n     *\n     * @param timestamp : Timestamp of most recent primary packet\n     */\n    maybeReportLossStats(ssrc, timestamp) {\n        if (timestamp === undefined ||\n            timestamp - this.lastLossReportTimestamp < this.lossReportInterval)\n            return;\n        /* istanbul ignore next */\n        if (RedundantAudioEncoder.shouldReportStats) {\n            // @ts-ignore\n            self.postMessage({\n                type: 'RedundantAudioEncoderStats',\n                ssrc,\n                totalAudioPacketsLost: this.totalAudioPacketsLost,\n                totalAudioPacketsExpected: this.totalAudioPacketsExpected,\n                totalAudioPacketsRecoveredRed: this.totalAudioPacketsRecoveredRed,\n                totalAudioPacketsRecoveredFec: this.totalAudioPacketsRecoveredFec,\n            });\n        }\n        this.lastLossReportTimestamp = timestamp;\n    }\n    /**\n     * Adds a timestamp to a packet log\n     *\n     * @param packetLog : The packetlog to add the timestamp to\n     * @param timestamp : The timestamp that should be added\n     */\n    addTimestamp(packetLog, timestamp) {\n        if (timestamp === undefined) {\n            return;\n        }\n        packetLog.window[packetLog.index] = timestamp;\n        packetLog.index = (packetLog.index + 1) % packetLog.windowSize;\n    }\n    /**\n     * Checks if a timestamp is in a packetlog\n     *\n     * @param packetLog : The packetlog to search\n     * @param timestamp : The timestamp to search for\n     * @returns true if timestamp is present, false otherwise\n     */\n    hasTimestamp(packetLog, timestamp) {\n        const element = packetLog.window.find(t => t === timestamp);\n        return !!element;\n    }\n    /**\n     * Removes a timestamp from a packet log\n     *\n     * @param packetLog : The packetlog from which the timestamp should be removed\n     * @param timestamp : The timestamp to be removed\n     * @returns true if timestamp was present in the log and removed, false otherwise\n     */\n    removeTimestamp(packetLog, timestamp) {\n        const index = packetLog.window.indexOf(timestamp);\n        if (index >= 0) {\n            packetLog.window[index] = undefined;\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Removes a timestamp from red and fec recovery windows.\n     *\n     * @param timestamp : The timestamp to be removed\n     */\n    removeFromRecoveryWindows(timestamp) {\n        let removed = this.removeTimestamp(this.redRecoveryLog, timestamp);\n        if (removed) {\n            if (this.totalAudioPacketsRecoveredRed > 0)\n                this.totalAudioPacketsRecoveredRed--;\n        }\n        removed = this.removeTimestamp(this.fecRecoveryLog, timestamp);\n        if (removed) {\n            if (this.totalAudioPacketsRecoveredFec > 0)\n                this.totalAudioPacketsRecoveredFec--;\n        }\n    }\n    /**\n     * Converts the supplied argument to 32-bit unsigned integer\n     */\n    uint32WrapAround(num) {\n        const mod = 4294967296; // 2^32\n        let res = num;\n        if (num >= mod) {\n            res = num - mod;\n        }\n        else if (num < 0) {\n            res = mod + num;\n        }\n        return res;\n    }\n    /**\n     * Converts the supplied argument to 16-bit signed integer\n     */\n    int16(num) {\n        return (num << 16) >> 16;\n    }\n    /**\n     * Determines if an Opus packet is in CELT-only mode.\n     *\n     * @param packet Opus packet.\n     * @returns `true` if the packet is in CELT-only mode.\n     */\n    opusPacketIsCeltOnly(packet) {\n        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):\n        //  0\n        //  0 1 2 3 4 5 6 7\n        // +-+-+-+-+-+-+-+-+\n        // | config  |s| c |\n        // +-+-+-+-+-+-+-+-+\n        // Since CELT-only packets are represented using configurations 16 to 31, the highest 'config' bit will always be 1\n        // for CELT-only packets.\n        return !!(packet.getUint8(0) & 0x80);\n    }\n    /**\n     * Gets the number of samples per frame from an Opus packet.\n     *\n     * @param packet Opus packet. This must contain at least one byte of data.\n     * @param sampleRateHz 32-bit integer sampling rate in Hz. This must be a multiple of 400 or inaccurate results will\n     *                     be returned.\n     * @returns Number of samples per frame.\n     */\n    opusPacketGetSamplesPerFrame(packet, sampleRateHz) {\n        // Sample rate must be a 32-bit integer.\n        sampleRateHz = Math.round(sampleRateHz);\n        sampleRateHz = Math.min(Math.max(sampleRateHz, -(Math.pow(2, 32))), Math.pow(2, 32) - 1);\n        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):\n        //  0\n        //  0 1 2 3 4 5 6 7\n        // +-+-+-+-+-+-+-+-+\n        // | config  |s| c |\n        // +-+-+-+-+-+-+-+-+\n        let numSamples;\n        let frameSizeOption;\n        // Case for CELT-only packet.\n        if (this.opusPacketIsCeltOnly(packet)) {\n            // The lower 3 'config' bits indicate the frame size option.\n            frameSizeOption = (packet.getUint8(0) >> 3) & 0x3;\n            // The frame size options 0, 1, 2, 3 correspond to frame sizes of 2.5, 5, 10, 20 ms. Notice that the frame sizes\n            // can be represented as (2.5 * 2^0), (2.5 * 2^1), (2.5 * 2^2), (2.5 * 2^3) ms. So, the number of samples can be\n            // calculated as follows:\n            // (sample/s) * (1s/1000ms) * (2.5ms) * 2^(frameSizeOption)\n            // = (sample/s) * (1s/400) * 2^(frameSizeOption)\n            // = (sample/s) * 2^(frameSizeOption) * (1s/400)\n            numSamples = (sampleRateHz << frameSizeOption) / 400;\n        }\n        // Case for Hybrid packet. Since Hybrid packets are represented using configurations 12 to 15, bits 1 and 2 in the\n        // above TOC byte diagram will both be 1.\n        else if ((packet.getUint8(0) & 0x60) === 0x60) {\n            // In the case of configuration 13 or 15, bit 4 in the above TOC byte diagram will be 1. Configurations 13 and 15\n            // correspond to a 20ms frame size, so the number of samples is calculated as follows:\n            // (sample/s) * (1s/1000ms) * (20ms)\n            // = (sample/s) * (1s/50)\n            //\n            // In the case of configuration 12 or 14, bit 4 in the above TOC byte diagram will be 0. Configurations 12 and 14\n            // correspond to a 10ms frame size, so the number of samples is calculated as follows:\n            // (sample/s) * (1s/1000ms) * (10ms)\n            // = (sample/s) * (1s/100)\n            numSamples = packet.getUint8(0) & 0x08 ? sampleRateHz / 50 : sampleRateHz / 100;\n        }\n        // Case for SILK-only packet.\n        else {\n            // The lower 3 'config' bits indicate the frame size option for SILK-only packets.\n            frameSizeOption = (packet.getUint8(0) >> 3) & 0x3;\n            if (frameSizeOption === 3) {\n                // Frame size option 3 corresponds to a frame size of 60ms, so the number of samples is calculated as follows:\n                // (sample/s) * (1s/1000ms) * (60ms)\n                // = (sample/s) * (60ms) * (1s/1000ms)\n                numSamples = (sampleRateHz * 60) / 1000;\n            }\n            else {\n                // The frame size options 0, 1, 2 correspond to frame sizes of 10, 20, 40 ms. Notice that the frame sizes can be\n                // represented as (10 * 2^0), (10 * 2^1), (10 * 2^2) ms. So, the number of samples can be calculated as follows:\n                // (sample/s) * (1s/1000ms) * (10ms) * 2^(frameSizeOption)\n                // = (sample/s) * (1s/100) * 2^(frameSizeOption)\n                // = (sample/s) * 2^(frameSizeOption) * (1s/100)\n                numSamples = (sampleRateHz << frameSizeOption) / 100;\n            }\n        }\n        return numSamples;\n    }\n    /**\n     * Gets the number of SILK frames per Opus frame.\n     *\n     * @param packet Opus packet.\n     * @returns Number of SILK frames per Opus frame.\n     */\n    opusNumSilkFrames(packet) {\n        // For computing the frame length in ms, the sample rate is not important since it cancels out. We use 48 kHz, but\n        // any valid sample rate would work.\n        //\n        // To calculate the length of a frame (with a 48kHz sample rate) in ms:\n        // (samples/frame) * (1s/48000 samples) * (1000ms/s)\n        // = (samples/frame) * (1000ms/48000 samples)\n        // = (samples/frame) * (1ms/48 samples)\n        let frameLengthMs = this.opusPacketGetSamplesPerFrame(packet, 48000) / 48;\n        if (frameLengthMs < 10)\n            frameLengthMs = 10;\n        // The number of SILK frames per Opus frame is described in https://www.rfc-editor.org/rfc/rfc6716#section-4.2.2.\n        switch (frameLengthMs) {\n            case 10:\n            case 20:\n                return 1;\n            case 40:\n                return 2;\n            case 60:\n                return 3;\n            // It is not possible to reach the default case since an Opus packet can only encode sizes of 2.5, 5, 10, 20, 40,\n            // or 60 ms, so we ignore the default case for test coverage.\n            /* istanbul ignore next */\n            default:\n                return 0;\n        }\n    }\n    /**\n     * Gets the number of channels from an Opus packet.\n     *\n     * @param packet Opus packet.\n     * @returns Number of channels.\n     */\n    opusPacketGetNumChannels(packet) {\n        // TOC byte format (https://www.rfc-editor.org/rfc/rfc6716#section-3.1):\n        //  0\n        //  0 1 2 3 4 5 6 7\n        // +-+-+-+-+-+-+-+-+\n        // | config  |s| c |\n        // +-+-+-+-+-+-+-+-+\n        // The 's' bit indicates mono or stereo audio, with 0 indicating mono and 1 indicating stereo.\n        return packet.getUint8(0) & 0x4 ? 2 : 1;\n    }\n    /**\n     * Determine the size (in bytes) of an Opus frame.\n     *\n     * @param packet Opus packet.\n     * @param byteOffset Offset (from the start of the packet) to the byte containing the size information.\n     * @param remainingBytes Remaining number of bytes to parse from the Opus packet.\n     * @param sizeBytes Variable to store the parsed frame size (in bytes).\n     * @returns Number of bytes that were parsed to determine the frame size.\n     */\n    opusParseSize(packet, byteOffset, remainingBytes, sizeBytes) {\n        // See https://www.rfc-editor.org/rfc/rfc6716#section-3.2.1 for an explanation of how frame size is represented.\n        // If there are no remaining bytes to parse the size from, then the size cannot be determined.\n        if (remainingBytes < 1) {\n            sizeBytes[0] = -1;\n            return -1;\n        }\n        // If the first byte is in the range 0...251, then this value is the size of the frame.\n        else if (packet.getUint8(byteOffset) < 252) {\n            sizeBytes[0] = packet.getUint8(byteOffset);\n            return 1;\n        }\n        // If the first byte is in the range 252...255, a second byte is needed. If there is no second byte, then the size\n        // cannot be determined.\n        else if (remainingBytes < 2) {\n            sizeBytes[0] = -1;\n            return -1;\n        }\n        // The total size of the frame given two size bytes is:\n        // (4 * secondSizeByte) + firstSizeByte\n        else {\n            sizeBytes[0] = 4 * packet.getUint8(byteOffset + 1) + packet.getUint8(byteOffset);\n            return 2;\n        }\n    }\n    /**\n     * Parse binary data containing an Opus packet into one or more Opus frames.\n     *\n     * @param data Binary data containing an Opus packet to be parsed. The data should begin with the first byte (i.e the\n     *             TOC byte) of an Opus packet. Note that the size of the data does not have to equal the size of the\n     *             contained Opus packet.\n     * @param lenBytes Size of the data (in bytes).\n     * @param selfDelimited Indicates if the Opus packet is self-delimiting\n     *                      (https://www.rfc-editor.org/rfc/rfc6716#appendix-B).\n     * @param tocByte Optional variable to store the TOC (table of contents) byte.\n     * @param frameOffsets Optional variable to store the offsets (from the start of the data) to the first bytes of each\n     *                     Opus frame.\n     * @param frameSizes Required variable to store the sizes (in bytes) of each Opus frame.\n     * @param payloadOffset Optional variable to store the offset (from the start of the data) to the first byte of the\n     *                      payload.\n     * @param packetLenBytes Optional variable to store the length of the Opus packet (in bytes).\n     * @returns Number of Opus frames.\n     */\n    opusPacketParseImpl(data, lenBytes, selfDelimited, tocByte, frameOffsets, frameSizes, payloadOffset, packetLenBytes) {\n        if (!frameSizes || lenBytes < 0)\n            return this.OPUS_BAD_ARG;\n        if (lenBytes === 0)\n            return this.OPUS_INVALID_PACKET;\n        // The number of Opus frames in the packet.\n        let numFrames;\n        // Intermediate storage for the number of bytes parsed to determine the size of a frame.\n        let numBytesParsed;\n        // The number of the padding bytes (excluding the padding count bytes) in the packet.\n        let paddingBytes = 0;\n        // Indicates whether CBR (constant bitrate) framing is used.\n        let cbr = false;\n        // The TOC (table of contents) byte (https://www.rfc-editor.org/rfc/rfc6716#section-3.1).\n        const toc = data.getUint8(0);\n        // Store the TOC byte.\n        if (tocByte)\n            tocByte[0] = toc;\n        // The remaining number of bytes to parse from the packet. Note that the TOC byte has already been parsed, hence the\n        // minus 1.\n        let remainingBytes = lenBytes - 1;\n        // This keeps track of where we are in the packet. This starts at 1 since the TOC byte has already been read.\n        let byteOffset = 1;\n        // The size of the last Opus frame in bytes.\n        let lastSizeBytes = remainingBytes;\n        // Read the `c` bits (i.e. code bits) from the TOC byte.\n        switch (toc & 0x3) {\n            // A code 0 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.2) has one frame.\n            case 0:\n                numFrames = 1;\n                break;\n            // A code 1 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.3) has two CBR (constant bitrate) frames.\n            case 1:\n                numFrames = 2;\n                cbr = true;\n                if (!selfDelimited) {\n                    // Undelimited code 1 packets must be an even number of data bytes, otherwise the packet is invalid.\n                    if (remainingBytes & 0x1)\n                        return this.OPUS_INVALID_PACKET;\n                    // The sizes of both frames are equal (i.e. half of the number of data bytes).\n                    lastSizeBytes = remainingBytes / 2;\n                    // If `lastSizeBytes` is too large, we will catch it later.\n                    frameSizes[0][0] = lastSizeBytes;\n                }\n                break;\n            // A code 2 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.4) has two VBR (variable bitrate) frames.\n            case 2:\n                numFrames = 2;\n                numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[0]);\n                remainingBytes -= numBytesParsed;\n                // The parsed size of the first frame cannot be larger than the number of remaining bytes in the packet.\n                if (frameSizes[0][0] < 0 || frameSizes[0][0] > remainingBytes) {\n                    return this.OPUS_INVALID_PACKET;\n                }\n                byteOffset += numBytesParsed;\n                // The size of the second frame is the remaining number of bytes after the first frame.\n                lastSizeBytes = remainingBytes - frameSizes[0][0];\n                break;\n            // A code 3 packet (https://www.rfc-editor.org/rfc/rfc6716#section-3.2.5) has multiple CBR/VBR frames (from 0 to\n            // 120 ms).\n            default:\n                // Code 3 packets must have at least 2 bytes (i.e. at least 1 byte after the TOC byte).\n                if (remainingBytes < 1)\n                    return this.OPUS_INVALID_PACKET;\n                // Frame count byte format:\n                //  0\n                //  0 1 2 3 4 5 6 7\n                // +-+-+-+-+-+-+-+-+\n                // |v|p|     M     |\n                // +-+-+-+-+-+-+-+-+\n                //\n                // Read the frame count byte, which immediately follows the TOC byte.\n                const frameCountByte = data.getUint8(byteOffset++);\n                --remainingBytes;\n                // Read the 'M' bits of the frame count byte, which encode the number of frames.\n                numFrames = frameCountByte & 0x3f;\n                // The number of frames in a code 3 packet must not be 0.\n                if (numFrames <= 0)\n                    return this.OPUS_INVALID_PACKET;\n                const samplesPerFrame = this.opusPacketGetSamplesPerFrame(data, 48000);\n                // A single frame can have at most 2880 samples, which happens in the case where 60ms of 48kHz audio is encoded\n                // per frame. A code 3 packet cannot contain more than 120ms of audio, so the total number of samples cannot\n                // exceed 2880 * 2 = 5760.\n                if (samplesPerFrame * numFrames > 5760)\n                    return this.OPUS_INVALID_PACKET;\n                // Parse padding bytes if the 'p' bit is 1.\n                if (frameCountByte & 0x40) {\n                    let paddingCountByte;\n                    let numPaddingBytes;\n                    // Remove padding bytes (including padding count bytes) from the remaining byte count.\n                    do {\n                        // Sanity check that there are enough bytes to parse and remove the padding.\n                        if (remainingBytes <= 0)\n                            return this.OPUS_INVALID_PACKET;\n                        // Get the next padding count byte.\n                        paddingCountByte = data.getUint8(byteOffset++);\n                        --remainingBytes;\n                        // If the padding count byte has a value in the range 0...254, then the total size of the padding is the\n                        // value in the padding count byte.\n                        //\n                        // If the padding count byte has value 255, then the total size of the padding is 254 plus the value in the\n                        // next padding count byte. Therefore, keep reading padding count bytes while the value is 255.\n                        numPaddingBytes = paddingCountByte === 255 ? 254 : paddingCountByte;\n                        remainingBytes -= numPaddingBytes;\n                        paddingBytes += numPaddingBytes;\n                    } while (paddingCountByte === 255);\n                }\n                // Sanity check that the remaining number of bytes is not negative after removing the padding.\n                if (remainingBytes < 0)\n                    return this.OPUS_INVALID_PACKET;\n                // Read the 'v' bit (i.e. VBR bit).\n                cbr = !(frameCountByte & 0x80);\n                // VBR case\n                if (!cbr) {\n                    lastSizeBytes = remainingBytes;\n                    // Let M be the number of frames. There will be M - 1 frame length indicators (which can be 1 or 2 bytes)\n                    // corresponding to the lengths of frames 0 to M - 2. The size of the last frame (i.e. frame M - 1) is the\n                    // number of data bytes after the end of frame M - 2 and before the start of the padding bytes.\n                    for (let i = 0; i < numFrames - 1; ++i) {\n                        numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[i]);\n                        remainingBytes -= numBytesParsed;\n                        // The remaining number of data bytes must be enough to contain each frame.\n                        if (frameSizes[i][0] < 0 || frameSizes[i][0] > remainingBytes) {\n                            return this.OPUS_INVALID_PACKET;\n                        }\n                        byteOffset += numBytesParsed;\n                        lastSizeBytes -= numBytesParsed + frameSizes[i][0];\n                    }\n                    // Sanity check that the size of the last frame is not negative.\n                    if (lastSizeBytes < 0)\n                        return this.OPUS_INVALID_PACKET;\n                }\n                // CBR case\n                else if (!selfDelimited) {\n                    // The size of each frame is the number of data bytes divided by the number of frames.\n                    lastSizeBytes = Math.trunc(remainingBytes / numFrames);\n                    // The number of data bytes must be a non-negative integer multiple of the number of frames.\n                    if (lastSizeBytes * numFrames !== remainingBytes)\n                        return this.OPUS_INVALID_PACKET;\n                    // All frames have equal size in the undelimited CBR case.\n                    for (let i = 0; i < numFrames - 1; ++i) {\n                        frameSizes[i][0] = lastSizeBytes;\n                    }\n                }\n        }\n        // Self-delimited framing uses an extra 1 or 2 bytes, immediately preceding the data bytes, to indicate either the\n        // size of the last frame (for code 0, code 2, and VBR code 3 packets) or the size of all the frames (for code 1 and\n        // CBR code 3 packets). See https://www.rfc-editor.org/rfc/rfc6716#appendix-B.\n        if (selfDelimited) {\n            // The extra frame size byte(s) will always indicate the size of the last frame.\n            numBytesParsed = this.opusParseSize(data, byteOffset, remainingBytes, frameSizes[numFrames - 1]);\n            remainingBytes -= numBytesParsed;\n            // There must be enough data bytes for the last frame.\n            if (frameSizes[numFrames - 1][0] < 0 || frameSizes[numFrames - 1][0] > remainingBytes) {\n                return this.OPUS_INVALID_PACKET;\n            }\n            byteOffset += numBytesParsed;\n            // For CBR packets, the sizes of all the frames are equal.\n            if (cbr) {\n                // There must be enough data bytes for all the frames.\n                if (frameSizes[numFrames - 1][0] * numFrames > remainingBytes) {\n                    return this.OPUS_INVALID_PACKET;\n                }\n                for (let i = 0; i < numFrames - 1; ++i) {\n                    frameSizes[i][0] = frameSizes[numFrames - 1][0];\n                }\n            }\n            // At this point, `lastSizeBytes` contains the size of the last frame plus the size of the extra frame size\n            // byte(s), so sanity check that `lastSizeBytes` is the upper bound for the size of the last frame.\n            else if (!(numBytesParsed + frameSizes[numFrames - 1][0] <= lastSizeBytes)) {\n                return this.OPUS_INVALID_PACKET;\n            }\n        }\n        // Undelimited case\n        else {\n            // Because the size of the last packet is not encoded explicitly, it is possible that the size of the last packet\n            // (or of all the packets, for the CBR case) is larger than maximum frame size.\n            if (lastSizeBytes > this.OPUS_MAX_FRAME_SIZE_BYTES)\n                return this.OPUS_INVALID_PACKET;\n            frameSizes[numFrames - 1][0] = lastSizeBytes;\n        }\n        // Store the offset to the start of the payload.\n        if (payloadOffset)\n            payloadOffset[0] = byteOffset;\n        // Store the offsets to the start of each frame.\n        for (let i = 0; i < numFrames; ++i) {\n            if (frameOffsets)\n                frameOffsets[i][0] = byteOffset;\n            byteOffset += frameSizes[i][0];\n        }\n        // Store the length of the Opus packet.\n        if (packetLenBytes)\n            packetLenBytes[0] = byteOffset + paddingBytes;\n        return numFrames;\n    }\n    /**\n     * Parse a single undelimited Opus packet into one or more Opus frames.\n     *\n     * @param packet Opus packet to be parsed.\n     * @param lenBytes Size of the packet (in bytes).\n     * @param tocByte Optional variable to store the TOC (table of contents) byte.\n     * @param frameOffsets Optional variable to store the offsets (from the start of the packet) to the first bytes of\n     *                     each Opus frame.\n     * @param frameSizes Required variable to store the sizes (in bytes) of each Opus frame.\n     * @param payloadOffset Optional variable to store the offset (from the start of the packet) to the first byte of the\n     *                      payload.\n     * @returns Number of Opus frames.\n     */\n    opusPacketParse(packet, lenBytes, tocByte, frameOffsets, frameSizes, payloadOffset) {\n        return this.opusPacketParseImpl(packet, lenBytes, \n        /* selfDelimited */ false, tocByte, frameOffsets, frameSizes, payloadOffset, null);\n    }\n    /**\n     * This function returns the SILK VAD (voice activity detection) information encoded in the Opus packet. For CELT-only\n     * packets that do not have VAD information, it returns -1.\n     *\n     * @param packet Opus packet.\n     * @param lenBytes Size of the packet (in bytes).\n     * @returns  0: no frame had the VAD flag set.\n     *           1: at least one frame had the VAD flag set.\n     *          -1: VAD status could not be determined.\n     */\n    opusPacketHasVoiceActivity(packet, lenBytes) {\n        if (!packet || lenBytes <= 0)\n            return 0;\n        // In CELT-only mode, we can not determine whether there is VAD.\n        if (this.opusPacketIsCeltOnly(packet))\n            return -1;\n        const numSilkFrames = this.opusNumSilkFrames(packet);\n        // It is not possible for `opusNumSilkFrames()` to return 0, so we ignore the next sanity check for test coverage.\n        /* istanbul ignore next */\n        if (numSilkFrames === 0)\n            return -1;\n        const opusFrameOffsets = new Array(this.OPUS_MAX_OPUS_FRAMES);\n        const opusFrameSizes = new Array(this.OPUS_MAX_OPUS_FRAMES);\n        for (let i = 0; i < this.OPUS_MAX_OPUS_FRAMES; ++i) {\n            opusFrameOffsets[i] = [undefined];\n            opusFrameSizes[i] = [undefined];\n        }\n        // Parse packet to get the Opus frames.\n        const numOpusFrames = this.opusPacketParse(packet, lenBytes, null, opusFrameOffsets, opusFrameSizes, null);\n        // VAD status cannot be determined for invalid packets.\n        if (numOpusFrames < 0)\n            return -1;\n        // Iterate over all Opus frames, which may contain multiple SILK frames, to determine the VAD status.\n        for (let i = 0; i < numOpusFrames; ++i) {\n            if (opusFrameSizes[i][0] < 1)\n                continue;\n            // LP layer header bits format (https://www.rfc-editor.org/rfc/rfc6716#section-4.2.3):\n            //\n            // Mono case:\n            // +-----------------+----------+\n            // | 1 to 3 VAD bits | LBRR bit |\n            // +-----------------+----------+\n            //\n            // Stereo case:\n            // +---------------------+--------------+----------------------+---------------+\n            // | 1 to 3 mid VAD bits | mid LBRR bit | 1 to 3 side VAD bits | side LBRR bit |\n            // +---------------------+--------------+----------------------+---------------+\n            // The upper 1 to 3 bits (dependent on the number of SILK frames) of the LP layer contain VAD bits. If any of\n            // these VAD bits are 1, then voice activity is present.\n            if (packet.getUint8(opusFrameOffsets[i][0]) >> (8 - numSilkFrames))\n                return 1;\n            // In the stereo case, there is a second set of 1 to 3 VAD bits, so also check these VAD bits.\n            const channels = this.opusPacketGetNumChannels(packet);\n            if (channels === 2 &&\n                (packet.getUint8(opusFrameOffsets[i][0]) << (numSilkFrames + 1)) >> (8 - numSilkFrames)) {\n                return 1;\n            }\n        }\n        // No voice activity was detected.\n        return 0;\n    }\n    /**\n     * This method is based on Definition of the Opus Audio Codec\n     * (https://tools.ietf.org/html/rfc6716). Basically, this method is based on\n     * parsing the LP layer of an Opus packet, particularly the LBRR flag.\n     *\n     * @param packet Opus packet.\n     * @param lenBytes Size of the packet (in bytes).\n     * @returns  true: packet has fec encoding about previous packet.\n     *           false: no fec encoding present.\n     */\n    opusPacketHasFec(packet, lenBytes) {\n        if (!packet || lenBytes <= 0)\n            return false;\n        // In CELT-only mode, packets should not have FEC.\n        if (this.opusPacketIsCeltOnly(packet))\n            return false;\n        const opusFrameOffsets = new Array(this.OPUS_MAX_OPUS_FRAMES);\n        const opusFrameSizes = new Array(this.OPUS_MAX_OPUS_FRAMES);\n        for (let i = 0; i < this.OPUS_MAX_OPUS_FRAMES; ++i) {\n            opusFrameOffsets[i] = [undefined];\n            opusFrameSizes[i] = [undefined];\n        }\n        // Parse packet to get the Opus frames.\n        const numOpusFrames = this.opusPacketParse(packet, lenBytes, null, opusFrameOffsets, opusFrameSizes, null);\n        if (numOpusFrames < 0)\n            return false;\n        /* istanbul ignore next */\n        if (opusFrameSizes[0][0] <= 1)\n            return false;\n        const numSilkFrames = this.opusNumSilkFrames(packet);\n        /* istanbul ignore next */\n        if (numSilkFrames === 0)\n            return false;\n        const channels = this.opusPacketGetNumChannels(packet);\n        /* istanbul ignore next */\n        if (channels !== 1 && channels !== 2)\n            return false;\n        // A frame starts with the LP layer. The LP layer begins with two to eight\n        // header bits.These consist of one VAD bit per SILK frame (up to 3),\n        // followed by a single flag indicating the presence of LBRR frames.\n        // For a stereo packet, these first flags correspond to the mid channel, and\n        // a second set of flags is included for the side channel. Because these are\n        // the first symbols decoded by the range coder and because they are coded\n        // as binary values with uniform probability, they can be extracted directly\n        // from the most significant bits of the first byte of compressed data.\n        for (let i = 0; i < channels; i++) {\n            if (packet.getUint8(opusFrameOffsets[0][0]) & (0x80 >> ((i + 1) * (numSilkFrames + 1) - 1)))\n                return true;\n        }\n        return false;\n    }\n}\nRedundantAudioEncoder.shouldLog = true;\nRedundantAudioEncoder.shouldReportStats = true;\nRedundantAudioEncoder.initializeWorker();\n";t.default=i},7797:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(4929));class o extends n.default{constructor(){super(0)}static nextTick(e){setTimeout(e,0)}}t.default=o},3922:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.intervalMs=e}start(e){this.stop(),this.timer=setInterval(e,this.intervalMs)}stop(){void 0!==this.timer&&(clearInterval(this.timer),this.timer=void 0)}running(){return void 0!==this.timer}}t.default=i},4929:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.timeoutMs=e,this.timer=null}start(e){this.stop(),this.timer=setTimeout(()=>{clearTimeout(this.timer),e()},this.timeoutMs)}stop(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)}}t.default=i},326:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(4076)),o=r(i(1944)),s=r(i(2330));class a{constructor(e){this.sdp=e}clone(){return new a(this.sdp)}static isRTPCandidate(e){let t=/candidate[:](\S+) (\d+)/g.exec(e);return null!==t&&"1"===t[2]}static linesToSDP(e){return new a(e.join(a.CRLF))}static candidateTypeFromString(e){switch(e){case n.default.Host:return n.default.Host;case n.default.ServerReflexive:return n.default.ServerReflexive;case n.default.PeerReflexive:return n.default.PeerReflexive;case n.default.Relay:return n.default.Relay}return null}static candidateType(e){let t=/a[=]candidate[:].* typ ([a-z]+) /g.exec(e);return null===t?null:a.candidateTypeFromString(t[1])}static mediaType(e){let t=/m=(audio|video)/g.exec(e);if(null!==t)return t[1]}static mid(e){if(e.includes("a=mid:"))return e.replace(/^(a=mid:)/,"")}static direction(e){let t=/a=(sendrecv|sendonly|recvonly|inactive)/g.exec(e);if(null!==t)return t[1]}static splitLines(e){return e.trim().split("\n").map(e=>e.trim())}static splitSections(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+a.CRLF)}static findActiveCameraSection(e){let t=0,i=!1;for(let r of e){if(/^m=video/.test(r)&&(r.indexOf("sendrecv")>-1||-1===r.indexOf("sendonly")&&-1===r.indexOf("recvonly")&&-1===r.indexOf("inactive"))){i=!0;break}t++}return!1===i&&(t=-1),t}static extractSSRCsFromFIDGroupLine(e){return/^a=ssrc-group:FID\s(.+)/.exec(e)[1]}static matchPrefix(e,t){return a.splitLines(e).filter(e=>0===e.indexOf(t))}lines(){return this.sdp.split(a.CRLF)}hasVideo(){return null!==/^m=video/gm.exec(this.sdp)}hasCandidates(){return null!==/a[=]candidate[:]/g.exec(this.sdp)}hasCandidatesForAllMLines(){return!(this.sdp.indexOf("c=IN IP4 0.0.0.0")>-1)}withoutCandidateType(e){return a.linesToSDP(this.lines().filter(t=>a.candidateType(t)!==e))}withoutServerReflexiveCandidates(){return this.withoutCandidateType(n.default.ServerReflexive)}withAudioMaxAverageBitrate(e){if(!e)return this.clone();e=Math.trunc(Math.min(Math.max(e,a.rfc7587LowestBitrate),a.rfc7587HighestBitrate));let t=this.lines(),i=a.findOpusFmtpAttributes(t),r=a.updateOpusFmtpAttributes(t,i,[`maxaveragebitrate=${e}`]);return a.linesToSDP(r)}withStereoAudio(){let e=this.lines(),t=a.findOpusFmtpAttributes(e),i=a.updateOpusFmtpAttributes(e,t,["stereo=1","sprop-stereo=1"]);return a.linesToSDP(i)}static findOpusFmtpAttributes(e){let t=/^a=rtpmap:\s*(\d+)\s+opus\/48000/,i=!1,r=[];for(let n of e)if(n.startsWith("m=audio")&&(r.push(null),i=!0),n.startsWith("m=video")&&(i=!1),i){let e=t.exec(n);null!==e&&(r[r.length-1]=`a=fmtp:${e[1]} `)}return r}static updateOpusFmtpAttributes(e,t,i){let r=[],n=0,o=null;for(let s of e)if(s.startsWith("m=audio")&&(o=t[n],n++),s.startsWith("m=video")&&(o=null),o&&s.startsWith(o)){let e=s.slice(o.length).split(";"),t=[];for(let r of e)0>i.findIndex(e=>e.startsWith(r.split("=")[0]))&&t.push(r);for(let e of i)t.push(e);r.push(o+t.join(";"))}else r.push(s);return r}withUnifiedPlanFormat(){let e=this.sdp;return e.includes("mozilla")?this.clone():new a(e=e.replace("o=-","o=mozilla-chrome"))}getUniqueRtpHeaderExtensionId(e){let t=[];for(let i of e)if(/^a=extmap:/.test(i.trim())){let e=+i.split("a=extmap:")[1].split(" ")[0];t.includes(e)||t.push(e)}t.sort((e,t)=>e-t);let i=0;for(let e of t){if(e-i>1)return i+1;i=e}return 14===i?-1:i+1}withVideoLayersAllocationRtpHeaderExtension(e){return this.withRtpHeaderExtension(e,a.videoLayersAllocationRtpHeaderExtensionUrl)}withDependencyDescriptorRtpHeaderExtension(e){return this.withRtpHeaderExtension(e,a.dependencyDescriptorRtpHeaderExtensionUrl)}withoutDependencyDescriptorRtpHeaderExtension(){let e=a.splitLines(this.sdp).filter(e=>!e.includes(a.dependencyDescriptorRtpHeaderExtensionUrl));return new a(e.join(a.CRLF)+a.CRLF)}withRtpHeaderExtension(e,t){let i=e?e.getRtpHeaderExtensionId(t):-1,r=-1===i?this.getUniqueRtpHeaderExtensionId(a.splitLines(this.sdp)):i,n=a.splitSections(this.sdp),o=[];for(let e of n){if(/^m=video/.test(e)&&-1===a.getRtpHeaderExtensionIdInSection(e,t)){let i=a.splitLines(e),n=[];if(-1===r||this.hasRtpHeaderExtensionId(r)){o.push(e);continue}for(let e of i)if(n.push(e),/^a=sendrecv/.test(e.trim())){let e="a=extmap:"+r+" "+t;n.push(e)}e=n.join(a.CRLF)+a.CRLF}else if(-1!==i&&/^m=video/.test(e)&&a.getRtpHeaderExtensionIdInSection(e,t)!==i){let r=a.splitLines(e),n=[];for(let e of r){if(/^a=extmap:/.test(e.trim())&&e.split("a=extmap:")[1].split(" ")[1]===t){if(!this.hasRtpHeaderExtensionId(i)){let e="a=extmap:"+i+" "+t;n.push(e)}continue}n.push(e)}e=n.join(a.CRLF)+a.CRLF}o.push(e)}return new a(o.join(""))}ssrcForVideoSendingSection(){let e=this.sdp,t=a.splitSections(e);if(t.length<2)return"";let i=a.findActiveCameraSection(t);if(-1===i)return"";let r=a.matchPrefix(t[i],"a=ssrc-group:FID ");if(r.length<1)return"";let[n]=a.extractSSRCsFromFIDGroupLine(r[0]).split(" ").map(e=>parseInt(e,10));return n.toString()}videoSendSectionHasDifferentSSRC(e){let t=this.ssrcForVideoSendingSection(),i=e.ssrcForVideoSendingSection();return""!==t&&""!==i&&parseInt(t,10)!==parseInt(i,10)}removeH264SupportFromSendSection(){let e=this.sdp,t=a.splitSections(e),i=a.findActiveCameraSection(t);if(-1===i)return new a(this.sdp);let r=t[i],n=a.splitLines(r),o=[],s=new Map;n.forEach(e=>{if(/^a=rtpmap:/.test(e)){let t=/^a=rtpmap:([0-9]+)\s/.exec(e);t&&e.toLowerCase().includes("h264")&&o.push(parseInt(t[1],10))}if(/^a=fmtp:/.test(e)){let t=/^a=fmtp:([0-9]+) apt=([0-9]+)/.exec(e);if(t&&3===t.length){let e=parseInt(t[1],10),i=parseInt(t[2],10);s.has(i)?s.get(i).push(e):s.set(i,[e])}}});let l=new Set;for(let e of o){l.add(e);let t=s.get(e);if(t)for(let e of t)l.add(e)}if(o.length>0){let e=n[0].split(" ");n[0]=e.filter(e=>!l.has(parseInt(e))).join(" ")}let d=n.filter(e=>{if(!e.includes("rtpmap")&&!e.includes("rtcp-fb")&&!e.includes("fmtp"))return!0;for(let t of l)if(e.includes(t.toString()))return!1;return!0});return t[i]=d.join(a.CRLF)+a.CRLF,new a(t.join(""))}mediaSections(){let e=a.splitSections(this.sdp);if(e.length<2)return[];let t=[];for(let i=1;i<e.length;i++){let r=new o.default;for(let t of a.splitLines(e[i])){let e=a.mediaType(t);if(void 0!==e){r.mediaType=e;continue}let i=a.direction(t);if(void 0!==i){r.direction=i;continue}let n=a.mid(t);if(void 0!==n){r.mid=n;continue}}t.push(r)}return t}static getRtpHeaderExtensionIdInSection(e,t){for(let i of a.splitLines(e))if(/^a=extmap:/.test(i.trim())){let e=i.split("a=extmap:")[1].split(" "),r=+e[0];if(e[1]===t)return r}return -1}getRtpHeaderExtensionId(e){for(let t of a.splitSections(this.sdp))if(/^m=video/.test(t)){let i=a.getRtpHeaderExtensionIdInSection(t,e);if(-1!==i)return i}return -1}hasRtpHeaderExtensionId(e){for(let t of a.splitLines(this.sdp))if(/^a=extmap:/.test(t.trim())&&+t.split("a=extmap:")[1].split(" ")[0]===e)return!0;return!1}withVideoSendCodecPreferences(e){let t=this.sdp,i=a.splitSections(t),r=a.findActiveCameraSection(i);return -1===r?new a(this.sdp):(i[r]=this.sectionWithCodecPreferences(i[r],e),new a(i.join("")))}sectionWithCodecPreferences(e,t){let i=new Map,r=a.splitLines(e);r.forEach(e=>{if(!e.startsWith("a=rtpmap:"))return;let n=/^a=rtpmap:(\d+)\s/.exec(e);if(!n)return;let o=n[1];for(let n of t){if(!e.includes(`${n.codecName}/${n.codecCapability.clockRate}`))continue;let t=!1;if(void 0!==n.codecCapability.sdpFmtpLine){let e=!1;for(let i of r){if(n.fmtpLineMatches(i,parseInt(o))){t=!0;break}e||(e=i.startsWith(`a=fmtp:${o} profile-id=`))}n.equals(s.default.vp9Profile0())&&!e&&(t=!0)}else t=!0;if(t){i.set(o,n);break}}});let n=new Set(i.keys()),o=r[0].split(" ").filter(e=>!n.has(e)),l=Array.from(i.entries()).sort(([e,i],[r,n])=>t.indexOf(i)-t.indexOf(n)).map(([e,t])=>e);return o.splice(3,0,...l),r[0]=o.join(" "),r.join(a.CRLF)+a.CRLF}highestPriorityVideoSendCodec(){let e=this.prioritizedSendVideoCodecCapabilities();return e.length>0?e[0]:void 0}prioritizedSendVideoCodecCapabilities(){let e=this.sdp,t=a.splitSections(e),i=a.findActiveCameraSection(t);if(-1===i)return[];let r=a.splitLines(t[i]),n=r[0].split(" ");return n.length<4?[]:n.slice(3).map(e=>this.videoCodecCapabilityForPayloadType(r,e)).filter(e=>void 0!==e&&["VP8","H264","VP9","AV1"].includes(e.codecName))}videoCodecCapabilityForPayloadType(e,t){let i,r,n;for(let o of e){let e=/^a=rtpmap:([0-9]+)\s/.exec(o);if(e&&e[1]===t){let e=o.split(" ")[1].split("/");e.length>=2&&(i=e[0],r=e[1])}o.startsWith(`a=fmtp:${t} `)&&(n=o.split(" ")[1])}if(void 0!==i)return new s.default(i,{clockRate:parseInt(r),mimeType:`video/${i}`,sdpFmtpLine:n})}getAudioPayloadTypes(){let e=new Map,t=this.sdp,i=a.splitSections(t);return e.set("opus",a.findAudioPayloadType("opus",i)),e.set("red",a.findAudioPayloadType("red",i)),e}static findAudioPayloadType(e,t){let i=RegExp(`a=rtpmap:\\s*(\\d+)\\s+${e}\\/48000`);for(let e of t)if(/^m=audio/.test(e)){let t=i.exec(e);if(null!==t)return Number(t[1])}return 0}withStartingVideoSendBitrate(e){let t=a.splitSections(this.sdp),i=a.findActiveCameraSection(t);if(-1===i)return this;let r=a.splitLines(t[i]),n=[];for(let t of r)if(/^a=fmtp:\d*/.test(t)){let i=t+`;x-google-start-bitrate=${e}`;n.push(i)}else n.push(t);return t[i]=n.join(a.CRLF)+a.CRLF,new a(t.join(""))}}t.default=a,a.CRLF="\r\n",a.rfc7587LowestBitrate=6e3,a.rfc7587HighestBitrate=51e4,a.dependencyDescriptorRtpHeaderExtensionUrl="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension",a.videoLayersAllocationRtpHeaderExtensionUrl="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00"},4076:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SDPCandidateType=void 0,function(e){e.Host="host",e.ServerReflexive="srflx",e.PeerReflexive="prflx",e.Relay="relay"}(i=t.SDPCandidateType||(t.SDPCandidateType={})),t.default=i},1944:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},2330:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=i(289);class n{constructor(e,t){this.codecName=e,this.codecCapability=t}equals(e){return void 0!==e&&this.codecName===e.codecName&&this.codecCapability.mimeType===e.codecCapability.mimeType&&this.codecCapability.clockRate===e.codecCapability.clockRate&&(this.codecCapability.sdpFmtpLine?this.cleanupFmtpLine(this.codecCapability.sdpFmtpLine,this.codecName):"")===(e.codecCapability.sdpFmtpLine?this.cleanupFmtpLine(e.codecCapability.sdpFmtpLine,e.codecName):"")}fmtpLineMatches(e,t){let i=this.codecCapability.sdpFmtpLine;if(!i)return!1;let r=`a=fmtp:${t} `;if(!e.startsWith(r))return!1;let n=e.substring(r.length);return this.cleanupFmtpLine(n,this.codecName)===this.cleanupFmtpLine(i,this.codecName)}cleanupFmtpLine(e,t){let i=/;x-google-start-bitrate=\d+/g,r=e.replace(i,"");if("H264"===t){let e=/profile-level-id=([0-9a-f]{4})[0-9a-f]{2}/i;r=r.replace(e,"profile-level-id=$1")}return r}static vp8(){return new n("VP8",{clockRate:9e4,mimeType:"video/VP8"})}static h264BaselineProfile(){return new n("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f"})}static h264ConstrainedBaselineProfile(){return new n("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f"})}static h264MainProfile(){return new n("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=4d001f"})}static h264HighProfile(){return new n("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=64001f"})}static h264ConstrainedHighProfile(){return new n("H264",{clockRate:9e4,mimeType:"video/H264",sdpFmtpLine:"level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=640c1f"})}static h264(){return n.h264ConstrainedBaselineProfile()}static vp9Profile0(){return new n("VP9",{clockRate:9e4,mimeType:"video/VP9",sdpFmtpLine:"profile-id=0"})}static vp9(){return n.vp9Profile0()}static av1Main(){return new n("AV1",{clockRate:9e4,mimeType:"video/AV1"})}static av1(){return n.av1Main()}static fromSignaled(e){switch(e){case r.SdkVideoCodecCapability.VP8:return n.vp8();case r.SdkVideoCodecCapability.H264_BASELINE_PROFILE:return n.h264BaselineProfile();case r.SdkVideoCodecCapability.H264_CONSTRAINED_BASELINE_PROFILE:return n.h264ConstrainedBaselineProfile();case r.SdkVideoCodecCapability.H264_MAIN_PROFILE:return n.h264MainProfile();case r.SdkVideoCodecCapability.H264_HIGH_PROFILE:return n.h264HighProfile();case r.SdkVideoCodecCapability.H264_CONSTRAINED_HIGH_PROFILE:return n.h264ConstrainedHighProfile();case r.SdkVideoCodecCapability.VP9_PROFILE_0:return n.vp9Profile0();case r.SdkVideoCodecCapability.AV1_MAIN_PROFILE:return n.av1Main();default:return}}}t.default=n},3320:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=i(9591);class n{constructor(e){this.logger=e}compress(e,t){if(t.length>0){let e=Math.min(t.length,n.MAX_DICTIONARY_SIZE);t=t.slice(0,e)}let i={memLevel:n.Z_MEM_LEVEL,dictionary:t};return r.deflateRaw(e,i)}decompress(e,t){if(t.length>0){let e=Math.min(t.length,n.MAX_DICTIONARY_SIZE);t=t.slice(0,e)}let i={to:"string",dictionary:t,chunkSize:4096},o="";try{o=r.inflateRaw(e,i)}catch(e){this.logger.error(`failed to decompress the string with error: [${e}]`)}return o}}t.default=n,n.Z_MEM_LEVEL=9,n.MAX_DICTIONARY_SIZE=31744},9678:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=i(3860),n=i(6850),o=i(9553),s=i(3013);class a{constructor(e){this.logger=e,this.currentState=o.SessionStateControllerState.NotConnected,this.deferredAction=null,this.deferredWork=null}perform(e,t){let i=this.currentState;if(i===o.SessionStateControllerState.NotConnected&&e===r.SessionStateControllerAction.Connect)this.transition(o.SessionStateControllerState.Connecting,e);else if(i===o.SessionStateControllerState.Connecting&&e===r.SessionStateControllerAction.Fail)this.transition(o.SessionStateControllerState.Disconnecting,e);else if(i===o.SessionStateControllerState.Connecting&&e===r.SessionStateControllerAction.FinishConnecting)this.transition(o.SessionStateControllerState.Connected,e);else if(i===o.SessionStateControllerState.Connected&&e===r.SessionStateControllerAction.Disconnect)this.transition(o.SessionStateControllerState.Disconnecting,e);else if(i===o.SessionStateControllerState.Connected&&e===r.SessionStateControllerAction.Reconnect)this.transition(o.SessionStateControllerState.Connecting,e);else if(i===o.SessionStateControllerState.Connected&&e===r.SessionStateControllerAction.Fail)this.transition(o.SessionStateControllerState.Disconnecting,e);else if(i===o.SessionStateControllerState.Connected&&e===r.SessionStateControllerAction.Update)this.transition(o.SessionStateControllerState.Updating,e);else if(i===o.SessionStateControllerState.Updating&&e===r.SessionStateControllerAction.Fail)this.transition(o.SessionStateControllerState.Disconnecting,e);else if(i===o.SessionStateControllerState.Updating&&e===r.SessionStateControllerAction.FinishUpdating)this.transition(o.SessionStateControllerState.Connected,e);else if(i===o.SessionStateControllerState.Disconnecting&&e===r.SessionStateControllerAction.FinishDisconnecting)this.transition(o.SessionStateControllerState.NotConnected,e);else if(this.canDefer(e))return this.logger.info(`deferring transition from ${o.SessionStateControllerState[this.currentState]} with ${r.SessionStateControllerAction[e]}`),this.deferAction(e,t),s.SessionStateControllerTransitionResult.DeferredTransition;else return this.logger.warn(`no transition found from ${o.SessionStateControllerState[this.currentState]} with ${r.SessionStateControllerAction[e]}`),s.SessionStateControllerTransitionResult.NoTransitionAvailable;try{t()}catch(t){return this.logger.error(`error during state ${o.SessionStateControllerState[this.currentState]} with action ${r.SessionStateControllerAction[e]}: ${t}`),this.logger.info(`rolling back transition to ${o.SessionStateControllerState[i]}`),this.currentState=i,s.SessionStateControllerTransitionResult.TransitionFailed}return this.performDeferredAction(),s.SessionStateControllerTransitionResult.Transitioned}state(){return this.currentState}transition(e,t){this.logger.info(`transitioning from ${o.SessionStateControllerState[this.currentState]} to ${o.SessionStateControllerState[e]} with ${r.SessionStateControllerAction[t]}`),this.currentState=e}deferPriority(e){switch(e){case r.SessionStateControllerAction.Disconnect:return n.SessionStateControllerDeferPriority.VeryHigh;case r.SessionStateControllerAction.Fail:return n.SessionStateControllerDeferPriority.High;case r.SessionStateControllerAction.Reconnect:return n.SessionStateControllerDeferPriority.Medium;case r.SessionStateControllerAction.Update:return n.SessionStateControllerDeferPriority.Low;default:return n.SessionStateControllerDeferPriority.DoNotDefer}}deferAction(e,t){null!==this.deferredAction&&this.deferPriority(this.deferredAction)>this.deferPriority(e)||(this.deferredAction=e,this.deferredWork=t)}canDefer(e){return this.deferPriority(e)!==n.SessionStateControllerDeferPriority.DoNotDefer&&(this.currentState===o.SessionStateControllerState.Connecting||this.currentState===o.SessionStateControllerState.Updating)}performDeferredAction(){if(!this.deferredAction)return;let e=this.deferredAction,t=this.deferredWork;this.deferredAction=null,this.deferredWork=null,this.logger.info(`performing deferred action ${r.SessionStateControllerAction[e]}`),this.perform(e,t)!==s.SessionStateControllerTransitionResult.Transitioned&&this.logger.info(`unable to perform deferred action ${r.SessionStateControllerAction[e]} in state ${o.SessionStateControllerState[this.currentState]}`)}}t.default=a},3860:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerAction=void 0,function(e){e[e.Connect=0]="Connect",e[e.FinishConnecting=1]="FinishConnecting",e[e.Update=2]="Update",e[e.FinishUpdating=3]="FinishUpdating",e[e.Reconnect=4]="Reconnect",e[e.Disconnect=5]="Disconnect",e[e.Fail=6]="Fail",e[e.FinishDisconnecting=7]="FinishDisconnecting"}(i=t.SessionStateControllerAction||(t.SessionStateControllerAction={})),t.default=i},6850:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerDeferPriority=void 0,function(e){e[e.DoNotDefer=0]="DoNotDefer",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High",e[e.VeryHigh=4]="VeryHigh"}(i=t.SessionStateControllerDeferPriority||(t.SessionStateControllerDeferPriority={})),t.default=i},9553:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerState=void 0,function(e){e[e.NotConnected=0]="NotConnected",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.Updating=3]="Updating",e[e.Disconnecting=4]="Disconnecting"}(i=t.SessionStateControllerState||(t.SessionStateControllerState={})),t.default=i},3013:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerTransitionResult=void 0,function(e){e[e.Transitioned=0]="Transitioned",e[e.NoTransitionAvailable=1]="NoTransitionAvailable",e[e.DeferredTransition=2]="DeferredTransition",e[e.TransitionFailed=3]="TransitionFailed"}(i=t.SessionStateControllerTransitionResult||(t.SessionStateControllerTransitionResult={})),t.default=i},1208:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(543)),o=r(i(4929)),s=i(289),a=i(8690),l=r(i(4046)),d=r(i(5992)),c=r(i(7387)),u=i(7103),h=r(i(2902)),f=r(i(9416));class p{constructor(e,t){this.webSocket=e,this.logger=t,this.unloadHandler=null,this.closeEventHandler=e=>{this.deactivatePageUnloadHandler(),this.resetConnection(),this.sendEvent(new h.default(this,f.default.WebSocketClosed,null,e.code,e.reason)),this.serviceConnectionRequestQueue()},this.observerQueue=new Set,this.connectionRequestQueue=[],this.resetConnection(),this.logger.debug(()=>"signaling client init"),this.audioSessionId=this.generateNewAudioSessionId()}registerObserver(e){this.logger.debug(()=>"registering signaling client observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.debug(()=>"removing signaling client observer"),this.observerQueue.delete(e)}openConnection(e){this.logger.info("adding connection request to queue: "+e.url()),this.connectionRequestQueue.push(e),this.closeConnection()}pingPong(e){this.logger.debug(()=>"sending ping");let t=s.SdkSignalFrame.create();return t.type=s.SdkSignalFrame.Type.PING_PONG,t.pingPong=e,this.sendMessage(t),t.timestampMs}join(e){this.logger.info("sending join");let t=s.SdkJoinFrame.create();t.protocolVersion=2,t.flags=s.SdkJoinFlags.HAS_STREAM_UPDATE;let i=new n.default,r={platformName:i.name(),platformVersion:i.version(),clientSource:l.default.sdkName,chimeSdkVersion:l.default.sdkVersion,clientUtcOffset:a.getFormattedOffset(new Date().getTimezoneOffset())};if(e.applicationMetadata){let{appName:t,appVersion:i}=e.applicationMetadata;r.appName=t,r.appVersion=i}t.clientDetails=s.SdkClientDetails.create(r),t.audioSessionId=this.audioSessionId,t.wantsCompressedSdp=p.CLIENT_SUPPORTS_COMPRESSION,t.disablePeriodicKeyframeRequestOnContentSender=e.disablePeriodicKeyframeRequestOnContentSender,t.serverSideNetworkAdaption=u.convertServerSideNetworkAdaptionEnumToSignaled(e.serverSideNetworkAdaption),t.supportedServerSideNetworkAdaptions=e.supportedServerSideNetworkAdaptions.map(u.convertServerSideNetworkAdaptionEnumToSignaled),t.wantsAllTemporalLayersInIndex=e.wantsAllTemporalLayersInIndex;let o=s.SdkSignalFrame.create();o.type=s.SdkSignalFrame.Type.JOIN,o.join=t,this.sendMessage(o)}subscribe(e){let t=s.SdkSubscribeFrame.create();if(t.sendStreams=[],t.sdpOffer=e.sdpOffer,e.connectionTypeHasVideo&&(t.receiveStreamIds=e.receiveStreamIds),e.audioHost&&(t.audioCheckin=e.audioCheckin,t.audioHost=e.audioHost,t.audioMuted=e.audioMuted,!e.audioCheckin)){let i=s.SdkStreamDescriptor.create();i.mediaType=s.SdkStreamMediaType.AUDIO,i.trackLabel="AmazonChimeExpressAudio",i.attendeeId=e.attendeeId,i.streamId=1,i.groupId=1,i.framerate=15,i.maxBitrateKbps=600,i.avgBitrateBps=4e5,t.sendStreams.push(i)}if(t.compressedSdpOffer=e.compressedSdpOffer,t.duplex=s.SdkStreamServiceType.RX,e.localVideoEnabled){t.duplex=s.SdkStreamServiceType.DUPLEX;for(let i=0;i<e.videoStreamDescriptions.length;i++){let r=e.videoStreamDescriptions[i].clone();r.attendeeId=e.attendeeId,t.sendStreams.push(r.toStreamDescriptor())}}e.videoSubscriptionConfiguration.length>0&&(t.videoSubscriptionConfiguration=e.videoSubscriptionConfiguration.map(this.convertSignalingClientVideoSubscriptionConfiguration));let i=s.SdkSignalFrame.create();i.type=s.SdkSignalFrame.Type.SUBSCRIBE,i.sub=t,this.sendMessage(i)}remoteVideoUpdate(e,t){let i=s.SdkRemoteVideoUpdateFrame.create();i.addedOrUpdatedVideoSubscriptions=e.map(this.convertSignalingClientVideoSubscriptionConfiguration),i.removedVideoSubscriptionMids=t;let r=s.SdkSignalFrame.create();r.type=s.SdkSignalFrame.Type.REMOTE_VIDEO_UPDATE,r.remoteVideoUpdate=i,this.sendMessage(r)}convertSignalingClientVideoSubscriptionConfiguration(e){let t=new s.SdkVideoSubscriptionConfiguration;switch(t.mid=e.mid,t.attendeeId=e.attendeeId,t.streamId=e.streamId,t.groupId=e.groupId,t.priority=e.priority,t.targetBitrateKbps=e.targetBitrateKbps,e.qualityAdaptationPreference){case d.default.Balanced:t.qualityAdaptationPreference=s.SdkVideoQualityAdaptationPreference.BALANCED;break;case d.default.MaintainFramerate:t.qualityAdaptationPreference=s.SdkVideoQualityAdaptationPreference.MAINTAIN_FRAMERATE;break;case d.default.MaintainResolution:t.qualityAdaptationPreference=s.SdkVideoQualityAdaptationPreference.MAINTAIN_RESOLUTION;break;default:t.qualityAdaptationPreference=s.SdkVideoQualityAdaptationPreference.BALANCED}return t}leave(){let e=s.SdkSignalFrame.create();e.type=s.SdkSignalFrame.Type.LEAVE,e.leave=s.SdkLeaveFrame.create(),this.sendMessage(e),this.logger.debug(()=>"sent leave")}sendClientMetrics(e){let t=s.SdkSignalFrame.create();t.type=s.SdkSignalFrame.Type.CLIENT_METRIC,t.clientMetric=e,this.sendMessage(t)}sendDataMessage(e){let t=s.SdkSignalFrame.create();t.type=s.SdkSignalFrame.Type.DATA_MESSAGE,t.dataMessage=e,this.sendMessage(t)}closeConnection(){var e,t;if(this.webSocket.readyState()!==c.default.None&&this.webSocket.readyState()!==c.default.Closed){this.isClosing=!0,this.sendEvent(new h.default(this,f.default.WebSocketClosing,null));let i=new o.default(p.CLOSE_EVENT_TIMEOUT_MS),r=e=>{var t,n;null===(n=(t=this.webSocket).removeEventListener)||void 0===n||n.call(t,"close",r),i.stop(),this.closeEventHandler(e)};null===(t=(e=this.webSocket).removeEventListener)||void 0===t||t.call(e,"close",this.closeEventHandler),this.webSocket.addEventListener("close",r),i.start(()=>{r(new CloseEvent("close",{wasClean:!1,code:1005,reason:"",bubbles:!1}))}),this.webSocket.close(),this.deactivatePageUnloadHandler()}else this.logger.info("no existing signaling client connection needs closing"),this.serviceConnectionRequestQueue()}ready(){return this.webSocket.readyState()===c.default.Open&&!this.isClosing&&this.wasOpened}mute(e){let t=s.SdkSignalFrame.create();t.type=s.SdkSignalFrame.Type.AUDIO_CONTROL;let i=s.SdkAudioControlFrame.create();i.muted=e,t.audioControl=i,this.sendMessage(t)}pause(e){let t=s.SdkSignalFrame.create();t.type=s.SdkSignalFrame.Type.PAUSE,t.pause=s.SdkPauseResumeFrame.create(),t.pause.streamIds=e,this.sendMessage(t)}resume(e){let t=s.SdkSignalFrame.create();t.type=s.SdkSignalFrame.Type.RESUME,t.pause=s.SdkPauseResumeFrame.create(),t.pause.streamIds=e,this.sendMessage(t)}resetConnection(){this.webSocket.destroy(),this.wasOpened=!1}sendMessage(e){e.timestampMs=Date.now(),this.logger.debug(()=>`sending: ${JSON.stringify(e)}`);let t=this.prependWithFrameTypeRTC(s.SdkSignalFrame.encode(e).finish());if(this.ready()){if(!this.webSocket.send(t)){this.sendEvent(new h.default(this,f.default.WebSocketSendMessageFailure,null));return}this.sendEvent(new h.default(this,f.default.WebSocketSentMessage,null))}else this.sendEvent(new h.default(this,f.default.WebSocketSkippedMessage,null))}receiveMessage(e){let t;try{t=s.SdkSignalFrame.decode(e)}catch(t){this.logger.info(`failed to decode: ${e}`),this.sendEvent(new h.default(this,f.default.ProtocolDecodeFailure,null));return}this.logger.debug(()=>`received: ${JSON.stringify(t)}`),this.webSocket.readyState()===c.default.Open?this.sendEvent(new h.default(this,f.default.ReceivedSignalFrame,t)):this.logger.info(`skipping notification of message since WebSocket is not open: ${JSON.stringify(t)}`)}stripFrameTypeRTC(e){let t=e[0];return t!==p.FRAME_TYPE_RTC&&2!==t&&this.logger.warn(`expected FrameTypeRTC for message but got ${t}`),e.slice(1)}prependWithFrameTypeRTC(e){let t=new Uint8Array(e.length+1);return t[0]=p.FRAME_TYPE_RTC,t.set(e,1),t}serviceConnectionRequestQueue(){if(0===this.connectionRequestQueue.length){this.logger.info("no connection requests to service");return}let e=this.connectionRequestQueue.shift();this.logger.info(`opening connection to ${e.url()}`),this.isClosing=!1,this.webSocket.create(e.url(),e.protocols()),this.setUpEventListeners(),this.sendEvent(new h.default(this,f.default.WebSocketConnecting,null))}sendEvent(e){switch(e.type){case f.default.WebSocketMessage:case f.default.ReceivedSignalFrame:case f.default.WebSocketSentMessage:this.logger.debug(()=>`notifying event: ${f.default[e.type]}`);break;case f.default.WebSocketSkippedMessage:this.logger.debug(()=>`notifying event: ${f.default[e.type]}, websocket state=${c.default[this.webSocket.readyState()]}`);break;case f.default.WebSocketClosed:this.logger.info(`notifying event: ${f.default[e.type]}, 
              code: ${e.closeCode} reason: ${e.closeReason}`);break;default:this.logger.info(`notifying event: ${f.default[e.type]}`)}for(let t of this.observerQueue)t.handleSignalingClientEvent(e)}setUpEventListeners(){this.webSocket.addEventListener("open",()=>{this.activatePageUnloadHandler(),this.wasOpened=!0,this.sendEvent(new h.default(this,f.default.WebSocketOpen,null))}),this.webSocket.addEventListener("message",e=>{this.sendEvent(new h.default(this,f.default.WebSocketMessage,null)),this.receiveMessage(this.stripFrameTypeRTC(new Uint8Array(e.data)))}),this.webSocket.addEventListener("close",this.closeEventHandler),this.webSocket.addEventListener("error",()=>{if(this.isClosing&&!this.wasOpened){this.logger.info("Signaling WebSocket ignoring error closing while connecting");return}this.wasOpened?(this.logger.error("Signaling WebSocket received error while connected"),this.sendEvent(new h.default(this,f.default.WebSocketError,null))):(this.logger.error("Signaling WebSocket received error while connecting"),this.sendEvent(new h.default(this,f.default.WebSocketFailed,null)))})}activatePageUnloadHandler(){this.unloadHandler=()=>{this.leave()};let e=i.g;e.window&&e.window.addEventListener&&window.addEventListener("unload",this.unloadHandler)}deactivatePageUnloadHandler(){let e=i.g;e.window&&e.window.removeEventListener&&window.removeEventListener("unload",this.unloadHandler),this.unloadHandler=null}generateNewAudioSessionId(){let e=new Uint32Array(1);return a.getRandomValues(e),e[0]}promoteToPrimaryMeeting(e){let t=s.SdkMeetingSessionCredentials.create();t.attendeeId=e.attendeeId,t.externalUserId=e.externalUserId,t.joinToken=e.joinToken;let i=s.SdkPrimaryMeetingJoinFrame.create();i.credentials=t;let r=s.SdkSignalFrame.create();r.type=s.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN,r.primaryMeetingJoin=i,this.sendMessage(r)}demoteFromPrimaryMeeting(){let e=s.SdkPrimaryMeetingLeaveFrame.create(),t=s.SdkSignalFrame.create();t.type=s.SdkSignalFrame.Type.PRIMARY_MEETING_LEAVE,t.primaryMeetingLeave=e,this.sendMessage(t)}}t.default=p,p.FRAME_TYPE_RTC=5,p.CLOSE_EVENT_TIMEOUT_MS=2e3,p.CLIENT_SUPPORTS_COMPRESSION=!0},7103:function(e,t,i){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.convertServerSideNetworkAdaptionEnumToSignaled=t.convertServerSideNetworkAdaptionEnumFromSignaled=t.serverSideNetworkAdaptionIsNoneOrDefault=t.ServerSideNetworkAdaption=void 0;let n=i(289);function o(e){return e===r.None||e===r.Default}function s(e){switch(e){case n.SdkServerSideNetworkAdaption.DEFAULT:return r.Default;case n.SdkServerSideNetworkAdaption.NONE:return r.None;case n.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING:return r.BandwidthProbing;case n.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION:return r.BandwidthProbingAndRemoteVideoQualityAdaption}}function a(e){switch(e){case r.Default:return n.SdkServerSideNetworkAdaption.DEFAULT;case r.None:return n.SdkServerSideNetworkAdaption.NONE;case r.BandwidthProbing:return n.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING;case r.BandwidthProbingAndRemoteVideoQualityAdaption:return n.SdkServerSideNetworkAdaption.BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION}}!function(e){e[e.Default=0]="Default",e[e.None=1]="None",e[e.BandwidthProbing=2]="BandwidthProbing",e[e.BandwidthProbingAndRemoteVideoQualityAdaption=3]="BandwidthProbingAndRemoteVideoQualityAdaption"}(r=t.ServerSideNetworkAdaption||(t.ServerSideNetworkAdaption={})),t.default=r,t.serverSideNetworkAdaptionIsNoneOrDefault=o,t.convertServerSideNetworkAdaptionEnumFromSignaled=s,t.convertServerSideNetworkAdaptionEnumToSignaled=a},3920:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t){this.signalingURL=e,this.joinToken=t}url(){return this.signalingURL+"?X-Chime-Control-Protocol-Version=3&X-Amzn-Chime-Send-Close-On-Error=1"}protocols(){return["_aws_wt_session",this.joinToken]}}t.default=i},2902:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(9416));class o{constructor(e,t,i,r,n){this.client=e,this.type=t,this.message=i,this.closeCode=r,this.closeReason=n,this.timestampMs=Date.now()}isConnectionTerminated(){switch(this.type){case n.default.WebSocketFailed:case n.default.WebSocketError:case n.default.WebSocketClosing:case n.default.WebSocketClosed:return!0;default:return!1}}}t.default=o},9416:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SignalingClientEventType=void 0,function(e){e[e.WebSocketConnecting=0]="WebSocketConnecting",e[e.WebSocketOpen=1]="WebSocketOpen",e[e.WebSocketError=2]="WebSocketError",e[e.WebSocketClosing=3]="WebSocketClosing",e[e.WebSocketClosed=4]="WebSocketClosed",e[e.WebSocketFailed=5]="WebSocketFailed",e[e.WebSocketMessage=6]="WebSocketMessage",e[e.WebSocketSendMessageFailure=7]="WebSocketSendMessageFailure",e[e.WebSocketSentMessage=8]="WebSocketSentMessage",e[e.ProtocolDecodeFailure=9]="ProtocolDecodeFailure",e[e.ReceivedSignalFrame=10]="ReceivedSignalFrame",e[e.WebSocketSkippedMessage=11]="WebSocketSkippedMessage"}(i=t.SignalingClientEventType||(t.SignalingClientEventType={})),t.default=i},2168:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(7103));class o{constructor(e){this.applicationMetadata=e,this.serverSideNetworkAdaption=n.default.Default,this.supportedServerSideNetworkAdaptions=[],this.wantsAllTemporalLayersInIndex=!1,this.disablePeriodicKeyframeRequestOnContentSender=!1}}t.default=o},6729:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,r,n,o,s,a,l,d){this.attendeeId=e,this.sdpOffer=t,this.audioHost=i,this.audioMuted=r,this.audioCheckin=n,this.receiveStreamIds=o,this.localVideoEnabled=s,this.videoStreamDescriptions=a,this.connectionTypeHasVideo=l,this.compressedSdpOffer=d,this.videoSubscriptionConfiguration=[]}}t.default=i},9101:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{equals(e){return void 0!==e&&this.mid===e.mid&&this.attendeeId===e.attendeeId&&this.streamId===e.streamId&&this.groupId===e.groupId&&this.priority===e.priority&&this.targetBitrateKbps===e.targetBitrateKbps&&this.qualityAdaptationPreference===e.qualityAdaptationPreference}}t.default=i},289:function(e,t,i){"use strict";var r=i(2100),n=r.Reader,o=r.Writer,s=r.util,a=r.roots.default||(r.roots.default={});a.SdkSignalFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timestampMs=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.type=1,e.prototype.error=null,e.prototype.join=null,e.prototype.joinack=null,e.prototype.sub=null,e.prototype.suback=null,e.prototype.index=null,e.prototype.pause=null,e.prototype.leave=null,e.prototype.leaveAck=null,e.prototype.bitrates=null,e.prototype.audioControl=null,e.prototype.audioMetadata=null,e.prototype.audioStreamIdInfo=null,e.prototype.pingPong=null,e.prototype.audioStatus=null,e.prototype.clientMetric=null,e.prototype.dataMessage=null,e.prototype.remoteVideoUpdate=null,e.prototype.primaryMeetingJoin=null,e.prototype.primaryMeetingJoinAck=null,e.prototype.primaryMeetingLeave=null,e.prototype.notification=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),t.uint32(8).uint64(e.timestampMs),t.uint32(16).int32(e.type),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&a.SdkErrorFrame.encode(e.error,t.uint32(26).fork()).ldelim(),null!=e.join&&Object.hasOwnProperty.call(e,"join")&&a.SdkJoinFrame.encode(e.join,t.uint32(34).fork()).ldelim(),null!=e.joinack&&Object.hasOwnProperty.call(e,"joinack")&&a.SdkJoinAckFrame.encode(e.joinack,t.uint32(42).fork()).ldelim(),null!=e.sub&&Object.hasOwnProperty.call(e,"sub")&&a.SdkSubscribeFrame.encode(e.sub,t.uint32(50).fork()).ldelim(),null!=e.suback&&Object.hasOwnProperty.call(e,"suback")&&a.SdkSubscribeAckFrame.encode(e.suback,t.uint32(58).fork()).ldelim(),null!=e.index&&Object.hasOwnProperty.call(e,"index")&&a.SdkIndexFrame.encode(e.index,t.uint32(66).fork()).ldelim(),null!=e.pause&&Object.hasOwnProperty.call(e,"pause")&&a.SdkPauseResumeFrame.encode(e.pause,t.uint32(82).fork()).ldelim(),null!=e.leave&&Object.hasOwnProperty.call(e,"leave")&&a.SdkLeaveFrame.encode(e.leave,t.uint32(90).fork()).ldelim(),null!=e.leaveAck&&Object.hasOwnProperty.call(e,"leaveAck")&&a.SdkLeaveAckFrame.encode(e.leaveAck,t.uint32(98).fork()).ldelim(),null!=e.bitrates&&Object.hasOwnProperty.call(e,"bitrates")&&a.SdkBitrateFrame.encode(e.bitrates,t.uint32(114).fork()).ldelim(),null!=e.audioControl&&Object.hasOwnProperty.call(e,"audioControl")&&a.SdkAudioControlFrame.encode(e.audioControl,t.uint32(138).fork()).ldelim(),null!=e.audioMetadata&&Object.hasOwnProperty.call(e,"audioMetadata")&&a.SdkAudioMetadataFrame.encode(e.audioMetadata,t.uint32(146).fork()).ldelim(),null!=e.audioStreamIdInfo&&Object.hasOwnProperty.call(e,"audioStreamIdInfo")&&a.SdkAudioStreamIdInfoFrame.encode(e.audioStreamIdInfo,t.uint32(154).fork()).ldelim(),null!=e.pingPong&&Object.hasOwnProperty.call(e,"pingPong")&&a.SdkPingPongFrame.encode(e.pingPong,t.uint32(162).fork()).ldelim(),null!=e.audioStatus&&Object.hasOwnProperty.call(e,"audioStatus")&&a.SdkAudioStatusFrame.encode(e.audioStatus,t.uint32(170).fork()).ldelim(),null!=e.clientMetric&&Object.hasOwnProperty.call(e,"clientMetric")&&a.SdkClientMetricFrame.encode(e.clientMetric,t.uint32(178).fork()).ldelim(),null!=e.dataMessage&&Object.hasOwnProperty.call(e,"dataMessage")&&a.SdkDataMessageFrame.encode(e.dataMessage,t.uint32(186).fork()).ldelim(),null!=e.remoteVideoUpdate&&Object.hasOwnProperty.call(e,"remoteVideoUpdate")&&a.SdkRemoteVideoUpdateFrame.encode(e.remoteVideoUpdate,t.uint32(202).fork()).ldelim(),null!=e.primaryMeetingJoin&&Object.hasOwnProperty.call(e,"primaryMeetingJoin")&&a.SdkPrimaryMeetingJoinFrame.encode(e.primaryMeetingJoin,t.uint32(210).fork()).ldelim(),null!=e.primaryMeetingJoinAck&&Object.hasOwnProperty.call(e,"primaryMeetingJoinAck")&&a.SdkPrimaryMeetingJoinAckFrame.encode(e.primaryMeetingJoinAck,t.uint32(218).fork()).ldelim(),null!=e.primaryMeetingLeave&&Object.hasOwnProperty.call(e,"primaryMeetingLeave")&&a.SdkPrimaryMeetingLeaveFrame.encode(e.primaryMeetingLeave,t.uint32(226).fork()).ldelim(),null!=e.notification&&Object.hasOwnProperty.call(e,"notification")&&a.SdkNotificationFrame.encode(e.notification,t.uint32(282).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkSignalFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.timestampMs=e.uint64();break;case 2:r.type=e.int32();break;case 3:r.error=a.SdkErrorFrame.decode(e,e.uint32());break;case 4:r.join=a.SdkJoinFrame.decode(e,e.uint32());break;case 5:r.joinack=a.SdkJoinAckFrame.decode(e,e.uint32());break;case 6:r.sub=a.SdkSubscribeFrame.decode(e,e.uint32());break;case 7:r.suback=a.SdkSubscribeAckFrame.decode(e,e.uint32());break;case 8:r.index=a.SdkIndexFrame.decode(e,e.uint32());break;case 10:r.pause=a.SdkPauseResumeFrame.decode(e,e.uint32());break;case 11:r.leave=a.SdkLeaveFrame.decode(e,e.uint32());break;case 12:r.leaveAck=a.SdkLeaveAckFrame.decode(e,e.uint32());break;case 14:r.bitrates=a.SdkBitrateFrame.decode(e,e.uint32());break;case 17:r.audioControl=a.SdkAudioControlFrame.decode(e,e.uint32());break;case 18:r.audioMetadata=a.SdkAudioMetadataFrame.decode(e,e.uint32());break;case 19:r.audioStreamIdInfo=a.SdkAudioStreamIdInfoFrame.decode(e,e.uint32());break;case 20:r.pingPong=a.SdkPingPongFrame.decode(e,e.uint32());break;case 21:r.audioStatus=a.SdkAudioStatusFrame.decode(e,e.uint32());break;case 22:r.clientMetric=a.SdkClientMetricFrame.decode(e,e.uint32());break;case 23:r.dataMessage=a.SdkDataMessageFrame.decode(e,e.uint32());break;case 25:r.remoteVideoUpdate=a.SdkRemoteVideoUpdateFrame.decode(e,e.uint32());break;case 26:r.primaryMeetingJoin=a.SdkPrimaryMeetingJoinFrame.decode(e,e.uint32());break;case 27:r.primaryMeetingJoinAck=a.SdkPrimaryMeetingJoinAckFrame.decode(e,e.uint32());break;case 28:r.primaryMeetingLeave=a.SdkPrimaryMeetingLeaveFrame.decode(e,e.uint32());break;case 35:r.notification=a.SdkNotificationFrame.decode(e,e.uint32());break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("timestampMs"))throw s.ProtocolError("missing required 'timestampMs'",{instance:r});if(!r.hasOwnProperty("type"))throw s.ProtocolError("missing required 'type'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isInteger(e.timestampMs)&&!(e.timestampMs&&s.isInteger(e.timestampMs.low)&&s.isInteger(e.timestampMs.high)))return"timestampMs: integer|Long expected";switch(e.type){default:return"type: enum value expected";case 1:case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 13:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 34:}if(null!=e.error&&e.hasOwnProperty("error")){var t=a.SdkErrorFrame.verify(e.error);if(t)return"error."+t}if(null!=e.join&&e.hasOwnProperty("join")){var t=a.SdkJoinFrame.verify(e.join);if(t)return"join."+t}if(null!=e.joinack&&e.hasOwnProperty("joinack")){var t=a.SdkJoinAckFrame.verify(e.joinack);if(t)return"joinack."+t}if(null!=e.sub&&e.hasOwnProperty("sub")){var t=a.SdkSubscribeFrame.verify(e.sub);if(t)return"sub."+t}if(null!=e.suback&&e.hasOwnProperty("suback")){var t=a.SdkSubscribeAckFrame.verify(e.suback);if(t)return"suback."+t}if(null!=e.index&&e.hasOwnProperty("index")){var t=a.SdkIndexFrame.verify(e.index);if(t)return"index."+t}if(null!=e.pause&&e.hasOwnProperty("pause")){var t=a.SdkPauseResumeFrame.verify(e.pause);if(t)return"pause."+t}if(null!=e.leave&&e.hasOwnProperty("leave")){var t=a.SdkLeaveFrame.verify(e.leave);if(t)return"leave."+t}if(null!=e.leaveAck&&e.hasOwnProperty("leaveAck")){var t=a.SdkLeaveAckFrame.verify(e.leaveAck);if(t)return"leaveAck."+t}if(null!=e.bitrates&&e.hasOwnProperty("bitrates")){var t=a.SdkBitrateFrame.verify(e.bitrates);if(t)return"bitrates."+t}if(null!=e.audioControl&&e.hasOwnProperty("audioControl")){var t=a.SdkAudioControlFrame.verify(e.audioControl);if(t)return"audioControl."+t}if(null!=e.audioMetadata&&e.hasOwnProperty("audioMetadata")){var t=a.SdkAudioMetadataFrame.verify(e.audioMetadata);if(t)return"audioMetadata."+t}if(null!=e.audioStreamIdInfo&&e.hasOwnProperty("audioStreamIdInfo")){var t=a.SdkAudioStreamIdInfoFrame.verify(e.audioStreamIdInfo);if(t)return"audioStreamIdInfo."+t}if(null!=e.pingPong&&e.hasOwnProperty("pingPong")){var t=a.SdkPingPongFrame.verify(e.pingPong);if(t)return"pingPong."+t}if(null!=e.audioStatus&&e.hasOwnProperty("audioStatus")){var t=a.SdkAudioStatusFrame.verify(e.audioStatus);if(t)return"audioStatus."+t}if(null!=e.clientMetric&&e.hasOwnProperty("clientMetric")){var t=a.SdkClientMetricFrame.verify(e.clientMetric);if(t)return"clientMetric."+t}if(null!=e.dataMessage&&e.hasOwnProperty("dataMessage")){var t=a.SdkDataMessageFrame.verify(e.dataMessage);if(t)return"dataMessage."+t}if(null!=e.remoteVideoUpdate&&e.hasOwnProperty("remoteVideoUpdate")){var t=a.SdkRemoteVideoUpdateFrame.verify(e.remoteVideoUpdate);if(t)return"remoteVideoUpdate."+t}if(null!=e.primaryMeetingJoin&&e.hasOwnProperty("primaryMeetingJoin")){var t=a.SdkPrimaryMeetingJoinFrame.verify(e.primaryMeetingJoin);if(t)return"primaryMeetingJoin."+t}if(null!=e.primaryMeetingJoinAck&&e.hasOwnProperty("primaryMeetingJoinAck")){var t=a.SdkPrimaryMeetingJoinAckFrame.verify(e.primaryMeetingJoinAck);if(t)return"primaryMeetingJoinAck."+t}if(null!=e.primaryMeetingLeave&&e.hasOwnProperty("primaryMeetingLeave")){var t=a.SdkPrimaryMeetingLeaveFrame.verify(e.primaryMeetingLeave);if(t)return"primaryMeetingLeave."+t}if(null!=e.notification&&e.hasOwnProperty("notification")){var t=a.SdkNotificationFrame.verify(e.notification);if(t)return"notification."+t}return null},e.fromObject=function(e){if(e instanceof a.SdkSignalFrame)return e;var t=new a.SdkSignalFrame;switch(null!=e.timestampMs&&(s.Long?(t.timestampMs=s.Long.fromValue(e.timestampMs)).unsigned=!0:"string"==typeof e.timestampMs?t.timestampMs=parseInt(e.timestampMs,10):"number"==typeof e.timestampMs?t.timestampMs=e.timestampMs:"object"==typeof e.timestampMs&&(t.timestampMs=new s.LongBits(e.timestampMs.low>>>0,e.timestampMs.high>>>0).toNumber(!0))),e.type){default:"number"==typeof e.type&&(t.type=e.type);break;case"JOIN":case 1:t.type=1;break;case"JOIN_ACK":case 2:t.type=2;break;case"SUBSCRIBE":case 3:t.type=3;break;case"SUBSCRIBE_ACK":case 4:t.type=4;break;case"INDEX":case 5:t.type=5;break;case"PAUSE":case 7:t.type=7;break;case"RESUME":case 8:t.type=8;break;case"LEAVE":case 9:t.type=9;break;case"LEAVE_ACK":case 10:t.type=10;break;case"BITRATES":case 13:t.type=13;break;case"AUDIO_CONTROL":case 16:t.type=16;break;case"AUDIO_METADATA":case 17:t.type=17;break;case"AUDIO_STREAM_ID_INFO":case 18:t.type=18;break;case"PING_PONG":case 19:t.type=19;break;case"AUDIO_STATUS":case 20:t.type=20;break;case"CLIENT_METRIC":case 21:t.type=21;break;case"DATA_MESSAGE":case 22:t.type=22;break;case"REMOTE_VIDEO_UPDATE":case 24:t.type=24;break;case"PRIMARY_MEETING_JOIN":case 25:t.type=25;break;case"PRIMARY_MEETING_JOIN_ACK":case 26:t.type=26;break;case"PRIMARY_MEETING_LEAVE":case 27:t.type=27;break;case"NOTIFICATION":case 34:t.type=34}if(null!=e.error){if("object"!=typeof e.error)throw TypeError(".SdkSignalFrame.error: object expected");t.error=a.SdkErrorFrame.fromObject(e.error)}if(null!=e.join){if("object"!=typeof e.join)throw TypeError(".SdkSignalFrame.join: object expected");t.join=a.SdkJoinFrame.fromObject(e.join)}if(null!=e.joinack){if("object"!=typeof e.joinack)throw TypeError(".SdkSignalFrame.joinack: object expected");t.joinack=a.SdkJoinAckFrame.fromObject(e.joinack)}if(null!=e.sub){if("object"!=typeof e.sub)throw TypeError(".SdkSignalFrame.sub: object expected");t.sub=a.SdkSubscribeFrame.fromObject(e.sub)}if(null!=e.suback){if("object"!=typeof e.suback)throw TypeError(".SdkSignalFrame.suback: object expected");t.suback=a.SdkSubscribeAckFrame.fromObject(e.suback)}if(null!=e.index){if("object"!=typeof e.index)throw TypeError(".SdkSignalFrame.index: object expected");t.index=a.SdkIndexFrame.fromObject(e.index)}if(null!=e.pause){if("object"!=typeof e.pause)throw TypeError(".SdkSignalFrame.pause: object expected");t.pause=a.SdkPauseResumeFrame.fromObject(e.pause)}if(null!=e.leave){if("object"!=typeof e.leave)throw TypeError(".SdkSignalFrame.leave: object expected");t.leave=a.SdkLeaveFrame.fromObject(e.leave)}if(null!=e.leaveAck){if("object"!=typeof e.leaveAck)throw TypeError(".SdkSignalFrame.leaveAck: object expected");t.leaveAck=a.SdkLeaveAckFrame.fromObject(e.leaveAck)}if(null!=e.bitrates){if("object"!=typeof e.bitrates)throw TypeError(".SdkSignalFrame.bitrates: object expected");t.bitrates=a.SdkBitrateFrame.fromObject(e.bitrates)}if(null!=e.audioControl){if("object"!=typeof e.audioControl)throw TypeError(".SdkSignalFrame.audioControl: object expected");t.audioControl=a.SdkAudioControlFrame.fromObject(e.audioControl)}if(null!=e.audioMetadata){if("object"!=typeof e.audioMetadata)throw TypeError(".SdkSignalFrame.audioMetadata: object expected");t.audioMetadata=a.SdkAudioMetadataFrame.fromObject(e.audioMetadata)}if(null!=e.audioStreamIdInfo){if("object"!=typeof e.audioStreamIdInfo)throw TypeError(".SdkSignalFrame.audioStreamIdInfo: object expected");t.audioStreamIdInfo=a.SdkAudioStreamIdInfoFrame.fromObject(e.audioStreamIdInfo)}if(null!=e.pingPong){if("object"!=typeof e.pingPong)throw TypeError(".SdkSignalFrame.pingPong: object expected");t.pingPong=a.SdkPingPongFrame.fromObject(e.pingPong)}if(null!=e.audioStatus){if("object"!=typeof e.audioStatus)throw TypeError(".SdkSignalFrame.audioStatus: object expected");t.audioStatus=a.SdkAudioStatusFrame.fromObject(e.audioStatus)}if(null!=e.clientMetric){if("object"!=typeof e.clientMetric)throw TypeError(".SdkSignalFrame.clientMetric: object expected");t.clientMetric=a.SdkClientMetricFrame.fromObject(e.clientMetric)}if(null!=e.dataMessage){if("object"!=typeof e.dataMessage)throw TypeError(".SdkSignalFrame.dataMessage: object expected");t.dataMessage=a.SdkDataMessageFrame.fromObject(e.dataMessage)}if(null!=e.remoteVideoUpdate){if("object"!=typeof e.remoteVideoUpdate)throw TypeError(".SdkSignalFrame.remoteVideoUpdate: object expected");t.remoteVideoUpdate=a.SdkRemoteVideoUpdateFrame.fromObject(e.remoteVideoUpdate)}if(null!=e.primaryMeetingJoin){if("object"!=typeof e.primaryMeetingJoin)throw TypeError(".SdkSignalFrame.primaryMeetingJoin: object expected");t.primaryMeetingJoin=a.SdkPrimaryMeetingJoinFrame.fromObject(e.primaryMeetingJoin)}if(null!=e.primaryMeetingJoinAck){if("object"!=typeof e.primaryMeetingJoinAck)throw TypeError(".SdkSignalFrame.primaryMeetingJoinAck: object expected");t.primaryMeetingJoinAck=a.SdkPrimaryMeetingJoinAckFrame.fromObject(e.primaryMeetingJoinAck)}if(null!=e.primaryMeetingLeave){if("object"!=typeof e.primaryMeetingLeave)throw TypeError(".SdkSignalFrame.primaryMeetingLeave: object expected");t.primaryMeetingLeave=a.SdkPrimaryMeetingLeaveFrame.fromObject(e.primaryMeetingLeave)}if(null!=e.notification){if("object"!=typeof e.notification)throw TypeError(".SdkSignalFrame.notification: object expected");t.notification=a.SdkNotificationFrame.fromObject(e.notification)}return t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(s.Long){var r=new s.Long(0,0,!0);i.timestampMs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timestampMs=t.longs===String?"0":0;i.type=t.enums===String?"JOIN":1,i.error=null,i.join=null,i.joinack=null,i.sub=null,i.suback=null,i.index=null,i.pause=null,i.leave=null,i.leaveAck=null,i.bitrates=null,i.audioControl=null,i.audioMetadata=null,i.audioStreamIdInfo=null,i.pingPong=null,i.audioStatus=null,i.clientMetric=null,i.dataMessage=null,i.remoteVideoUpdate=null,i.primaryMeetingJoin=null,i.primaryMeetingJoinAck=null,i.primaryMeetingLeave=null,i.notification=null}return null!=e.timestampMs&&e.hasOwnProperty("timestampMs")&&("number"==typeof e.timestampMs?i.timestampMs=t.longs===String?String(e.timestampMs):e.timestampMs:i.timestampMs=t.longs===String?s.Long.prototype.toString.call(e.timestampMs):t.longs===Number?new s.LongBits(e.timestampMs.low>>>0,e.timestampMs.high>>>0).toNumber(!0):e.timestampMs),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?void 0===a.SdkSignalFrame.Type[e.type]?e.type:a.SdkSignalFrame.Type[e.type]:e.type),null!=e.error&&e.hasOwnProperty("error")&&(i.error=a.SdkErrorFrame.toObject(e.error,t)),null!=e.join&&e.hasOwnProperty("join")&&(i.join=a.SdkJoinFrame.toObject(e.join,t)),null!=e.joinack&&e.hasOwnProperty("joinack")&&(i.joinack=a.SdkJoinAckFrame.toObject(e.joinack,t)),null!=e.sub&&e.hasOwnProperty("sub")&&(i.sub=a.SdkSubscribeFrame.toObject(e.sub,t)),null!=e.suback&&e.hasOwnProperty("suback")&&(i.suback=a.SdkSubscribeAckFrame.toObject(e.suback,t)),null!=e.index&&e.hasOwnProperty("index")&&(i.index=a.SdkIndexFrame.toObject(e.index,t)),null!=e.pause&&e.hasOwnProperty("pause")&&(i.pause=a.SdkPauseResumeFrame.toObject(e.pause,t)),null!=e.leave&&e.hasOwnProperty("leave")&&(i.leave=a.SdkLeaveFrame.toObject(e.leave,t)),null!=e.leaveAck&&e.hasOwnProperty("leaveAck")&&(i.leaveAck=a.SdkLeaveAckFrame.toObject(e.leaveAck,t)),null!=e.bitrates&&e.hasOwnProperty("bitrates")&&(i.bitrates=a.SdkBitrateFrame.toObject(e.bitrates,t)),null!=e.audioControl&&e.hasOwnProperty("audioControl")&&(i.audioControl=a.SdkAudioControlFrame.toObject(e.audioControl,t)),null!=e.audioMetadata&&e.hasOwnProperty("audioMetadata")&&(i.audioMetadata=a.SdkAudioMetadataFrame.toObject(e.audioMetadata,t)),null!=e.audioStreamIdInfo&&e.hasOwnProperty("audioStreamIdInfo")&&(i.audioStreamIdInfo=a.SdkAudioStreamIdInfoFrame.toObject(e.audioStreamIdInfo,t)),null!=e.pingPong&&e.hasOwnProperty("pingPong")&&(i.pingPong=a.SdkPingPongFrame.toObject(e.pingPong,t)),null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&(i.audioStatus=a.SdkAudioStatusFrame.toObject(e.audioStatus,t)),null!=e.clientMetric&&e.hasOwnProperty("clientMetric")&&(i.clientMetric=a.SdkClientMetricFrame.toObject(e.clientMetric,t)),null!=e.dataMessage&&e.hasOwnProperty("dataMessage")&&(i.dataMessage=a.SdkDataMessageFrame.toObject(e.dataMessage,t)),null!=e.remoteVideoUpdate&&e.hasOwnProperty("remoteVideoUpdate")&&(i.remoteVideoUpdate=a.SdkRemoteVideoUpdateFrame.toObject(e.remoteVideoUpdate,t)),null!=e.primaryMeetingJoin&&e.hasOwnProperty("primaryMeetingJoin")&&(i.primaryMeetingJoin=a.SdkPrimaryMeetingJoinFrame.toObject(e.primaryMeetingJoin,t)),null!=e.primaryMeetingJoinAck&&e.hasOwnProperty("primaryMeetingJoinAck")&&(i.primaryMeetingJoinAck=a.SdkPrimaryMeetingJoinAckFrame.toObject(e.primaryMeetingJoinAck,t)),null!=e.primaryMeetingLeave&&e.hasOwnProperty("primaryMeetingLeave")&&(i.primaryMeetingLeave=a.SdkPrimaryMeetingLeaveFrame.toObject(e.primaryMeetingLeave,t)),null!=e.notification&&e.hasOwnProperty("notification")&&(i.notification=a.SdkNotificationFrame.toObject(e.notification,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkSignalFrame"},e.Type=function(){var e={},t=Object.create(e);return t[e[1]="JOIN"]=1,t[e[2]="JOIN_ACK"]=2,t[e[3]="SUBSCRIBE"]=3,t[e[4]="SUBSCRIBE_ACK"]=4,t[e[5]="INDEX"]=5,t[e[7]="PAUSE"]=7,t[e[8]="RESUME"]=8,t[e[9]="LEAVE"]=9,t[e[10]="LEAVE_ACK"]=10,t[e[13]="BITRATES"]=13,t[e[16]="AUDIO_CONTROL"]=16,t[e[17]="AUDIO_METADATA"]=17,t[e[18]="AUDIO_STREAM_ID_INFO"]=18,t[e[19]="PING_PONG"]=19,t[e[20]="AUDIO_STATUS"]=20,t[e[21]="CLIENT_METRIC"]=21,t[e[22]="DATA_MESSAGE"]=22,t[e[24]="REMOTE_VIDEO_UPDATE"]=24,t[e[25]="PRIMARY_MEETING_JOIN"]=25,t[e[26]="PRIMARY_MEETING_JOIN_ACK"]=26,t[e[27]="PRIMARY_MEETING_LEAVE"]=27,t[e[34]="NOTIFICATION"]=34,t}(),e}(),a.SdkErrorFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.status=0,e.prototype.description="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(8).uint32(e.status),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(18).string(e.description),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkErrorFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.status=e.uint32();break;case 2:r.description=e.string();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.status&&e.hasOwnProperty("status")&&!s.isInteger(e.status)?"status: integer expected":null!=e.description&&e.hasOwnProperty("description")&&!s.isString(e.description)?"description: string expected":null},e.fromObject=function(e){if(e instanceof a.SdkErrorFrame)return e;var t=new a.SdkErrorFrame;return null!=e.status&&(t.status=e.status>>>0),null!=e.description&&(t.description=String(e.description)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.status=0,i.description=""),null!=e.status&&e.hasOwnProperty("status")&&(i.status=e.status),null!=e.description&&e.hasOwnProperty("description")&&(i.description=e.description),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkErrorFrame"},e}(),a.SdkJoinFlags=function(){var e={},t=Object.create(e);return t[e[2]="HAS_STREAM_UPDATE"]=2,t[e[16]="COMPLETE_VIDEO_SOURCES_LIST"]=16,t[e[32]="EXCLUDE_SELF_CONTENT_IN_INDEX"]=32,t}(),a.SdkClientDetails=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.appName="",e.prototype.appVersion="",e.prototype.deviceModel="",e.prototype.deviceMake="",e.prototype.platformName="",e.prototype.platformVersion="",e.prototype.clientSource="",e.prototype.chimeSdkVersion="",e.prototype.clientUtcOffset="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.appName&&Object.hasOwnProperty.call(e,"appName")&&t.uint32(10).string(e.appName),null!=e.appVersion&&Object.hasOwnProperty.call(e,"appVersion")&&t.uint32(18).string(e.appVersion),null!=e.deviceModel&&Object.hasOwnProperty.call(e,"deviceModel")&&t.uint32(26).string(e.deviceModel),null!=e.deviceMake&&Object.hasOwnProperty.call(e,"deviceMake")&&t.uint32(34).string(e.deviceMake),null!=e.platformName&&Object.hasOwnProperty.call(e,"platformName")&&t.uint32(42).string(e.platformName),null!=e.platformVersion&&Object.hasOwnProperty.call(e,"platformVersion")&&t.uint32(50).string(e.platformVersion),null!=e.clientSource&&Object.hasOwnProperty.call(e,"clientSource")&&t.uint32(58).string(e.clientSource),null!=e.chimeSdkVersion&&Object.hasOwnProperty.call(e,"chimeSdkVersion")&&t.uint32(66).string(e.chimeSdkVersion),null!=e.clientUtcOffset&&Object.hasOwnProperty.call(e,"clientUtcOffset")&&t.uint32(74).string(e.clientUtcOffset),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkClientDetails;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.appName=e.string();break;case 2:r.appVersion=e.string();break;case 3:r.deviceModel=e.string();break;case 4:r.deviceMake=e.string();break;case 5:r.platformName=e.string();break;case 6:r.platformVersion=e.string();break;case 7:r.clientSource=e.string();break;case 8:r.chimeSdkVersion=e.string();break;case 9:r.clientUtcOffset=e.string();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.appName&&e.hasOwnProperty("appName")&&!s.isString(e.appName)?"appName: string expected":null!=e.appVersion&&e.hasOwnProperty("appVersion")&&!s.isString(e.appVersion)?"appVersion: string expected":null!=e.deviceModel&&e.hasOwnProperty("deviceModel")&&!s.isString(e.deviceModel)?"deviceModel: string expected":null!=e.deviceMake&&e.hasOwnProperty("deviceMake")&&!s.isString(e.deviceMake)?"deviceMake: string expected":null!=e.platformName&&e.hasOwnProperty("platformName")&&!s.isString(e.platformName)?"platformName: string expected":null!=e.platformVersion&&e.hasOwnProperty("platformVersion")&&!s.isString(e.platformVersion)?"platformVersion: string expected":null!=e.clientSource&&e.hasOwnProperty("clientSource")&&!s.isString(e.clientSource)?"clientSource: string expected":null!=e.chimeSdkVersion&&e.hasOwnProperty("chimeSdkVersion")&&!s.isString(e.chimeSdkVersion)?"chimeSdkVersion: string expected":null!=e.clientUtcOffset&&e.hasOwnProperty("clientUtcOffset")&&!s.isString(e.clientUtcOffset)?"clientUtcOffset: string expected":null},e.fromObject=function(e){if(e instanceof a.SdkClientDetails)return e;var t=new a.SdkClientDetails;return null!=e.appName&&(t.appName=String(e.appName)),null!=e.appVersion&&(t.appVersion=String(e.appVersion)),null!=e.deviceModel&&(t.deviceModel=String(e.deviceModel)),null!=e.deviceMake&&(t.deviceMake=String(e.deviceMake)),null!=e.platformName&&(t.platformName=String(e.platformName)),null!=e.platformVersion&&(t.platformVersion=String(e.platformVersion)),null!=e.clientSource&&(t.clientSource=String(e.clientSource)),null!=e.chimeSdkVersion&&(t.chimeSdkVersion=String(e.chimeSdkVersion)),null!=e.clientUtcOffset&&(t.clientUtcOffset=String(e.clientUtcOffset)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.appName="",i.appVersion="",i.deviceModel="",i.deviceMake="",i.platformName="",i.platformVersion="",i.clientSource="",i.chimeSdkVersion="",i.clientUtcOffset=""),null!=e.appName&&e.hasOwnProperty("appName")&&(i.appName=e.appName),null!=e.appVersion&&e.hasOwnProperty("appVersion")&&(i.appVersion=e.appVersion),null!=e.deviceModel&&e.hasOwnProperty("deviceModel")&&(i.deviceModel=e.deviceModel),null!=e.deviceMake&&e.hasOwnProperty("deviceMake")&&(i.deviceMake=e.deviceMake),null!=e.platformName&&e.hasOwnProperty("platformName")&&(i.platformName=e.platformName),null!=e.platformVersion&&e.hasOwnProperty("platformVersion")&&(i.platformVersion=e.platformVersion),null!=e.clientSource&&e.hasOwnProperty("clientSource")&&(i.clientSource=e.clientSource),null!=e.chimeSdkVersion&&e.hasOwnProperty("chimeSdkVersion")&&(i.chimeSdkVersion=e.chimeSdkVersion),null!=e.clientUtcOffset&&e.hasOwnProperty("clientUtcOffset")&&(i.clientUtcOffset=e.clientUtcOffset),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkClientDetails"},e}(),a.SdkServerSideNetworkAdaption=function(){var e={},t=Object.create(e);return t[e[1]="DEFAULT"]=1,t[e[2]="NONE"]=2,t[e[3]="BANDWIDTH_PROBING"]=3,t[e[4]="BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION"]=4,t}(),a.SdkJoinFrame=function(){function e(e){if(this.supportedServerSideNetworkAdaptions=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.protocolVersion=2,e.prototype.maxNumOfVideos=0,e.prototype.flags=0,e.prototype.clientDetails=null,e.prototype.audioSessionId=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.wantsCompressedSdp=!1,e.prototype.serverSideNetworkAdaption=1,e.prototype.supportedServerSideNetworkAdaptions=s.emptyArray,e.prototype.wantsAllTemporalLayersInIndex=!1,e.prototype.disablePeriodicKeyframeRequestOnContentSender=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.protocolVersion&&Object.hasOwnProperty.call(e,"protocolVersion")&&t.uint32(8).uint32(e.protocolVersion),null!=e.maxNumOfVideos&&Object.hasOwnProperty.call(e,"maxNumOfVideos")&&t.uint32(16).uint32(e.maxNumOfVideos),null!=e.flags&&Object.hasOwnProperty.call(e,"flags")&&t.uint32(24).uint32(e.flags),null!=e.clientDetails&&Object.hasOwnProperty.call(e,"clientDetails")&&a.SdkClientDetails.encode(e.clientDetails,t.uint32(34).fork()).ldelim(),null!=e.audioSessionId&&Object.hasOwnProperty.call(e,"audioSessionId")&&t.uint32(48).uint64(e.audioSessionId),null!=e.wantsCompressedSdp&&Object.hasOwnProperty.call(e,"wantsCompressedSdp")&&t.uint32(56).bool(e.wantsCompressedSdp),null!=e.serverSideNetworkAdaption&&Object.hasOwnProperty.call(e,"serverSideNetworkAdaption")&&t.uint32(80).int32(e.serverSideNetworkAdaption),null!=e.supportedServerSideNetworkAdaptions&&e.supportedServerSideNetworkAdaptions.length)for(var i=0;i<e.supportedServerSideNetworkAdaptions.length;++i)t.uint32(88).int32(e.supportedServerSideNetworkAdaptions[i]);return null!=e.wantsAllTemporalLayersInIndex&&Object.hasOwnProperty.call(e,"wantsAllTemporalLayersInIndex")&&t.uint32(96).bool(e.wantsAllTemporalLayersInIndex),null!=e.disablePeriodicKeyframeRequestOnContentSender&&Object.hasOwnProperty.call(e,"disablePeriodicKeyframeRequestOnContentSender")&&t.uint32(104).bool(e.disablePeriodicKeyframeRequestOnContentSender),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkJoinFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.protocolVersion=e.uint32();break;case 2:r.maxNumOfVideos=e.uint32();break;case 3:r.flags=e.uint32();break;case 4:r.clientDetails=a.SdkClientDetails.decode(e,e.uint32());break;case 6:r.audioSessionId=e.uint64();break;case 7:r.wantsCompressedSdp=e.bool();break;case 10:r.serverSideNetworkAdaption=e.int32();break;case 11:if(r.supportedServerSideNetworkAdaptions&&r.supportedServerSideNetworkAdaptions.length||(r.supportedServerSideNetworkAdaptions=[]),(7&o)==2)for(var s=e.uint32()+e.pos;e.pos<s;)r.supportedServerSideNetworkAdaptions.push(e.int32());else r.supportedServerSideNetworkAdaptions.push(e.int32());break;case 12:r.wantsAllTemporalLayersInIndex=e.bool();break;case 13:r.disablePeriodicKeyframeRequestOnContentSender=e.bool();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.protocolVersion&&e.hasOwnProperty("protocolVersion")&&!s.isInteger(e.protocolVersion))return"protocolVersion: integer expected";if(null!=e.maxNumOfVideos&&e.hasOwnProperty("maxNumOfVideos")&&!s.isInteger(e.maxNumOfVideos))return"maxNumOfVideos: integer expected";if(null!=e.flags&&e.hasOwnProperty("flags")&&!s.isInteger(e.flags))return"flags: integer expected";if(null!=e.clientDetails&&e.hasOwnProperty("clientDetails")){var t=a.SdkClientDetails.verify(e.clientDetails);if(t)return"clientDetails."+t}if(null!=e.audioSessionId&&e.hasOwnProperty("audioSessionId")&&!s.isInteger(e.audioSessionId)&&!(e.audioSessionId&&s.isInteger(e.audioSessionId.low)&&s.isInteger(e.audioSessionId.high)))return"audioSessionId: integer|Long expected";if(null!=e.wantsCompressedSdp&&e.hasOwnProperty("wantsCompressedSdp")&&"boolean"!=typeof e.wantsCompressedSdp)return"wantsCompressedSdp: boolean expected";if(null!=e.serverSideNetworkAdaption&&e.hasOwnProperty("serverSideNetworkAdaption"))switch(e.serverSideNetworkAdaption){default:return"serverSideNetworkAdaption: enum value expected";case 1:case 2:case 3:case 4:}if(null!=e.supportedServerSideNetworkAdaptions&&e.hasOwnProperty("supportedServerSideNetworkAdaptions")){if(!Array.isArray(e.supportedServerSideNetworkAdaptions))return"supportedServerSideNetworkAdaptions: array expected";for(var i=0;i<e.supportedServerSideNetworkAdaptions.length;++i)switch(e.supportedServerSideNetworkAdaptions[i]){default:return"supportedServerSideNetworkAdaptions: enum value[] expected";case 1:case 2:case 3:case 4:}}return null!=e.wantsAllTemporalLayersInIndex&&e.hasOwnProperty("wantsAllTemporalLayersInIndex")&&"boolean"!=typeof e.wantsAllTemporalLayersInIndex?"wantsAllTemporalLayersInIndex: boolean expected":null!=e.disablePeriodicKeyframeRequestOnContentSender&&e.hasOwnProperty("disablePeriodicKeyframeRequestOnContentSender")&&"boolean"!=typeof e.disablePeriodicKeyframeRequestOnContentSender?"disablePeriodicKeyframeRequestOnContentSender: boolean expected":null},e.fromObject=function(e){if(e instanceof a.SdkJoinFrame)return e;var t=new a.SdkJoinFrame;if(null!=e.protocolVersion&&(t.protocolVersion=e.protocolVersion>>>0),null!=e.maxNumOfVideos&&(t.maxNumOfVideos=e.maxNumOfVideos>>>0),null!=e.flags&&(t.flags=e.flags>>>0),null!=e.clientDetails){if("object"!=typeof e.clientDetails)throw TypeError(".SdkJoinFrame.clientDetails: object expected");t.clientDetails=a.SdkClientDetails.fromObject(e.clientDetails)}switch(null!=e.audioSessionId&&(s.Long?(t.audioSessionId=s.Long.fromValue(e.audioSessionId)).unsigned=!0:"string"==typeof e.audioSessionId?t.audioSessionId=parseInt(e.audioSessionId,10):"number"==typeof e.audioSessionId?t.audioSessionId=e.audioSessionId:"object"==typeof e.audioSessionId&&(t.audioSessionId=new s.LongBits(e.audioSessionId.low>>>0,e.audioSessionId.high>>>0).toNumber(!0))),null!=e.wantsCompressedSdp&&(t.wantsCompressedSdp=!!e.wantsCompressedSdp),e.serverSideNetworkAdaption){default:"number"==typeof e.serverSideNetworkAdaption&&(t.serverSideNetworkAdaption=e.serverSideNetworkAdaption);break;case"DEFAULT":case 1:t.serverSideNetworkAdaption=1;break;case"NONE":case 2:t.serverSideNetworkAdaption=2;break;case"BANDWIDTH_PROBING":case 3:t.serverSideNetworkAdaption=3;break;case"BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION":case 4:t.serverSideNetworkAdaption=4}if(e.supportedServerSideNetworkAdaptions){if(!Array.isArray(e.supportedServerSideNetworkAdaptions))throw TypeError(".SdkJoinFrame.supportedServerSideNetworkAdaptions: array expected");t.supportedServerSideNetworkAdaptions=[];for(var i=0;i<e.supportedServerSideNetworkAdaptions.length;++i)switch(e.supportedServerSideNetworkAdaptions[i]){default:if("number"==typeof e.supportedServerSideNetworkAdaptions[i]){t.supportedServerSideNetworkAdaptions[i]=e.supportedServerSideNetworkAdaptions[i];break}case"DEFAULT":case 1:t.supportedServerSideNetworkAdaptions[i]=1;break;case"NONE":case 2:t.supportedServerSideNetworkAdaptions[i]=2;break;case"BANDWIDTH_PROBING":case 3:t.supportedServerSideNetworkAdaptions[i]=3;break;case"BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION":case 4:t.supportedServerSideNetworkAdaptions[i]=4}}return null!=e.wantsAllTemporalLayersInIndex&&(t.wantsAllTemporalLayersInIndex=!!e.wantsAllTemporalLayersInIndex),null!=e.disablePeriodicKeyframeRequestOnContentSender&&(t.disablePeriodicKeyframeRequestOnContentSender=!!e.disablePeriodicKeyframeRequestOnContentSender),t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.supportedServerSideNetworkAdaptions=[]),t.defaults){if(i.protocolVersion=2,i.maxNumOfVideos=0,i.flags=0,i.clientDetails=null,s.Long){var r=new s.Long(0,0,!0);i.audioSessionId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.audioSessionId=t.longs===String?"0":0;i.wantsCompressedSdp=!1,i.serverSideNetworkAdaption=t.enums===String?"DEFAULT":1,i.wantsAllTemporalLayersInIndex=!1,i.disablePeriodicKeyframeRequestOnContentSender=!1}if(null!=e.protocolVersion&&e.hasOwnProperty("protocolVersion")&&(i.protocolVersion=e.protocolVersion),null!=e.maxNumOfVideos&&e.hasOwnProperty("maxNumOfVideos")&&(i.maxNumOfVideos=e.maxNumOfVideos),null!=e.flags&&e.hasOwnProperty("flags")&&(i.flags=e.flags),null!=e.clientDetails&&e.hasOwnProperty("clientDetails")&&(i.clientDetails=a.SdkClientDetails.toObject(e.clientDetails,t)),null!=e.audioSessionId&&e.hasOwnProperty("audioSessionId")&&("number"==typeof e.audioSessionId?i.audioSessionId=t.longs===String?String(e.audioSessionId):e.audioSessionId:i.audioSessionId=t.longs===String?s.Long.prototype.toString.call(e.audioSessionId):t.longs===Number?new s.LongBits(e.audioSessionId.low>>>0,e.audioSessionId.high>>>0).toNumber(!0):e.audioSessionId),null!=e.wantsCompressedSdp&&e.hasOwnProperty("wantsCompressedSdp")&&(i.wantsCompressedSdp=e.wantsCompressedSdp),null!=e.serverSideNetworkAdaption&&e.hasOwnProperty("serverSideNetworkAdaption")&&(i.serverSideNetworkAdaption=t.enums===String?void 0===a.SdkServerSideNetworkAdaption[e.serverSideNetworkAdaption]?e.serverSideNetworkAdaption:a.SdkServerSideNetworkAdaption[e.serverSideNetworkAdaption]:e.serverSideNetworkAdaption),e.supportedServerSideNetworkAdaptions&&e.supportedServerSideNetworkAdaptions.length){i.supportedServerSideNetworkAdaptions=[];for(var n=0;n<e.supportedServerSideNetworkAdaptions.length;++n)i.supportedServerSideNetworkAdaptions[n]=t.enums===String?void 0===a.SdkServerSideNetworkAdaption[e.supportedServerSideNetworkAdaptions[n]]?e.supportedServerSideNetworkAdaptions[n]:a.SdkServerSideNetworkAdaption[e.supportedServerSideNetworkAdaptions[n]]:e.supportedServerSideNetworkAdaptions[n]}return null!=e.wantsAllTemporalLayersInIndex&&e.hasOwnProperty("wantsAllTemporalLayersInIndex")&&(i.wantsAllTemporalLayersInIndex=e.wantsAllTemporalLayersInIndex),null!=e.disablePeriodicKeyframeRequestOnContentSender&&e.hasOwnProperty("disablePeriodicKeyframeRequestOnContentSender")&&(i.disablePeriodicKeyframeRequestOnContentSender=e.disablePeriodicKeyframeRequestOnContentSender),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkJoinFrame"},e}(),a.SdkJoinAckFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.turnCredentials=null,e.prototype.videoSubscriptionLimit=0,e.prototype.wantsCompressedSdp=!1,e.prototype.defaultServerSideNetworkAdaption=1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.turnCredentials&&Object.hasOwnProperty.call(e,"turnCredentials")&&a.SdkTurnCredentials.encode(e.turnCredentials,t.uint32(10).fork()).ldelim(),null!=e.videoSubscriptionLimit&&Object.hasOwnProperty.call(e,"videoSubscriptionLimit")&&t.uint32(16).uint32(e.videoSubscriptionLimit),null!=e.wantsCompressedSdp&&Object.hasOwnProperty.call(e,"wantsCompressedSdp")&&t.uint32(24).bool(e.wantsCompressedSdp),null!=e.defaultServerSideNetworkAdaption&&Object.hasOwnProperty.call(e,"defaultServerSideNetworkAdaption")&&t.uint32(32).int32(e.defaultServerSideNetworkAdaption),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkJoinAckFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.turnCredentials=a.SdkTurnCredentials.decode(e,e.uint32());break;case 2:r.videoSubscriptionLimit=e.uint32();break;case 3:r.wantsCompressedSdp=e.bool();break;case 4:r.defaultServerSideNetworkAdaption=e.int32();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.turnCredentials&&e.hasOwnProperty("turnCredentials")){var t=a.SdkTurnCredentials.verify(e.turnCredentials);if(t)return"turnCredentials."+t}if(null!=e.videoSubscriptionLimit&&e.hasOwnProperty("videoSubscriptionLimit")&&!s.isInteger(e.videoSubscriptionLimit))return"videoSubscriptionLimit: integer expected";if(null!=e.wantsCompressedSdp&&e.hasOwnProperty("wantsCompressedSdp")&&"boolean"!=typeof e.wantsCompressedSdp)return"wantsCompressedSdp: boolean expected";if(null!=e.defaultServerSideNetworkAdaption&&e.hasOwnProperty("defaultServerSideNetworkAdaption"))switch(e.defaultServerSideNetworkAdaption){default:return"defaultServerSideNetworkAdaption: enum value expected";case 1:case 2:case 3:case 4:}return null},e.fromObject=function(e){if(e instanceof a.SdkJoinAckFrame)return e;var t=new a.SdkJoinAckFrame;if(null!=e.turnCredentials){if("object"!=typeof e.turnCredentials)throw TypeError(".SdkJoinAckFrame.turnCredentials: object expected");t.turnCredentials=a.SdkTurnCredentials.fromObject(e.turnCredentials)}switch(null!=e.videoSubscriptionLimit&&(t.videoSubscriptionLimit=e.videoSubscriptionLimit>>>0),null!=e.wantsCompressedSdp&&(t.wantsCompressedSdp=!!e.wantsCompressedSdp),e.defaultServerSideNetworkAdaption){default:"number"==typeof e.defaultServerSideNetworkAdaption&&(t.defaultServerSideNetworkAdaption=e.defaultServerSideNetworkAdaption);break;case"DEFAULT":case 1:t.defaultServerSideNetworkAdaption=1;break;case"NONE":case 2:t.defaultServerSideNetworkAdaption=2;break;case"BANDWIDTH_PROBING":case 3:t.defaultServerSideNetworkAdaption=3;break;case"BANDWIDTH_PROBING_AND_VIDEO_QUALITY_ADAPTION":case 4:t.defaultServerSideNetworkAdaption=4}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.turnCredentials=null,i.videoSubscriptionLimit=0,i.wantsCompressedSdp=!1,i.defaultServerSideNetworkAdaption=t.enums===String?"DEFAULT":1),null!=e.turnCredentials&&e.hasOwnProperty("turnCredentials")&&(i.turnCredentials=a.SdkTurnCredentials.toObject(e.turnCredentials,t)),null!=e.videoSubscriptionLimit&&e.hasOwnProperty("videoSubscriptionLimit")&&(i.videoSubscriptionLimit=e.videoSubscriptionLimit),null!=e.wantsCompressedSdp&&e.hasOwnProperty("wantsCompressedSdp")&&(i.wantsCompressedSdp=e.wantsCompressedSdp),null!=e.defaultServerSideNetworkAdaption&&e.hasOwnProperty("defaultServerSideNetworkAdaption")&&(i.defaultServerSideNetworkAdaption=t.enums===String?void 0===a.SdkServerSideNetworkAdaption[e.defaultServerSideNetworkAdaption]?e.defaultServerSideNetworkAdaption:a.SdkServerSideNetworkAdaption[e.defaultServerSideNetworkAdaption]:e.defaultServerSideNetworkAdaption),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkJoinAckFrame"},e}(),a.SdkLeaveFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkLeaveFrame;e.pos<i;){var o=e.uint32();e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof a.SdkLeaveFrame?e:new a.SdkLeaveFrame},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkLeaveFrame"},e}(),a.SdkLeaveAckFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkLeaveAckFrame;e.pos<i;){var o=e.uint32();e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof a.SdkLeaveAckFrame?e:new a.SdkLeaveAckFrame},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkLeaveAckFrame"},e}(),a.SdkStreamServiceType=function(){var e={},t=Object.create(e);return t[e[1]="RX"]=1,t[e[2]="TX"]=2,t[e[3]="DUPLEX"]=3,t}(),a.SdkStreamMediaType=function(){var e={},t=Object.create(e);return t[e[1]="AUDIO"]=1,t[e[2]="VIDEO"]=2,t}(),a.SdkSubscribeFrame=function(){function e(e){if(this.sendStreams=[],this.receiveStreamIds=[],this.videoSubscriptionConfiguration=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.duplex=1,e.prototype.sendStreams=s.emptyArray,e.prototype.receiveStreamIds=s.emptyArray,e.prototype.sdpOffer="",e.prototype.audioHost="",e.prototype.audioCheckin=!1,e.prototype.audioMuted=!1,e.prototype.compressedSdpOffer=s.newBuffer([]),e.prototype.videoSubscriptionConfiguration=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.duplex&&Object.hasOwnProperty.call(e,"duplex")&&t.uint32(8).int32(e.duplex),null!=e.sendStreams&&e.sendStreams.length)for(var i=0;i<e.sendStreams.length;++i)a.SdkStreamDescriptor.encode(e.sendStreams[i],t.uint32(18).fork()).ldelim();if(null!=e.receiveStreamIds&&e.receiveStreamIds.length)for(var i=0;i<e.receiveStreamIds.length;++i)t.uint32(24).uint32(e.receiveStreamIds[i]);if(null!=e.sdpOffer&&Object.hasOwnProperty.call(e,"sdpOffer")&&t.uint32(34).string(e.sdpOffer),null!=e.audioHost&&Object.hasOwnProperty.call(e,"audioHost")&&t.uint32(42).string(e.audioHost),null!=e.audioCheckin&&Object.hasOwnProperty.call(e,"audioCheckin")&&t.uint32(48).bool(e.audioCheckin),null!=e.audioMuted&&Object.hasOwnProperty.call(e,"audioMuted")&&t.uint32(56).bool(e.audioMuted),null!=e.compressedSdpOffer&&Object.hasOwnProperty.call(e,"compressedSdpOffer")&&t.uint32(66).bytes(e.compressedSdpOffer),null!=e.videoSubscriptionConfiguration&&e.videoSubscriptionConfiguration.length)for(var i=0;i<e.videoSubscriptionConfiguration.length;++i)a.SdkVideoSubscriptionConfiguration.encode(e.videoSubscriptionConfiguration[i],t.uint32(74).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkSubscribeFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.duplex=e.int32();break;case 2:r.sendStreams&&r.sendStreams.length||(r.sendStreams=[]),r.sendStreams.push(a.SdkStreamDescriptor.decode(e,e.uint32()));break;case 3:if(r.receiveStreamIds&&r.receiveStreamIds.length||(r.receiveStreamIds=[]),(7&o)==2)for(var s=e.uint32()+e.pos;e.pos<s;)r.receiveStreamIds.push(e.uint32());else r.receiveStreamIds.push(e.uint32());break;case 4:r.sdpOffer=e.string();break;case 5:r.audioHost=e.string();break;case 6:r.audioCheckin=e.bool();break;case 7:r.audioMuted=e.bool();break;case 8:r.compressedSdpOffer=e.bytes();break;case 9:r.videoSubscriptionConfiguration&&r.videoSubscriptionConfiguration.length||(r.videoSubscriptionConfiguration=[]),r.videoSubscriptionConfiguration.push(a.SdkVideoSubscriptionConfiguration.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.duplex&&e.hasOwnProperty("duplex"))switch(e.duplex){default:return"duplex: enum value expected";case 1:case 2:case 3:}if(null!=e.sendStreams&&e.hasOwnProperty("sendStreams")){if(!Array.isArray(e.sendStreams))return"sendStreams: array expected";for(var t=0;t<e.sendStreams.length;++t){var i=a.SdkStreamDescriptor.verify(e.sendStreams[t]);if(i)return"sendStreams."+i}}if(null!=e.receiveStreamIds&&e.hasOwnProperty("receiveStreamIds")){if(!Array.isArray(e.receiveStreamIds))return"receiveStreamIds: array expected";for(var t=0;t<e.receiveStreamIds.length;++t)if(!s.isInteger(e.receiveStreamIds[t]))return"receiveStreamIds: integer[] expected"}if(null!=e.sdpOffer&&e.hasOwnProperty("sdpOffer")&&!s.isString(e.sdpOffer))return"sdpOffer: string expected";if(null!=e.audioHost&&e.hasOwnProperty("audioHost")&&!s.isString(e.audioHost))return"audioHost: string expected";if(null!=e.audioCheckin&&e.hasOwnProperty("audioCheckin")&&"boolean"!=typeof e.audioCheckin)return"audioCheckin: boolean expected";if(null!=e.audioMuted&&e.hasOwnProperty("audioMuted")&&"boolean"!=typeof e.audioMuted)return"audioMuted: boolean expected";if(null!=e.compressedSdpOffer&&e.hasOwnProperty("compressedSdpOffer")&&!(e.compressedSdpOffer&&"number"==typeof e.compressedSdpOffer.length||s.isString(e.compressedSdpOffer)))return"compressedSdpOffer: buffer expected";if(null!=e.videoSubscriptionConfiguration&&e.hasOwnProperty("videoSubscriptionConfiguration")){if(!Array.isArray(e.videoSubscriptionConfiguration))return"videoSubscriptionConfiguration: array expected";for(var t=0;t<e.videoSubscriptionConfiguration.length;++t){var i=a.SdkVideoSubscriptionConfiguration.verify(e.videoSubscriptionConfiguration[t]);if(i)return"videoSubscriptionConfiguration."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkSubscribeFrame)return e;var t=new a.SdkSubscribeFrame;switch(e.duplex){default:"number"==typeof e.duplex&&(t.duplex=e.duplex);break;case"RX":case 1:t.duplex=1;break;case"TX":case 2:t.duplex=2;break;case"DUPLEX":case 3:t.duplex=3}if(e.sendStreams){if(!Array.isArray(e.sendStreams))throw TypeError(".SdkSubscribeFrame.sendStreams: array expected");t.sendStreams=[];for(var i=0;i<e.sendStreams.length;++i){if("object"!=typeof e.sendStreams[i])throw TypeError(".SdkSubscribeFrame.sendStreams: object expected");t.sendStreams[i]=a.SdkStreamDescriptor.fromObject(e.sendStreams[i])}}if(e.receiveStreamIds){if(!Array.isArray(e.receiveStreamIds))throw TypeError(".SdkSubscribeFrame.receiveStreamIds: array expected");t.receiveStreamIds=[];for(var i=0;i<e.receiveStreamIds.length;++i)t.receiveStreamIds[i]=e.receiveStreamIds[i]>>>0}if(null!=e.sdpOffer&&(t.sdpOffer=String(e.sdpOffer)),null!=e.audioHost&&(t.audioHost=String(e.audioHost)),null!=e.audioCheckin&&(t.audioCheckin=!!e.audioCheckin),null!=e.audioMuted&&(t.audioMuted=!!e.audioMuted),null!=e.compressedSdpOffer&&("string"==typeof e.compressedSdpOffer?s.base64.decode(e.compressedSdpOffer,t.compressedSdpOffer=s.newBuffer(s.base64.length(e.compressedSdpOffer)),0):e.compressedSdpOffer.length>=0&&(t.compressedSdpOffer=e.compressedSdpOffer)),e.videoSubscriptionConfiguration){if(!Array.isArray(e.videoSubscriptionConfiguration))throw TypeError(".SdkSubscribeFrame.videoSubscriptionConfiguration: array expected");t.videoSubscriptionConfiguration=[];for(var i=0;i<e.videoSubscriptionConfiguration.length;++i){if("object"!=typeof e.videoSubscriptionConfiguration[i])throw TypeError(".SdkSubscribeFrame.videoSubscriptionConfiguration: object expected");t.videoSubscriptionConfiguration[i]=a.SdkVideoSubscriptionConfiguration.fromObject(e.videoSubscriptionConfiguration[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.sendStreams=[],i.receiveStreamIds=[],i.videoSubscriptionConfiguration=[]),t.defaults&&(i.duplex=t.enums===String?"RX":1,i.sdpOffer="",i.audioHost="",i.audioCheckin=!1,i.audioMuted=!1,t.bytes===String?i.compressedSdpOffer="":(i.compressedSdpOffer=[],t.bytes!==Array&&(i.compressedSdpOffer=s.newBuffer(i.compressedSdpOffer)))),null!=e.duplex&&e.hasOwnProperty("duplex")&&(i.duplex=t.enums===String?void 0===a.SdkStreamServiceType[e.duplex]?e.duplex:a.SdkStreamServiceType[e.duplex]:e.duplex),e.sendStreams&&e.sendStreams.length){i.sendStreams=[];for(var r=0;r<e.sendStreams.length;++r)i.sendStreams[r]=a.SdkStreamDescriptor.toObject(e.sendStreams[r],t)}if(e.receiveStreamIds&&e.receiveStreamIds.length){i.receiveStreamIds=[];for(var r=0;r<e.receiveStreamIds.length;++r)i.receiveStreamIds[r]=e.receiveStreamIds[r]}if(null!=e.sdpOffer&&e.hasOwnProperty("sdpOffer")&&(i.sdpOffer=e.sdpOffer),null!=e.audioHost&&e.hasOwnProperty("audioHost")&&(i.audioHost=e.audioHost),null!=e.audioCheckin&&e.hasOwnProperty("audioCheckin")&&(i.audioCheckin=e.audioCheckin),null!=e.audioMuted&&e.hasOwnProperty("audioMuted")&&(i.audioMuted=e.audioMuted),null!=e.compressedSdpOffer&&e.hasOwnProperty("compressedSdpOffer")&&(i.compressedSdpOffer=t.bytes===String?s.base64.encode(e.compressedSdpOffer,0,e.compressedSdpOffer.length):t.bytes===Array?Array.prototype.slice.call(e.compressedSdpOffer):e.compressedSdpOffer),e.videoSubscriptionConfiguration&&e.videoSubscriptionConfiguration.length){i.videoSubscriptionConfiguration=[];for(var r=0;r<e.videoSubscriptionConfiguration.length;++r)i.videoSubscriptionConfiguration[r]=a.SdkVideoSubscriptionConfiguration.toObject(e.videoSubscriptionConfiguration[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkSubscribeFrame"},e}(),a.SdkSubscribeAckFrame=function(){function e(e){if(this.allocations=[],this.tracks=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.duplex=1,e.prototype.allocations=s.emptyArray,e.prototype.sdpAnswer="",e.prototype.tracks=s.emptyArray,e.prototype.compressedSdpAnswer=s.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.duplex&&Object.hasOwnProperty.call(e,"duplex")&&t.uint32(8).int32(e.duplex),null!=e.allocations&&e.allocations.length)for(var i=0;i<e.allocations.length;++i)a.SdkStreamAllocation.encode(e.allocations[i],t.uint32(18).fork()).ldelim();if(null!=e.sdpAnswer&&Object.hasOwnProperty.call(e,"sdpAnswer")&&t.uint32(26).string(e.sdpAnswer),null!=e.tracks&&e.tracks.length)for(var i=0;i<e.tracks.length;++i)a.SdkTrackMapping.encode(e.tracks[i],t.uint32(34).fork()).ldelim();return null!=e.compressedSdpAnswer&&Object.hasOwnProperty.call(e,"compressedSdpAnswer")&&t.uint32(42).bytes(e.compressedSdpAnswer),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkSubscribeAckFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.duplex=e.int32();break;case 2:r.allocations&&r.allocations.length||(r.allocations=[]),r.allocations.push(a.SdkStreamAllocation.decode(e,e.uint32()));break;case 3:r.sdpAnswer=e.string();break;case 4:r.tracks&&r.tracks.length||(r.tracks=[]),r.tracks.push(a.SdkTrackMapping.decode(e,e.uint32()));break;case 5:r.compressedSdpAnswer=e.bytes();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.duplex&&e.hasOwnProperty("duplex"))switch(e.duplex){default:return"duplex: enum value expected";case 1:case 2:case 3:}if(null!=e.allocations&&e.hasOwnProperty("allocations")){if(!Array.isArray(e.allocations))return"allocations: array expected";for(var t=0;t<e.allocations.length;++t){var i=a.SdkStreamAllocation.verify(e.allocations[t]);if(i)return"allocations."+i}}if(null!=e.sdpAnswer&&e.hasOwnProperty("sdpAnswer")&&!s.isString(e.sdpAnswer))return"sdpAnswer: string expected";if(null!=e.tracks&&e.hasOwnProperty("tracks")){if(!Array.isArray(e.tracks))return"tracks: array expected";for(var t=0;t<e.tracks.length;++t){var i=a.SdkTrackMapping.verify(e.tracks[t]);if(i)return"tracks."+i}}return null!=e.compressedSdpAnswer&&e.hasOwnProperty("compressedSdpAnswer")&&!(e.compressedSdpAnswer&&"number"==typeof e.compressedSdpAnswer.length||s.isString(e.compressedSdpAnswer))?"compressedSdpAnswer: buffer expected":null},e.fromObject=function(e){if(e instanceof a.SdkSubscribeAckFrame)return e;var t=new a.SdkSubscribeAckFrame;switch(e.duplex){default:"number"==typeof e.duplex&&(t.duplex=e.duplex);break;case"RX":case 1:t.duplex=1;break;case"TX":case 2:t.duplex=2;break;case"DUPLEX":case 3:t.duplex=3}if(e.allocations){if(!Array.isArray(e.allocations))throw TypeError(".SdkSubscribeAckFrame.allocations: array expected");t.allocations=[];for(var i=0;i<e.allocations.length;++i){if("object"!=typeof e.allocations[i])throw TypeError(".SdkSubscribeAckFrame.allocations: object expected");t.allocations[i]=a.SdkStreamAllocation.fromObject(e.allocations[i])}}if(null!=e.sdpAnswer&&(t.sdpAnswer=String(e.sdpAnswer)),e.tracks){if(!Array.isArray(e.tracks))throw TypeError(".SdkSubscribeAckFrame.tracks: array expected");t.tracks=[];for(var i=0;i<e.tracks.length;++i){if("object"!=typeof e.tracks[i])throw TypeError(".SdkSubscribeAckFrame.tracks: object expected");t.tracks[i]=a.SdkTrackMapping.fromObject(e.tracks[i])}}return null!=e.compressedSdpAnswer&&("string"==typeof e.compressedSdpAnswer?s.base64.decode(e.compressedSdpAnswer,t.compressedSdpAnswer=s.newBuffer(s.base64.length(e.compressedSdpAnswer)),0):e.compressedSdpAnswer.length>=0&&(t.compressedSdpAnswer=e.compressedSdpAnswer)),t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.allocations=[],i.tracks=[]),t.defaults&&(i.duplex=t.enums===String?"RX":1,i.sdpAnswer="",t.bytes===String?i.compressedSdpAnswer="":(i.compressedSdpAnswer=[],t.bytes!==Array&&(i.compressedSdpAnswer=s.newBuffer(i.compressedSdpAnswer)))),null!=e.duplex&&e.hasOwnProperty("duplex")&&(i.duplex=t.enums===String?void 0===a.SdkStreamServiceType[e.duplex]?e.duplex:a.SdkStreamServiceType[e.duplex]:e.duplex),e.allocations&&e.allocations.length){i.allocations=[];for(var r=0;r<e.allocations.length;++r)i.allocations[r]=a.SdkStreamAllocation.toObject(e.allocations[r],t)}if(null!=e.sdpAnswer&&e.hasOwnProperty("sdpAnswer")&&(i.sdpAnswer=e.sdpAnswer),e.tracks&&e.tracks.length){i.tracks=[];for(var r=0;r<e.tracks.length;++r)i.tracks[r]=a.SdkTrackMapping.toObject(e.tracks[r],t)}return null!=e.compressedSdpAnswer&&e.hasOwnProperty("compressedSdpAnswer")&&(i.compressedSdpAnswer=t.bytes===String?s.base64.encode(e.compressedSdpAnswer,0,e.compressedSdpAnswer.length):t.bytes===Array?Array.prototype.slice.call(e.compressedSdpAnswer):e.compressedSdpAnswer),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkSubscribeAckFrame"},e}(),a.SdkIndexFrame=function(){function e(e){if(this.sources=[],this.pausedAtSourceIds=[],this.supportedReceiveCodecIntersection=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.atCapacity=!1,e.prototype.sources=s.emptyArray,e.prototype.pausedAtSourceIds=s.emptyArray,e.prototype.numParticipants=0,e.prototype.supportedReceiveCodecIntersection=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.atCapacity&&Object.hasOwnProperty.call(e,"atCapacity")&&t.uint32(8).bool(e.atCapacity),null!=e.sources&&e.sources.length)for(var i=0;i<e.sources.length;++i)a.SdkStreamDescriptor.encode(e.sources[i],t.uint32(18).fork()).ldelim();if(null!=e.pausedAtSourceIds&&e.pausedAtSourceIds.length)for(var i=0;i<e.pausedAtSourceIds.length;++i)t.uint32(24).uint32(e.pausedAtSourceIds[i]);if(null!=e.numParticipants&&Object.hasOwnProperty.call(e,"numParticipants")&&t.uint32(32).uint32(e.numParticipants),null!=e.supportedReceiveCodecIntersection&&e.supportedReceiveCodecIntersection.length)for(var i=0;i<e.supportedReceiveCodecIntersection.length;++i)t.uint32(40).int32(e.supportedReceiveCodecIntersection[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkIndexFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.atCapacity=e.bool();break;case 2:r.sources&&r.sources.length||(r.sources=[]),r.sources.push(a.SdkStreamDescriptor.decode(e,e.uint32()));break;case 3:if(r.pausedAtSourceIds&&r.pausedAtSourceIds.length||(r.pausedAtSourceIds=[]),(7&o)==2)for(var s=e.uint32()+e.pos;e.pos<s;)r.pausedAtSourceIds.push(e.uint32());else r.pausedAtSourceIds.push(e.uint32());break;case 4:r.numParticipants=e.uint32();break;case 5:if(r.supportedReceiveCodecIntersection&&r.supportedReceiveCodecIntersection.length||(r.supportedReceiveCodecIntersection=[]),(7&o)==2)for(var s=e.uint32()+e.pos;e.pos<s;)r.supportedReceiveCodecIntersection.push(e.int32());else r.supportedReceiveCodecIntersection.push(e.int32());break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.atCapacity&&e.hasOwnProperty("atCapacity")&&"boolean"!=typeof e.atCapacity)return"atCapacity: boolean expected";if(null!=e.sources&&e.hasOwnProperty("sources")){if(!Array.isArray(e.sources))return"sources: array expected";for(var t=0;t<e.sources.length;++t){var i=a.SdkStreamDescriptor.verify(e.sources[t]);if(i)return"sources."+i}}if(null!=e.pausedAtSourceIds&&e.hasOwnProperty("pausedAtSourceIds")){if(!Array.isArray(e.pausedAtSourceIds))return"pausedAtSourceIds: array expected";for(var t=0;t<e.pausedAtSourceIds.length;++t)if(!s.isInteger(e.pausedAtSourceIds[t]))return"pausedAtSourceIds: integer[] expected"}if(null!=e.numParticipants&&e.hasOwnProperty("numParticipants")&&!s.isInteger(e.numParticipants))return"numParticipants: integer expected";if(null!=e.supportedReceiveCodecIntersection&&e.hasOwnProperty("supportedReceiveCodecIntersection")){if(!Array.isArray(e.supportedReceiveCodecIntersection))return"supportedReceiveCodecIntersection: array expected";for(var t=0;t<e.supportedReceiveCodecIntersection.length;++t)switch(e.supportedReceiveCodecIntersection[t]){default:return"supportedReceiveCodecIntersection: enum value[] expected";case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 11:}}return null},e.fromObject=function(e){if(e instanceof a.SdkIndexFrame)return e;var t=new a.SdkIndexFrame;if(null!=e.atCapacity&&(t.atCapacity=!!e.atCapacity),e.sources){if(!Array.isArray(e.sources))throw TypeError(".SdkIndexFrame.sources: array expected");t.sources=[];for(var i=0;i<e.sources.length;++i){if("object"!=typeof e.sources[i])throw TypeError(".SdkIndexFrame.sources: object expected");t.sources[i]=a.SdkStreamDescriptor.fromObject(e.sources[i])}}if(e.pausedAtSourceIds){if(!Array.isArray(e.pausedAtSourceIds))throw TypeError(".SdkIndexFrame.pausedAtSourceIds: array expected");t.pausedAtSourceIds=[];for(var i=0;i<e.pausedAtSourceIds.length;++i)t.pausedAtSourceIds[i]=e.pausedAtSourceIds[i]>>>0}if(null!=e.numParticipants&&(t.numParticipants=e.numParticipants>>>0),e.supportedReceiveCodecIntersection){if(!Array.isArray(e.supportedReceiveCodecIntersection))throw TypeError(".SdkIndexFrame.supportedReceiveCodecIntersection: array expected");t.supportedReceiveCodecIntersection=[];for(var i=0;i<e.supportedReceiveCodecIntersection.length;++i)switch(e.supportedReceiveCodecIntersection[i]){default:if("number"==typeof e.supportedReceiveCodecIntersection[i]){t.supportedReceiveCodecIntersection[i]=e.supportedReceiveCodecIntersection[i];break}case"VP8":case 1:t.supportedReceiveCodecIntersection[i]=1;break;case"H264_BASELINE_PROFILE":case 2:t.supportedReceiveCodecIntersection[i]=2;break;case"H264_CONSTRAINED_BASELINE_PROFILE":case 3:t.supportedReceiveCodecIntersection[i]=3;break;case"H264_MAIN_PROFILE":case 4:t.supportedReceiveCodecIntersection[i]=4;break;case"H264_HIGH_PROFILE":case 5:t.supportedReceiveCodecIntersection[i]=5;break;case"H264_CONSTRAINED_HIGH_PROFILE":case 6:t.supportedReceiveCodecIntersection[i]=6;break;case"VP9_PROFILE_0":case 8:t.supportedReceiveCodecIntersection[i]=8;break;case"AV1_MAIN_PROFILE":case 11:t.supportedReceiveCodecIntersection[i]=11}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.sources=[],i.pausedAtSourceIds=[],i.supportedReceiveCodecIntersection=[]),t.defaults&&(i.atCapacity=!1,i.numParticipants=0),null!=e.atCapacity&&e.hasOwnProperty("atCapacity")&&(i.atCapacity=e.atCapacity),e.sources&&e.sources.length){i.sources=[];for(var r=0;r<e.sources.length;++r)i.sources[r]=a.SdkStreamDescriptor.toObject(e.sources[r],t)}if(e.pausedAtSourceIds&&e.pausedAtSourceIds.length){i.pausedAtSourceIds=[];for(var r=0;r<e.pausedAtSourceIds.length;++r)i.pausedAtSourceIds[r]=e.pausedAtSourceIds[r]}if(null!=e.numParticipants&&e.hasOwnProperty("numParticipants")&&(i.numParticipants=e.numParticipants),e.supportedReceiveCodecIntersection&&e.supportedReceiveCodecIntersection.length){i.supportedReceiveCodecIntersection=[];for(var r=0;r<e.supportedReceiveCodecIntersection.length;++r)i.supportedReceiveCodecIntersection[r]=t.enums===String?void 0===a.SdkVideoCodecCapability[e.supportedReceiveCodecIntersection[r]]?e.supportedReceiveCodecIntersection[r]:a.SdkVideoCodecCapability[e.supportedReceiveCodecIntersection[r]]:e.supportedReceiveCodecIntersection[r]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkIndexFrame"},e}(),a.SdkPauseResumeFrame=function(){function e(e){if(this.streamIds=[],this.groupIds=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.streamIds=s.emptyArray,e.prototype.groupIds=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.streamIds&&e.streamIds.length)for(var i=0;i<e.streamIds.length;++i)t.uint32(8).uint32(e.streamIds[i]);if(null!=e.groupIds&&e.groupIds.length)for(var i=0;i<e.groupIds.length;++i)t.uint32(16).uint32(e.groupIds[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkPauseResumeFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:if(r.streamIds&&r.streamIds.length||(r.streamIds=[]),(7&o)==2)for(var s=e.uint32()+e.pos;e.pos<s;)r.streamIds.push(e.uint32());else r.streamIds.push(e.uint32());break;case 2:if(r.groupIds&&r.groupIds.length||(r.groupIds=[]),(7&o)==2)for(var s=e.uint32()+e.pos;e.pos<s;)r.groupIds.push(e.uint32());else r.groupIds.push(e.uint32());break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.streamIds&&e.hasOwnProperty("streamIds")){if(!Array.isArray(e.streamIds))return"streamIds: array expected";for(var t=0;t<e.streamIds.length;++t)if(!s.isInteger(e.streamIds[t]))return"streamIds: integer[] expected"}if(null!=e.groupIds&&e.hasOwnProperty("groupIds")){if(!Array.isArray(e.groupIds))return"groupIds: array expected";for(var t=0;t<e.groupIds.length;++t)if(!s.isInteger(e.groupIds[t]))return"groupIds: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof a.SdkPauseResumeFrame)return e;var t=new a.SdkPauseResumeFrame;if(e.streamIds){if(!Array.isArray(e.streamIds))throw TypeError(".SdkPauseResumeFrame.streamIds: array expected");t.streamIds=[];for(var i=0;i<e.streamIds.length;++i)t.streamIds[i]=e.streamIds[i]>>>0}if(e.groupIds){if(!Array.isArray(e.groupIds))throw TypeError(".SdkPauseResumeFrame.groupIds: array expected");t.groupIds=[];for(var i=0;i<e.groupIds.length;++i)t.groupIds[i]=e.groupIds[i]>>>0}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.streamIds=[],i.groupIds=[]),e.streamIds&&e.streamIds.length){i.streamIds=[];for(var r=0;r<e.streamIds.length;++r)i.streamIds[r]=e.streamIds[r]}if(e.groupIds&&e.groupIds.length){i.groupIds=[];for(var r=0;r<e.groupIds.length;++r)i.groupIds[r]=e.groupIds[r]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkPauseResumeFrame"},e}(),a.SdkBitrateFrame=function(){function e(e){if(this.bitrates=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.bitrates=s.emptyArray,e.prototype.serverAvailableOutgoingBitrate=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.bitrates&&e.bitrates.length)for(var i=0;i<e.bitrates.length;++i)a.SdkBitrate.encode(e.bitrates[i],t.uint32(10).fork()).ldelim();return null!=e.serverAvailableOutgoingBitrate&&Object.hasOwnProperty.call(e,"serverAvailableOutgoingBitrate")&&t.uint32(16).uint32(e.serverAvailableOutgoingBitrate),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkBitrateFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.bitrates&&r.bitrates.length||(r.bitrates=[]),r.bitrates.push(a.SdkBitrate.decode(e,e.uint32()));break;case 2:r.serverAvailableOutgoingBitrate=e.uint32();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.bitrates&&e.hasOwnProperty("bitrates")){if(!Array.isArray(e.bitrates))return"bitrates: array expected";for(var t=0;t<e.bitrates.length;++t){var i=a.SdkBitrate.verify(e.bitrates[t]);if(i)return"bitrates."+i}}return null!=e.serverAvailableOutgoingBitrate&&e.hasOwnProperty("serverAvailableOutgoingBitrate")&&!s.isInteger(e.serverAvailableOutgoingBitrate)?"serverAvailableOutgoingBitrate: integer expected":null},e.fromObject=function(e){if(e instanceof a.SdkBitrateFrame)return e;var t=new a.SdkBitrateFrame;if(e.bitrates){if(!Array.isArray(e.bitrates))throw TypeError(".SdkBitrateFrame.bitrates: array expected");t.bitrates=[];for(var i=0;i<e.bitrates.length;++i){if("object"!=typeof e.bitrates[i])throw TypeError(".SdkBitrateFrame.bitrates: object expected");t.bitrates[i]=a.SdkBitrate.fromObject(e.bitrates[i])}}return null!=e.serverAvailableOutgoingBitrate&&(t.serverAvailableOutgoingBitrate=e.serverAvailableOutgoingBitrate>>>0),t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.bitrates=[]),t.defaults&&(i.serverAvailableOutgoingBitrate=0),e.bitrates&&e.bitrates.length){i.bitrates=[];for(var r=0;r<e.bitrates.length;++r)i.bitrates[r]=a.SdkBitrate.toObject(e.bitrates[r],t)}return null!=e.serverAvailableOutgoingBitrate&&e.hasOwnProperty("serverAvailableOutgoingBitrate")&&(i.serverAvailableOutgoingBitrate=e.serverAvailableOutgoingBitrate),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkBitrateFrame"},e}(),a.SdkStreamDescriptor=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.streamId=0,e.prototype.framerate=0,e.prototype.maxBitrateKbps=0,e.prototype.trackLabel="",e.prototype.groupId=0,e.prototype.avgBitrateBps=0,e.prototype.attendeeId="",e.prototype.mediaType=1,e.prototype.externalUserId="",e.prototype.width=0,e.prototype.height=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(8).uint32(e.streamId),null!=e.framerate&&Object.hasOwnProperty.call(e,"framerate")&&t.uint32(16).uint32(e.framerate),null!=e.maxBitrateKbps&&Object.hasOwnProperty.call(e,"maxBitrateKbps")&&t.uint32(24).uint32(e.maxBitrateKbps),null!=e.trackLabel&&Object.hasOwnProperty.call(e,"trackLabel")&&t.uint32(34).string(e.trackLabel),null!=e.groupId&&Object.hasOwnProperty.call(e,"groupId")&&t.uint32(48).uint32(e.groupId),null!=e.avgBitrateBps&&Object.hasOwnProperty.call(e,"avgBitrateBps")&&t.uint32(56).uint32(e.avgBitrateBps),null!=e.attendeeId&&Object.hasOwnProperty.call(e,"attendeeId")&&t.uint32(66).string(e.attendeeId),null!=e.mediaType&&Object.hasOwnProperty.call(e,"mediaType")&&t.uint32(72).int32(e.mediaType),null!=e.externalUserId&&Object.hasOwnProperty.call(e,"externalUserId")&&t.uint32(82).string(e.externalUserId),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(88).uint32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(96).uint32(e.height),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkStreamDescriptor;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.streamId=e.uint32();break;case 2:r.framerate=e.uint32();break;case 3:r.maxBitrateKbps=e.uint32();break;case 4:r.trackLabel=e.string();break;case 6:r.groupId=e.uint32();break;case 7:r.avgBitrateBps=e.uint32();break;case 8:r.attendeeId=e.string();break;case 9:r.mediaType=e.int32();break;case 10:r.externalUserId=e.string();break;case 11:r.width=e.uint32();break;case 12:r.height=e.uint32();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.streamId&&e.hasOwnProperty("streamId")&&!s.isInteger(e.streamId))return"streamId: integer expected";if(null!=e.framerate&&e.hasOwnProperty("framerate")&&!s.isInteger(e.framerate))return"framerate: integer expected";if(null!=e.maxBitrateKbps&&e.hasOwnProperty("maxBitrateKbps")&&!s.isInteger(e.maxBitrateKbps))return"maxBitrateKbps: integer expected";if(null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&!s.isString(e.trackLabel))return"trackLabel: string expected";if(null!=e.groupId&&e.hasOwnProperty("groupId")&&!s.isInteger(e.groupId))return"groupId: integer expected";if(null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&!s.isInteger(e.avgBitrateBps))return"avgBitrateBps: integer expected";if(null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&!s.isString(e.attendeeId))return"attendeeId: string expected";if(null!=e.mediaType&&e.hasOwnProperty("mediaType"))switch(e.mediaType){default:return"mediaType: enum value expected";case 1:case 2:}return null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&!s.isString(e.externalUserId)?"externalUserId: string expected":null!=e.width&&e.hasOwnProperty("width")&&!s.isInteger(e.width)?"width: integer expected":null!=e.height&&e.hasOwnProperty("height")&&!s.isInteger(e.height)?"height: integer expected":null},e.fromObject=function(e){if(e instanceof a.SdkStreamDescriptor)return e;var t=new a.SdkStreamDescriptor;switch(null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.framerate&&(t.framerate=e.framerate>>>0),null!=e.maxBitrateKbps&&(t.maxBitrateKbps=e.maxBitrateKbps>>>0),null!=e.trackLabel&&(t.trackLabel=String(e.trackLabel)),null!=e.groupId&&(t.groupId=e.groupId>>>0),null!=e.avgBitrateBps&&(t.avgBitrateBps=e.avgBitrateBps>>>0),null!=e.attendeeId&&(t.attendeeId=String(e.attendeeId)),e.mediaType){default:"number"==typeof e.mediaType&&(t.mediaType=e.mediaType);break;case"AUDIO":case 1:t.mediaType=1;break;case"VIDEO":case 2:t.mediaType=2}return null!=e.externalUserId&&(t.externalUserId=String(e.externalUserId)),null!=e.width&&(t.width=e.width>>>0),null!=e.height&&(t.height=e.height>>>0),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.streamId=0,i.framerate=0,i.maxBitrateKbps=0,i.trackLabel="",i.groupId=0,i.avgBitrateBps=0,i.attendeeId="",i.mediaType=t.enums===String?"AUDIO":1,i.externalUserId="",i.width=0,i.height=0),null!=e.streamId&&e.hasOwnProperty("streamId")&&(i.streamId=e.streamId),null!=e.framerate&&e.hasOwnProperty("framerate")&&(i.framerate=e.framerate),null!=e.maxBitrateKbps&&e.hasOwnProperty("maxBitrateKbps")&&(i.maxBitrateKbps=e.maxBitrateKbps),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&(i.trackLabel=e.trackLabel),null!=e.groupId&&e.hasOwnProperty("groupId")&&(i.groupId=e.groupId),null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&(i.avgBitrateBps=e.avgBitrateBps),null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&(i.attendeeId=e.attendeeId),null!=e.mediaType&&e.hasOwnProperty("mediaType")&&(i.mediaType=t.enums===String?void 0===a.SdkStreamMediaType[e.mediaType]?e.mediaType:a.SdkStreamMediaType[e.mediaType]:e.mediaType),null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&(i.externalUserId=e.externalUserId),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),null!=e.height&&e.hasOwnProperty("height")&&(i.height=e.height),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkStreamDescriptor"},e}(),a.SdkStreamAllocation=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.trackLabel="",e.prototype.streamId=0,e.prototype.groupId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.trackLabel&&Object.hasOwnProperty.call(e,"trackLabel")&&t.uint32(10).string(e.trackLabel),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(16).uint32(e.streamId),null!=e.groupId&&Object.hasOwnProperty.call(e,"groupId")&&t.uint32(24).uint32(e.groupId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkStreamAllocation;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.trackLabel=e.string();break;case 2:r.streamId=e.uint32();break;case 3:r.groupId=e.uint32();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&!s.isString(e.trackLabel)?"trackLabel: string expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!s.isInteger(e.streamId)?"streamId: integer expected":null!=e.groupId&&e.hasOwnProperty("groupId")&&!s.isInteger(e.groupId)?"groupId: integer expected":null},e.fromObject=function(e){if(e instanceof a.SdkStreamAllocation)return e;var t=new a.SdkStreamAllocation;return null!=e.trackLabel&&(t.trackLabel=String(e.trackLabel)),null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.groupId&&(t.groupId=e.groupId>>>0),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.trackLabel="",i.streamId=0,i.groupId=0),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&(i.trackLabel=e.trackLabel),null!=e.streamId&&e.hasOwnProperty("streamId")&&(i.streamId=e.streamId),null!=e.groupId&&e.hasOwnProperty("groupId")&&(i.groupId=e.groupId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkStreamAllocation"},e}(),a.SdkTrackMapping=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.streamId=0,e.prototype.ssrc=0,e.prototype.trackLabel="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(8).uint32(e.streamId),null!=e.ssrc&&Object.hasOwnProperty.call(e,"ssrc")&&t.uint32(16).uint32(e.ssrc),null!=e.trackLabel&&Object.hasOwnProperty.call(e,"trackLabel")&&t.uint32(26).string(e.trackLabel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTrackMapping;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.streamId=e.uint32();break;case 2:r.ssrc=e.uint32();break;case 3:r.trackLabel=e.string();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!s.isInteger(e.streamId)?"streamId: integer expected":null!=e.ssrc&&e.hasOwnProperty("ssrc")&&!s.isInteger(e.ssrc)?"ssrc: integer expected":null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&!s.isString(e.trackLabel)?"trackLabel: string expected":null},e.fromObject=function(e){if(e instanceof a.SdkTrackMapping)return e;var t=new a.SdkTrackMapping;return null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.ssrc&&(t.ssrc=e.ssrc>>>0),null!=e.trackLabel&&(t.trackLabel=String(e.trackLabel)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.streamId=0,i.ssrc=0,i.trackLabel=""),null!=e.streamId&&e.hasOwnProperty("streamId")&&(i.streamId=e.streamId),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&(i.ssrc=e.ssrc),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&(i.trackLabel=e.trackLabel),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTrackMapping"},e}(),a.SdkBitrate=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.sourceStreamId=0,e.prototype.avgBitrateBps=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.sourceStreamId&&Object.hasOwnProperty.call(e,"sourceStreamId")&&t.uint32(8).uint32(e.sourceStreamId),null!=e.avgBitrateBps&&Object.hasOwnProperty.call(e,"avgBitrateBps")&&t.uint32(16).uint32(e.avgBitrateBps),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkBitrate;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.sourceStreamId=e.uint32();break;case 2:r.avgBitrateBps=e.uint32();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sourceStreamId&&e.hasOwnProperty("sourceStreamId")&&!s.isInteger(e.sourceStreamId)?"sourceStreamId: integer expected":null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&!s.isInteger(e.avgBitrateBps)?"avgBitrateBps: integer expected":null},e.fromObject=function(e){if(e instanceof a.SdkBitrate)return e;var t=new a.SdkBitrate;return null!=e.sourceStreamId&&(t.sourceStreamId=e.sourceStreamId>>>0),null!=e.avgBitrateBps&&(t.avgBitrateBps=e.avgBitrateBps>>>0),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.sourceStreamId=0,i.avgBitrateBps=0),null!=e.sourceStreamId&&e.hasOwnProperty("sourceStreamId")&&(i.sourceStreamId=e.sourceStreamId),null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&(i.avgBitrateBps=e.avgBitrateBps),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkBitrate"},e}(),a.SdkAudioControlFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.muted=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.muted&&Object.hasOwnProperty.call(e,"muted")&&t.uint32(8).bool(e.muted),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkAudioControlFrame;e.pos<i;){var o=e.uint32();o>>>3==1?r.muted=e.bool():e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.muted&&e.hasOwnProperty("muted")&&"boolean"!=typeof e.muted?"muted: boolean expected":null},e.fromObject=function(e){if(e instanceof a.SdkAudioControlFrame)return e;var t=new a.SdkAudioControlFrame;return null!=e.muted&&(t.muted=!!e.muted),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.muted=!1),null!=e.muted&&e.hasOwnProperty("muted")&&(i.muted=e.muted),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkAudioControlFrame"},e}(),a.SdkAudioMetadataFrame=function(){function e(e){if(this.attendeeStates=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.attendeeStates=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.attendeeStates&&e.attendeeStates.length)for(var i=0;i<e.attendeeStates.length;++i)a.SdkAudioAttendeeState.encode(e.attendeeStates[i],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkAudioMetadataFrame;e.pos<i;){var o=e.uint32();o>>>3==1?(r.attendeeStates&&r.attendeeStates.length||(r.attendeeStates=[]),r.attendeeStates.push(a.SdkAudioAttendeeState.decode(e,e.uint32()))):e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.attendeeStates&&e.hasOwnProperty("attendeeStates")){if(!Array.isArray(e.attendeeStates))return"attendeeStates: array expected";for(var t=0;t<e.attendeeStates.length;++t){var i=a.SdkAudioAttendeeState.verify(e.attendeeStates[t]);if(i)return"attendeeStates."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkAudioMetadataFrame)return e;var t=new a.SdkAudioMetadataFrame;if(e.attendeeStates){if(!Array.isArray(e.attendeeStates))throw TypeError(".SdkAudioMetadataFrame.attendeeStates: array expected");t.attendeeStates=[];for(var i=0;i<e.attendeeStates.length;++i){if("object"!=typeof e.attendeeStates[i])throw TypeError(".SdkAudioMetadataFrame.attendeeStates: object expected");t.attendeeStates[i]=a.SdkAudioAttendeeState.fromObject(e.attendeeStates[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.attendeeStates=[]),e.attendeeStates&&e.attendeeStates.length){i.attendeeStates=[];for(var r=0;r<e.attendeeStates.length;++r)i.attendeeStates[r]=a.SdkAudioAttendeeState.toObject(e.attendeeStates[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkAudioMetadataFrame"},e}(),a.SdkAudioAttendeeState=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.audioStreamId=0,e.prototype.volume=0,e.prototype.muted=!1,e.prototype.signalStrength=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.audioStreamId&&Object.hasOwnProperty.call(e,"audioStreamId")&&t.uint32(8).uint32(e.audioStreamId),null!=e.volume&&Object.hasOwnProperty.call(e,"volume")&&t.uint32(16).uint32(e.volume),null!=e.muted&&Object.hasOwnProperty.call(e,"muted")&&t.uint32(24).bool(e.muted),null!=e.signalStrength&&Object.hasOwnProperty.call(e,"signalStrength")&&t.uint32(32).uint32(e.signalStrength),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkAudioAttendeeState;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.audioStreamId=e.uint32();break;case 2:r.volume=e.uint32();break;case 3:r.muted=e.bool();break;case 4:r.signalStrength=e.uint32();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&!s.isInteger(e.audioStreamId)?"audioStreamId: integer expected":null!=e.volume&&e.hasOwnProperty("volume")&&!s.isInteger(e.volume)?"volume: integer expected":null!=e.muted&&e.hasOwnProperty("muted")&&"boolean"!=typeof e.muted?"muted: boolean expected":null!=e.signalStrength&&e.hasOwnProperty("signalStrength")&&!s.isInteger(e.signalStrength)?"signalStrength: integer expected":null},e.fromObject=function(e){if(e instanceof a.SdkAudioAttendeeState)return e;var t=new a.SdkAudioAttendeeState;return null!=e.audioStreamId&&(t.audioStreamId=e.audioStreamId>>>0),null!=e.volume&&(t.volume=e.volume>>>0),null!=e.muted&&(t.muted=!!e.muted),null!=e.signalStrength&&(t.signalStrength=e.signalStrength>>>0),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.audioStreamId=0,i.volume=0,i.muted=!1,i.signalStrength=0),null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&(i.audioStreamId=e.audioStreamId),null!=e.volume&&e.hasOwnProperty("volume")&&(i.volume=e.volume),null!=e.muted&&e.hasOwnProperty("muted")&&(i.muted=e.muted),null!=e.signalStrength&&e.hasOwnProperty("signalStrength")&&(i.signalStrength=e.signalStrength),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkAudioAttendeeState"},e}(),a.SdkAudioStreamIdInfoFrame=function(){function e(e){if(this.streams=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.streams=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.streams&&e.streams.length)for(var i=0;i<e.streams.length;++i)a.SdkAudioStreamIdInfo.encode(e.streams[i],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkAudioStreamIdInfoFrame;e.pos<i;){var o=e.uint32();o>>>3==1?(r.streams&&r.streams.length||(r.streams=[]),r.streams.push(a.SdkAudioStreamIdInfo.decode(e,e.uint32()))):e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.streams&&e.hasOwnProperty("streams")){if(!Array.isArray(e.streams))return"streams: array expected";for(var t=0;t<e.streams.length;++t){var i=a.SdkAudioStreamIdInfo.verify(e.streams[t]);if(i)return"streams."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkAudioStreamIdInfoFrame)return e;var t=new a.SdkAudioStreamIdInfoFrame;if(e.streams){if(!Array.isArray(e.streams))throw TypeError(".SdkAudioStreamIdInfoFrame.streams: array expected");t.streams=[];for(var i=0;i<e.streams.length;++i){if("object"!=typeof e.streams[i])throw TypeError(".SdkAudioStreamIdInfoFrame.streams: object expected");t.streams[i]=a.SdkAudioStreamIdInfo.fromObject(e.streams[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.streams=[]),e.streams&&e.streams.length){i.streams=[];for(var r=0;r<e.streams.length;++r)i.streams[r]=a.SdkAudioStreamIdInfo.toObject(e.streams[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkAudioStreamIdInfoFrame"},e}(),a.SdkAudioStreamIdInfo=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.audioStreamId=0,e.prototype.attendeeId="",e.prototype.muted=!1,e.prototype.externalUserId="",e.prototype.dropped=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.audioStreamId&&Object.hasOwnProperty.call(e,"audioStreamId")&&t.uint32(8).uint32(e.audioStreamId),null!=e.attendeeId&&Object.hasOwnProperty.call(e,"attendeeId")&&t.uint32(18).string(e.attendeeId),null!=e.muted&&Object.hasOwnProperty.call(e,"muted")&&t.uint32(24).bool(e.muted),null!=e.externalUserId&&Object.hasOwnProperty.call(e,"externalUserId")&&t.uint32(34).string(e.externalUserId),null!=e.dropped&&Object.hasOwnProperty.call(e,"dropped")&&t.uint32(40).bool(e.dropped),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkAudioStreamIdInfo;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.audioStreamId=e.uint32();break;case 2:r.attendeeId=e.string();break;case 3:r.muted=e.bool();break;case 4:r.externalUserId=e.string();break;case 5:r.dropped=e.bool();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&!s.isInteger(e.audioStreamId)?"audioStreamId: integer expected":null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&!s.isString(e.attendeeId)?"attendeeId: string expected":null!=e.muted&&e.hasOwnProperty("muted")&&"boolean"!=typeof e.muted?"muted: boolean expected":null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&!s.isString(e.externalUserId)?"externalUserId: string expected":null!=e.dropped&&e.hasOwnProperty("dropped")&&"boolean"!=typeof e.dropped?"dropped: boolean expected":null},e.fromObject=function(e){if(e instanceof a.SdkAudioStreamIdInfo)return e;var t=new a.SdkAudioStreamIdInfo;return null!=e.audioStreamId&&(t.audioStreamId=e.audioStreamId>>>0),null!=e.attendeeId&&(t.attendeeId=String(e.attendeeId)),null!=e.muted&&(t.muted=!!e.muted),null!=e.externalUserId&&(t.externalUserId=String(e.externalUserId)),null!=e.dropped&&(t.dropped=!!e.dropped),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.audioStreamId=0,i.attendeeId="",i.muted=!1,i.externalUserId="",i.dropped=!1),null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&(i.audioStreamId=e.audioStreamId),null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&(i.attendeeId=e.attendeeId),null!=e.muted&&e.hasOwnProperty("muted")&&(i.muted=e.muted),null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&(i.externalUserId=e.externalUserId),null!=e.dropped&&e.hasOwnProperty("dropped")&&(i.dropped=e.dropped),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkAudioStreamIdInfo"},e}(),a.SdkPingPongType=function(){var e={},t=Object.create(e);return t[e[1]="PING"]=1,t[e[2]="PONG"]=2,t}(),a.SdkPingPongFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.type=1,e.prototype.pingId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),t.uint32(8).int32(e.type),t.uint32(16).uint32(e.pingId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkPingPongFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.type=e.int32();break;case 2:r.pingId=e.uint32();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("type"))throw s.ProtocolError("missing required 'type'",{instance:r});if(!r.hasOwnProperty("pingId"))throw s.ProtocolError("missing required 'pingId'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";switch(e.type){default:return"type: enum value expected";case 1:case 2:}return s.isInteger(e.pingId)?null:"pingId: integer expected"},e.fromObject=function(e){if(e instanceof a.SdkPingPongFrame)return e;var t=new a.SdkPingPongFrame;switch(e.type){default:"number"==typeof e.type&&(t.type=e.type);break;case"PING":case 1:t.type=1;break;case"PONG":case 2:t.type=2}return null!=e.pingId&&(t.pingId=e.pingId>>>0),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.type=t.enums===String?"PING":1,i.pingId=0),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?void 0===a.SdkPingPongType[e.type]?e.type:a.SdkPingPongType[e.type]:e.type),null!=e.pingId&&e.hasOwnProperty("pingId")&&(i.pingId=e.pingId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkPingPongFrame"},e}(),a.SdkAudioStatusFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.audioStatus=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.audioStatus&&Object.hasOwnProperty.call(e,"audioStatus")&&t.uint32(8).uint32(e.audioStatus),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkAudioStatusFrame;e.pos<i;){var o=e.uint32();o>>>3==1?r.audioStatus=e.uint32():e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&!s.isInteger(e.audioStatus)?"audioStatus: integer expected":null},e.fromObject=function(e){if(e instanceof a.SdkAudioStatusFrame)return e;var t=new a.SdkAudioStatusFrame;return null!=e.audioStatus&&(t.audioStatus=e.audioStatus>>>0),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.audioStatus=0),null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&(i.audioStatus=e.audioStatus),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkAudioStatusFrame"},e}(),a.SdkMetric=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.type=1,e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkMetric;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.type=e.int32();break;case 2:r.value=e.double();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 60:case 64:case 66:case 69:case 72:case 86:case 87:case 88:case 89:case 90:case 91:case 92:case 93:case 94:case 95:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:}return null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value?"value: number expected":null},e.fromObject=function(e){if(e instanceof a.SdkMetric)return e;var t=new a.SdkMetric;switch(e.type){default:"number"==typeof e.type&&(t.type=e.type);break;case"VIDEO_ACTUAL_ENCODER_BITRATE":case 1:t.type=1;break;case"VIDEO_AVAILABLE_SEND_BANDWIDTH":case 2:t.type=2;break;case"VIDEO_RETRANSMIT_BITRATE":case 3:t.type=3;break;case"VIDEO_AVAILABLE_RECEIVE_BANDWIDTH":case 4:t.type=4;break;case"VIDEO_TARGET_ENCODER_BITRATE":case 5:t.type=5;break;case"VIDEO_BUCKET_DELAY_MS":case 6:t.type=6;break;case"STUN_RTT_MS":case 7:t.type=7;break;case"SOCKET_DISCARDED_PPS":case 8:t.type=8;break;case"RTC_MIC_JITTER_MS":case 9:t.type=9;break;case"RTC_MIC_PPS":case 10:t.type=10;break;case"RTC_MIC_FRACTION_PACKET_LOST_PERCENT":case 11:t.type=11;break;case"RTC_MIC_BITRATE":case 12:t.type=12;break;case"RTC_MIC_RTT_MS":case 13:t.type=13;break;case"RTC_SPK_PPS":case 14:t.type=14;break;case"RTC_SPK_FRACTION_PACKET_LOST_PERCENT":case 15:t.type=15;break;case"RTC_SPK_JITTER_MS":case 16:t.type=16;break;case"RTC_SPK_FRACTION_DECODER_LOSS_PERCENT":case 17:t.type=17;break;case"RTC_SPK_BITRATE":case 18:t.type=18;break;case"RTC_SPK_CURRENT_DELAY_MS":case 19:t.type=19;break;case"RTC_SPK_JITTER_BUFFER_MS":case 20:t.type=20;break;case"VIDEO_SENT_RTT_MS":case 21:t.type=21;break;case"VIDEO_ENCODE_USAGE_PERCENT":case 22:t.type=22;break;case"VIDEO_NACKS_RECEIVED":case 23:t.type=23;break;case"VIDEO_PLIS_RECEIVED":case 24:t.type=24;break;case"VIDEO_ENCODE_MS":case 25:t.type=25;break;case"VIDEO_INPUT_FPS":case 26:t.type=26;break;case"VIDEO_ENCODE_FPS":case 27:t.type=27;break;case"VIDEO_SENT_FPS":case 28:t.type=28;break;case"VIDEO_FIRS_RECEIVED":case 29:t.type=29;break;case"VIDEO_SENT_PPS":case 30:t.type=30;break;case"VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT":case 31:t.type=31;break;case"VIDEO_SENT_BITRATE":case 32:t.type=32;break;case"VIDEO_DROPPED_FPS":case 33:t.type=33;break;case"VIDEO_TARGET_DELAY_MS":case 34:t.type=34;break;case"VIDEO_DECODE_MS":case 35:t.type=35;break;case"VIDEO_OUTPUT_FPS":case 36:t.type=36;break;case"VIDEO_RECEIVED_PPS":case 37:t.type=37;break;case"VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT":case 38:t.type=38;break;case"VIDEO_RENDER_DELAY_MS":case 39:t.type=39;break;case"VIDEO_RECEIVED_FPS":case 40:t.type=40;break;case"VIDEO_DECODE_FPS":case 41:t.type=41;break;case"VIDEO_NACKS_SENT":case 42:t.type=42;break;case"VIDEO_FIRS_SENT":case 43:t.type=43;break;case"VIDEO_RECEIVED_BITRATE":case 44:t.type=44;break;case"VIDEO_CURRENT_DELAY_MS":case 45:t.type=45;break;case"VIDEO_JITTER_BUFFER_MS":case 46:t.type=46;break;case"VIDEO_DISCARDED_PPS":case 47:t.type=47;break;case"VIDEO_PLIS_SENT":case 48:t.type=48;break;case"VIDEO_RECEIVED_JITTER_MS":case 49:t.type=49;break;case"VIDEO_INPUT_HEIGHT":case 60:t.type=60;break;case"VIDEO_ENCODE_HEIGHT":case 64:t.type=64;break;case"VIDEO_SENT_QP_SUM":case 66:t.type=66;break;case"VIDEO_DECODE_HEIGHT":case 69:t.type=69;break;case"VIDEO_RECEIVED_QP_SUM":case 72:t.type=72;break;case"VIDEO_ENCODE_WIDTH":case 86:t.type=86;break;case"VIDEO_DECODE_WIDTH":case 87:t.type=87;break;case"VIDEO_ENCODER_IS_HARDWARE":case 88:t.type=88;break;case"VIDEO_DECODER_IS_HARDWARE":case 89:t.type=89;break;case"VIDEO_FREEZE_COUNT":case 90:t.type=90;break;case"VIDEO_FREEZE_DURATION":case 91:t.type=91;break;case"VIDEO_PAUSE_COUNT":case 92:t.type=92;break;case"VIDEO_PAUSE_DURATION":case 93:t.type=93;break;case"VIDEO_QUALITY_REASON":case 94:t.type=94;break;case"VIDEO_PROCESSING_TIME":case 95:t.type=95;break;case"RTC_SPK_AUDIO_LEVEL":case 96:t.type=96;break;case"RTC_MIC_AUDIO_LEVEL":case 97:t.type=97;break;case"RTC_SPK_TOTAL_LOST":case 98:t.type=98;break;case"RTC_SPK_TOTAL_EXPECTED":case 99:t.type=99;break;case"RTC_SPK_TOTAL_RECOVERED_RED":case 100:t.type=100;break;case"RTC_SPK_TOTAL_RECOVERED_FEC":case 101:t.type=101;break;case"VIDEO_QUALITY_LIMITATION_DURATION_CPU":case 102:t.type=102;break;case"VIDEO_CODEC_DEGRADATION_HIGH_ENCODE_CPU":case 103:t.type=103;break;case"VIDEO_CODEC_DEGRADATION_ENCODE_FAILURE":case 104:t.type=104;break;case"VIDEO_RENDER_HEIGHT":case 105:t.type=105;break;case"VIDEO_RENDER_WIDTH":case 106:t.type=106;break;case"VIDEO_INPUT_WIDTH":case 107:t.type=107;break;case"VIDEO_SENT_JITTER_MS":case 108:t.type=108}return null!=e.value&&(t.value=Number(e.value)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.type=t.enums===String?"VIDEO_ACTUAL_ENCODER_BITRATE":1,i.value=0),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?void 0===a.SdkMetric.Type[e.type]?e.type:a.SdkMetric.Type[e.type]:e.type),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkMetric"},e.Type=function(){var e={},t=Object.create(e);return t[e[1]="VIDEO_ACTUAL_ENCODER_BITRATE"]=1,t[e[2]="VIDEO_AVAILABLE_SEND_BANDWIDTH"]=2,t[e[3]="VIDEO_RETRANSMIT_BITRATE"]=3,t[e[4]="VIDEO_AVAILABLE_RECEIVE_BANDWIDTH"]=4,t[e[5]="VIDEO_TARGET_ENCODER_BITRATE"]=5,t[e[6]="VIDEO_BUCKET_DELAY_MS"]=6,t[e[7]="STUN_RTT_MS"]=7,t[e[8]="SOCKET_DISCARDED_PPS"]=8,t[e[9]="RTC_MIC_JITTER_MS"]=9,t[e[10]="RTC_MIC_PPS"]=10,t[e[11]="RTC_MIC_FRACTION_PACKET_LOST_PERCENT"]=11,t[e[12]="RTC_MIC_BITRATE"]=12,t[e[13]="RTC_MIC_RTT_MS"]=13,t[e[14]="RTC_SPK_PPS"]=14,t[e[15]="RTC_SPK_FRACTION_PACKET_LOST_PERCENT"]=15,t[e[16]="RTC_SPK_JITTER_MS"]=16,t[e[17]="RTC_SPK_FRACTION_DECODER_LOSS_PERCENT"]=17,t[e[18]="RTC_SPK_BITRATE"]=18,t[e[19]="RTC_SPK_CURRENT_DELAY_MS"]=19,t[e[20]="RTC_SPK_JITTER_BUFFER_MS"]=20,t[e[21]="VIDEO_SENT_RTT_MS"]=21,t[e[22]="VIDEO_ENCODE_USAGE_PERCENT"]=22,t[e[23]="VIDEO_NACKS_RECEIVED"]=23,t[e[24]="VIDEO_PLIS_RECEIVED"]=24,t[e[25]="VIDEO_ENCODE_MS"]=25,t[e[26]="VIDEO_INPUT_FPS"]=26,t[e[27]="VIDEO_ENCODE_FPS"]=27,t[e[28]="VIDEO_SENT_FPS"]=28,t[e[29]="VIDEO_FIRS_RECEIVED"]=29,t[e[30]="VIDEO_SENT_PPS"]=30,t[e[31]="VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT"]=31,t[e[32]="VIDEO_SENT_BITRATE"]=32,t[e[33]="VIDEO_DROPPED_FPS"]=33,t[e[34]="VIDEO_TARGET_DELAY_MS"]=34,t[e[35]="VIDEO_DECODE_MS"]=35,t[e[36]="VIDEO_OUTPUT_FPS"]=36,t[e[37]="VIDEO_RECEIVED_PPS"]=37,t[e[38]="VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT"]=38,t[e[39]="VIDEO_RENDER_DELAY_MS"]=39,t[e[40]="VIDEO_RECEIVED_FPS"]=40,t[e[41]="VIDEO_DECODE_FPS"]=41,t[e[42]="VIDEO_NACKS_SENT"]=42,t[e[43]="VIDEO_FIRS_SENT"]=43,t[e[44]="VIDEO_RECEIVED_BITRATE"]=44,t[e[45]="VIDEO_CURRENT_DELAY_MS"]=45,t[e[46]="VIDEO_JITTER_BUFFER_MS"]=46,t[e[47]="VIDEO_DISCARDED_PPS"]=47,t[e[48]="VIDEO_PLIS_SENT"]=48,t[e[49]="VIDEO_RECEIVED_JITTER_MS"]=49,t[e[60]="VIDEO_INPUT_HEIGHT"]=60,t[e[64]="VIDEO_ENCODE_HEIGHT"]=64,t[e[66]="VIDEO_SENT_QP_SUM"]=66,t[e[69]="VIDEO_DECODE_HEIGHT"]=69,t[e[72]="VIDEO_RECEIVED_QP_SUM"]=72,t[e[86]="VIDEO_ENCODE_WIDTH"]=86,t[e[87]="VIDEO_DECODE_WIDTH"]=87,t[e[88]="VIDEO_ENCODER_IS_HARDWARE"]=88,t[e[89]="VIDEO_DECODER_IS_HARDWARE"]=89,t[e[90]="VIDEO_FREEZE_COUNT"]=90,t[e[91]="VIDEO_FREEZE_DURATION"]=91,t[e[92]="VIDEO_PAUSE_COUNT"]=92,t[e[93]="VIDEO_PAUSE_DURATION"]=93,t[e[94]="VIDEO_QUALITY_REASON"]=94,t[e[95]="VIDEO_PROCESSING_TIME"]=95,t[e[96]="RTC_SPK_AUDIO_LEVEL"]=96,t[e[97]="RTC_MIC_AUDIO_LEVEL"]=97,t[e[98]="RTC_SPK_TOTAL_LOST"]=98,t[e[99]="RTC_SPK_TOTAL_EXPECTED"]=99,t[e[100]="RTC_SPK_TOTAL_RECOVERED_RED"]=100,t[e[101]="RTC_SPK_TOTAL_RECOVERED_FEC"]=101,t[e[102]="VIDEO_QUALITY_LIMITATION_DURATION_CPU"]=102,t[e[103]="VIDEO_CODEC_DEGRADATION_HIGH_ENCODE_CPU"]=103,t[e[104]="VIDEO_CODEC_DEGRADATION_ENCODE_FAILURE"]=104,t[e[105]="VIDEO_RENDER_HEIGHT"]=105,t[e[106]="VIDEO_RENDER_WIDTH"]=106,t[e[107]="VIDEO_INPUT_WIDTH"]=107,t[e[108]="VIDEO_SENT_JITTER_MS"]=108,t}(),e}(),a.SdkStreamMetricFrame=function(){function e(e){if(this.metrics=[],this.dimensions=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.streamId=0,e.prototype.groupId=0,e.prototype.metrics=s.emptyArray,e.prototype.dimensions=s.emptyArray,e.prototype.mediaType=1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(24).uint32(e.streamId),null!=e.groupId&&Object.hasOwnProperty.call(e,"groupId")&&t.uint32(32).uint32(e.groupId),null!=e.metrics&&e.metrics.length)for(var i=0;i<e.metrics.length;++i)a.SdkMetric.encode(e.metrics[i],t.uint32(42).fork()).ldelim();if(null!=e.dimensions&&e.dimensions.length)for(var i=0;i<e.dimensions.length;++i)a.SdkStreamDimension.encode(e.dimensions[i],t.uint32(50).fork()).ldelim();return null!=e.mediaType&&Object.hasOwnProperty.call(e,"mediaType")&&t.uint32(56).int32(e.mediaType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkStreamMetricFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 3:r.streamId=e.uint32();break;case 4:r.groupId=e.uint32();break;case 5:r.metrics&&r.metrics.length||(r.metrics=[]),r.metrics.push(a.SdkMetric.decode(e,e.uint32()));break;case 6:r.dimensions&&r.dimensions.length||(r.dimensions=[]),r.dimensions.push(a.SdkStreamDimension.decode(e,e.uint32()));break;case 7:r.mediaType=e.int32();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.streamId&&e.hasOwnProperty("streamId")&&!s.isInteger(e.streamId))return"streamId: integer expected";if(null!=e.groupId&&e.hasOwnProperty("groupId")&&!s.isInteger(e.groupId))return"groupId: integer expected";if(null!=e.metrics&&e.hasOwnProperty("metrics")){if(!Array.isArray(e.metrics))return"metrics: array expected";for(var t=0;t<e.metrics.length;++t){var i=a.SdkMetric.verify(e.metrics[t]);if(i)return"metrics."+i}}if(null!=e.dimensions&&e.hasOwnProperty("dimensions")){if(!Array.isArray(e.dimensions))return"dimensions: array expected";for(var t=0;t<e.dimensions.length;++t){var i=a.SdkStreamDimension.verify(e.dimensions[t]);if(i)return"dimensions."+i}}if(null!=e.mediaType&&e.hasOwnProperty("mediaType"))switch(e.mediaType){default:return"mediaType: enum value expected";case 1:case 2:}return null},e.fromObject=function(e){if(e instanceof a.SdkStreamMetricFrame)return e;var t=new a.SdkStreamMetricFrame;if(null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.groupId&&(t.groupId=e.groupId>>>0),e.metrics){if(!Array.isArray(e.metrics))throw TypeError(".SdkStreamMetricFrame.metrics: array expected");t.metrics=[];for(var i=0;i<e.metrics.length;++i){if("object"!=typeof e.metrics[i])throw TypeError(".SdkStreamMetricFrame.metrics: object expected");t.metrics[i]=a.SdkMetric.fromObject(e.metrics[i])}}if(e.dimensions){if(!Array.isArray(e.dimensions))throw TypeError(".SdkStreamMetricFrame.dimensions: array expected");t.dimensions=[];for(var i=0;i<e.dimensions.length;++i){if("object"!=typeof e.dimensions[i])throw TypeError(".SdkStreamMetricFrame.dimensions: object expected");t.dimensions[i]=a.SdkStreamDimension.fromObject(e.dimensions[i])}}switch(e.mediaType){default:"number"==typeof e.mediaType&&(t.mediaType=e.mediaType);break;case"AUDIO":case 1:t.mediaType=1;break;case"VIDEO":case 2:t.mediaType=2}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.metrics=[],i.dimensions=[]),t.defaults&&(i.streamId=0,i.groupId=0,i.mediaType=t.enums===String?"AUDIO":1),null!=e.streamId&&e.hasOwnProperty("streamId")&&(i.streamId=e.streamId),null!=e.groupId&&e.hasOwnProperty("groupId")&&(i.groupId=e.groupId),e.metrics&&e.metrics.length){i.metrics=[];for(var r=0;r<e.metrics.length;++r)i.metrics[r]=a.SdkMetric.toObject(e.metrics[r],t)}if(e.dimensions&&e.dimensions.length){i.dimensions=[];for(var r=0;r<e.dimensions.length;++r)i.dimensions[r]=a.SdkStreamDimension.toObject(e.dimensions[r],t)}return null!=e.mediaType&&e.hasOwnProperty("mediaType")&&(i.mediaType=t.enums===String?void 0===a.SdkStreamMediaType[e.mediaType]?e.mediaType:a.SdkStreamMediaType[e.mediaType]:e.mediaType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkStreamMetricFrame"},e}(),a.SdkClientMetricFrame=function(){function e(e){if(this.globalMetrics=[],this.streamMetricFrames=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.globalMetrics=s.emptyArray,e.prototype.streamMetricFrames=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.globalMetrics&&e.globalMetrics.length)for(var i=0;i<e.globalMetrics.length;++i)a.SdkMetric.encode(e.globalMetrics[i],t.uint32(10).fork()).ldelim();if(null!=e.streamMetricFrames&&e.streamMetricFrames.length)for(var i=0;i<e.streamMetricFrames.length;++i)a.SdkStreamMetricFrame.encode(e.streamMetricFrames[i],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkClientMetricFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.globalMetrics&&r.globalMetrics.length||(r.globalMetrics=[]),r.globalMetrics.push(a.SdkMetric.decode(e,e.uint32()));break;case 2:r.streamMetricFrames&&r.streamMetricFrames.length||(r.streamMetricFrames=[]),r.streamMetricFrames.push(a.SdkStreamMetricFrame.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.globalMetrics&&e.hasOwnProperty("globalMetrics")){if(!Array.isArray(e.globalMetrics))return"globalMetrics: array expected";for(var t=0;t<e.globalMetrics.length;++t){var i=a.SdkMetric.verify(e.globalMetrics[t]);if(i)return"globalMetrics."+i}}if(null!=e.streamMetricFrames&&e.hasOwnProperty("streamMetricFrames")){if(!Array.isArray(e.streamMetricFrames))return"streamMetricFrames: array expected";for(var t=0;t<e.streamMetricFrames.length;++t){var i=a.SdkStreamMetricFrame.verify(e.streamMetricFrames[t]);if(i)return"streamMetricFrames."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkClientMetricFrame)return e;var t=new a.SdkClientMetricFrame;if(e.globalMetrics){if(!Array.isArray(e.globalMetrics))throw TypeError(".SdkClientMetricFrame.globalMetrics: array expected");t.globalMetrics=[];for(var i=0;i<e.globalMetrics.length;++i){if("object"!=typeof e.globalMetrics[i])throw TypeError(".SdkClientMetricFrame.globalMetrics: object expected");t.globalMetrics[i]=a.SdkMetric.fromObject(e.globalMetrics[i])}}if(e.streamMetricFrames){if(!Array.isArray(e.streamMetricFrames))throw TypeError(".SdkClientMetricFrame.streamMetricFrames: array expected");t.streamMetricFrames=[];for(var i=0;i<e.streamMetricFrames.length;++i){if("object"!=typeof e.streamMetricFrames[i])throw TypeError(".SdkClientMetricFrame.streamMetricFrames: object expected");t.streamMetricFrames[i]=a.SdkStreamMetricFrame.fromObject(e.streamMetricFrames[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.globalMetrics=[],i.streamMetricFrames=[]),e.globalMetrics&&e.globalMetrics.length){i.globalMetrics=[];for(var r=0;r<e.globalMetrics.length;++r)i.globalMetrics[r]=a.SdkMetric.toObject(e.globalMetrics[r],t)}if(e.streamMetricFrames&&e.streamMetricFrames.length){i.streamMetricFrames=[];for(var r=0;r<e.streamMetricFrames.length;++r)i.streamMetricFrames[r]=a.SdkStreamMetricFrame.toObject(e.streamMetricFrames[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkClientMetricFrame"},e}(),a.SdkStreamDimension=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.type=1,e.prototype.value=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&a.SdkDimensionValue.encode(e.value,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkStreamDimension;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.type=e.int32();break;case 2:r.value=a.SdkDimensionValue.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 1:case 2:}if(null!=e.value&&e.hasOwnProperty("value")){var t=a.SdkDimensionValue.verify(e.value);if(t)return"value."+t}return null},e.fromObject=function(e){if(e instanceof a.SdkStreamDimension)return e;var t=new a.SdkStreamDimension;switch(e.type){default:"number"==typeof e.type&&(t.type=e.type);break;case"VIDEO_ENCODER_NAME":case 1:t.type=1;break;case"VIDEO_DECODER_NAME":case 2:t.type=2}if(null!=e.value){if("object"!=typeof e.value)throw TypeError(".SdkStreamDimension.value: object expected");t.value=a.SdkDimensionValue.fromObject(e.value)}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.type=t.enums===String?"VIDEO_ENCODER_NAME":1,i.value=null),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?void 0===a.SdkStreamDimension.Type[e.type]?e.type:a.SdkStreamDimension.Type[e.type]:e.type),null!=e.value&&e.hasOwnProperty("value")&&(i.value=a.SdkDimensionValue.toObject(e.value,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkStreamDimension"},e.Type=function(){var e={},t=Object.create(e);return t[e[1]="VIDEO_ENCODER_NAME"]=1,t[e[2]="VIDEO_DECODER_NAME"]=2,t}(),e}(),a.SdkDimensionValue=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.stringValue="",e.prototype.boolValue=!1,e.prototype.uintValue=s.Long?s.Long.fromBits(0,0,!0):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.stringValue&&Object.hasOwnProperty.call(e,"stringValue")&&t.uint32(10).string(e.stringValue),null!=e.boolValue&&Object.hasOwnProperty.call(e,"boolValue")&&t.uint32(16).bool(e.boolValue),null!=e.uintValue&&Object.hasOwnProperty.call(e,"uintValue")&&t.uint32(24).uint64(e.uintValue),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkDimensionValue;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.stringValue=e.string();break;case 2:r.boolValue=e.bool();break;case 3:r.uintValue=e.uint64();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.stringValue&&e.hasOwnProperty("stringValue")&&!s.isString(e.stringValue)?"stringValue: string expected":null!=e.boolValue&&e.hasOwnProperty("boolValue")&&"boolean"!=typeof e.boolValue?"boolValue: boolean expected":null!=e.uintValue&&e.hasOwnProperty("uintValue")&&!s.isInteger(e.uintValue)&&!(e.uintValue&&s.isInteger(e.uintValue.low)&&s.isInteger(e.uintValue.high))?"uintValue: integer|Long expected":null},e.fromObject=function(e){if(e instanceof a.SdkDimensionValue)return e;var t=new a.SdkDimensionValue;return null!=e.stringValue&&(t.stringValue=String(e.stringValue)),null!=e.boolValue&&(t.boolValue=!!e.boolValue),null!=e.uintValue&&(s.Long?(t.uintValue=s.Long.fromValue(e.uintValue)).unsigned=!0:"string"==typeof e.uintValue?t.uintValue=parseInt(e.uintValue,10):"number"==typeof e.uintValue?t.uintValue=e.uintValue:"object"==typeof e.uintValue&&(t.uintValue=new s.LongBits(e.uintValue.low>>>0,e.uintValue.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(i.stringValue="",i.boolValue=!1,s.Long){var r=new s.Long(0,0,!0);i.uintValue=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.uintValue=t.longs===String?"0":0}return null!=e.stringValue&&e.hasOwnProperty("stringValue")&&(i.stringValue=e.stringValue),null!=e.boolValue&&e.hasOwnProperty("boolValue")&&(i.boolValue=e.boolValue),null!=e.uintValue&&e.hasOwnProperty("uintValue")&&("number"==typeof e.uintValue?i.uintValue=t.longs===String?String(e.uintValue):e.uintValue:i.uintValue=t.longs===String?s.Long.prototype.toString.call(e.uintValue):t.longs===Number?new s.LongBits(e.uintValue.low>>>0,e.uintValue.high>>>0).toNumber(!0):e.uintValue),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkDimensionValue"},e}(),a.SdkDataMessageFrame=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.messages=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.messages&&e.messages.length)for(var i=0;i<e.messages.length;++i)a.SdkDataMessagePayload.encode(e.messages[i],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkDataMessageFrame;e.pos<i;){var o=e.uint32();o>>>3==1?(r.messages&&r.messages.length||(r.messages=[]),r.messages.push(a.SdkDataMessagePayload.decode(e,e.uint32()))):e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.messages&&e.hasOwnProperty("messages")){if(!Array.isArray(e.messages))return"messages: array expected";for(var t=0;t<e.messages.length;++t){var i=a.SdkDataMessagePayload.verify(e.messages[t]);if(i)return"messages."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkDataMessageFrame)return e;var t=new a.SdkDataMessageFrame;if(e.messages){if(!Array.isArray(e.messages))throw TypeError(".SdkDataMessageFrame.messages: array expected");t.messages=[];for(var i=0;i<e.messages.length;++i){if("object"!=typeof e.messages[i])throw TypeError(".SdkDataMessageFrame.messages: object expected");t.messages[i]=a.SdkDataMessagePayload.fromObject(e.messages[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.messages=[]),e.messages&&e.messages.length){i.messages=[];for(var r=0;r<e.messages.length;++r)i.messages[r]=a.SdkDataMessagePayload.toObject(e.messages[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkDataMessageFrame"},e}(),a.SdkDataMessagePayload=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.topic="",e.prototype.data=s.newBuffer([]),e.prototype.lifetimeMs=0,e.prototype.senderAttendeeId="",e.prototype.ingestTimeNs=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.senderExternalUserId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.topic&&Object.hasOwnProperty.call(e,"topic")&&t.uint32(10).string(e.topic),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.lifetimeMs&&Object.hasOwnProperty.call(e,"lifetimeMs")&&t.uint32(24).uint32(e.lifetimeMs),null!=e.senderAttendeeId&&Object.hasOwnProperty.call(e,"senderAttendeeId")&&t.uint32(34).string(e.senderAttendeeId),null!=e.ingestTimeNs&&Object.hasOwnProperty.call(e,"ingestTimeNs")&&t.uint32(40).int64(e.ingestTimeNs),null!=e.senderExternalUserId&&Object.hasOwnProperty.call(e,"senderExternalUserId")&&t.uint32(50).string(e.senderExternalUserId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkDataMessagePayload;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.topic=e.string();break;case 2:r.data=e.bytes();break;case 3:r.lifetimeMs=e.uint32();break;case 4:r.senderAttendeeId=e.string();break;case 5:r.ingestTimeNs=e.int64();break;case 6:r.senderExternalUserId=e.string();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.topic&&e.hasOwnProperty("topic")&&!s.isString(e.topic)?"topic: string expected":null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||s.isString(e.data))?"data: buffer expected":null!=e.lifetimeMs&&e.hasOwnProperty("lifetimeMs")&&!s.isInteger(e.lifetimeMs)?"lifetimeMs: integer expected":null!=e.senderAttendeeId&&e.hasOwnProperty("senderAttendeeId")&&!s.isString(e.senderAttendeeId)?"senderAttendeeId: string expected":null!=e.ingestTimeNs&&e.hasOwnProperty("ingestTimeNs")&&!s.isInteger(e.ingestTimeNs)&&!(e.ingestTimeNs&&s.isInteger(e.ingestTimeNs.low)&&s.isInteger(e.ingestTimeNs.high))?"ingestTimeNs: integer|Long expected":null!=e.senderExternalUserId&&e.hasOwnProperty("senderExternalUserId")&&!s.isString(e.senderExternalUserId)?"senderExternalUserId: string expected":null},e.fromObject=function(e){if(e instanceof a.SdkDataMessagePayload)return e;var t=new a.SdkDataMessagePayload;return null!=e.topic&&(t.topic=String(e.topic)),null!=e.data&&("string"==typeof e.data?s.base64.decode(e.data,t.data=s.newBuffer(s.base64.length(e.data)),0):e.data.length>=0&&(t.data=e.data)),null!=e.lifetimeMs&&(t.lifetimeMs=e.lifetimeMs>>>0),null!=e.senderAttendeeId&&(t.senderAttendeeId=String(e.senderAttendeeId)),null!=e.ingestTimeNs&&(s.Long?(t.ingestTimeNs=s.Long.fromValue(e.ingestTimeNs)).unsigned=!1:"string"==typeof e.ingestTimeNs?t.ingestTimeNs=parseInt(e.ingestTimeNs,10):"number"==typeof e.ingestTimeNs?t.ingestTimeNs=e.ingestTimeNs:"object"==typeof e.ingestTimeNs&&(t.ingestTimeNs=new s.LongBits(e.ingestTimeNs.low>>>0,e.ingestTimeNs.high>>>0).toNumber())),null!=e.senderExternalUserId&&(t.senderExternalUserId=String(e.senderExternalUserId)),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(i.topic="",t.bytes===String?i.data="":(i.data=[],t.bytes!==Array&&(i.data=s.newBuffer(i.data))),i.lifetimeMs=0,i.senderAttendeeId="",s.Long){var r=new s.Long(0,0,!1);i.ingestTimeNs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.ingestTimeNs=t.longs===String?"0":0;i.senderExternalUserId=""}return null!=e.topic&&e.hasOwnProperty("topic")&&(i.topic=e.topic),null!=e.data&&e.hasOwnProperty("data")&&(i.data=t.bytes===String?s.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.lifetimeMs&&e.hasOwnProperty("lifetimeMs")&&(i.lifetimeMs=e.lifetimeMs),null!=e.senderAttendeeId&&e.hasOwnProperty("senderAttendeeId")&&(i.senderAttendeeId=e.senderAttendeeId),null!=e.ingestTimeNs&&e.hasOwnProperty("ingestTimeNs")&&("number"==typeof e.ingestTimeNs?i.ingestTimeNs=t.longs===String?String(e.ingestTimeNs):e.ingestTimeNs:i.ingestTimeNs=t.longs===String?s.Long.prototype.toString.call(e.ingestTimeNs):t.longs===Number?new s.LongBits(e.ingestTimeNs.low>>>0,e.ingestTimeNs.high>>>0).toNumber():e.ingestTimeNs),null!=e.senderExternalUserId&&e.hasOwnProperty("senderExternalUserId")&&(i.senderExternalUserId=e.senderExternalUserId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkDataMessagePayload"},e}(),a.SdkTurnCredentials=function(){function e(e){if(this.uris=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.username="",e.prototype.password="",e.prototype.ttl=0,e.prototype.uris=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.username&&Object.hasOwnProperty.call(e,"username")&&t.uint32(10).string(e.username),null!=e.password&&Object.hasOwnProperty.call(e,"password")&&t.uint32(18).string(e.password),null!=e.ttl&&Object.hasOwnProperty.call(e,"ttl")&&t.uint32(24).uint32(e.ttl),null!=e.uris&&e.uris.length)for(var i=0;i<e.uris.length;++i)t.uint32(34).string(e.uris[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTurnCredentials;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.username=e.string();break;case 2:r.password=e.string();break;case 3:r.ttl=e.uint32();break;case 4:r.uris&&r.uris.length||(r.uris=[]),r.uris.push(e.string());break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.username&&e.hasOwnProperty("username")&&!s.isString(e.username))return"username: string expected";if(null!=e.password&&e.hasOwnProperty("password")&&!s.isString(e.password))return"password: string expected";if(null!=e.ttl&&e.hasOwnProperty("ttl")&&!s.isInteger(e.ttl))return"ttl: integer expected";if(null!=e.uris&&e.hasOwnProperty("uris")){if(!Array.isArray(e.uris))return"uris: array expected";for(var t=0;t<e.uris.length;++t)if(!s.isString(e.uris[t]))return"uris: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.SdkTurnCredentials)return e;var t=new a.SdkTurnCredentials;if(null!=e.username&&(t.username=String(e.username)),null!=e.password&&(t.password=String(e.password)),null!=e.ttl&&(t.ttl=e.ttl>>>0),e.uris){if(!Array.isArray(e.uris))throw TypeError(".SdkTurnCredentials.uris: array expected");t.uris=[];for(var i=0;i<e.uris.length;++i)t.uris[i]=String(e.uris[i])}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.uris=[]),t.defaults&&(i.username="",i.password="",i.ttl=0),null!=e.username&&e.hasOwnProperty("username")&&(i.username=e.username),null!=e.password&&e.hasOwnProperty("password")&&(i.password=e.password),null!=e.ttl&&e.hasOwnProperty("ttl")&&(i.ttl=e.ttl),e.uris&&e.uris.length){i.uris=[];for(var r=0;r<e.uris.length;++r)i.uris[r]=e.uris[r]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTurnCredentials"},e}(),a.SdkTranscriptItem=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.content="",e.prototype.endTime=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.speakerAttendeeId="",e.prototype.speakerExternalUserId="",e.prototype.startTime=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.type=1,e.prototype.vocabularyFilterMatch=!1,e.prototype.confidence=0,e.prototype.stable=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(10).string(e.content),null!=e.endTime&&Object.hasOwnProperty.call(e,"endTime")&&t.uint32(16).int64(e.endTime),null!=e.speakerAttendeeId&&Object.hasOwnProperty.call(e,"speakerAttendeeId")&&t.uint32(26).string(e.speakerAttendeeId),null!=e.speakerExternalUserId&&Object.hasOwnProperty.call(e,"speakerExternalUserId")&&t.uint32(34).string(e.speakerExternalUserId),null!=e.startTime&&Object.hasOwnProperty.call(e,"startTime")&&t.uint32(40).int64(e.startTime),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(48).int32(e.type),null!=e.vocabularyFilterMatch&&Object.hasOwnProperty.call(e,"vocabularyFilterMatch")&&t.uint32(56).bool(e.vocabularyFilterMatch),null!=e.confidence&&Object.hasOwnProperty.call(e,"confidence")&&t.uint32(65).double(e.confidence),null!=e.stable&&Object.hasOwnProperty.call(e,"stable")&&t.uint32(72).bool(e.stable),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscriptItem;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.content=e.string();break;case 2:r.endTime=e.int64();break;case 3:r.speakerAttendeeId=e.string();break;case 4:r.speakerExternalUserId=e.string();break;case 5:r.startTime=e.int64();break;case 6:r.type=e.int32();break;case 7:r.vocabularyFilterMatch=e.bool();break;case 8:r.confidence=e.double();break;case 9:r.stable=e.bool();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.content&&e.hasOwnProperty("content")&&!s.isString(e.content))return"content: string expected";if(null!=e.endTime&&e.hasOwnProperty("endTime")&&!s.isInteger(e.endTime)&&!(e.endTime&&s.isInteger(e.endTime.low)&&s.isInteger(e.endTime.high)))return"endTime: integer|Long expected";if(null!=e.speakerAttendeeId&&e.hasOwnProperty("speakerAttendeeId")&&!s.isString(e.speakerAttendeeId))return"speakerAttendeeId: string expected";if(null!=e.speakerExternalUserId&&e.hasOwnProperty("speakerExternalUserId")&&!s.isString(e.speakerExternalUserId))return"speakerExternalUserId: string expected";if(null!=e.startTime&&e.hasOwnProperty("startTime")&&!s.isInteger(e.startTime)&&!(e.startTime&&s.isInteger(e.startTime.low)&&s.isInteger(e.startTime.high)))return"startTime: integer|Long expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 1:case 2:}return null!=e.vocabularyFilterMatch&&e.hasOwnProperty("vocabularyFilterMatch")&&"boolean"!=typeof e.vocabularyFilterMatch?"vocabularyFilterMatch: boolean expected":null!=e.confidence&&e.hasOwnProperty("confidence")&&"number"!=typeof e.confidence?"confidence: number expected":null!=e.stable&&e.hasOwnProperty("stable")&&"boolean"!=typeof e.stable?"stable: boolean expected":null},e.fromObject=function(e){if(e instanceof a.SdkTranscriptItem)return e;var t=new a.SdkTranscriptItem;switch(null!=e.content&&(t.content=String(e.content)),null!=e.endTime&&(s.Long?(t.endTime=s.Long.fromValue(e.endTime)).unsigned=!1:"string"==typeof e.endTime?t.endTime=parseInt(e.endTime,10):"number"==typeof e.endTime?t.endTime=e.endTime:"object"==typeof e.endTime&&(t.endTime=new s.LongBits(e.endTime.low>>>0,e.endTime.high>>>0).toNumber())),null!=e.speakerAttendeeId&&(t.speakerAttendeeId=String(e.speakerAttendeeId)),null!=e.speakerExternalUserId&&(t.speakerExternalUserId=String(e.speakerExternalUserId)),null!=e.startTime&&(s.Long?(t.startTime=s.Long.fromValue(e.startTime)).unsigned=!1:"string"==typeof e.startTime?t.startTime=parseInt(e.startTime,10):"number"==typeof e.startTime?t.startTime=e.startTime:"object"==typeof e.startTime&&(t.startTime=new s.LongBits(e.startTime.low>>>0,e.startTime.high>>>0).toNumber())),e.type){default:"number"==typeof e.type&&(t.type=e.type);break;case"PRONUNCIATION":case 1:t.type=1;break;case"PUNCTUATION":case 2:t.type=2}return null!=e.vocabularyFilterMatch&&(t.vocabularyFilterMatch=!!e.vocabularyFilterMatch),null!=e.confidence&&(t.confidence=Number(e.confidence)),null!=e.stable&&(t.stable=!!e.stable),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(i.content="",s.Long){var r=new s.Long(0,0,!1);i.endTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.endTime=t.longs===String?"0":0;if(i.speakerAttendeeId="",i.speakerExternalUserId="",s.Long){var r=new s.Long(0,0,!1);i.startTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.startTime=t.longs===String?"0":0;i.type=t.enums===String?"PRONUNCIATION":1,i.vocabularyFilterMatch=!1,i.confidence=0,i.stable=!1}return null!=e.content&&e.hasOwnProperty("content")&&(i.content=e.content),null!=e.endTime&&e.hasOwnProperty("endTime")&&("number"==typeof e.endTime?i.endTime=t.longs===String?String(e.endTime):e.endTime:i.endTime=t.longs===String?s.Long.prototype.toString.call(e.endTime):t.longs===Number?new s.LongBits(e.endTime.low>>>0,e.endTime.high>>>0).toNumber():e.endTime),null!=e.speakerAttendeeId&&e.hasOwnProperty("speakerAttendeeId")&&(i.speakerAttendeeId=e.speakerAttendeeId),null!=e.speakerExternalUserId&&e.hasOwnProperty("speakerExternalUserId")&&(i.speakerExternalUserId=e.speakerExternalUserId),null!=e.startTime&&e.hasOwnProperty("startTime")&&("number"==typeof e.startTime?i.startTime=t.longs===String?String(e.startTime):e.startTime:i.startTime=t.longs===String?s.Long.prototype.toString.call(e.startTime):t.longs===Number?new s.LongBits(e.startTime.low>>>0,e.startTime.high>>>0).toNumber():e.startTime),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?void 0===a.SdkTranscriptItem.Type[e.type]?e.type:a.SdkTranscriptItem.Type[e.type]:e.type),null!=e.vocabularyFilterMatch&&e.hasOwnProperty("vocabularyFilterMatch")&&(i.vocabularyFilterMatch=e.vocabularyFilterMatch),null!=e.confidence&&e.hasOwnProperty("confidence")&&(i.confidence=t.json&&!isFinite(e.confidence)?String(e.confidence):e.confidence),null!=e.stable&&e.hasOwnProperty("stable")&&(i.stable=e.stable),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscriptItem"},e.Type=function(){var e={},t=Object.create(e);return t[e[1]="PRONUNCIATION"]=1,t[e[2]="PUNCTUATION"]=2,t}(),e}(),a.SdkTranscriptEntity=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.category="",e.prototype.confidence=0,e.prototype.content="",e.prototype.endTime=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.startTime=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.type="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.category&&Object.hasOwnProperty.call(e,"category")&&t.uint32(10).string(e.category),null!=e.confidence&&Object.hasOwnProperty.call(e,"confidence")&&t.uint32(17).double(e.confidence),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(26).string(e.content),null!=e.endTime&&Object.hasOwnProperty.call(e,"endTime")&&t.uint32(32).int64(e.endTime),null!=e.startTime&&Object.hasOwnProperty.call(e,"startTime")&&t.uint32(40).int64(e.startTime),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(50).string(e.type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscriptEntity;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.category=e.string();break;case 2:r.confidence=e.double();break;case 3:r.content=e.string();break;case 4:r.endTime=e.int64();break;case 5:r.startTime=e.int64();break;case 6:r.type=e.string();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.category&&e.hasOwnProperty("category")&&!s.isString(e.category)?"category: string expected":null!=e.confidence&&e.hasOwnProperty("confidence")&&"number"!=typeof e.confidence?"confidence: number expected":null!=e.content&&e.hasOwnProperty("content")&&!s.isString(e.content)?"content: string expected":null!=e.endTime&&e.hasOwnProperty("endTime")&&!s.isInteger(e.endTime)&&!(e.endTime&&s.isInteger(e.endTime.low)&&s.isInteger(e.endTime.high))?"endTime: integer|Long expected":null!=e.startTime&&e.hasOwnProperty("startTime")&&!s.isInteger(e.startTime)&&!(e.startTime&&s.isInteger(e.startTime.low)&&s.isInteger(e.startTime.high))?"startTime: integer|Long expected":null!=e.type&&e.hasOwnProperty("type")&&!s.isString(e.type)?"type: string expected":null},e.fromObject=function(e){if(e instanceof a.SdkTranscriptEntity)return e;var t=new a.SdkTranscriptEntity;return null!=e.category&&(t.category=String(e.category)),null!=e.confidence&&(t.confidence=Number(e.confidence)),null!=e.content&&(t.content=String(e.content)),null!=e.endTime&&(s.Long?(t.endTime=s.Long.fromValue(e.endTime)).unsigned=!1:"string"==typeof e.endTime?t.endTime=parseInt(e.endTime,10):"number"==typeof e.endTime?t.endTime=e.endTime:"object"==typeof e.endTime&&(t.endTime=new s.LongBits(e.endTime.low>>>0,e.endTime.high>>>0).toNumber())),null!=e.startTime&&(s.Long?(t.startTime=s.Long.fromValue(e.startTime)).unsigned=!1:"string"==typeof e.startTime?t.startTime=parseInt(e.startTime,10):"number"==typeof e.startTime?t.startTime=e.startTime:"object"==typeof e.startTime&&(t.startTime=new s.LongBits(e.startTime.low>>>0,e.startTime.high>>>0).toNumber())),null!=e.type&&(t.type=String(e.type)),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(i.category="",i.confidence=0,i.content="",s.Long){var r=new s.Long(0,0,!1);i.endTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.endTime=t.longs===String?"0":0;if(s.Long){var r=new s.Long(0,0,!1);i.startTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.startTime=t.longs===String?"0":0;i.type=""}return null!=e.category&&e.hasOwnProperty("category")&&(i.category=e.category),null!=e.confidence&&e.hasOwnProperty("confidence")&&(i.confidence=t.json&&!isFinite(e.confidence)?String(e.confidence):e.confidence),null!=e.content&&e.hasOwnProperty("content")&&(i.content=e.content),null!=e.endTime&&e.hasOwnProperty("endTime")&&("number"==typeof e.endTime?i.endTime=t.longs===String?String(e.endTime):e.endTime:i.endTime=t.longs===String?s.Long.prototype.toString.call(e.endTime):t.longs===Number?new s.LongBits(e.endTime.low>>>0,e.endTime.high>>>0).toNumber():e.endTime),null!=e.startTime&&e.hasOwnProperty("startTime")&&("number"==typeof e.startTime?i.startTime=t.longs===String?String(e.startTime):e.startTime:i.startTime=t.longs===String?s.Long.prototype.toString.call(e.startTime):t.longs===Number?new s.LongBits(e.startTime.low>>>0,e.startTime.high>>>0).toNumber():e.startTime),null!=e.type&&e.hasOwnProperty("type")&&(i.type=e.type),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscriptEntity"},e}(),a.SdkTranscriptAlternative=function(){function e(e){if(this.items=[],this.entities=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.items=s.emptyArray,e.prototype.transcript="",e.prototype.entities=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.items&&e.items.length)for(var i=0;i<e.items.length;++i)a.SdkTranscriptItem.encode(e.items[i],t.uint32(10).fork()).ldelim();if(null!=e.transcript&&Object.hasOwnProperty.call(e,"transcript")&&t.uint32(18).string(e.transcript),null!=e.entities&&e.entities.length)for(var i=0;i<e.entities.length;++i)a.SdkTranscriptEntity.encode(e.entities[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscriptAlternative;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.items&&r.items.length||(r.items=[]),r.items.push(a.SdkTranscriptItem.decode(e,e.uint32()));break;case 2:r.transcript=e.string();break;case 3:r.entities&&r.entities.length||(r.entities=[]),r.entities.push(a.SdkTranscriptEntity.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.items&&e.hasOwnProperty("items")){if(!Array.isArray(e.items))return"items: array expected";for(var t=0;t<e.items.length;++t){var i=a.SdkTranscriptItem.verify(e.items[t]);if(i)return"items."+i}}if(null!=e.transcript&&e.hasOwnProperty("transcript")&&!s.isString(e.transcript))return"transcript: string expected";if(null!=e.entities&&e.hasOwnProperty("entities")){if(!Array.isArray(e.entities))return"entities: array expected";for(var t=0;t<e.entities.length;++t){var i=a.SdkTranscriptEntity.verify(e.entities[t]);if(i)return"entities."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkTranscriptAlternative)return e;var t=new a.SdkTranscriptAlternative;if(e.items){if(!Array.isArray(e.items))throw TypeError(".SdkTranscriptAlternative.items: array expected");t.items=[];for(var i=0;i<e.items.length;++i){if("object"!=typeof e.items[i])throw TypeError(".SdkTranscriptAlternative.items: object expected");t.items[i]=a.SdkTranscriptItem.fromObject(e.items[i])}}if(null!=e.transcript&&(t.transcript=String(e.transcript)),e.entities){if(!Array.isArray(e.entities))throw TypeError(".SdkTranscriptAlternative.entities: array expected");t.entities=[];for(var i=0;i<e.entities.length;++i){if("object"!=typeof e.entities[i])throw TypeError(".SdkTranscriptAlternative.entities: object expected");t.entities[i]=a.SdkTranscriptEntity.fromObject(e.entities[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.items=[],i.entities=[]),t.defaults&&(i.transcript=""),e.items&&e.items.length){i.items=[];for(var r=0;r<e.items.length;++r)i.items[r]=a.SdkTranscriptItem.toObject(e.items[r],t)}if(null!=e.transcript&&e.hasOwnProperty("transcript")&&(i.transcript=e.transcript),e.entities&&e.entities.length){i.entities=[];for(var r=0;r<e.entities.length;++r)i.entities[r]=a.SdkTranscriptEntity.toObject(e.entities[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscriptAlternative"},e}(),a.SdkTranscriptLanguageWithScore=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.languageCode="",e.prototype.score=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.languageCode&&Object.hasOwnProperty.call(e,"languageCode")&&t.uint32(10).string(e.languageCode),null!=e.score&&Object.hasOwnProperty.call(e,"score")&&t.uint32(17).double(e.score),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscriptLanguageWithScore;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.languageCode=e.string();break;case 2:r.score=e.double();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.languageCode&&e.hasOwnProperty("languageCode")&&!s.isString(e.languageCode)?"languageCode: string expected":null!=e.score&&e.hasOwnProperty("score")&&"number"!=typeof e.score?"score: number expected":null},e.fromObject=function(e){if(e instanceof a.SdkTranscriptLanguageWithScore)return e;var t=new a.SdkTranscriptLanguageWithScore;return null!=e.languageCode&&(t.languageCode=String(e.languageCode)),null!=e.score&&(t.score=Number(e.score)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.languageCode="",i.score=0),null!=e.languageCode&&e.hasOwnProperty("languageCode")&&(i.languageCode=e.languageCode),null!=e.score&&e.hasOwnProperty("score")&&(i.score=t.json&&!isFinite(e.score)?String(e.score):e.score),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscriptLanguageWithScore"},e}(),a.SdkTranscriptResult=function(){function e(e){if(this.alternatives=[],this.languageIdentification=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.alternatives=s.emptyArray,e.prototype.channelId="",e.prototype.endTime=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.isPartial=!1,e.prototype.resultId="",e.prototype.startTime=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.languageCode="",e.prototype.languageIdentification=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.alternatives&&e.alternatives.length)for(var i=0;i<e.alternatives.length;++i)a.SdkTranscriptAlternative.encode(e.alternatives[i],t.uint32(10).fork()).ldelim();if(null!=e.channelId&&Object.hasOwnProperty.call(e,"channelId")&&t.uint32(18).string(e.channelId),null!=e.endTime&&Object.hasOwnProperty.call(e,"endTime")&&t.uint32(24).int64(e.endTime),null!=e.isPartial&&Object.hasOwnProperty.call(e,"isPartial")&&t.uint32(32).bool(e.isPartial),null!=e.resultId&&Object.hasOwnProperty.call(e,"resultId")&&t.uint32(42).string(e.resultId),null!=e.startTime&&Object.hasOwnProperty.call(e,"startTime")&&t.uint32(48).int64(e.startTime),null!=e.languageCode&&Object.hasOwnProperty.call(e,"languageCode")&&t.uint32(58).string(e.languageCode),null!=e.languageIdentification&&e.languageIdentification.length)for(var i=0;i<e.languageIdentification.length;++i)a.SdkTranscriptLanguageWithScore.encode(e.languageIdentification[i],t.uint32(66).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscriptResult;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.alternatives&&r.alternatives.length||(r.alternatives=[]),r.alternatives.push(a.SdkTranscriptAlternative.decode(e,e.uint32()));break;case 2:r.channelId=e.string();break;case 3:r.endTime=e.int64();break;case 4:r.isPartial=e.bool();break;case 5:r.resultId=e.string();break;case 6:r.startTime=e.int64();break;case 7:r.languageCode=e.string();break;case 8:r.languageIdentification&&r.languageIdentification.length||(r.languageIdentification=[]),r.languageIdentification.push(a.SdkTranscriptLanguageWithScore.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.alternatives&&e.hasOwnProperty("alternatives")){if(!Array.isArray(e.alternatives))return"alternatives: array expected";for(var t=0;t<e.alternatives.length;++t){var i=a.SdkTranscriptAlternative.verify(e.alternatives[t]);if(i)return"alternatives."+i}}if(null!=e.channelId&&e.hasOwnProperty("channelId")&&!s.isString(e.channelId))return"channelId: string expected";if(null!=e.endTime&&e.hasOwnProperty("endTime")&&!s.isInteger(e.endTime)&&!(e.endTime&&s.isInteger(e.endTime.low)&&s.isInteger(e.endTime.high)))return"endTime: integer|Long expected";if(null!=e.isPartial&&e.hasOwnProperty("isPartial")&&"boolean"!=typeof e.isPartial)return"isPartial: boolean expected";if(null!=e.resultId&&e.hasOwnProperty("resultId")&&!s.isString(e.resultId))return"resultId: string expected";if(null!=e.startTime&&e.hasOwnProperty("startTime")&&!s.isInteger(e.startTime)&&!(e.startTime&&s.isInteger(e.startTime.low)&&s.isInteger(e.startTime.high)))return"startTime: integer|Long expected";if(null!=e.languageCode&&e.hasOwnProperty("languageCode")&&!s.isString(e.languageCode))return"languageCode: string expected";if(null!=e.languageIdentification&&e.hasOwnProperty("languageIdentification")){if(!Array.isArray(e.languageIdentification))return"languageIdentification: array expected";for(var t=0;t<e.languageIdentification.length;++t){var i=a.SdkTranscriptLanguageWithScore.verify(e.languageIdentification[t]);if(i)return"languageIdentification."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkTranscriptResult)return e;var t=new a.SdkTranscriptResult;if(e.alternatives){if(!Array.isArray(e.alternatives))throw TypeError(".SdkTranscriptResult.alternatives: array expected");t.alternatives=[];for(var i=0;i<e.alternatives.length;++i){if("object"!=typeof e.alternatives[i])throw TypeError(".SdkTranscriptResult.alternatives: object expected");t.alternatives[i]=a.SdkTranscriptAlternative.fromObject(e.alternatives[i])}}if(null!=e.channelId&&(t.channelId=String(e.channelId)),null!=e.endTime&&(s.Long?(t.endTime=s.Long.fromValue(e.endTime)).unsigned=!1:"string"==typeof e.endTime?t.endTime=parseInt(e.endTime,10):"number"==typeof e.endTime?t.endTime=e.endTime:"object"==typeof e.endTime&&(t.endTime=new s.LongBits(e.endTime.low>>>0,e.endTime.high>>>0).toNumber())),null!=e.isPartial&&(t.isPartial=!!e.isPartial),null!=e.resultId&&(t.resultId=String(e.resultId)),null!=e.startTime&&(s.Long?(t.startTime=s.Long.fromValue(e.startTime)).unsigned=!1:"string"==typeof e.startTime?t.startTime=parseInt(e.startTime,10):"number"==typeof e.startTime?t.startTime=e.startTime:"object"==typeof e.startTime&&(t.startTime=new s.LongBits(e.startTime.low>>>0,e.startTime.high>>>0).toNumber())),null!=e.languageCode&&(t.languageCode=String(e.languageCode)),e.languageIdentification){if(!Array.isArray(e.languageIdentification))throw TypeError(".SdkTranscriptResult.languageIdentification: array expected");t.languageIdentification=[];for(var i=0;i<e.languageIdentification.length;++i){if("object"!=typeof e.languageIdentification[i])throw TypeError(".SdkTranscriptResult.languageIdentification: object expected");t.languageIdentification[i]=a.SdkTranscriptLanguageWithScore.fromObject(e.languageIdentification[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.alternatives=[],i.languageIdentification=[]),t.defaults){if(i.channelId="",s.Long){var r=new s.Long(0,0,!1);i.endTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.endTime=t.longs===String?"0":0;if(i.isPartial=!1,i.resultId="",s.Long){var r=new s.Long(0,0,!1);i.startTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.startTime=t.longs===String?"0":0;i.languageCode=""}if(e.alternatives&&e.alternatives.length){i.alternatives=[];for(var n=0;n<e.alternatives.length;++n)i.alternatives[n]=a.SdkTranscriptAlternative.toObject(e.alternatives[n],t)}if(null!=e.channelId&&e.hasOwnProperty("channelId")&&(i.channelId=e.channelId),null!=e.endTime&&e.hasOwnProperty("endTime")&&("number"==typeof e.endTime?i.endTime=t.longs===String?String(e.endTime):e.endTime:i.endTime=t.longs===String?s.Long.prototype.toString.call(e.endTime):t.longs===Number?new s.LongBits(e.endTime.low>>>0,e.endTime.high>>>0).toNumber():e.endTime),null!=e.isPartial&&e.hasOwnProperty("isPartial")&&(i.isPartial=e.isPartial),null!=e.resultId&&e.hasOwnProperty("resultId")&&(i.resultId=e.resultId),null!=e.startTime&&e.hasOwnProperty("startTime")&&("number"==typeof e.startTime?i.startTime=t.longs===String?String(e.startTime):e.startTime:i.startTime=t.longs===String?s.Long.prototype.toString.call(e.startTime):t.longs===Number?new s.LongBits(e.startTime.low>>>0,e.startTime.high>>>0).toNumber():e.startTime),null!=e.languageCode&&e.hasOwnProperty("languageCode")&&(i.languageCode=e.languageCode),e.languageIdentification&&e.languageIdentification.length){i.languageIdentification=[];for(var n=0;n<e.languageIdentification.length;++n)i.languageIdentification[n]=a.SdkTranscriptLanguageWithScore.toObject(e.languageIdentification[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscriptResult"},e}(),a.SdkTranscript=function(){function e(e){if(this.results=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.results=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.results&&e.results.length)for(var i=0;i<e.results.length;++i)a.SdkTranscriptResult.encode(e.results[i],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscript;e.pos<i;){var o=e.uint32();o>>>3==1?(r.results&&r.results.length||(r.results=[]),r.results.push(a.SdkTranscriptResult.decode(e,e.uint32()))):e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.results&&e.hasOwnProperty("results")){if(!Array.isArray(e.results))return"results: array expected";for(var t=0;t<e.results.length;++t){var i=a.SdkTranscriptResult.verify(e.results[t]);if(i)return"results."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkTranscript)return e;var t=new a.SdkTranscript;if(e.results){if(!Array.isArray(e.results))throw TypeError(".SdkTranscript.results: array expected");t.results=[];for(var i=0;i<e.results.length;++i){if("object"!=typeof e.results[i])throw TypeError(".SdkTranscript.results: object expected");t.results[i]=a.SdkTranscriptResult.fromObject(e.results[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.results=[]),e.results&&e.results.length){i.results=[];for(var r=0;r<e.results.length;++r)i.results[r]=a.SdkTranscriptResult.toObject(e.results[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscript"},e}(),a.SdkTranscriptionStatus=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.type=1,e.prototype.eventTime=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.transcriptionRegion="",e.prototype.transcriptionConfiguration="",e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.eventTime&&Object.hasOwnProperty.call(e,"eventTime")&&t.uint32(16).int64(e.eventTime),null!=e.transcriptionRegion&&Object.hasOwnProperty.call(e,"transcriptionRegion")&&t.uint32(26).string(e.transcriptionRegion),null!=e.transcriptionConfiguration&&Object.hasOwnProperty.call(e,"transcriptionConfiguration")&&t.uint32(34).string(e.transcriptionConfiguration),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(42).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscriptionStatus;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.type=e.int32();break;case 2:r.eventTime=e.int64();break;case 3:r.transcriptionRegion=e.string();break;case 4:r.transcriptionConfiguration=e.string();break;case 5:r.message=e.string();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 1:case 2:case 3:case 4:case 5:}return null!=e.eventTime&&e.hasOwnProperty("eventTime")&&!s.isInteger(e.eventTime)&&!(e.eventTime&&s.isInteger(e.eventTime.low)&&s.isInteger(e.eventTime.high))?"eventTime: integer|Long expected":null!=e.transcriptionRegion&&e.hasOwnProperty("transcriptionRegion")&&!s.isString(e.transcriptionRegion)?"transcriptionRegion: string expected":null!=e.transcriptionConfiguration&&e.hasOwnProperty("transcriptionConfiguration")&&!s.isString(e.transcriptionConfiguration)?"transcriptionConfiguration: string expected":null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof a.SdkTranscriptionStatus)return e;var t=new a.SdkTranscriptionStatus;switch(e.type){default:"number"==typeof e.type&&(t.type=e.type);break;case"STARTED":case 1:t.type=1;break;case"INTERRUPTED":case 2:t.type=2;break;case"RESUMED":case 3:t.type=3;break;case"STOPPED":case 4:t.type=4;break;case"FAILED":case 5:t.type=5}return null!=e.eventTime&&(s.Long?(t.eventTime=s.Long.fromValue(e.eventTime)).unsigned=!1:"string"==typeof e.eventTime?t.eventTime=parseInt(e.eventTime,10):"number"==typeof e.eventTime?t.eventTime=e.eventTime:"object"==typeof e.eventTime&&(t.eventTime=new s.LongBits(e.eventTime.low>>>0,e.eventTime.high>>>0).toNumber())),null!=e.transcriptionRegion&&(t.transcriptionRegion=String(e.transcriptionRegion)),null!=e.transcriptionConfiguration&&(t.transcriptionConfiguration=String(e.transcriptionConfiguration)),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(i.type=t.enums===String?"STARTED":1,s.Long){var r=new s.Long(0,0,!1);i.eventTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.eventTime=t.longs===String?"0":0;i.transcriptionRegion="",i.transcriptionConfiguration="",i.message=""}return null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?void 0===a.SdkTranscriptionStatus.Type[e.type]?e.type:a.SdkTranscriptionStatus.Type[e.type]:e.type),null!=e.eventTime&&e.hasOwnProperty("eventTime")&&("number"==typeof e.eventTime?i.eventTime=t.longs===String?String(e.eventTime):e.eventTime:i.eventTime=t.longs===String?s.Long.prototype.toString.call(e.eventTime):t.longs===Number?new s.LongBits(e.eventTime.low>>>0,e.eventTime.high>>>0).toNumber():e.eventTime),null!=e.transcriptionRegion&&e.hasOwnProperty("transcriptionRegion")&&(i.transcriptionRegion=e.transcriptionRegion),null!=e.transcriptionConfiguration&&e.hasOwnProperty("transcriptionConfiguration")&&(i.transcriptionConfiguration=e.transcriptionConfiguration),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscriptionStatus"},e.Type=function(){var e={},t=Object.create(e);return t[e[1]="STARTED"]=1,t[e[2]="INTERRUPTED"]=2,t[e[3]="RESUMED"]=3,t[e[4]="STOPPED"]=4,t[e[5]="FAILED"]=5,t}(),e}(),a.SdkTranscriptEvent=function(){var e;function t(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return t.prototype.status=null,t.prototype.transcript=null,Object.defineProperty(t.prototype,"Event",{get:s.oneOfGetter(e=["status","transcript"]),set:s.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(e,t){return t||(t=o.create()),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&a.SdkTranscriptionStatus.encode(e.status,t.uint32(10).fork()).ldelim(),null!=e.transcript&&Object.hasOwnProperty.call(e,"transcript")&&a.SdkTranscript.encode(e.transcript,t.uint32(18).fork()).ldelim(),t},t.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},t.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscriptEvent;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.status=a.SdkTranscriptionStatus.decode(e,e.uint32());break;case 2:r.transcript=a.SdkTranscript.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},t.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},t.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.status&&e.hasOwnProperty("status")){t.Event=1;var i=a.SdkTranscriptionStatus.verify(e.status);if(i)return"status."+i}if(null!=e.transcript&&e.hasOwnProperty("transcript")){if(1===t.Event)return"Event: multiple values";t.Event=1;var i=a.SdkTranscript.verify(e.transcript);if(i)return"transcript."+i}return null},t.fromObject=function(e){if(e instanceof a.SdkTranscriptEvent)return e;var t=new a.SdkTranscriptEvent;if(null!=e.status){if("object"!=typeof e.status)throw TypeError(".SdkTranscriptEvent.status: object expected");t.status=a.SdkTranscriptionStatus.fromObject(e.status)}if(null!=e.transcript){if("object"!=typeof e.transcript)throw TypeError(".SdkTranscriptEvent.transcript: object expected");t.transcript=a.SdkTranscript.fromObject(e.transcript)}return t},t.toObject=function(e,t){t||(t={});var i={};return null!=e.status&&e.hasOwnProperty("status")&&(i.status=a.SdkTranscriptionStatus.toObject(e.status,t),t.oneofs&&(i.Event="status")),null!=e.transcript&&e.hasOwnProperty("transcript")&&(i.transcript=a.SdkTranscript.toObject(e.transcript,t),t.oneofs&&(i.Event="transcript")),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},t.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscriptEvent"},t}(),a.SdkTranscriptFrame=function(){function e(e){if(this.events=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.events=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.events&&e.events.length)for(var i=0;i<e.events.length;++i)a.SdkTranscriptEvent.encode(e.events[i],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkTranscriptFrame;e.pos<i;){var o=e.uint32();o>>>3==1?(r.events&&r.events.length||(r.events=[]),r.events.push(a.SdkTranscriptEvent.decode(e,e.uint32()))):e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.events&&e.hasOwnProperty("events")){if(!Array.isArray(e.events))return"events: array expected";for(var t=0;t<e.events.length;++t){var i=a.SdkTranscriptEvent.verify(e.events[t]);if(i)return"events."+i}}return null},e.fromObject=function(e){if(e instanceof a.SdkTranscriptFrame)return e;var t=new a.SdkTranscriptFrame;if(e.events){if(!Array.isArray(e.events))throw TypeError(".SdkTranscriptFrame.events: array expected");t.events=[];for(var i=0;i<e.events.length;++i){if("object"!=typeof e.events[i])throw TypeError(".SdkTranscriptFrame.events: object expected");t.events[i]=a.SdkTranscriptEvent.fromObject(e.events[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.events=[]),e.events&&e.events.length){i.events=[];for(var r=0;r<e.events.length;++r)i.events[r]=a.SdkTranscriptEvent.toObject(e.events[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkTranscriptFrame"},e}(),a.SdkRemoteVideoUpdateFrame=function(){function e(e){if(this.addedOrUpdatedVideoSubscriptions=[],this.removedVideoSubscriptionMids=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.addedOrUpdatedVideoSubscriptions=s.emptyArray,e.prototype.removedVideoSubscriptionMids=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.addedOrUpdatedVideoSubscriptions&&e.addedOrUpdatedVideoSubscriptions.length)for(var i=0;i<e.addedOrUpdatedVideoSubscriptions.length;++i)a.SdkVideoSubscriptionConfiguration.encode(e.addedOrUpdatedVideoSubscriptions[i],t.uint32(10).fork()).ldelim();if(null!=e.removedVideoSubscriptionMids&&e.removedVideoSubscriptionMids.length)for(var i=0;i<e.removedVideoSubscriptionMids.length;++i)t.uint32(18).string(e.removedVideoSubscriptionMids[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkRemoteVideoUpdateFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.addedOrUpdatedVideoSubscriptions&&r.addedOrUpdatedVideoSubscriptions.length||(r.addedOrUpdatedVideoSubscriptions=[]),r.addedOrUpdatedVideoSubscriptions.push(a.SdkVideoSubscriptionConfiguration.decode(e,e.uint32()));break;case 2:r.removedVideoSubscriptionMids&&r.removedVideoSubscriptionMids.length||(r.removedVideoSubscriptionMids=[]),r.removedVideoSubscriptionMids.push(e.string());break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.addedOrUpdatedVideoSubscriptions&&e.hasOwnProperty("addedOrUpdatedVideoSubscriptions")){if(!Array.isArray(e.addedOrUpdatedVideoSubscriptions))return"addedOrUpdatedVideoSubscriptions: array expected";for(var t=0;t<e.addedOrUpdatedVideoSubscriptions.length;++t){var i=a.SdkVideoSubscriptionConfiguration.verify(e.addedOrUpdatedVideoSubscriptions[t]);if(i)return"addedOrUpdatedVideoSubscriptions."+i}}if(null!=e.removedVideoSubscriptionMids&&e.hasOwnProperty("removedVideoSubscriptionMids")){if(!Array.isArray(e.removedVideoSubscriptionMids))return"removedVideoSubscriptionMids: array expected";for(var t=0;t<e.removedVideoSubscriptionMids.length;++t)if(!s.isString(e.removedVideoSubscriptionMids[t]))return"removedVideoSubscriptionMids: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.SdkRemoteVideoUpdateFrame)return e;var t=new a.SdkRemoteVideoUpdateFrame;if(e.addedOrUpdatedVideoSubscriptions){if(!Array.isArray(e.addedOrUpdatedVideoSubscriptions))throw TypeError(".SdkRemoteVideoUpdateFrame.addedOrUpdatedVideoSubscriptions: array expected");t.addedOrUpdatedVideoSubscriptions=[];for(var i=0;i<e.addedOrUpdatedVideoSubscriptions.length;++i){if("object"!=typeof e.addedOrUpdatedVideoSubscriptions[i])throw TypeError(".SdkRemoteVideoUpdateFrame.addedOrUpdatedVideoSubscriptions: object expected");t.addedOrUpdatedVideoSubscriptions[i]=a.SdkVideoSubscriptionConfiguration.fromObject(e.addedOrUpdatedVideoSubscriptions[i])}}if(e.removedVideoSubscriptionMids){if(!Array.isArray(e.removedVideoSubscriptionMids))throw TypeError(".SdkRemoteVideoUpdateFrame.removedVideoSubscriptionMids: array expected");t.removedVideoSubscriptionMids=[];for(var i=0;i<e.removedVideoSubscriptionMids.length;++i)t.removedVideoSubscriptionMids[i]=String(e.removedVideoSubscriptionMids[i])}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.addedOrUpdatedVideoSubscriptions=[],i.removedVideoSubscriptionMids=[]),e.addedOrUpdatedVideoSubscriptions&&e.addedOrUpdatedVideoSubscriptions.length){i.addedOrUpdatedVideoSubscriptions=[];for(var r=0;r<e.addedOrUpdatedVideoSubscriptions.length;++r)i.addedOrUpdatedVideoSubscriptions[r]=a.SdkVideoSubscriptionConfiguration.toObject(e.addedOrUpdatedVideoSubscriptions[r],t)}if(e.removedVideoSubscriptionMids&&e.removedVideoSubscriptionMids.length){i.removedVideoSubscriptionMids=[];for(var r=0;r<e.removedVideoSubscriptionMids.length;++r)i.removedVideoSubscriptionMids[r]=e.removedVideoSubscriptionMids[r]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkRemoteVideoUpdateFrame"},e}(),a.SdkVideoQualityAdaptationPreference=function(){var e={},t=Object.create(e);return t[e[1]="BALANCED"]=1,t[e[2]="MAINTAIN_FRAMERATE"]=2,t[e[3]="MAINTAIN_RESOLUTION"]=3,t}(),a.SdkVideoSubscriptionConfiguration=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.mid="",e.prototype.attendeeId="",e.prototype.streamId=0,e.prototype.priority=0,e.prototype.targetBitrateKbps=0,e.prototype.groupId=0,e.prototype.qualityAdaptationPreference=1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),t.uint32(10).string(e.mid),null!=e.attendeeId&&Object.hasOwnProperty.call(e,"attendeeId")&&t.uint32(18).string(e.attendeeId),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(24).uint32(e.streamId),null!=e.priority&&Object.hasOwnProperty.call(e,"priority")&&t.uint32(32).uint32(e.priority),null!=e.targetBitrateKbps&&Object.hasOwnProperty.call(e,"targetBitrateKbps")&&t.uint32(40).uint32(e.targetBitrateKbps),null!=e.groupId&&Object.hasOwnProperty.call(e,"groupId")&&t.uint32(48).uint32(e.groupId),null!=e.qualityAdaptationPreference&&Object.hasOwnProperty.call(e,"qualityAdaptationPreference")&&t.uint32(56).int32(e.qualityAdaptationPreference),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkVideoSubscriptionConfiguration;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.mid=e.string();break;case 2:r.attendeeId=e.string();break;case 3:r.streamId=e.uint32();break;case 4:r.priority=e.uint32();break;case 5:r.targetBitrateKbps=e.uint32();break;case 6:r.groupId=e.uint32();break;case 7:r.qualityAdaptationPreference=e.int32();break;default:e.skipType(7&o)}}if(!r.hasOwnProperty("mid"))throw s.ProtocolError("missing required 'mid'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!s.isString(e.mid))return"mid: string expected";if(null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&!s.isString(e.attendeeId))return"attendeeId: string expected";if(null!=e.streamId&&e.hasOwnProperty("streamId")&&!s.isInteger(e.streamId))return"streamId: integer expected";if(null!=e.priority&&e.hasOwnProperty("priority")&&!s.isInteger(e.priority))return"priority: integer expected";if(null!=e.targetBitrateKbps&&e.hasOwnProperty("targetBitrateKbps")&&!s.isInteger(e.targetBitrateKbps))return"targetBitrateKbps: integer expected";if(null!=e.groupId&&e.hasOwnProperty("groupId")&&!s.isInteger(e.groupId))return"groupId: integer expected";if(null!=e.qualityAdaptationPreference&&e.hasOwnProperty("qualityAdaptationPreference"))switch(e.qualityAdaptationPreference){default:return"qualityAdaptationPreference: enum value expected";case 1:case 2:case 3:}return null},e.fromObject=function(e){if(e instanceof a.SdkVideoSubscriptionConfiguration)return e;var t=new a.SdkVideoSubscriptionConfiguration;switch(null!=e.mid&&(t.mid=String(e.mid)),null!=e.attendeeId&&(t.attendeeId=String(e.attendeeId)),null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.priority&&(t.priority=e.priority>>>0),null!=e.targetBitrateKbps&&(t.targetBitrateKbps=e.targetBitrateKbps>>>0),null!=e.groupId&&(t.groupId=e.groupId>>>0),e.qualityAdaptationPreference){default:"number"==typeof e.qualityAdaptationPreference&&(t.qualityAdaptationPreference=e.qualityAdaptationPreference);break;case"BALANCED":case 1:t.qualityAdaptationPreference=1;break;case"MAINTAIN_FRAMERATE":case 2:t.qualityAdaptationPreference=2;break;case"MAINTAIN_RESOLUTION":case 3:t.qualityAdaptationPreference=3}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.mid="",i.attendeeId="",i.streamId=0,i.priority=0,i.targetBitrateKbps=0,i.groupId=0,i.qualityAdaptationPreference=t.enums===String?"BALANCED":1),null!=e.mid&&e.hasOwnProperty("mid")&&(i.mid=e.mid),null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&(i.attendeeId=e.attendeeId),null!=e.streamId&&e.hasOwnProperty("streamId")&&(i.streamId=e.streamId),null!=e.priority&&e.hasOwnProperty("priority")&&(i.priority=e.priority),null!=e.targetBitrateKbps&&e.hasOwnProperty("targetBitrateKbps")&&(i.targetBitrateKbps=e.targetBitrateKbps),null!=e.groupId&&e.hasOwnProperty("groupId")&&(i.groupId=e.groupId),null!=e.qualityAdaptationPreference&&e.hasOwnProperty("qualityAdaptationPreference")&&(i.qualityAdaptationPreference=t.enums===String?void 0===a.SdkVideoQualityAdaptationPreference[e.qualityAdaptationPreference]?e.qualityAdaptationPreference:a.SdkVideoQualityAdaptationPreference[e.qualityAdaptationPreference]:e.qualityAdaptationPreference),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkVideoSubscriptionConfiguration"},e}(),a.SdkNotificationFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.level=3,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.level&&Object.hasOwnProperty.call(e,"level")&&t.uint32(8).int32(e.level),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkNotificationFrame;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.level=e.int32();break;case 2:r.message=e.string();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.level&&e.hasOwnProperty("level"))switch(e.level){default:return"level: enum value expected";case 1:case 2:case 3:}return null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof a.SdkNotificationFrame)return e;var t=new a.SdkNotificationFrame;switch(e.level){case"INFO":case 1:t.level=1;break;case"WARNING":case 2:t.level=2;break;default:"number"==typeof e.level&&(t.level=e.level);break;case"ERROR":case 3:t.level=3}return null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.level=t.enums===String?"ERROR":3,i.message=""),null!=e.level&&e.hasOwnProperty("level")&&(i.level=t.enums===String?void 0===a.SdkNotificationFrame.NotificationLevel[e.level]?e.level:a.SdkNotificationFrame.NotificationLevel[e.level]:e.level),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkNotificationFrame"},e.NotificationLevel=function(){var e={},t=Object.create(e);return t[e[1]="INFO"]=1,t[e[2]="WARNING"]=2,t[e[3]="ERROR"]=3,t}(),e}(),a.SdkPrimaryMeetingJoinFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.credentials=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.credentials&&Object.hasOwnProperty.call(e,"credentials")&&a.SdkMeetingSessionCredentials.encode(e.credentials,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkPrimaryMeetingJoinFrame;e.pos<i;){var o=e.uint32();o>>>3==1?r.credentials=a.SdkMeetingSessionCredentials.decode(e,e.uint32()):e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.credentials&&e.hasOwnProperty("credentials")){var t=a.SdkMeetingSessionCredentials.verify(e.credentials);if(t)return"credentials."+t}return null},e.fromObject=function(e){if(e instanceof a.SdkPrimaryMeetingJoinFrame)return e;var t=new a.SdkPrimaryMeetingJoinFrame;if(null!=e.credentials){if("object"!=typeof e.credentials)throw TypeError(".SdkPrimaryMeetingJoinFrame.credentials: object expected");t.credentials=a.SdkMeetingSessionCredentials.fromObject(e.credentials)}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.credentials=null),null!=e.credentials&&e.hasOwnProperty("credentials")&&(i.credentials=a.SdkMeetingSessionCredentials.toObject(e.credentials,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkPrimaryMeetingJoinFrame"},e}(),a.SdkPrimaryMeetingJoinAckFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkPrimaryMeetingJoinAckFrame;e.pos<i;){var o=e.uint32();e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof a.SdkPrimaryMeetingJoinAckFrame?e:new a.SdkPrimaryMeetingJoinAckFrame},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkPrimaryMeetingJoinAckFrame"},e}(),a.SdkPrimaryMeetingLeaveFrame=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkPrimaryMeetingLeaveFrame;e.pos<i;){var o=e.uint32();e.skipType(7&o)}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof a.SdkPrimaryMeetingLeaveFrame?e:new a.SdkPrimaryMeetingLeaveFrame},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkPrimaryMeetingLeaveFrame"},e}(),a.SdkMeetingSessionCredentials=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.attendeeId="",e.prototype.externalUserId="",e.prototype.joinToken="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.attendeeId&&Object.hasOwnProperty.call(e,"attendeeId")&&t.uint32(10).string(e.attendeeId),null!=e.externalUserId&&Object.hasOwnProperty.call(e,"externalUserId")&&t.uint32(18).string(e.externalUserId),null!=e.joinToken&&Object.hasOwnProperty.call(e,"joinToken")&&t.uint32(26).string(e.joinToken),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new a.SdkMeetingSessionCredentials;e.pos<i;){var o=e.uint32();switch(o>>>3){case 1:r.attendeeId=e.string();break;case 2:r.externalUserId=e.string();break;case 3:r.joinToken=e.string();break;default:e.skipType(7&o)}}return r},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&!s.isString(e.attendeeId)?"attendeeId: string expected":null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&!s.isString(e.externalUserId)?"externalUserId: string expected":null!=e.joinToken&&e.hasOwnProperty("joinToken")&&!s.isString(e.joinToken)?"joinToken: string expected":null},e.fromObject=function(e){if(e instanceof a.SdkMeetingSessionCredentials)return e;var t=new a.SdkMeetingSessionCredentials;return null!=e.attendeeId&&(t.attendeeId=String(e.attendeeId)),null!=e.externalUserId&&(t.externalUserId=String(e.externalUserId)),null!=e.joinToken&&(t.joinToken=String(e.joinToken)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.attendeeId="",i.externalUserId="",i.joinToken=""),null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&(i.attendeeId=e.attendeeId),null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&(i.externalUserId=e.externalUserId),null!=e.joinToken&&e.hasOwnProperty("joinToken")&&(i.joinToken=e.joinToken),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SdkMeetingSessionCredentials"},e}(),a.SdkVideoCodecCapability=function(){var e={},t=Object.create(e);return t[e[1]="VP8"]=1,t[e[2]="H264_BASELINE_PROFILE"]=2,t[e[3]="H264_CONSTRAINED_BASELINE_PROFILE"]=3,t[e[4]="H264_MAIN_PROFILE"]=4,t[e[5]="H264_HIGH_PROFILE"]=5,t[e[6]="H264_CONSTRAINED_HIGH_PROFILE"]=6,t[e[8]="VP9_PROFILE_0"]=8,t[e[11]="AV1_MAIN_PROFILE"]=11,t}(),e.exports=a,s.Long=void 0,r.configure()},334:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=i(3625),s=i(3538),a=n(i(4046));class l{constructor(e){this.chimeClient=e}makeTwoDigits(e){return e>9?e.toString():"0"+e.toString()}hmac(e,t){let i=new o.Sha256(t);return i.update(e),i.digest()}getDateTimeString(){let e=new Date;return e.getUTCFullYear()+this.makeTwoDigits(e.getUTCMonth()+1)+this.makeTwoDigits(e.getUTCDate())+"T"+this.makeTwoDigits(e.getUTCHours())+this.makeTwoDigits(e.getUTCMinutes())+this.makeTwoDigits(e.getUTCSeconds())+"Z"}getDateString(e){return e.substring(0,e.indexOf("T"))}getSignatureKey(e,t,i,n){return r(this,void 0,void 0,function*(){let r=yield this.hmac(t,"AWS4"+e),o=yield this.hmac(i,r),s=yield this.hmac(n,o);return yield this.hmac("aws4_request",s)})}signURL(e,t,i,n,o,l,d){return r(this,void 0,void 0,function*(){let r;let c=this.getDateTimeString(),u=this.getDateString(c),h="AWS4-HMAC-SHA256",f="";f=this.chimeClient.config.region instanceof Function?yield this.chimeClient.config.region():this.chimeClient.config.region;let p="host",m="host:"+n.toLowerCase()+"\n",g=u+"/"+f+"/"+i+"/aws4_request";r=this.chimeClient.config.credentials instanceof Function?yield this.chimeClient.config.credentials():this.chimeClient.config.credentials;let v=new Map;v.set("X-Amz-Algorithm",[h]),v.set("X-Amz-Credential",[encodeURIComponent(r.accessKeyId+"/"+g)]),v.set("X-Amz-Date",[c]),v.set("X-Amz-Expires",["10"]),v.set("X-Amz-SignedHeaders",["host"]),r.sessionToken&&v.set("X-Amz-Security-Token",[encodeURIComponent(r.sessionToken)]),v.set(a.default.X_AMZN_VERSION,[encodeURIComponent(a.default.sdkVersion)]),v.set(a.default.X_AMZN_USER_AGENT,[encodeURIComponent(a.default.sdkUserAgentLowResolution)]),null==d||d.forEach((e,t)=>{let i=encodeURIComponent(t);e.sort().forEach(e=>{v.has(i)||v.set(i,[]),v.get(i).push(encodeURIComponent(e))})});let b="";(v=new Map([...v.entries()].sort())).forEach((e,t)=>{e.forEach(e=>{b.length&&(b+="&"),b+=t+"="+e})});let y=e+"\n"+o+"\n"+b+"\n"+m+"\n"+p+"\n"+s.toHex((yield this.hmac(l))),S="AWS4-HMAC-SHA256\n"+c+"\n"+u+"/"+f+"/"+i+"/aws4_request\n"+s.toHex((yield this.hmac(y))),w=yield this.getSignatureKey(r.secretAccessKey,u,f,i),C=s.toHex((yield this.hmac(S,w)));return t+"://"+n+o+"?"+b+"&X-Amz-Signature="+C})}}t.default=l},7606:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SimulcastLayers=void 0,function(e){e[e.Low=0]="Low",e[e.LowAndMedium=1]="LowAndMedium",e[e.LowAndHigh=2]="LowAndHigh",e[e.Medium=3]="Medium",e[e.MediumAndHigh=4]="MediumAndHigh",e[e.High=5]="High"}(i=t.SimulcastLayers||(t.SimulcastLayers={})),t.default=i},9880:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.AudioLogEvent=void 0,function(e){e[e.DeviceChanged=0]="DeviceChanged",e[e.MutedLocal=1]="MutedLocal",e[e.UnmutedLocal=2]="UnmutedLocal",e[e.Connected=3]="Connected",e[e.ConnectFailed=4]="ConnectFailed",e[e.RedmicStartLoss=5]="RedmicStartLoss",e[e.RedmicEndLoss=6]="RedmicEndLoss"}(i=t.AudioLogEvent||(t.AudioLogEvent={})),t.default=i},8597:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(4571)),s=n(i(6196)),a=n(i(9496)),l=n(i(2353)),d=n(i(2811)),c=n(i(7604)),u=n(i(1296)),h=n(i(3922)),f=i(289),p=i(8660),m=n(i(9880)),g=n(i(155));class v{constructor(e,t,i=v.INTERVAL_MS){this.audioVideoController=e,this.logger=t,this.interval=i,this.intervalScheduler=null,this.redRecoveryMetricReport=new l.default,this.lastRedRecoveryMetricReportConsumedTimestampMs=0,this.videoCodecDegradationHighEncodeCpuCount=0,this.videoCodecDegradationEncodeFailureCount=0,this.videoCodecDegradationConcurrentSendersCount=0,this.resolutionMap=new Map,this.metricsAddTime=(e,t,i)=>{},this.metricsLogEvent=(e,t)=>{}}toAttribute(e){return this.toSuffix(e).substring(1)}toSuffix(e){return e.toLowerCase()===e?`_${e}`:e.toUpperCase()===e?`_${e.toLowerCase()}`:e.replace(/([A-Z][a-z]+)/g,function(e){return`_${e}`}).replace(/([A-Z][A-Z]+)/g,function(e){return`_${e}`}).toLowerCase()}logLatency(e,t,i){let r=this.toSuffix(e);this.logEventTime("meeting"+r,t,i)}logStateTimeout(e,t){let i=this.toSuffix(e);this.logEvent("meeting_session_state_timeout",Object.assign(Object.assign({},t),{state:`state${i}`}))}logAudioEvent(e,t){let i="audio"+this.toSuffix(m.default[e]);this.logEvent(i,t)}logVideoEvent(e,t){let i="video"+this.toSuffix(g.default[e]);this.logEvent(i,t)}logEventTime(e,t,i={}){let r=Object.assign(Object.assign({},i),{call_id:this.audioVideoController.configuration.meetingId,client_type:v.CLIENT_TYPE,metric_type:"latency"});this.logger.debug(()=>`[StatsCollector] ${e}: ${JSON.stringify(r)}`),this.metricsAddTime(e,t,r)}logMeetingSessionStatus(e){let t=`${e.statusCode()}`;this.logEvent(t);let i={status:t,status_code:`${e.statusCode()}`};this.logEvent("meeting_session_status",i),e.isTerminal()&&this.logEvent("meeting_session_stopped",i),e.isAudioConnectionFailure()&&this.logEvent("meeting_session_audio_failed",i),e.isFailure()&&this.logEvent("meeting_session_failed",i)}logLifecycleEvent(e,t){let i={lifecycle_event:`lifecycle${this.toSuffix(c.default[e])}`,lifecycle_event_code:`${e}`,lifecycle_event_condition:`condition${this.toSuffix(u.default[t])}`,lifecycle_event_condition_code:`${t}`};this.logEvent("meeting_session_lifecycle",i)}logEvent(e,t={}){let i=Object.assign(Object.assign({},t),{call_id:this.audioVideoController.configuration.meetingId,client_type:v.CLIENT_TYPE});this.logger.debug(()=>`[StatsCollector] ${e}: ${JSON.stringify(i)}`),this.metricsLogEvent(e,i)}start(e,t){return!this.intervalScheduler&&(this.logger.info("Starting StatsCollector"),this.signalingClient=e,this.videoStreamIndex=t,this.clientMetricReport=new o.default(this.logger,this.videoStreamIndex,this.audioVideoController.configuration.credentials.attendeeId),this.intervalScheduler=new h.default(this.interval),this.intervalScheduler.start(()=>r(this,void 0,void 0,function*(){yield this.getStatsWrapper()})),!0)}stop(){this.logger.info("Stopping StatsCollector"),this.intervalScheduler&&this.intervalScheduler.stop(),this.intervalScheduler=null}videoTileResolutionDidChange(e,t,i){this.resolutionMap.set(e,{width:t,height:i})}videoTileUnbound(e){this.resolutionMap.delete(e)}updateMetricValues(e,t){let i;let r=t?this.clientMetricReport.streamMetricReports[Number(e.ssrc)]:this.clientMetricReport.globalMetricReport;if(t){let t=r.mediaType,n=r.direction;i=this.clientMetricReport.getMetricMap(t,n),t===a.default.VIDEO&&n===s.default.DOWNSTREAM&&this.addRenderResolutionToVideoDownstreamMetrics(r,e.ssrc)}else i=this.clientMetricReport.getMetricMap();for(let t in e)t in i&&("number"==typeof e[t]?(r.previousMetrics[t]=r.currentMetrics[t],r.currentMetrics[t]=e[t]):"string"==typeof e[t]?r.currentStringMetrics[t]=e[t]:"object"==typeof e[t]?(r.previousObjectMetrics[t]=void 0===r.currentObjectMetrics[t]?e[t]:r.currentObjectMetrics[t],r.currentObjectMetrics[t]=e[t]):this.logger.error(`Unknown metric value type ${typeof e[t]} for metric ${t}`))}processRawMetricReports(e){this.clientMetricReport.currentSsrcs={};let t=Date.now();for(let t of e){if(this.isVideoSourceMetricReport(t))continue;let e=this.isStreamRawMetricReport(t);if(e){let e=this.clientMetricReport.streamMetricReports[Number(t.ssrc)];if(e)e.mediaType===a.default.VIDEO&&e.direction===s.default.UPSTREAM?e.streamId=this.videoStreamIndex.sendVideoStreamIdFromRid(t.rid):e.streamId=this.videoStreamIndex.streamIdForSSRC(Number(t.ssrc));else{let e=new d.default;e.mediaType=this.getMediaType(t),e.direction=this.getDirectionType(t),e.mediaType===a.default.VIDEO&&e.direction===s.default.UPSTREAM?e.streamId=this.videoStreamIndex.sendVideoStreamIdFromRid(t.rid):this.videoStreamIndex.allStreams().empty()||(e.streamId=this.videoStreamIndex.streamIdForSSRC(Number(t.ssrc)),void 0!==this.videoStreamIndex.groupIdForSSRC&&(e.groupId=this.videoStreamIndex.groupIdForSSRC(Number(t.ssrc)))),this.clientMetricReport.streamMetricReports[Number(t.ssrc)]=e}this.clientMetricReport.currentSsrcs[Number(t.ssrc)]=1}this.updateMetricValues(t,e)}this.clientMetricReport.removeDestroyedSsrcs(),this.clientMetricReport.previousTimestampMs=this.clientMetricReport.currentTimestampMs,this.clientMetricReport.currentTimestampMs=t,this.clientMetricReport.print()}addStreamMetricDimensionFrames(e,t){let i=this.clientMetricReport.getStreamDimensionMap();for(let r in t.currentStringMetrics)if(r in i){let n=f.SdkStreamDimension.create();n.type=i[r];let o=f.SdkDimensionValue.create();o.stringValue=t.currentStringMetrics[r],n.value=o,e.dimensions.push(n)}}addMetricFrame(e,t,i,r){let n=i.type,o=i.transform,s=i.source,a=t.streamMetricFrames.length,l=t.streamMetricFrames[a-1];if(n){let i=f.SdkMetric.create();i.type=n,i.value=o(s||e,r),r?l.metrics.push(i):t.globalMetrics.push(i)}}addGlobalMetricsToProtobuf(e){let t=this.clientMetricReport.getMetricMap();for(let i in this.clientMetricReport.globalMetricReport.currentMetrics)this.addMetricFrame(i,e,t[i])}addStreamMetricsToProtobuf(e){for(let t in this.clientMetricReport.streamMetricReports){let i=this.clientMetricReport.streamMetricReports[t],r=f.SdkStreamMetricFrame.create();r.streamId=i.streamId,r.mediaType=i.mediaType===a.default.AUDIO?f.SdkStreamMediaType.AUDIO:f.SdkStreamMediaType.VIDEO,r.metrics=[],this.addStreamMetricDimensionFrames(r,i),e.streamMetricFrames.push(r);let n=this.clientMetricReport.getMetricMap(i.mediaType,i.direction);for(let r in n)this.hasMetricDependenciesInReport(r,i)&&this.addMetricFrame(r,e,n[r],Number(t))}}hasMetricDependenciesInReport(e,t){return"decoderLoss"===e&&void 0!==t.currentMetrics.concealedSamples&&void 0!==t.currentMetrics.totalSamplesReceived||"jitterBufferMs"===e&&void 0!==t.currentMetrics.jitterBufferDelay&&void 0!==t.currentMetrics.jitterBufferEmittedCount||e in t.currentMetrics||e in t.currentStringMetrics||e in t.currentObjectMetrics}makeClientMetricProtobuf(){let e=f.SdkClientMetricFrame.create();return e.globalMetrics=[],e.streamMetricFrames=[],this.addGlobalMetricsToProtobuf(e),this.addStreamMetricsToProtobuf(e),e}sendClientMetricProtobuf(e){this.signalingClient.sendClientMetrics(e)}isStreamRawMetricReport(e){return["inbound-rtp","inbound-rtp-red","outbound-rtp","remote-inbound-rtp","remote-outbound-rtp"].includes(e.type)||this.isVideoSourceMetricReport(e)}getMediaType(e){return"audio"===e.kind?a.default.AUDIO:a.default.VIDEO}getDirectionType(e){let{type:t}=e;return"inbound-rtp"===t||"remote-outbound-rtp"===t||"inbound-rtp-red"===t?s.default.DOWNSTREAM:s.default.UPSTREAM}isValidStandardRawMetric(e){return"inbound-rtp"===e.type||"inbound-rtp-red"===e.type||"outbound-rtp"===e.type||"remote-inbound-rtp"===e.type||"remote-outbound-rtp"===e.type||"candidate-pair"===e.type&&"succeeded"===e.state||"media-source"===e.type}isValidSsrc(e){let t=!0;return this.isStreamRawMetricReport(e)&&this.getDirectionType(e)===s.default.DOWNSTREAM&&this.getMediaType(e)===a.default.VIDEO&&(t=this.videoStreamIndex.streamIdForSSRC(Number(e.ssrc))>0),t}isValidRawMetricReport(e){return this.isValidStandardRawMetric(e)&&this.isValidSsrc(e)}filterRawMetricReports(e){let t=[];for(let i of e)this.isValidRawMetricReport(i)&&t.push(i);return t}handleRawMetricReports(e){let t=this.filterRawMetricReports(e);this.logger.debug(()=>`Filtered raw metrics : ${JSON.stringify(t)}`);let i=[];this.maybeAddRedRecoveryMetrics(i);let r=this.getVideoUpstreamSsrcFromRawMetricReports(t);null!==r&&this.addVideoCodecDegradationMetrics(i,r),this.clientMetricReport.customStatsReports=i,t.push(...i),this.processRawMetricReports(t),this.updateVideoSourceMetrics(t);let n=this.makeClientMetricProtobuf();this.sendClientMetricProtobuf(n),this.audioVideoController.forEachObserver(e=>{p.Maybe.of(e.metricsDidReceive).map(t=>t.bind(e)(this.clientMetricReport.clone()))})}getStatsWrapper(){return r(this,void 0,void 0,function*(){if(!this.audioVideoController.rtcPeerConnection)return;let e=[];try{let t=yield this.audioVideoController.rtcPeerConnection.getStats();this.clientMetricReport.rtcStatsReport=t,t.forEach(t=>{e.push(t)}),this.handleRawMetricReports(e)}catch(e){this.logger.error(e.message)}})}overrideObservableMetric(e,t){this.clientMetricReport.overrideObservableMetric(e,t)}recoveryMetricsDidReceive(e){this.redRecoveryMetricReport=e}maybeAddRedRecoveryMetrics(e){this.redRecoveryMetricReport.currentTimestampMs!==this.lastRedRecoveryMetricReportConsumedTimestampMs&&(e.push({kind:"audio",type:"inbound-rtp-red",ssrc:this.redRecoveryMetricReport.ssrc,timestamp:this.redRecoveryMetricReport.currentTimestampMs,totalAudioPacketsLost:this.redRecoveryMetricReport.totalAudioPacketsLost,totalAudioPacketsExpected:this.redRecoveryMetricReport.totalAudioPacketsExpected,totalAudioPacketsRecoveredRed:this.redRecoveryMetricReport.totalAudioPacketsRecoveredRed,totalAudioPacketsRecoveredFec:this.redRecoveryMetricReport.totalAudioPacketsRecoveredFec}),this.lastRedRecoveryMetricReportConsumedTimestampMs=this.redRecoveryMetricReport.currentTimestampMs)}videoCodecDegradationHighEncodeCpuDidReceive(){this.videoCodecDegradationHighEncodeCpuCount+=1}videoCodecDegradationEncodeFailureDidReceive(){this.videoCodecDegradationEncodeFailureCount+=1}videoCodecDegradationConcurrentSendersDidReceive(){this.videoCodecDegradationConcurrentSendersCount+=1}addVideoCodecDegradationMetrics(e,t){e.push({kind:"video",type:"outbound-rtp",ssrc:t,timestamp:Date.now(),videoCodecDegradationHighEncodeCpu:this.videoCodecDegradationHighEncodeCpuCount,videoCodecDegradationEncodeFailure:this.videoCodecDegradationEncodeFailureCount,videoCodecDegradationConcurrentSenders:this.videoCodecDegradationConcurrentSendersCount}),this.videoCodecDegradationHighEncodeCpuCount=0,this.videoCodecDegradationEncodeFailureCount=0,this.videoCodecDegradationConcurrentSendersCount=0}getVideoUpstreamSsrcFromRawMetricReports(e){for(let t of e)if(this.isStreamRawMetricReport(t)&&this.getMediaType(t)===a.default.VIDEO&&this.getDirectionType(t)===s.default.UPSTREAM)return t.ssrc;return null}isVideoSourceMetricReport(e){return"media-source"===e.type&&"video"===e.kind}addRenderResolutionToVideoDownstreamMetrics(e,t){let i=this.videoStreamIndex.streamIdForSSRC(Number(t)),r=this.videoStreamIndex.attendeeIdForStreamId(i);if(void 0===i||""===r){this.logger.warn(`No attendee found for ssrc ${t}`);return}this.resolutionMap.has(r)&&(e.currentMetrics.videoRenderWidth=this.resolutionMap.get(r).width,e.currentMetrics.videoRenderHeight=this.resolutionMap.get(r).height)}updateVideoSourceMetrics(e){for(let t of e)if(this.isVideoSourceMetricReport(t)){let e=this.clientMetricReport.getVideoUpstreamSsrcs();if(0===e.length){this.logger.warn("No video upstream ssrcs found");return}for(let i of e)this.clientMetricReport.streamMetricReports[i].currentMetrics.videoInputWidth=t.width,this.clientMetricReport.streamMetricReports[i].currentMetrics.videoInputHeight=t.height}}}t.default=v,v.INTERVAL_MS=1e3,v.CLIENT_TYPE="amazon-chime-sdk-js"},155:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoLogEvent=void 0,function(e){e[e.InputAttached=0]="InputAttached",e[e.SendingFailed=1]="SendingFailed",e[e.SendingSuccess=2]="SendingSuccess"}(i=t.VideoLogEvent||(t.VideoLogEvent={})),t.default=i},8358:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(155)),s=n(i(1789));class a extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="AttachMediaInputTask"}run(){return r(this,void 0,void 0,function*(){let e=this.context.transceiverController;e.setPeer(this.context.peer),e.setupLocalTransceivers();let t=this.context.activeAudioInput;if(t){let i=t.getAudioTracks();this.context.logger.info("attaching audio track to peer connection"),yield e.setAudioInput(i.length?i[0]:null)}else yield e.setAudioInput(null),this.context.logger.info("no audio track");this.setAudioCodecPreferences();let i=this.context.activeVideoInput;if(i){let t=i.getVideoTracks(),r=t.length?t[0]:null;if(this.context.logger.info("attaching video track to peer connection"),yield e.setVideoInput(r),this.context.enableSimulcast&&this.context.videoUplinkBandwidthPolicy){let t=this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters();e.setEncodingParameters(t)}r&&this.context.statsCollector.logVideoEvent(o.default.InputAttached,this.context.videoDeviceInformation)}else yield e.setVideoInput(null),this.context.logger.info("no video track");this.context.videoSubscriptions=e.updateVideoTransceivers(this.context.videoStreamIndex,this.context.videosToReceive),this.context.videoStreamIndex.subscribeFrameSent()})}setAudioCodecPreferences(){let e=window.RTCRtpTransceiver&&"setCodecPreferences"in window.RTCRtpTransceiver.prototype,t=this.context.audioProfile.hasRedundancyEnabled();if(!e){this.context.logger.warn("Setting codec preferences not supported");return}let i=this.context.transceiverController.localAudioTransceiver(),{codecs:r}=RTCRtpSender.getCapabilities("audio");this.context.logger.debug(`Available audio codecs ${JSON.stringify(r,null,4)}`);let n=r.findIndex(e=>"audio/red"===e.mimeType);if(!i){this.context.logger.error("audio transceiver is null");return}if(n>=0){let e=r[n];r.splice(n,1),t?(r.unshift(e),this.context.logger.info("audio/red set as preferred codec")):this.context.logger.info("audio/red removed from preferred codec"),i.setCodecPreferences(r);return}this.context.logger.info("audio/red codec not supported")}}t.default=a},1789:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1124)),s=n(i(4456));class a{constructor(e){this.logger=e,this.taskName="BaseTask",this.parentTask=null,this.status=s.default.IDLE,this.run=this.baseRun.bind(this,this.run),this.cancel=this.baseCancel.bind(this,this.cancel)}once(...e){return new o.default(this.logger,this,e)}cancel(){}name(){return this.parentTask?`${this.parentTask.name()}/${this.taskName}`:this.taskName}setParent(e){this.parentTask=e}getStatus(){return this.status}logAndThrow(e){throw this.logger.info(e),Error(e)}baseRun(e){return r(this,void 0,void 0,function*(){try{let t=Date.now();switch(this.logger.info(`running task ${this.name()}`),this.status){case s.default.RUNNING:this.logAndThrow(`${this.name()} is already running`);case s.default.CANCELED:this.logAndThrow(`${this.name()} was canceled before running`);case s.default.FINISHED:this.logAndThrow(`${this.name()} was already finished`)}this.status=s.default.RUNNING,yield e.call(this),this.logger.info(`${this.name()} took ${Math.round(Date.now()-t)} ms`)}catch(e){throw e}finally{this.status!==s.default.CANCELED&&(this.status=s.default.FINISHED)}})}baseCancel(e){if(this.status===s.default.CANCELED||this.status===s.default.FINISHED){this.logger.info(`Not canceling ${this.name()}: state is ${this.status}`);return}this.logger.info(`canceling task ${this.name()}`),this.status=s.default.CANCELED,e.call(this)}}t.default=a},3216:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1789));class s extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="CleanRestartedSessionTask"}run(){return r(this,void 0,void 0,function*(){this.context.resetConnectionSpecificState()})}}t.default=s},7408:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(9416)),s=n(i(1789));class a extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="CleanStoppedSessionTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return r(this,void 0,void 0,function*(){try{this.context.signalingClient.ready()&&(this.context.signalingClient.closeConnection(),yield this.receiveWebSocketClosedEvent())}catch(e){throw e}finally{for(let e of this.context.removableObservers)e.removeObserver();this.context.resetConnectionSpecificState(),this.context.statsCollector.stop(),this.context.statsCollector=null,this.context.connectionMonitor.stop(),this.context.connectionMonitor=null,this.context.videoUplinkBandwidthPolicy.setTransceiverController&&this.context.videoUplinkBandwidthPolicy.setTransceiverController(void 0),this.context.videoDownlinkBandwidthPolicy.bindToTileController&&this.context.videoDownlinkBandwidthPolicy.bindToTileController(void 0);let e=this.context.videoTileController.getLocalVideoTile();e&&e.bindVideoStream("",!0,null,null,null,null),this.context.videoTileController.removeAllVideoTiles()}})}receiveWebSocketClosedEvent(){return new Promise((e,t)=>{class i{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(Error("CleanStoppedSessionTask got canceled while waiting for the WebSocket closed event"))}handleSignalingClientEvent(t){t.type===o.default.WebSocketClosed&&(this.signalingClient.removeObserver(this),e())}}let r=new i(this.context.signalingClient);this.taskCanceler=r,this.context.signalingClient.registerObserver(r)})}}t.default=a},5482:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1789));class s extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="CreatePeerConnectionTask",this.removeTrackAddedEventListener=null,this.removeTrackRemovedEventListeners={},this.trackEvents=["ended","mute","unmute","isolationchange","overconstrained"],this.removeVideoTrackEventListeners={},this.trackAddedHandler=e=>{let t=e.track;if(this.context.logger.info(`received track event: kind=${t.kind} id=${t.id} label=${t.label}`),e.transceiver&&"inactive"===e.transceiver.currentDirection)return;if(0===e.streams.length){this.context.logger.warn("Track event but no stream");return}let i=e.streams[0];"audio"===t.kind?this.context.audioMixController.bindAudioStream(i):"video"!==t.kind||this.trackIsVideoInput(t)||this.addRemoteVideoTrack(t,i)}}removeObserver(){for(let e in this.removeTrackAddedEventListener&&this.removeTrackAddedEventListener(),this.removeTrackRemovedEventListeners)this.removeTrackRemovedEventListeners[e]()}addPeerConnectionEventLogger(){let e=this.context.peer;e.addEventListener("connectionstatechange",()=>{this.context.logger.info(`peer connection state changed: ${e.connectionState}`)}),e.addEventListener("negotiationneeded",()=>{this.context.logger.info("peer connection negotiation is needed")}),e.addEventListener("icegatheringstatechange",()=>{this.context.logger.info(`peer connection ice gathering state changed: ${e.iceGatheringState}`)}),e.addEventListener("icecandidate",e=>{this.context.logger.info(`peer connection ice candidate: ${e.candidate?e.candidate.candidate:"(null)"}`)}),e.addEventListener("iceconnectionstatechange",()=>{this.context.logger.info(`peer connection ice connection state changed: ${e.iceConnectionState}`)})}run(){return r(this,void 0,void 0,function*(){this.context.removableObservers.push(this);let e=this.context.turnCredentials&&this.context.turnCredentials.uris.length>0?{iceServers:[{urls:this.context.turnCredentials.uris,username:this.context.turnCredentials.username,credential:this.context.turnCredentials.password,credentialType:"password"}],iceTransportPolicy:"relay"}:{};e.bundlePolicy=this.context.browserBehavior.requiresBundlePolicy(),e.sdpSemantics="unified-plan",e.encodedInsertableStreams=this.context.audioProfile.hasRedundancyEnabled(),this.context.peer?this.context.logger.info("reusing peer connection"):(this.context.logger.info("creating new peer connection"),this.context.peer=new RTCPeerConnection(e),this.addPeerConnectionEventLogger()),this.removeTrackAddedEventListener=()=>{this.context.peer&&this.context.peer.removeEventListener("track",this.trackAddedHandler),this.removeTrackAddedEventListener=null},this.context.peer.addEventListener("track",this.trackAddedHandler)})}trackIsVideoInput(e){return!!this.context.transceiverController.useTransceivers()&&(this.logger.debug(()=>"getting video track type"),this.context.transceiverController.trackIsVideoInput(e))}addRemoteVideoTrack(e,t){var i;let r,n,o,s;let a=t.id,l=this.context.videoStreamIndex.attendeeIdForTrack(a);if(r=this.context.videoTileController.getVideoTileForAttendeeId?!!(null===(i=null==(n=this.context.videoTileController.getVideoTileForAttendeeId(l))?void 0:n.state())||void 0===i?void 0:i.boundVideoStream):this.context.videoTileController.haveVideoTileForAttendeeId(l)){this.context.logger.info(`Not adding remote track. Already have tile for attendeeId:  ${l}`);return}n||(n=this.context.videoTileController.addVideoTile(),this.logger.info(`Created video tile ${n.id()}`));let d=this.context.videoStreamIndex.streamIdForTrack(a);void 0===d&&(this.logger.warn(`stream not found for tile=${n.id()} track=${a}`),d=null);let c=this.context.videoStreamIndex.groupIdForStreamId(d);void 0===c&&(c=null);for(let i=0;i<this.trackEvents.length;i++){let r=this.trackEvents[i],o=t.getVideoTracks();if(o&&o.length){let t=o[0],i=()=>{this.context.logger.info(`received the ${r} event for tile=${n.id()} id=${e.id} streamId=${d}`),"ended"===r&&this.removeRemoteVideoTrack(e,n.state())};t.addEventListener(r,i),this.removeVideoTrackEventListeners[e.id]||(this.removeVideoTrackEventListeners[e.id]=[]),this.removeVideoTrackEventListeners[e.id].push(()=>{t.removeEventListener(r,i)})}}if(e.getSettings){let t=e.getSettings();o=t.width,s=t.height}else{let t=e.getCapabilities();o=t.width,s=t.height}let u=this.context.videoStreamIndex.externalUserIdForTrack(a);n.bindVideoStream(l,!1,t,o,s,d,u,c),this.logger.info(`video track added, use tile=${n.id()} track=${a} streamId=${d} groupId=${c}`);let h="removetrack",f=t,p=()=>this.removeRemoteVideoTrack(e,n.state());this.removeTrackRemovedEventListeners[e.id]=()=>{f.removeEventListener(h,p),delete this.removeTrackRemovedEventListeners[e.id]},f.addEventListener(h,p)}removeRemoteVideoTrack(e,t){if(this.removeTrackRemovedEventListeners.hasOwnProperty(e.id)){for(let t of(this.removeTrackRemovedEventListeners[e.id](),this.removeVideoTrackEventListeners[e.id]))t();delete this.removeVideoTrackEventListeners[e.id]}this.logger.info(`video track ended, removing tile=${t.tileId} id=${e.id} stream=${t.streamId}`),t.streamId?this.context.videosPaused.remove(t.streamId):this.logger.warn(`no stream found for tile=${t.tileId}`),this.context.videoTileController.removeVideoTile(t.tileId)}}t.default=s,s.REMOVE_HANDLER_INTERVAL_MS=1e4},1129:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(5687)),s=n(i(326)),a=n(i(1789));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="CreateSDPTask"}cancel(){if(this.cancelPromise){let e=Error(`canceling ${this.name()}`);this.cancelPromise(e),delete this.cancelPromise}}sessionUsesAudio(){var e,t;return!!(null===(t=null===(e=this.context.meetingSessionConfiguration)||void 0===e?void 0:e.urls)||void 0===t?void 0:t.audioHostURL)}sessionUsesVideo(){let e;let t=!0;e=this.context.transceiverController.useTransceivers()?this.context.transceiverController.hasVideoInput():this.context.videoTileController.hasStartedLocalVideoTile();let i=!!this.context.videosToReceive&&!this.context.videosToReceive.empty(),r=t&&(e||i);return this.context.logger.info(`uses video: ${r} (enabled: ${t}, sending: ${e}, receiving: ${i})`),r}run(){return r(this,void 0,void 0,function*(){let e={offerToReceiveAudio:this.sessionUsesAudio(),offerToReceiveVideo:this.sessionUsesVideo()};this.logger.info(`peer connection offerOptions: ${JSON.stringify(e)}`),yield new Promise((t,i)=>r(this,void 0,void 0,function*(){this.cancelPromise=e=>{i(e)};try{if(this.context.sdpOfferInit=yield this.context.peer.createOffer(e),this.context.logger.info("peer connection created offer"),this.context.previousSdpOffer&&new s.default(this.context.sdpOfferInit.sdp).videoSendSectionHasDifferentSSRC(this.context.previousSdpOffer)){let e=Error(`canceling ${this.name()} due to the meeting status code: ${o.default.IncompatibleSDP}`);this.context.previousSdpOffer=null,i(e);return}t()}catch(e){i(e)}finally{delete this.cancelPromise}}))})}}t.default=l},6240:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(5687)),s=n(i(326)),a=n(i(1789));class l extends a.default{constructor(e,t=l.CHROME_VPN_TIMEOUT_MS){super(e.logger),this.context=e,this.chromeVpnTimeoutMs=t,this.taskName="FinishGatheringICECandidatesTask"}removeEventListener(){this.context.peer&&(this.context.peer.removeEventListener("icecandidate",this.context.iceCandidateHandler),this.context.turnCredentials||this.context.peer.removeEventListener("icegatheringstatechange",this.context.iceGatheringStateEventHandler))}cancel(){let e;this.context.browserBehavior.requiresIceCandidateGatheringTimeoutWorkaround()&&this.chromeVpnTimeoutMs<this.context.meetingSessionConfiguration.connectionTimeoutMs&&Date.now()-this.startTimestampMs>this.chromeVpnTimeoutMs&&(e=Error(`canceling ${this.name()} due to the meeting status code: ${o.default.ICEGatheringTimeoutWorkaround}`)),this.cancelPromise&&(e=e||Error(`canceling ${this.name()}`),this.cancelPromise(e),delete this.cancelPromise)}run(){return r(this,void 0,void 0,function*(){if(this.context.peer||this.logAndThrow("session does not have peer connection; bypass ice gathering"),this.context.browserBehavior.requiresCheckForSdpConnectionAttributes()){if(new s.default(this.context.peer.localDescription.sdp).hasCandidatesForAllMLines()){this.context.logger.info(`ice gathering already complete; bypass gathering, current local description ${this.context.peer.localDescription.sdp}`);return}}else this.context.logger.info(`iOS device does not require checking for connection attributes in SDP, current local description ${this.context.peer.localDescription.sdp}`);if((this.context.browserBehavior.hasFirefoxWebRTC()||"complete"===this.context.peer.iceGatheringState)&&new s.default(this.context.peer.localDescription.sdp).hasCandidates()){this.context.logger.info("ice gathering state is complete and candidates are in SDP; bypass gathering");return}try{yield new Promise((e,t)=>{this.cancelPromise=e=>{this.removeEventListener(),t(e)},this.context.turnCredentials||(this.context.iceGatheringStateEventHandler=()=>{if("complete"===this.context.peer.iceGatheringState){this.removeEventListener(),e(),delete this.cancelPromise;return}},this.context.peer.addEventListener("icegatheringstatechange",this.context.iceGatheringStateEventHandler)),this.context.iceCandidateHandler=i=>{if(this.context.logger.info(`ice candidate: ${i.candidate?i.candidate.candidate:"(null)"} state: ${this.context.peer.iceGatheringState}`),i.candidate&&(s.default.isRTPCandidate(i.candidate.candidate)&&this.context.iceCandidates.push(i.candidate),this.context.turnCredentials&&this.context.iceCandidates.length>=1)){this.context.logger.info("gathered at least one relay candidate"),this.removeEventListener(),e(),delete this.cancelPromise;return}"complete"===this.context.peer.iceGatheringState&&(this.context.logger.info("done gathering ice candidates"),this.removeEventListener(),new s.default(this.context.peer.localDescription.sdp).hasCandidates()&&0!==this.context.iceCandidates.length?e():t(Error("no ice candidates were gathered")),delete this.cancelPromise)},this.context.peer.addEventListener("icecandidate",this.context.iceCandidateHandler),this.startTimestampMs=Date.now()})}catch(e){throw e}finally{this.startTimestampMs&&(this.context.iceGatheringDurationMs=Math.round(Date.now()-this.startTimestampMs))}})}}t.default=l,l.CHROME_VPN_TIMEOUT_MS=5e3},1960:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},s=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let l=a(i(3789)),d=a(i(5687)),c=a(i(7215)),u=o(i(7103)),h=a(i(9416)),f=a(i(2168)),p=i(289),m=a(i(1789));class g extends m.default{constructor(e){super(e.logger),this.context=e,this.taskName="JoinAndReceiveIndexTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return s(this,void 0,void 0,function*(){let e=yield new Promise((e,t)=>{let i=this.context;i.turnCredentials=null;class r{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(Error("JoinAndReceiveIndexTask got canceled while waiting for SdkIndexFrame"))}handleSignalingClientEvent(t){if(t.type===h.default.WebSocketClosed){let e=`The signaling connection was closed with code ${t.closeCode} and reason: ${t.closeReason}`;i.logger.warn(e);let r=d.default.SignalingBadRequest;4410===t.closeCode?(e="The meeting already ended.",i.logger.warn(e),r=d.default.MeetingEnded):t.closeCode>=4500&&t.closeCode<4600&&(r=d.default.SignalingInternalServerError),i.audioVideoController.handleMeetingSessionStatus(new l.default(r),Error(e));return}if(t.type===h.default.ReceivedSignalFrame){if(t.message.type===p.SdkSignalFrame.Type.JOIN_ACK){let e=t.message.joinack;if(!e){i.audioVideoController.handleMeetingSessionStatus(new l.default(d.default.SignalingRequestFailed),Error("Join ACK message did not include expected frame"));return}if(e.videoSubscriptionLimit&&(i.videoSubscriptionLimit=e.videoSubscriptionLimit),i.serverSupportsCompression=e.wantsCompressedSdp,void 0!==e.defaultServerSideNetworkAdaption&&e.defaultServerSideNetworkAdaption!==u.default.Default&&void 0!==i.videoDownlinkBandwidthPolicy.setServerSideNetworkAdaption){let t=e.defaultServerSideNetworkAdaption;i.logger.info(`Overriding server side network adaption value to ${t}`),i.videoDownlinkBandwidthPolicy.setServerSideNetworkAdaption(u.convertServerSideNetworkAdaptionEnumFromSignaled(t))}e&&e.turnCredentials?(i.turnCredentials=new c.default,i.turnCredentials.username=e.turnCredentials.username,i.turnCredentials.password=e.turnCredentials.password,i.turnCredentials.ttl=e.turnCredentials.ttl,i.turnCredentials.uris=e.turnCredentials.uris.map(e=>i.meetingSessionConfiguration.urls.urlRewriter(e)).filter(e=>!!e)):i.logger.error("missing TURN credentials in JoinAckFrame");return}t.message.type===p.SdkSignalFrame.Type.INDEX&&(this.signalingClient.removeObserver(this),e(t.message.index))}}}let n=new r(this.context.signalingClient);this.context.signalingClient.registerObserver(n),this.taskCanceler=n,this.context.previousSdpAnswerAsString="",this.context.previousSdpOffer=null,this.context.serverSupportsCompression=!1;let o=new f.default(this.context.meetingSessionConfiguration.applicationMetadata);void 0!==this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption&&void 0!==this.context.videoDownlinkBandwidthPolicy.supportedServerSideNetworkAdaptions&&(o.serverSideNetworkAdaption=this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption(),o.supportedServerSideNetworkAdaptions=this.context.videoDownlinkBandwidthPolicy.supportedServerSideNetworkAdaptions()),void 0!==this.context.videoDownlinkBandwidthPolicy.wantsAllTemporalLayersInIndex&&(o.wantsAllTemporalLayersInIndex=this.context.videoDownlinkBandwidthPolicy.wantsAllTemporalLayersInIndex()),o.disablePeriodicKeyframeRequestOnContentSender=this.context.meetingSessionConfiguration.disablePeriodicKeyframeRequestOnContentSender,this.context.signalingClient.join(o)});this.context.logger.info(`received first index ${JSON.stringify(e)}`),this.context.indexFrame=e})}}t.default=g},6180:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(9416)),s=i(289),a=n(i(1789));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="LeaveAndReceiveLeaveAckTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return r(this,void 0,void 0,function*(){this.context.signalingClient.ready()&&(this.context.signalingClient.leave(),this.context.logger.info("sent leave"),yield this.receiveLeaveAck())})}receiveLeaveAck(){return new Promise((e,t)=>{class i{constructor(e,t){this.signalingClient=e,this.logger=t}cancel(){this.signalingClient.removeObserver(this),t(Error("LeaveAndReceiveLeaveAckTask got canceled while waiting for IndexFrame"))}handleSignalingClientEvent(t){if(t.isConnectionTerminated()){this.signalingClient.removeObserver(this),this.logger.info("LeaveAndReceiveLeaveAckTask connection terminated"),e();return}t.type===o.default.ReceivedSignalFrame&&t.message.type===s.SdkSignalFrame.Type.LEAVE_ACK&&(this.signalingClient.removeObserver(this),this.logger.info("got leave ack"),e())}}let r=new i(this.context.signalingClient,this.context.logger);this.taskCanceler=r,this.context.signalingClient.registerObserver(r)})}}t.default=l},2748:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(9416)),s=i(289),a=n(i(1789));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="ListenForVolumeIndicatorsTask",this.realtimeMuteAndUnmuteHandler=e=>{this.context.signalingClient.mute(e)}}run(){return r(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.signalingClient.registerObserver(this),this.context.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(this.realtimeMuteAndUnmuteHandler)})}removeObserver(){this.context.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(this.realtimeMuteAndUnmuteHandler),this.context.signalingClient.removeObserver(this)}handleSignalingClientEvent(e){if(e.type===o.default.ReceivedSignalFrame){if(e.message.type===s.SdkSignalFrame.Type.AUDIO_STREAM_ID_INFO){let t=e.message.audioStreamIdInfo;this.context.volumeIndicatorAdapter.sendRealtimeUpdatesForAudioStreamIdInfo(t)}else if(e.message.type===s.SdkSignalFrame.Type.AUDIO_METADATA){let t=e.message.audioMetadata;this.context.volumeIndicatorAdapter.sendRealtimeUpdatesForAudioMetadata(t)}}}}t.default=l},1981:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(6196)),s=n(i(9496)),a=n(i(9708)),l=n(i(2977)),d=n(i(1922)),c=n(i(7752)),u=n(i(3789)),h=n(i(5687)),f=n(i(2330)),p=n(i(9416)),m=i(289),g=n(i(9880)),v=i(8660),b=n(i(1789));class y extends b.default{constructor(e,t,i){for(let r of(super(e.logger),this.context=e,this.initialConnectionHealthData=i,this.taskName="MonitorTask",this.prevSignalStrength=1,this.currentAvailableStreamAvgBitrates=null,this.hasSignalingError=!1,this.presenceHandlerCalled=!1,this.isResubscribeCheckPaused=!1,this.pendingMetricsReport=void 0,this.videoEncodingHealthPolicies=[],this.checkAndSendWeakSignalEvent=e=>{let t=e<1,i=this.prevSignalStrength<1,r=t?i?null:g.default.RedmicStartLoss:i?g.default.RedmicEndLoss:null;r&&this.context.statsCollector.logAudioEvent(r),this.prevSignalStrength=e},this.realtimeFatalErrorCallback=e=>{this.logger.error(`realtime error: ${e}: ${e.stack}`),this.context.audioVideoController.handleMeetingSessionStatus(new u.default(h.default.RealtimeApiFailed),e)},this.realtimeAttendeeIdPresenceHandler=(e,t)=>{var i;let r=this.context.meetingSessionConfiguration.credentials.attendeeId;this.logger.info(`attendeePresenceReceived: ${r}`),r===e&&t&&!this.presenceHandlerCalled&&(this.presenceHandlerCalled=!0,this.context.attendeePresenceDurationMs=Date.now()-this.context.startAudioVideoTimestamp,null===(i=this.context.eventController)||void 0===i||i.publishEvent("attendeePresenceReceived",{attendeePresenceDurationMs:this.context.attendeePresenceDurationMs}))},this.generateBaseAudioVideoEventAttributes=()=>{let{signalingOpenDurationMs:e,startTimeMs:t,iceGatheringDurationMs:i,attendeePresenceDurationMs:r,meetingStartDurationMs:n}=this.context;return{meetingDurationMs:null===t?0:Math.round(Date.now()-t),signalingOpenDurationMs:e,iceGatheringDurationMs:i,attendeePresenceDurationMs:r,meetingStartDurationMs:n}},this.generateAudioVideoEventAttributesForReceivingAudioDropped=()=>Object.assign(Object.assign({},this.generateBaseAudioVideoEventAttributes()),{maxVideoTileCount:this.context.maxVideoTileCount,poorConnectionCount:this.context.poorConnectionCount}),this.reconnectionHealthPolicy=new a.default(e.logger,Object.assign({},t),this.initialConnectionHealthData.clone()),this.unusableAudioWarningHealthPolicy=new d.default(Object.assign({},t),this.initialConnectionHealthData.clone()),this.sendingAudioFailureHealthPolicy=new l.default(e.logger,Object.assign({},t),this.initialConnectionHealthData.clone()),t.videoEncodingHealthPolicies))this.videoEncodingHealthPolicies.push(new r(Object.assign({},t),this.initialConnectionHealthData.clone()))}removeObserver(){this.context.audioVideoController.removeObserver(this),this.context.realtimeController.realtimeUnsubscribeToFatalError(this.realtimeFatalErrorCallback),this.context.realtimeController.realtimeUnsubscribeToLocalSignalStrengthChange(this.checkAndSendWeakSignalEvent),this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(this.realtimeAttendeeIdPresenceHandler),this.context.signalingClient.removeObserver(this)}run(){return r(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.audioVideoController.addObserver(this),this.context.realtimeController.realtimeSubscribeToFatalError(this.realtimeFatalErrorCallback),this.context.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(this.checkAndSendWeakSignalEvent),this.context.realtimeController.realtimeSubscribeToAttendeeIdPresence(this.realtimeAttendeeIdPresenceHandler),this.context.connectionMonitor.start(),this.context.statsCollector.start(this.context.signalingClient,this.context.videoStreamIndex),this.context.signalingClient.registerObserver(this)})}pauseResubscribeCheck(){this.isResubscribeCheckPaused=!0}resumeResubscribeCheck(){this.isResubscribeCheckPaused&&(this.isResubscribeCheckPaused=!1,this.pendingMetricsReport&&(this.context.logger.info("Resuming resubscribe check with pending metrics report"),this.checkResubscribe(this.pendingMetricsReport)&&this.context.audioVideoController.update({needsRenegotiation:!1})))}videoTileDidUpdate(e){this.context.maxVideoTileCount=Math.max(this.context.maxVideoTileCount,this.context.videoTileController.getAllVideoTiles().length)}checkResubscribe(e){if(this.isResubscribeCheckPaused){this.context.logger.info("Resubscribe check is paused, setting incoming client metric report as pending"),this.pendingMetricsReport=e;return}this.pendingMetricsReport=void 0;let t=e.getObservableMetrics(),i=t.availableOutgoingBitrate,r=t.nackCountReceivedPerSecond,n=!1;this.context.videoDownlinkBandwidthPolicy.updateMetrics(e);let o=this.context.videoDownlinkBandwidthPolicy.wantsResubscribe();if(n=n||o,o){let e=this.context.videoDownlinkBandwidthPolicy.chooseSubscriptions();this.context.videosToReceive=e.truncate(this.context.videoSubscriptionLimit),e.size()>this.context.videosToReceive.size()&&this.logger.warn(`Video receive limit exceeded. Limiting the videos to ${this.context.videosToReceive.size()}. Please consider using AllHighestVideoBandwidthPolicy or VideoPriorityBasedPolicy along with chooseRemoteVideoSources api to select the video sources to be displayed.`),this.logger.info(`trigger resubscribe for down=${o}; videosToReceive=[${this.context.videosToReceive.array()}]`)}if(this.context.videoTileController.hasStartedLocalVideoTile()){this.context.videoUplinkBandwidthPolicy.updateConnectionMetric({uplinkKbps:i/1e3,nackCountPerSecond:r});let e=this.context.videoUplinkBandwidthPolicy.wantsResubscribe();n=n||e,e&&(this.logger.info(`trigger resubscribe for up=${e}; videosToReceive=[${this.context.videosToReceive.array()}]`),this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters())}return n}metricsDidReceive(e){if(this.checkResubscribe(e)&&this.context.audioVideoController.update({needsRenegotiation:!1}),!this.currentAvailableStreamAvgBitrates)return;let t=e.streamMetricReports,i=new Map;for(let e in t)t[e].mediaType===s.default.VIDEO&&t[e].direction===o.default.DOWNSTREAM&&i.set(t[e].streamId,t[e])}connectionHealthDidChange(e){for(let t of(0===e.consecutiveMissedPongs&&this.context.reconnectController&&this.context.reconnectController.setLastActiveTimestampMs(Date.now()),this.applyHealthPolicy(this.reconnectionHealthPolicy,e,()=>{this.context.audioVideoController.handleMeetingSessionStatus(new u.default(h.default.ConnectionHealthReconnect),null)}),this.applyHealthPolicy(this.unusableAudioWarningHealthPolicy,e,()=>{var e;this.context.poorConnectionCount+=1;let t=this.generateAudioVideoEventAttributesForReceivingAudioDropped();null===(e=this.context.eventController)||void 0===e||e.publishEvent("receivingAudioDropped",t),this.context.videoTileController.haveVideoTilesWithStreams()?this.context.audioVideoController.forEachObserver(e=>{v.Maybe.of(e.connectionDidSuggestStopVideo).map(t=>t.bind(e)())}):this.context.audioVideoController.forEachObserver(e=>{v.Maybe.of(e.connectionDidBecomePoor).map(t=>t.bind(e)())})},()=>{this.context.audioVideoController.forEachObserver(e=>{v.Maybe.of(e.connectionDidBecomeGood).map(t=>t.bind(e)())})}),this.videoEncodingHealthPolicies))this.applyHealthPolicy(t,e,()=>{switch(this.degradeVideoCodec(t.name),t.name){case c.default.VideoEncodingCpuHealth:this.context.statsCollector.videoCodecDegradationHighEncodeCpuDidReceive();break;case c.default.VideoEncodingFramerateHealth:this.context.statsCollector.videoCodecDegradationEncodeFailureDidReceive();break;case c.default.VideoConcurrentSendersHealth:this.context.statsCollector.videoCodecDegradationConcurrentSendersDidReceive()}});this.context.isSessionConnected&&this.applyHealthPolicy(this.sendingAudioFailureHealthPolicy,e,()=>{var e;let t=this.generateBaseAudioVideoEventAttributes();null===(e=this.context.eventController)||void 0===e||e.publishEvent("sendingAudioFailed",t)},()=>{var e;let t=this.generateBaseAudioVideoEventAttributes();null===(e=this.context.eventController)||void 0===e||e.publishEvent("sendingAudioRecovered",t)})}applyHealthPolicy(e,t,i,r){e.update(t);let n=e.healthIfChanged();null!==n&&(this.logger.info(`${e.name} value is now ${n}`),n<=e.minimumHealth()?v.Maybe.of(i).map(e=>e.bind(this)()):v.Maybe.of(r).map(e=>e.bind(this)()))}handleBitrateFrame(e){this.currentAvailableStreamAvgBitrates=e,e.serverAvailableOutgoingBitrate>0&&(this.logger.info(`Received server side estimation of available incoming bitrate ${e.serverAvailableOutgoingBitrate}kbps`),this.context.statsCollector.overrideObservableMetric("availableIncomingBitrate",1e3*e.serverAvailableOutgoingBitrate))}handleSignalingClientEvent(e){var t;if(e.type===p.default.WebSocketClosed&&this.isUnexpectedWebsocketCloseCode(e.closeCode)||e.type===p.default.WebSocketError||e.type===p.default.WebSocketFailed){if(e.type===p.default.WebSocketClosed&&this.context.logger.info(`The signaling connection was closed with code ${e.closeCode} and reason: ${e.closeReason}`),!this.hasSignalingError){let e=this.generateAudioVideoEventAttributesForReceivingAudioDropped();null===(t=this.context.eventController)||void 0===t||t.publishEvent("signalingDropped",e),this.hasSignalingError=!0}this.context.isSessionConnected&&this.context.audioVideoController.handleMeetingSessionStatus(new u.default(this.isInternalServerFailureCloseCode(e.closeCode)?h.default.SignalingInternalServerError:h.default.SignalingChannelClosedUnexpectedly),null)}else e.type===p.default.WebSocketOpen&&(this.hasSignalingError=!1);if(e.type===p.default.ReceivedSignalFrame){if(e.message.type===m.SdkSignalFrame.Type.NOTIFICATION){switch(e.message.notification.level){case m.SdkNotificationFrame.NotificationLevel.INFO:this.logger.info(`Received notification from server: ${e.message.notification.message}`);break;case m.SdkNotificationFrame.NotificationLevel.WARNING:this.logger.warn(`Received warning from server: ${e.message.notification.message}`);break;case m.SdkNotificationFrame.NotificationLevel.ERROR:this.logger.error(`Received error from server: ${e.message.notification.message}`);break;default:this.logger.error(`Received notification from server with unknown level ${e.message.notification.level}: ${e.message.notification.message}`)}return}if(e.message.bitrates){let t=e.message.bitrates;this.context.videoStreamIndex.integrateBitratesFrame(t),this.context.videoDownlinkBandwidthPolicy.updateIndex(this.context.videoStreamIndex),this.handleBitrateFrame(e.message.bitrates)}let t=u.default.fromSignalFrame(e.message);e.message.type!==m.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN_ACK&&t.statusCode()!==h.default.OK&&this.context.audioVideoController.handleMeetingSessionStatus(t,null)}}isUnexpectedWebsocketCloseCode(e){return 1006===e||this.isInternalServerFailureCloseCode(e)}isInternalServerFailureCloseCode(e){return e>=4500&&e<4600}degradeVideoCodec(e){if(void 0!==this.context.meetingSupportedVideoSendCodecPreferences&&this.context.meetingSupportedVideoSendCodecPreferences.length>1&&!(this.context.meetingSupportedVideoSendCodecPreferences[0].equals(f.default.h264ConstrainedBaselineProfile())||this.context.meetingSupportedVideoSendCodecPreferences[0].equals(f.default.vp8()))){let t=[];for(let e of this.context.videoSendCodecPreferences)e.equals(this.context.meetingSupportedVideoSendCodecPreferences[0])||t.push(e);t.length>0?(this.context.logger.info(`Downgrading codec from ${this.context.meetingSupportedVideoSendCodecPreferences[0].codecName} to ${t[0].codecName} due to ${e}`),this.context.degradedVideoSendCodecs.push(this.context.meetingSupportedVideoSendCodecPreferences[0]),this.context.meetingSupportedVideoSendCodecPreferences=t,this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs&&this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs(this.context.meetingSupportedVideoSendCodecPreferences,this.context.videoSendCodecPreferences),this.context.audioVideoController.update({needsRenegotiation:!0})):this.context.logger.warn(`Degrading video codec failed since there is no alternative codec to select. Currently degraded codecs: ${this.context.degradedVideoSendCodecs.map(e=>e.codecName).join(",")}`)}}}t.default=y},8831:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{cancel(){}name(){return"NoOpTask"}run(){return Promise.resolve()}setParent(e){}}t.default=i},1124:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(813)),o=r(i(7797));class s{constructor(e,t,i){this.logger=e,this.task=t,this.dependencies=i,this.canceled=!1}name(){return`${this.task.name()} (once)`}cancel(){if(!this.canceled){if(this.dependencies)for(let e of this.dependencies)e.cancel();this.logger.info(`Canceling ${this.name()}`),o.default.nextTick(()=>this.task.cancel()),this.canceled=!0,this.cancelPromise&&o.default.nextTick(()=>this.cancelPromise(Error(`canceling ${this.name()}`)))}}logDependencies(){if(this.logger.getLogLevel()>n.default.INFO||!this.dependencies)return;let e=this.dependencies.filter(e=>e).map(e=>e.name()).join(", ");this.logger.info(`${this.task.name()} waiting for dependencies: ${e}`)}run(){if(this.promise)return this.promise;let e=this.dependencies?Promise.all(this.dependencies.map(e=>null==e?void 0:e.run())):Promise.resolve();return this.logDependencies(),this.ongoing=e.then(()=>this.task.run()),this.promise=new Promise((e,t)=>{this.cancelPromise=t,this.ongoing.then(e).catch(t)})}setParent(e){this.task.setParent(e)}}t.default=s},4543:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(3920)),s=n(i(9416)),a=n(i(1789));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="OpenSignalingConnectionTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return r(this,void 0,void 0,function*(){let e=this.context.meetingSessionConfiguration;this.context.signalingClient.openConnection(new o.default(e.urls.signalingURL,e.credentials.joinToken));let t=Date.now();try{yield new Promise((e,t)=>{class i{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(Error("OpenSignalingConnectionTask got canceled while waiting to open signaling connection"))}handleSignalingClientEvent(i){switch(i.type){case s.default.WebSocketOpen:this.signalingClient.removeObserver(this),e();break;case s.default.WebSocketFailed:this.signalingClient.removeObserver(this),t(Error("WebSocket connection failed"))}}}let r=new i(this.context.signalingClient);this.context.signalingClient.registerObserver(r),this.taskCanceler=r})}catch(e){throw e}finally{this.context.signalingOpenDurationMs=Math.round(Date.now()-t),this.logger.info(`Opening signaling connection took ${this.context.signalingOpenDurationMs} ms`)}})}}t.default=l},8556:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1789));class s extends o.default{constructor(e,t,i){for(let r of(super(e),this.taskName=t,this.tasksToRunParallel=i,i))r.setParent(this)}cancel(){for(let e of this.tasksToRunParallel)this.logger.info(`canceling parallel group task ${this.name()} subtask ${e.name()}`),e.cancel()}run(){return r(this,void 0,void 0,function*(){let e=[];for(let t of this.tasksToRunParallel)this.logger.info(`parallel group task ${this.name()} running subtask ${t.name()}`),e.push(t.run());let t=[];for(let i=0;i<e.length;i++){try{yield e[i]}catch(e){t.push(`task ${this.tasksToRunParallel[i].name()} failed: ${e.message}`)}this.logger.info(`parallel group task ${this.name()} completed subtask ${this.tasksToRunParallel[i].name()}`)}if(t.length>0){let e=t.join(", ");this.logAndThrow(`parallel group task ${this.name()} failed for tasks: ${e}`)}this.logger.info(`parallel group task ${this.name()} completed`)})}}t.default=s},9945:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=i(3204),s=n(i(9416)),a=i(289),l=n(i(1789));class d extends l.default{constructor(e,t,i){super(e.logger),this.context=e,this.credentials=t,this.completionCallback=i,this.taskName="PromoteToPrimaryMeetingTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return r(this,void 0,void 0,function*(){this.context.signalingClient.ready()?(this.context.signalingClient.promoteToPrimaryMeeting(this.credentials),this.context.logger.info("Sent request to join primary meeting"),yield this.receivePrimaryMeetingJoinAck()):this.completionCallback(new o.MeetingSessionStatus(o.MeetingSessionStatusCode.SignalingRequestFailed))})}receivePrimaryMeetingJoinAck(){return new Promise((e,t)=>{class i{constructor(e,t,i){this.signalingClient=e,this.completionCallback=t,this.logger=i}cancel(){this.signalingClient.removeObserver(this),this.completionCallback(new o.MeetingSessionStatus(o.MeetingSessionStatusCode.SignalingRequestFailed)),e()}handleSignalingClientEvent(t){t.isConnectionTerminated()&&(this.signalingClient.removeObserver(this),this.logger.info("PromoteToPrimaryMeetingTask connection terminated"),this.completionCallback(new o.MeetingSessionStatus(o.MeetingSessionStatusCode.SignalingRequestFailed)),e()),t.type===s.default.ReceivedSignalFrame&&t.message.type===a.SdkSignalFrame.Type.PRIMARY_MEETING_JOIN_ACK&&(this.signalingClient.removeObserver(this),this.logger.info("Got a primary meeting join ACK"),this.completionCallback(o.MeetingSessionStatus.fromSignalFrame(t.message)),e())}}let r=new i(this.context.signalingClient,this.completionCallback,this.context.logger);this.taskCanceler=r,this.context.signalingClient.registerObserver(r)})}}t.default=d},1209:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1789));class s extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveAudioInputTask"}run(){var e,t;return r(this,void 0,void 0,function*(){let i;if(!(null===(t=null===(e=this.context.meetingSessionConfiguration)||void 0===e?void 0:e.urls)||void 0===t?void 0:t.audioHostURL)){this.context.logger.info("No audio connection: not acquiring audio input");return}if(this.context.activeAudioInput){this.context.logger.info("an active audio input exists");return}try{i=yield this.context.mediaStreamBroker.acquireAudioInputStream()}catch(e){this.context.logger.warn("could not acquire audio input from current device")}i?this.context.activeAudioInput=i:this.context.logger.warn("an audio input is not available")})}}t.default=s},6274:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(9416)),s=i(289),a=n(i(1789));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveRemoteVideoPauseResume",this.serverPausedVideoTileIds=new Set}removeObserver(){this.context.signalingClient.removeObserver(this)}run(){return r(this,void 0,void 0,function*(){this.context.signalingClient.registerObserver(this),this.context.removableObservers.push(this)})}updateSubscribedGroupdIds(e){let t=new Set;for(let i of e){let e=this.context.videoStreamIndex.attendeeIdForGroupId(i);if(0===e.length){this.logger.warn(`Could not find attendee ID for newly subscribed group ID ${i}`);continue}let r=this.context.videoTileController.getVideoTileForAttendeeId(e);void 0===r&&(this.logger.info(`No existing video tile for attendee ID ${e} with new group ID ${i}. Creating new one.`),(r=this.context.videoTileController.addVideoTile()).bindVideoStream(e,!1,null,0,0,0,null)),t.add(r.id())}this.serverPausedVideoTileIds.forEach(e=>{t.has(e)||this.serverPausedVideoTileIds.delete(e)})}handleSignalingClientEvent(e){if(e.type!==o.default.ReceivedSignalFrame||e.message.type!==s.SdkSignalFrame.Type.PAUSE&&e.message.type!==s.SdkSignalFrame.Type.RESUME)return;let t=e.message.pause,i=e.message.type;if(this.logger.info(`Received new ${i===s.SdkSignalFrame.Type.PAUSE?"pause":"resume"} frame: ${JSON.stringify(t)}`),t&&void 0!==this.context.videoTileController.getVideoTileForAttendeeId&&void 0!==this.context.videoDownlinkBandwidthPolicy.forEachObserver&&void 0!==this.context.videoStreamIndex.attendeeIdForGroupId)for(let e of t.groupIds.map(e=>{let t=this.context.videoStreamIndex.attendeeIdForGroupId(e);if(0===t.length){this.logger.warn(`Could not find attendee ID for paused group ID ${e}`);return}return this.context.videoTileController.getVideoTileForAttendeeId(t)}))void 0!==e&&(i===s.SdkSignalFrame.Type.PAUSE?e.state().paused||(this.serverPausedVideoTileIds.add(e.id()),this.context.videoDownlinkBandwidthPolicy.forEachObserver(t=>{t.tileWillBePausedByDownlinkPolicy(e.id())}),e.pause()):e.state().paused&&this.serverPausedVideoTileIds.has(e.id())&&(this.serverPausedVideoTileIds.delete(e.id()),this.context.videoDownlinkBandwidthPolicy.forEachObserver(t=>{t.tileWillBeUnpausedByDownlinkPolicy(e.id())}),e.unpause()))}}t.default=l},120:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(214)),s=i(289),a=n(i(1789));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveVideoInputTask"}checkAndApplyVideoConstraint(e,t,i,n,o){return r(this,void 0,void 0,function*(){let r=e?this.context.meetingSessionConfiguration.meetingFeatures.contentMaxResolution:this.context.meetingSessionConfiguration.meetingFeatures.videoMaxResolution;if(!e&&i<=r.videoWidth&&n<=r.videoHeight&&o<=r.videoFrameRate)return;let s={resizeMode:{ideal:"none"},width:{max:r.videoWidth},height:{max:r.videoHeight},frameRate:{ideal:o,max:r.videoFrameRate}};try{yield t.applyConstraints(s)}catch(t){this.context.logger.info(`Could not apply constraint for video track (content = ${e})`)}})}run(){return r(this,void 0,void 0,function*(){let e;let t=this.context.videoDuplexMode===s.SdkStreamServiceType.RX||this.context.videoDuplexMode===s.SdkStreamServiceType.DUPLEX;if(this.context.videoTileController.hasStartedLocalVideoTile()?this.context.videoDuplexMode=t?s.SdkStreamServiceType.DUPLEX:s.SdkStreamServiceType.TX:this.context.videoDuplexMode=t?s.SdkStreamServiceType.RX:0,this.context.videoCaptureAndEncodeParameter=this.context.videoUplinkBandwidthPolicy.chooseCaptureAndEncodeParameters(),!this.context.videoTileController.hasStartedLocalVideoTile()){this.context.logger.info("has not started local video tile"),this.context.activeVideoInput&&(this.context.activeVideoInput=void 0,this.context.videoStreamIndex.integrateUplinkPolicyDecision([]));return}let i=this.context.videoTileController.getLocalVideoTile();try{e=yield this.context.mediaStreamBroker.acquireVideoInputStream()}catch(e){this.context.logger.warn("could not acquire video input from current device"),this.context.videoTileController.stopLocalVideoTile()}if(this.context.enableSimulcast){let e=this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters();this.context.videoStreamIndex.integrateUplinkPolicyDecision(Array.from(e.values()))}if(this.context.activeVideoInput=e,e){let t=e.getVideoTracks();if(!t||0===t.length)return;let r=this.context.meetingSessionConfiguration.credentials.attendeeId,n=new o.default(r).hasModality(o.default.MODALITY_CONTENT),s=t[0].getSettings();this.checkAndApplyVideoConstraint(n,t[0],s.width,s.height,s.frameRate);let a=this.context.audioVideoController.configuration.credentials.externalUserId;for(let n of(i.bindVideoStream(r,!0,e,s.width,s.height,null,a),t))this.logger.info(`Using video device label=${n.label} id=${n.id}`),this.context.videoDeviceInformation.current_camera_name=n.label,this.context.videoDeviceInformation.current_camera_id=n.id}})}}t.default=l},9560:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(5723)),s=n(i(214)),a=n(i(2330)),l=n(i(9416)),d=i(289),c=i(8660),u=n(i(1789));class h extends u.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveVideoStreamIndexTask",this.isIngestionPaused=!1,this.pendingIndex=null}removeObserver(){this.context.signalingClient.removeObserver(this)}run(){return r(this,void 0,void 0,function*(){this.handleIndexFrame(this.context.indexFrame),this.context.signalingClient.registerObserver(this),this.context.removableObservers.push(this)})}handleSignalingClientEvent(e){if(e.type!==l.default.ReceivedSignalFrame||e.message.type!==d.SdkSignalFrame.Type.INDEX)return;let t=e.message.index;this.context.logger.info(`received new index ${JSON.stringify(t)}`),this.handleIndexFrame(t)}pauseIngestion(){this.isIngestionPaused=!0}resumeIngestion(){this.isIngestionPaused&&(this.isIngestionPaused=!1,this.pendingIndex&&(this.context.logger.info("Resuming index ingestion with pending index"),this.handleIndexFrame(this.pendingIndex)))}handleIndexFrame(e){if(!e)return;if(this.isIngestionPaused){this.context.logger.info("Index ingestion is paused, setting most recent index as pending"),this.pendingIndex=e;return}this.pendingIndex=null;let t=this.context.audioVideoController.configuration.credentials.attendeeId;e.sources=e.sources.filter(e=>{let i=new s.default(e.attendeeId);return!(i.base()===t&&i.hasModality(s.default.MODALITY_CONTENT))});let{videoStreamIndex:i,videoDownlinkBandwidthPolicy:r,videoUplinkBandwidthPolicy:n}=this.context,o=i.allVideoSendingSourcesExcludingSelf(t);i.integrateIndexFrame(e),r.updateIndex(i),n.updateIndex(i),this.resubscribe(r,n),this.updateVideoAvailability(e),this.handleIndexVideosPausedAtSource(),e.supportedReceiveCodecIntersection.length>0&&this.handleSupportedVideoReceiveCodecIntersection(e);let a=i.allVideoSendingSourcesExcludingSelf(t);this.areVideoSourcesEqual(o,a)||this.context.audioVideoController.forEachObserver(e=>{c.Maybe.of(e.remoteVideoSourcesDidChange).map(t=>t.bind(e)(a))})}areVideoSourcesEqual(e,t){if(e.length!==t.length)return!1;let i=(e,t)=>e.attendee.attendeeId.localeCompare(t.attendee.attendeeId),r=[...e].sort(i),n=[...t].sort(i);for(let e=0;e<r.length;e++)if(r[e].attendee.attendeeId!==n[e].attendee.attendeeId)return!1;return!0}resubscribe(e,t){let i=e.wantsResubscribe(),r=(this.context.videoDuplexMode===d.SdkStreamServiceType.TX||this.context.videoDuplexMode===d.SdkStreamServiceType.DUPLEX)&&t.wantsResubscribe(),n=i||r;if(this.logger.info(`should resubscribe: ${n} (downlink: ${i} uplink: ${r})`),!n)return;let o=e.chooseSubscriptions();this.context.videosToReceive=o.truncate(this.context.videoSubscriptionLimit),o.size()>this.context.videosToReceive.size()&&this.logger.warn(`Video receive limit exceeded. Limiting the videos to ${this.context.videosToReceive.size()}. Please consider using AllHighestVideoBandwidthPolicy or VideoPriorityBasedPolicy along with chooseRemoteVideoSources api to select the video sources to be displayed.`),this.context.videoCaptureAndEncodeParameter=t.chooseCaptureAndEncodeParameters(),this.logger.info(`trigger resubscribe for up=${r} down=${i}; videosToReceive=[${this.context.videosToReceive.array()}] captureParams=${JSON.stringify(this.context.videoCaptureAndEncodeParameter)}`),this.context.audioVideoController.update({needsRenegotiation:!1})}updateVideoAvailability(e){if(!this.context.videosToReceive){this.logger.error("videosToReceive must be set in the meeting context.");return}let t=new o.default;t.remoteVideoAvailable=!this.context.videosToReceive.empty(),t.canStartLocalVideo=!e.atCapacity,this.context.lastKnownVideoAvailability&&this.context.lastKnownVideoAvailability.equal(t)||(this.context.lastKnownVideoAvailability=t.clone(),this.context.audioVideoController.forEachObserver(e=>{c.Maybe.of(e.videoAvailabilityDidChange).map(i=>i.bind(e)(t.clone()))}))}handleSupportedVideoReceiveCodecIntersection(e){if(void 0===this.context.videoSendCodecPreferences)return;let t=[],i=!1;for(let i of this.context.videoSendCodecPreferences){if(this.context.degradedVideoSendCodecs.some(e=>i.equals(e))){this.logger.info(`Skipping ${i.codecName} since the codec has been identfied as degraded`);continue}for(let r of e.supportedReceiveCodecIntersection)if(i.equals(a.default.fromSignaled(r))){t.push(i);break}}if(t.length>0){let e=t.find(e=>this.context.prioritizedSendVideoCodecCapabilities.some(t=>e.equals(t)));void 0===this.context.currentVideoSendCodec||void 0!==e&&this.context.currentVideoSendCodec.equals(e)||(i=!0),this.context.meetingSupportedVideoSendCodecPreferences=t}else this.logger.warn("Interesection of meeting receive codec support and send codec preferences has no overlap, falling back to just values provided in `setVideoCodecSendPreferences`"),this.context.meetingSupportedVideoSendCodecPreferences=void 0;this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs&&this.context.videoUplinkBandwidthPolicy.setMeetingSupportedVideoSendCodecs(this.context.meetingSupportedVideoSendCodecPreferences,this.context.videoSendCodecPreferences),i&&this.context.audioVideoController.update({needsRenegotiation:!0})}handleIndexVideosPausedAtSource(){let e=this.context.videoStreamIndex.streamsPausedAtSource();for(let t of this.context.videoTileController.getAllVideoTiles()){let i=t.state();e.contain(i.streamId)?t.markPoorConnection()&&this.logger.info(`marks the tile ${i.tileId} as having a poor connection`):t.unmarkPoorConnection()&&this.logger.info(`unmarks the tile ${i.tileId} as having a poor connection`)}}}t.default=h},4191:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(1789));class o extends n.default{constructor(e,t,i="RunnableTask"){super(e),this.fn=t,this.taskName=i}run(){return this.fn().then(()=>{})}}t.default=o},9485:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1018)),s=n(i(9416)),a=i(289),l=n(i(1789));class d extends l.default{constructor(e){super(e.logger),this.context=e,this.taskName="SendAndReceiveDataMessagesTask",this.sendDataMessageHandler=(e,t,i)=>{if(this.context.signalingClient.ready()){let r;t instanceof Uint8Array?r=t:r="string"==typeof t?new TextEncoder().encode(t):new TextEncoder().encode(JSON.stringify(t)),this.validateDataMessage(e,r,i);let n=a.SdkDataMessagePayload.create();n.topic=e,n.lifetimeMs=i,n.data=r;let o=a.SdkDataMessageFrame.create();o.messages=[n],this.context.signalingClient.sendDataMessage(o)}else this.context.logger.error("Cannot send data message because signaling client is not ready")}}run(){return r(this,void 0,void 0,function*(){this.context.removableObservers.push(this),this.context.signalingClient.registerObserver(this),this.context.realtimeController.realtimeSubscribeToSendDataMessage(this.sendDataMessageHandler)})}removeObserver(){this.context.realtimeController.realtimeUnsubscribeFromSendDataMessage(this.sendDataMessageHandler),this.context.signalingClient.removeObserver(this)}handleSignalingClientEvent(e){if(e.type===s.default.ReceivedSignalFrame&&e.message.type===a.SdkSignalFrame.Type.DATA_MESSAGE)for(let t of e.message.dataMessage.messages){let e=new o.default(t.ingestTimeNs/1e6,t.topic,t.data,t.senderAttendeeId,t.senderExternalUserId,0===t.ingestTimeNs);this.context.realtimeController.realtimeReceiveDataMessage(e)}}validateDataMessage(e,t,i){if(!d.TOPIC_REGEX.test(e))throw Error("Invalid topic");if(t.length>d.DATA_SIZE)throw Error("Data size has to be less than 2048 bytes");if(i&&i<0)throw Error("The life time of the message has to be non negative")}}t.default=d,d.TOPIC_REGEX=new RegExp(/^[a-zA-Z0-9_-]{1,36}$/),d.DATA_SIZE=2048},7079:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1789)),s=n(i(4456));class a extends o.default{constructor(e,t,i){for(let r of(super(e),this.taskName=t,this.tasksToRunSerially=i,this.currentTask=null,i))r.setParent(this)}cancel(){this.currentTask&&(this.logger.info(`canceling serial group task ${this.name()} subtask ${this.currentTask.name()}`),this.currentTask.cancel())}run(){return r(this,void 0,void 0,function*(){for(let e of this.tasksToRunSerially){this.getStatus()===s.default.CANCELED&&this.logAndThrow(`serial group task ${this.name()} was canceled`);try{this.logger.info(`serial group task ${this.name()} running subtask ${e.name()}`),this.currentTask=e,yield e.run(),this.logger.info(`serial group task ${this.name()} completed subtask ${e.name()}`)}catch(e){this.logAndThrow(`serial group task ${this.name()} was canceled due to subtask ${this.currentTask.name()} error: ${e.message}`)}finally{this.currentTask=null}}this.logger.info(`serial group task ${this.name()} completed`)})}}t.default=a},4833:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(543)),s=n(i(326)),a=n(i(1789));class l extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="SetLocalDescriptionTask"}cancel(){if(this.cancelPromise){let e=Error(`canceling ${this.name()}`);this.cancelPromise(e),delete this.cancelPromise}}run(){return r(this,void 0,void 0,function*(){let e=this.context.peer,t=this.context.sdpOfferInit.sdp;if(this.context.browserBehavior.supportsVideoLayersAllocationRtpHeaderExtension()&&(t=new s.default(t).withVideoLayersAllocationRtpHeaderExtension(this.context.previousSdpOffer).sdp),this.context.browserBehavior.supportsDependencyDescriptorRtpHeaderExtension()&&void 0!==this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension&&this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension()&&(t=new s.default(t).withDependencyDescriptorRtpHeaderExtension(this.context.previousSdpOffer).sdp),new o.default().requiresDisablingH264Encoding()&&(t=new s.default(t).removeH264SupportFromSendSection().sdp),t=new s.default(t).withStartingVideoSendBitrate(1e3).sdp,void 0!==this.context.videoSendCodecPreferences&&this.context.videoSendCodecPreferences.length>0&&(t=new s.default(t).withVideoSendCodecPreferences(void 0!==this.context.meetingSupportedVideoSendCodecPreferences?this.context.meetingSupportedVideoSendCodecPreferences:this.context.videoSendCodecPreferences).sdp),this.context.audioProfile&&(t=new s.default(t).withAudioMaxAverageBitrate(this.context.audioProfile.audioBitrateBps).sdp,this.context.audioProfile.isStereo()&&(t=new s.default(t).withStereoAudio().sdp),this.context.audioProfile.hasRedundancyEnabled())){let e=new s.default(t).getAudioPayloadTypes();this.context.transceiverController&&this.context.transceiverController.setAudioPayloadTypes&&this.context.transceiverController.setAudioPayloadTypes(e)}this.logger.debug(()=>`local description is >>>${t}<<<`);let i={type:"offer",sdp:t,toJSON:null};yield new Promise((t,n)=>r(this,void 0,void 0,function*(){this.cancelPromise=e=>{n(e)};try{yield e.setLocalDescription(i),t()}catch(e){n(e)}finally{delete this.cancelPromise}})),this.context.logger.info("set local description")})}}t.default=l},5275:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(214)),s=n(i(326)),a=n(i(2330)),l=n(i(1789));class d extends l.default{constructor(e){super(e.logger),this.context=e,this.taskName="SetRemoteDescriptionTask"}cancel(){this.cancelICEPromise&&this.cancelICEPromise()}run(){var e;return r(this,void 0,void 0,function*(){this.context.peer||this.logAndThrow("session does not have peer connection; bypass set remote description");let t=this.context.sdpAnswer;t=new s.default(t).withoutServerReflexiveCandidates().sdp,this.context.audioProfile&&(t=new s.default(t).withAudioMaxAverageBitrate(this.context.audioProfile.audioBitrateBps).sdp,this.context.audioProfile.isStereo()&&(t=new s.default(t).withStereoAudio().sdp)),void 0!==this.context.videoSendCodecPreferences&&this.context.videoSendCodecPreferences.length>0&&(t=new s.default(t).withVideoSendCodecPreferences(void 0!==this.context.meetingSupportedVideoSendCodecPreferences?this.context.meetingSupportedVideoSendCodecPreferences:this.context.videoSendCodecPreferences).sdp),this.context.prioritizedSendVideoCodecCapabilities=new s.default(t).prioritizedSendVideoCodecCapabilities(),this.context.currentVideoSendCodec=this.context.prioritizedSendVideoCodecCapabilities.length>0?this.context.prioritizedSendVideoCodecCapabilities[0]:void 0;let i=this.context.activeVideoInput;if(void 0!==i){let t=this.context.audioVideoController.configuration.credentials.attendeeId,r=new o.default(t).hasModality(o.default.MODALITY_CONTENT),n=i.getVideoTracks()[0];r&&((null===(e=this.context.currentVideoSendCodec)||void 0===e?void 0:e.codecName)===a.default.av1Main().codecName?(n.contentHint="text",this.logger.info(`Setting content hint to text for AV1, attendee: ${t}`)):this.context.audioVideoController.configuration.enableSVC&&(n.contentHint="motion",this.logger.info(`Setting content hint to motion to enable SVC, attendee: ${t}`)))}this.logger.info(`processed remote description is >>>${t}<<<`);let r={type:"answer",sdp:t,toJSON:null};try{yield this.createICEConnectionCompletedPromise(r)}catch(e){throw e}})}createICEConnectionCompletedPromise(e){return new Promise((t,i)=>r(this,void 0,void 0,function*(){let r=()=>{("connected"===this.context.peer.iceConnectionState||"completed"===this.context.peer.iceConnectionState)&&(this.context.peer.removeEventListener("iceconnectionstatechange",r),t())};this.cancelICEPromise=()=>{this.context.peer&&this.context.peer.removeEventListener("iceconnectionstatechange",r),i(Error(`${this.name()} got canceled while waiting for the ICE connection state`))},this.context.peer.addEventListener("iceconnectionstatechange",r);try{yield this.context.peer.setRemoteDescription(e),this.logger.info("set remote description, waiting for ICE connection"),r()}catch(e){i(e)}}))}}t.default=d},5924:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(3789)),s=n(i(5687)),a=n(i(326)),l=n(i(3320)),d=i(7103),c=n(i(9416)),u=n(i(6729)),h=i(289),f=i(1819),p=n(i(1789));class m extends p.default{constructor(e){super(e.logger),this.context=e,this.taskName="SubscribeAndReceiveSubscribeAckTask",this.taskCanceler=null,this.textCompressor=new l.default(e.logger)}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return r(this,void 0,void 0,function*(){let e,t="";if(this.context.peer&&this.context.peer.localDescription&&(t=new a.default(this.context.peer.localDescription.sdp).withUnifiedPlanFormat().sdp),!this.context.enableSimulcast){let e=0,t=0;this.context.videoCaptureAndEncodeParameter&&(e=this.context.videoCaptureAndEncodeParameter.captureFrameRate(),t=this.context.videoCaptureAndEncodeParameter.encodeBitrates()[0]);let i={rid:"hi",maxBitrate:1e3*t,maxFramerate:e,active:!0};this.context.videoStreamIndex.integrateUplinkPolicyDecision([i])}let i=this.fixUpSubscriptionOrder(t,this.context.videoSubscriptions),r=this.context.videoDuplexMode===h.SdkStreamServiceType.TX||this.context.videoDuplexMode===h.SdkStreamServiceType.DUPLEX,n=t;if(void 0!==this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension&&this.context.videoUplinkBandwidthPolicy.wantsVideoDependencyDescriptorRtpHeaderExtension()||(n=new a.default(n).withoutDependencyDescriptorRtpHeaderExtension().sdp),this.context.serverSupportsCompression){let i=this.context.previousSdpOffer?this.context.previousSdpOffer.sdp:"";e=this.textCompressor.compress(n,i),this.context.logger.info(`Compressed the SDP message from ${n.length} to ${e.length} bytes.`),t=""}this.context.previousSdpOffer=new a.default(t);let o=new u.default(this.context.meetingSessionConfiguration.credentials.attendeeId,t,this.context.meetingSessionConfiguration.urls.audioHostURL,this.context.realtimeController.realtimeIsLocalAudioMuted(),!1,i,r,this.context.videoStreamIndex.localStreamDescriptions(),!0,e);void 0===this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption||d.serverSideNetworkAdaptionIsNoneOrDefault(this.context.videoDownlinkBandwidthPolicy.getServerSideNetworkAdaption())||void 0===this.context.videoDownlinkBandwidthPolicy.getVideoPreferences||(o.videoSubscriptionConfiguration=f.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration(this.context,i.map(e=>0===e?0:this.context.videoStreamIndex.groupIdForStreamId(e)),this.context.videoDownlinkBandwidthPolicy.getVideoPreferences())),this.context.logger.info(`sending subscribe: ${JSON.stringify(o)}`),this.context.signalingClient.subscribe(o);let s=yield this.receiveSubscribeAck();this.context.logger.info(`got subscribe ack: ${JSON.stringify(s)}`);let l="";s.compressedSdpAnswer&&s.compressedSdpAnswer.length?(0===(l=this.textCompressor.decompress(s.compressedSdpAnswer,this.context.previousSdpAnswerAsString)).length&&(this.context.sdpAnswer="",this.context.previousSdpAnswerAsString="",this.logAndThrow("Error occurred while trying to decompress the SDP answer.")),this.context.logger.info(`Decompressed the SDP message from ${s.compressedSdpAnswer.length} to ${l.length} bytes.`),this.context.sdpAnswer=l):this.context.sdpAnswer=s.sdpAnswer,this.context.previousSdpAnswerAsString=this.context.sdpAnswer,this.context.videoStreamIndex.integrateSubscribeAckFrame(s)})}fixUpSubscriptionOrder(e,t){if(void 0===this.context.transceiverController.getMidForStreamId)return t;let i=new Map;for(let e of t){let t=this.context.transceiverController.getMidForStreamId(e);if(void 0===t){0!==e&&this.logger.warn(`Could not find MID for stream ID: ${e}`);continue}i.set(t,e)}let r=new a.default(e).mediaSections(),n=[];for(let e of r)if("video"===e.mediaType){if("recvonly"===e.direction){let t=i.get(e.mid);if(void 0===t){this.logger.warn(`Could not find stream ID for MID: ${e.mid}`);continue}n.push(t)}else n.push(0)}return this.logger.info(`Fixed up ${JSON.stringify(t)} to ${JSON.stringify(n)} (may be same))}`),n}receiveSubscribeAck(){return new Promise((e,t)=>{let i=this.context;class r{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(Error("SubscribeAndReceiveSubscribeAckTask got canceled while waiting for SdkSubscribeAckFrame"))}handleSignalingClientEvent(t){if(t.isConnectionTerminated()){let e=`SubscribeAndReceiveSubscribeAckTask connection was terminated with code ${t.closeCode} and reason: ${t.closeReason}`;i.logger.warn(e);let r=s.default.TaskFailed;t.closeCode>=4500&&t.closeCode<4600&&(r=s.default.SignalingInternalServerError),i.audioVideoController.handleMeetingSessionStatus(new o.default(r),Error(e));return}t.type===c.default.ReceivedSignalFrame&&t.message.type===h.SdkSignalFrame.Type.SUBSCRIBE_ACK&&(this.signalingClient.removeObserver(this),e(t.message.suback))}}let n=new r(this.context.signalingClient);this.context.signalingClient.registerObserver(n),this.taskCanceler=n})}}t.default=m},4456:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.IDLE="IDLE",e.RUNNING="RUNNING",e.CANCELED="CANCELED",e.FINISHED="FINISHED"}(i||(i={})),t.default=i},250:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(4929)),s=n(i(1789));class a extends s.default{constructor(e,t,i){super(e),this.taskToRunBeforeTimeout=t,this.timeoutMs=i,this.taskName=`Timeout${this.timeoutMs}ms`,t.setParent(this)}cancel(){this.logger.info(`canceling timeout task ${this.name()} subtask ${this.taskToRunBeforeTimeout}`),this.taskToRunBeforeTimeout.cancel()}run(){return r(this,void 0,void 0,function*(){let e=new o.default(this.timeoutMs);e.start(()=>{this.logger.info(`timeout reached for task ${this.name()}`),this.taskToRunBeforeTimeout.cancel()});try{yield this.taskToRunBeforeTimeout.run()}finally{e.stop()}this.logger.info(`timeout task ${this.name()} completed`)})}}t.default=a},6171:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(5687)),s=n(i(1789));class a extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="WaitForAttendeePresenceTask"}cancel(){if(this.cancelPromise){let e=Error(`canceling ${this.name()} due to the meeting status code: ${o.default.NoAttendeePresent}`);this.cancelPromise(e),delete this.cancelPromise}}run(){return r(this,void 0,void 0,function*(){let e=this.context.meetingSessionConfiguration.credentials.attendeeId;return new Promise((t,i)=>{let r=(i,n,o,s,a)=>{e===i&&n&&(this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(r),t(),delete this.cancelPromise)};this.cancelPromise=e=>{this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(r),i(e)},this.context.realtimeController.realtimeSubscribeToAttendeeIdPresence(r)})})}}t.default=a},365:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(3765)),s=n(i(2353)),a=n(i(4773)),l=n(i(1044)),d=n(i(7797));class c{constructor(e,t,i){this.logger=e,this.browserBehavior=t,this.meetingSessionContext=i,this._localCameraTransceiver=null,this._localAudioTransceiver=null,this.videoSubscriptions=[],this.defaultMediaStream=null,this.peer=null,this.streamIdToTransceiver=new Map,this.groupIdToTransceiver=new Map,this.audioRedWorker=null,this.audioRedWorkerURL=null,this.audioMetricsHistory=[],this.redMetricsObservers=new Set,this.currentNumRedundantEncodings=0,this.lastRedHolddownTimerStartTimestampMs=0,this.lastHighPacketLossEventTimestampMs=0,this.lastAudioRedTurnOffTimestampMs=0,this.maxAudioMetricsHistory=20,this.audioRedPacketLossShortEvalPeriodMs=5e3,this.audioRedPacketLossLongEvalPeriodMs=15e3,this.audioRedHoldDownTimeMs=3e5,this.redRecoveryTimeMs=6e4}setEncodingParameters(e){return r(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;let t=this._localCameraTransceiver.sender;if(!e||0===e.size)return;let i=Array.from(e.values()),r=t.getParameters();if(r.encodings&&0!==r.encodings.length)for(let e of r.encodings)for(let t of i){let i;if(!e.rid&&!t.rid||e.rid===t.rid)for(i in t)"rid"!==i&&"codecPayloadType"!==i&&t.hasOwnProperty(i)&&(e[i]=t[i])}else r.encodings=i;yield t.setParameters(r)})}localAudioTransceiver(){return this._localAudioTransceiver}localVideoTransceiver(){return this._localCameraTransceiver}setVideoSendingBitrateKbps(e){return r(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;let t=this._localCameraTransceiver.sender;if(!t||e<=0)return;let i=t.getParameters();for(let t of(i.encodings||(i.encodings=[{}]),i.encodings))t.maxBitrate=1e3*e;yield t.setParameters(i)})}setPeer(e){this.peer=e}reset(){this.destroyAudioRedWorkerAndStates(),this._localCameraTransceiver=null,this._localAudioTransceiver=null,this.videoSubscriptions=[],this.defaultMediaStream=null,this.peer=null}useTransceivers(){return!!this.peer&&void 0!==this.peer.getTransceivers}hasVideoInput(){return!!this._localCameraTransceiver&&"sendrecv"===this._localCameraTransceiver.direction}trackIsVideoInput(e){return!!this._localCameraTransceiver&&(e===this._localCameraTransceiver.sender.track||e===this._localCameraTransceiver.receiver.track)}setupLocalTransceivers(){var e,t;this.useTransceivers()&&(this.defaultMediaStream||"undefined"==typeof MediaStream||(this.defaultMediaStream=new MediaStream),!this._localAudioTransceiver&&(this._localAudioTransceiver=this.peer.addTransceiver("audio",{direction:"inactive",streams:[this.defaultMediaStream]}),(null===(t=null===(e=this.meetingSessionContext)||void 0===e?void 0:e.audioProfile)||void 0===t?void 0:t.hasRedundancyEnabled())&&this.setupAudioRedWorker()),this._localCameraTransceiver||(this._localCameraTransceiver=this.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream]})))}replaceAudioTrack(e){return r(this,void 0,void 0,function*(){return this._localAudioTransceiver&&"sendrecv"===this._localAudioTransceiver.direction?(yield this._localAudioTransceiver.sender.replaceTrack(e),!0):(this.logger.info("audio transceiver direction is not set up or not activated"),!1)})}setAudioInput(e){return r(this,void 0,void 0,function*(){yield this.setTransceiverInput(this._localAudioTransceiver,e)})}setVideoInput(e){return r(this,void 0,void 0,function*(){yield this.setTransceiverInput(this._localCameraTransceiver,e)})}updateVideoTransceivers(e,t){if(!this.useTransceivers())return t.array();let i=this.peer.getTransceivers();return this.videoSubscriptions=[0],t=t.clone(),this.updateTransceivers(i,e,t),this.logger.debug(()=>this.debugDumpTransceivers()),this.videoSubscriptions}updateTransceivers(e,t,i){let r=i.array();for(let i of(0===e.length||e[0].stop?0!==e.length&&this.updateTransceiverWithStop(e,t,r):(this.logger.info("Updating transceivers without `stop` function"),this.updateTransceiverWithoutStop(e,t,r)),r)){let e=this.addTransceiver("video",{direction:"recvonly",streams:[new MediaStream]});this.streamIdToTransceiver.set(i,e),this.groupIdToTransceiver.set(t.groupIdForStreamId(i),e),this.videoSubscriptions.push(i),this.logger.info(`adding transceiver mid: ${e.mid} subscription: ${i} direction: recvonly`)}}updateTransceiverWithStop(e,t,i){let r=1;for(let n of(this.videoSubscriptions=[0],e)){if(n===this._localCameraTransceiver||!this.transceiverIsVideo(n)||!n.mid)continue;let e=!1,o=t.streamIdForTrack("v_"+n.mid);if("inactive"!==n.direction&&void 0!==o){for(let[s,a]of i.entries())if(t.StreamIdsInSameGroup(o,a)){n.direction="recvonly",this.videoSubscriptions[r]=a,e=!0,this.streamIdToTransceiver.delete(o),this.streamIdToTransceiver.set(a,n),i.splice(s,1);break}}if(!e)for(let[e,i]of(this.videoSubscriptions[r]=0,this.logger.info(`Stopping MID: ${n.mid}, direction: ${n.direction}, current direction: ${n.currentDirection}`),n.stop(),this.streamIdToTransceiver.entries()))n.mid===i.mid&&(this.streamIdToTransceiver.delete(e),this.groupIdToTransceiver.delete(t.groupIdForStreamId(e)));r+=1}}updateTransceiverWithoutStop(e,t,i){let r=1;for(let n of e)if(n!==this._localCameraTransceiver&&this.transceiverIsVideo(n)){if(this.videoSubscriptions[r]=0,"inactive"!==n.direction){let e=t.streamIdForTrack("v_"+n.mid);if(void 0!==e){for(let[o,s]of i.entries())if(t.StreamIdsInSameGroup(e,s)){n.direction="recvonly",this.videoSubscriptions[r]=s,this.streamIdToTransceiver.delete(e),this.streamIdToTransceiver.set(s,n),i.splice(o,1);break}}}r+=1}for(let n of(r=1,e))if(n!==this._localCameraTransceiver&&this.transceiverIsVideo(n)){if("inactive"===n.direction&&i.length>0){n.direction="recvonly";let e=i.shift();this.videoSubscriptions[r]=e,this.streamIdToTransceiver.set(e,n),this.groupIdToTransceiver.set(t.groupIdForStreamId(e),n)}else if(0===this.videoSubscriptions[r])for(let[e,i]of(n.direction="inactive",this.streamIdToTransceiver.entries()))n===i&&(this.streamIdToTransceiver.delete(e),this.groupIdToTransceiver.delete(t.groupIdForStreamId(e)));r+=1}}getMidForStreamId(e){var t;return null===(t=this.streamIdToTransceiver.get(e))||void 0===t?void 0:t.mid}setStreamIdForMid(e,t){for(let[i,r]of this.streamIdToTransceiver.entries())if(r.mid===e){this.streamIdToTransceiver.delete(i),this.streamIdToTransceiver.set(t,r);return}}getMidForGroupId(e){var t,i;return null!==(i=null===(t=this.groupIdToTransceiver.get(e))||void 0===t?void 0:t.mid)&&void 0!==i?i:void 0}transceiverIsVideo(e){return e.receiver&&e.receiver.track&&"video"===e.receiver.track.kind||e.sender&&e.sender.track&&"video"===e.sender.track.kind}debugDumpTransceivers(){let e="",t=0;for(let i of this.peer.getTransceivers())this.transceiverIsVideo(i)&&(e+=`transceiver index=${t} mid=${i.mid} subscription=${this.videoSubscriptions[t]} direction=${i.direction}
`,t+=1);return e}setTransceiverInput(e,t){return r(this,void 0,void 0,function*(){e&&(t?e.direction="sendrecv":e.direction="inactive",yield e.sender.replaceTrack(t))})}forEachRedMetricsObserver(e){for(let t of this.redMetricsObservers)d.default.nextTick(()=>{this.redMetricsObservers.has(t)&&t.recoveryMetricsDidReceive(e)})}disableAudioRedundancy(){this.meetingSessionContext.audioProfile=new o.default(this.meetingSessionContext.audioProfile.audioBitrateBps,!1),this.meetingSessionContext.audioVideoController.setAudioProfile(this.meetingSessionContext.audioProfile)}setupAudioRedWorker(){var e,t;let i=!!window.RTCRtpScriptTransform,r=!!RTCRtpSender.prototype.createEncodedStreams;if(i)this.logger.info("[AudioRed] Supports encoded insertable streams using RTCRtpScriptTransform");else if(r)this.logger.info("[AudioRed] Supports encoded insertable streams using TransformStream");else throw this.disableAudioRedundancy(),Error("[AudioRed] Encoded insertable streams not supported. Recreating peer connection with audio redundancy disabled.");try{this.audioRedWorkerURL=URL.createObjectURL(new Blob([l.default],{type:"application/javascript"})),this.logger.info(`[AudioRed] Redundant audio worker URL ${this.audioRedWorkerURL}`),this.audioRedWorker=new Worker(this.audioRedWorkerURL)}catch(e){throw this.logger.error(`[AudioRed] Unable to create audio red worker due to ${e}`),URL.revokeObjectURL(this.audioRedWorkerURL),this.audioRedWorkerURL=null,this.audioRedWorker=null,this.disableAudioRedundancy(),this.logger.info("[AudioRed] Recreating peer connection with audio redundancy disabled"),e}if(this.audioRedEnabled=!0,this.audioRedWorker.onmessage=e=>{if("REDWorkerLog"===e.data.type)this.logger.info(e.data.log);else if("RedundantAudioEncoderStats"===e.data.type){let t=new s.default;t.currentTimestampMs=Date.now(),t.ssrc=e.data.ssrc,t.totalAudioPacketsLost=e.data.totalAudioPacketsLost,t.totalAudioPacketsExpected=e.data.totalAudioPacketsExpected,t.totalAudioPacketsRecoveredRed=e.data.totalAudioPacketsRecoveredRed,t.totalAudioPacketsRecoveredFec=e.data.totalAudioPacketsRecoveredFec,this.forEachRedMetricsObserver(t)}},i)this._localAudioTransceiver.sender.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"SenderTransform"}),this._localAudioTransceiver.receiver.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"ReceiverTransform"});else if(r){let e=this._localAudioTransceiver.sender.createEncodedStreams(),t=this._localAudioTransceiver.receiver.createEncodedStreams();this.audioRedWorker.postMessage({msgType:"StartRedWorker",send:e,receive:t},[e.readable,e.writable,t.readable,t.writable])}null===(e=this.meetingSessionContext)||void 0===e||e.audioVideoController.addObserver(this),this.addRedundantAudioRecoveryMetricsObserver(null===(t=this.meetingSessionContext)||void 0===t?void 0:t.statsCollector)}addTransceiver(e,t){var i;let r=this.peer.addTransceiver(e,t);if(!(null===(i=this.peer.getConfiguration())||void 0===i?void 0:i.encodedInsertableStreams)||!this.audioRedWorker)return r;let n=!!window.RTCRtpScriptTransform,o=!!RTCRtpSender.prototype.createEncodedStreams;if(n)r.sender.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"PassthroughTransform"}),r.receiver.transform=new RTCRtpScriptTransform(this.audioRedWorker,{type:"PassthroughTransform"});else if(o){let e=r.sender.createEncodedStreams(),t=r.receiver.createEncodedStreams();this.audioRedWorker.postMessage({msgType:"PassthroughTransform",send:e,receive:t},[e.readable,e.writable,t.readable,t.writable])}return r}destroyAudioRedWorkerAndStates(){var e,t;this.audioRedWorker&&(URL.revokeObjectURL(this.audioRedWorkerURL),this.audioRedWorkerURL=null,this.audioRedWorker.terminate(),this.audioRedWorker=null,this.currentNumRedundantEncodings=0,this.lastRedHolddownTimerStartTimestampMs=0,this.lastAudioRedTurnOffTimestampMs=0,this.lastHighPacketLossEventTimestampMs=0,this.audioRedEnabled=!0,null===(e=this.meetingSessionContext)||void 0===e||e.audioVideoController.removeObserver(this),this.removeRedundantAudioRecoveryMetricsObserver(null===(t=this.meetingSessionContext)||void 0===t?void 0:t.statsCollector))}setAudioPayloadTypes(e){this.audioRedWorker&&(this.audioRedWorker.postMessage({msgType:"RedPayloadType",payloadType:e.get("red")}),this.audioRedWorker.postMessage({msgType:"OpusPayloadType",payloadType:e.get("opus")}))}metricsDidReceive(e){let{currentTimestampMs:t}=e,i=e.getRTCStatsReport(),r=0,n=0,o=0;i.forEach(e=>{"audio"===e.kind&&("outbound-rtp"===e.type?n=e.packetsSent:"remote-inbound-rtp"===e.type&&(r=e.timestamp,o=e.packetsLost))}),(0===this.audioMetricsHistory.length||r>this.audioMetricsHistory[this.audioMetricsHistory.length-1].timestampMs&&n>this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsSent)&&this.audioMetricsHistory.push({timestampMs:r,totalPacketsSent:n,totalPacketsLost:o}),this.audioMetricsHistory.length>this.maxAudioMetricsHistory&&this.audioMetricsHistory.shift();let s=Math.max(this.lossPercent(this.audioRedPacketLossShortEvalPeriodMs),this.lossPercent(this.audioRedPacketLossLongEvalPeriodMs)),[l,d]=a.default.getNumRedundantEncodingsForPacketLoss(s);if(d){this.lastHighPacketLossEventTimestampMs=t,this.audioRedEnabled&&(this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"Disable"}),this.audioRedEnabled=!1,this.lastAudioRedTurnOffTimestampMs=t);return}if(!this.audioRedEnabled){let e=t-this.lastAudioRedTurnOffTimestampMs,i=t-this.lastHighPacketLossEventTimestampMs;if(e>=this.audioRedPacketLossLongEvalPeriodMs&&i<this.redRecoveryTimeMs)return;this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"Enable"}),this.audioRedEnabled=!0,this.maybeResetHoldDownTimer(t)}this.shouldUpdateAudioRedWorkerEncodings(t,l)&&this.audioRedWorker&&this.audioRedWorker.postMessage({msgType:"UpdateNumRedundantEncodings",numRedundantEncodings:l})}maybeResetHoldDownTimer(e){this.currentNumRedundantEncodings>0&&(this.lastRedHolddownTimerStartTimestampMs=e)}lossPercent(e){if(this.audioMetricsHistory.length<2)return 0;let t=this.audioMetricsHistory[this.audioMetricsHistory.length-1].timestampMs,i=this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsSent,r=this.audioMetricsHistory[this.audioMetricsHistory.length-1].totalPacketsLost;for(let n=this.audioMetricsHistory.length-2;n>=0;n--)if(t-this.audioMetricsHistory[n].timestampMs>=e)return Math.max(0,Math.min((r-this.audioMetricsHistory[n].totalPacketsLost)/(i-this.audioMetricsHistory[n].totalPacketsSent)*100,100));return 0}shouldUpdateAudioRedWorkerEncodings(e,t){return this.currentNumRedundantEncodings===t?(this.maybeResetHoldDownTimer(e),!1):(!(t<this.currentNumRedundantEncodings)||!(e-this.lastRedHolddownTimerStartTimestampMs<this.audioRedHoldDownTimeMs))&&(this.currentNumRedundantEncodings=t,this.maybeResetHoldDownTimer(e),!0)}addRedundantAudioRecoveryMetricsObserver(e){this.redMetricsObservers.add(e)}removeRedundantAudioRecoveryMetricsObserver(e){this.redMetricsObservers.delete(e)}}t.default=c},7377:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(5785));class s extends o.default{constructor(e,t,i){super(e,t,i);let r=2;this.videoQualityControlParameterMap=new Map;for(let e=0;e<s.NAME_ARR_ASCENDING.length;e++){let t=s.NAME_ARR_ASCENDING[e];this.videoQualityControlParameterMap.set(t,{rid:t,scaleResolutionDownBy:r,maxBitrate:1e3*s.BITRATE_ARR_ASCENDING[e]}),r/=2}}setEncodingParameters(e){return r(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;let t=this._localCameraTransceiver.sender,i=Array.from(e.values());if(i.length<=0)return;let r=t.getParameters();if(r.encodings)for(let t=0;t<r.encodings.length;t++)r.encodings[t].rid===o.default.LOW_LEVEL_NAME&&this.copyEncodingParams(e.get(o.default.LOW_LEVEL_NAME),r.encodings[t]),r.encodings[t].rid===o.default.HIGH_LEVEL_NAME&&this.copyEncodingParams(e.get(o.default.HIGH_LEVEL_NAME),r.encodings[t]);else r.encodings=i;yield t.setParameters(r),this.logVideoTransceiverParameters()})}}t.default=s,s.NAME_ARR_ASCENDING=["low","hi"],s.BITRATE_ARR_ASCENDING=[300,1200]},5785:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(365));class s extends o.default{constructor(e,t,i){super(e,t,i),this.videoQualityControlParameterMap=new Map;let r=4;for(let e=0;e<s.NAME_ARR_ASCENDING.length;e++){let t=s.NAME_ARR_ASCENDING[e];this.videoQualityControlParameterMap.set(t,{rid:t,scaleResolutionDownBy:r,maxBitrate:1e3*s.BITRATE_ARR_ASCENDING[e]}),r/=2}}setEncodingParameters(e){return r(this,void 0,void 0,function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;let t=this._localCameraTransceiver.sender,i=Array.from(e.values());if(i.length<=0)return;let r=t.getParameters();if(r.encodings)for(let t of r.encodings)t.rid===s.LOW_LEVEL_NAME&&this.copyEncodingParams(e.get(s.LOW_LEVEL_NAME),t),t.rid===s.MID_LEVEL_NAME&&this.copyEncodingParams(e.get(s.MID_LEVEL_NAME),t),t.rid===s.HIGH_LEVEL_NAME&&this.copyEncodingParams(e.get(s.HIGH_LEVEL_NAME),t);else r.encodings=i;yield t.setParameters(r),this.logVideoTransceiverParameters()})}setVideoSendingBitrateKbps(e){return r(this,void 0,void 0,function*(){})}setupLocalTransceivers(){var e,t;if(this.useTransceivers()&&(this.defaultMediaStream||"undefined"==typeof MediaStream||(this.defaultMediaStream=new MediaStream),!this._localAudioTransceiver&&(this._localAudioTransceiver=this.peer.addTransceiver("audio",{direction:"inactive",streams:[this.defaultMediaStream]}),(null===(t=null===(e=this.meetingSessionContext)||void 0===e?void 0:e.audioProfile)||void 0===t?void 0:t.hasRedundancyEnabled())&&this.setupAudioRedWorker()),!this._localCameraTransceiver)){let e=Array.from(this.videoQualityControlParameterMap.values());this._localCameraTransceiver=this.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream],sendEncodings:e})}}logVideoTransceiverParameters(){let e=this._localCameraTransceiver.sender.getParameters().encodings,t="simulcast: current encoding parameters \n";for(let i of e)t+=`rid=${i.rid} maxBitrate=${i.maxBitrate} active=${i.active} scaleDownBy=${i.scaleResolutionDownBy} maxFrameRate = ${i.maxFramerate} 
`;this.logger.info(t)}copyEncodingParams(e,t){t.active=e.active,t.maxBitrate=e.maxBitrate,t.scaleResolutionDownBy=e.scaleResolutionDownBy,t.maxFramerate=e.maxFramerate}}t.default=s,s.LOW_LEVEL_NAME="low",s.MID_LEVEL_NAME="mid",s.HIGH_LEVEL_NAME="hi",s.NAME_ARR_ASCENDING=["low","mid","hi"],s.BITRATE_ARR_ASCENDING=[200,400,1100]},9354:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(365));class o extends n.default{constructor(e,t,i){super(e,t,i)}setupLocalTransceivers(){this.useTransceivers()&&(this.defaultMediaStream||"undefined"==typeof MediaStream||(this.defaultMediaStream=new MediaStream),this._localCameraTransceiver||(this._localCameraTransceiver=this.peer.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream]})))}}t.default=o},5308:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TRANSCRIPTION_DATA_MESSAGE_TOPIC=void 0;let r=i(1877);t.TRANSCRIPTION_DATA_MESSAGE_TOPIC="aws:chime:transcription";class n{constructor(e){this.realtimeController=e,this.transcriptEventCallbacks=new Set}subscribeToTranscriptEvent(e){0===this.transcriptEventCallbacks.size&&this.realtimeController.realtimeSubscribeToReceiveDataMessage(t.TRANSCRIPTION_DATA_MESSAGE_TOPIC,e=>{for(let t of r.TranscriptEventConverter.from(e))for(let e of this.transcriptEventCallbacks)e(t)}),this.transcriptEventCallbacks.add(e)}unsubscribeFromTranscriptEvent(e){this.transcriptEventCallbacks.delete(e),0===this.transcriptEventCallbacks.size&&this.realtimeController.realtimeUnsubscribeFromReceiveDataMessage(t.TRANSCRIPTION_DATA_MESSAGE_TOPIC)}}t.default=n},4739:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},2471:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},7210:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},1877:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TranscriptEventConverter=void 0;let n=i(289),o=r(i(4739)),s=r(i(1288)),a=r(i(1326)),l=r(i(6864)),d={[n.SdkTranscriptionStatus.Type.STARTED]:a.default.STARTED,[n.SdkTranscriptionStatus.Type.INTERRUPTED]:a.default.INTERRUPTED,[n.SdkTranscriptionStatus.Type.RESUMED]:a.default.RESUMED,[n.SdkTranscriptionStatus.Type.STOPPED]:a.default.STOPPED,[n.SdkTranscriptionStatus.Type.FAILED]:a.default.FAILED};class c{static from(e){let t;try{t=n.SdkTranscriptFrame.decode(e.data)}catch(e){throw Error("Cannot decode transcript data message: "+e)}let i=[];for(let e of t.events)if(e.status){let t=d[e.status.type];if(!t)continue;let r=new s.default;r.type=t,r.eventTimeMs=e.status.eventTime,r.transcriptionRegion=e.status.transcriptionRegion,r.transcriptionConfiguration=e.status.transcriptionConfiguration,e.status.message&&(r.message=e.status.message),i.push(r)}else if(e.transcript){let t=new o.default;for(let i of(t.results=[],e.transcript.results)){let e={channelId:i.channelId,isPartial:i.isPartial,resultId:i.resultId,startTimeMs:i.startTime,endTimeMs:i.endTime,alternatives:[]};if(i.languageCode&&(e.languageCode=i.languageCode),i.languageIdentification&&i.languageIdentification.length>0)for(let t of(e.languageIdentification=[],i.languageIdentification)){let i={languageCode:t.languageCode,score:t.score};e.languageIdentification.push(i)}for(let t of i.alternatives){let i={items:[],transcript:t.transcript};for(let e of t.items){let t={content:e.content,attendee:{attendeeId:e.speakerAttendeeId,externalUserId:e.speakerExternalUserId},startTimeMs:e.startTime,endTimeMs:e.endTime,type:null};switch(e.vocabularyFilterMatch&&(t.vocabularyFilterMatch=e.vocabularyFilterMatch),e.hasOwnProperty("stable")&&(t.stable=e.stable),e.hasOwnProperty("confidence")&&(t.confidence=e.confidence),e.type){case n.SdkTranscriptItem.Type.PRONUNCIATION:t.type=l.default.PRONUNCIATION;break;case n.SdkTranscriptItem.Type.PUNCTUATION:t.type=l.default.PUNCTUATION}i.items.push(t)}for(let e of t.entities){i.entities||(i.entities=[]);let t={category:e.category,confidence:e.confidence,content:e.content,startTimeMs:e.startTime,endTimeMs:e.endTime};e.type&&(t.type=e.type),i.entities.push(t)}e.alternatives.push(i)}t.results.push(e)}i.push(t)}return i}}t.TranscriptEventConverter=c},1741:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},6864:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PRONUNCIATION="pronunciation",e.PUNCTUATION="punctuation"}(i||(i={})),t.default=i},9063:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},5323:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},1288:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},1326:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.STARTED="started",e.INTERRUPTED="interrupted",e.RESUMED="resumed",e.STOPPED="stopped",e.FAILED="failed"}(i||(i={})),t.default=i},8627:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(2238),o=r(i(4046));class s{constructor(e){var t,i,r,o,a,l,d;try{this.parserResult=navigator&&navigator.userAgent?new n.UAParser(navigator.userAgent).getResult():void 0}catch(t){e.error(t.message)}this.browserMajorVersion=(null===(r=null===(i=null===(t=this.parserResult)||void 0===t?void 0:t.browser)||void 0===i?void 0:i.version)||void 0===r?void 0:r.split(".")[0])||s.UNAVAILABLE,this.browserName=(null===(o=this.parserResult)||void 0===o?void 0:o.browser.name)||s.UNAVAILABLE,this.browserVersion=(null===(a=this.parserResult)||void 0===a?void 0:a.browser.version)||s.UNAVAILABLE,this.deviceName=[(null===(l=this.parserResult)||void 0===l?void 0:l.device.vendor)||"",(null===(d=this.parserResult)||void 0===d?void 0:d.device.model)||""].join(" ").trim()||s.UNAVAILABLE}getParserResult(){var e,t;return{browserMajorVersion:this.browserMajorVersion,browserName:this.browserName,browserVersion:this.browserVersion,deviceName:this.deviceName,osName:(null===(e=this.parserResult)||void 0===e?void 0:e.os.name)||s.UNAVAILABLE,osVersion:(null===(t=this.parserResult)||void 0===t?void 0:t.os.version)||s.UNAVAILABLE,sdkVersion:o.default.sdkVersion,sdkName:o.default.sdkName}}}t.default=s,s.UNAVAILABLE="Unavailable"},5804:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.queue=Promise.resolve()}add(e){return new Promise((t,i)=>{this.queue=this.queue.then(e).then(t).catch(i)})}}t.default=i},8660:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.None=t.Some=t.Maybe=void 0;class i{static of(e){return null==e?n.of():r.of(e)}}t.Maybe=i;class r{constructor(e){this.value=e,this.isSome=!0,this.isNone=!1}map(e){return i.of(e(this.value))}flatMap(e){return e(this.value)}get(){return this.value}getOrElse(e){return this.value}defaulting(e){return i.of(this.getOrElse(e))}static of(e){if(null==e)throw Error("value is ${value}");return new r(e)}}t.Some=r;class n{constructor(){this.isSome=!1,this.isNone=!0}get(){throw Error("value is null")}getOrElse(e){return e}map(e){return new n}flatMap(e){return new n}defaulting(e){return i.of(this.getOrElse(e))}static of(){return new n}}t.None=n},8690:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.iterateEvery=t.SuppressedError=t.getRandomValues=t.getFormattedOffset=t.getDefaultAssetSpec=t.toLowerCasePropertyNames=t.isIFramed=t.wait=void 0;let n=r(i(4046));function o(e){return new Promise(t=>setTimeout(t,e))}function s(){var e;try{return(null===(e=window.frameElement)||void 0===e?void 0:e.nodeName)==="IFRAME"||parent!==top}catch(e){return!0}}function a(e){return null===e?null:"object"!=typeof e?e:Array.isArray(e)?e.map(a):Object.keys(e).reduce((t,i)=>{let r=e[i],n="object"==typeof r?a(r):r;return t[i.toLowerCase()]=n,t},{})}function l(){let e=n.default.sdkVersionSemVer;return{assetGroup:`sdk-${e.major}.${e.minor}`}}function d(e){let t=Math.abs(e),i=e<=0?"+":"-",r=Math.floor(t/60).toString().padStart(2,"0"),n=Math.floor(t%60).toString().padStart(2,"0");return`${i}${r}:${n}`}function c(e){try{window.crypto.getRandomValues(e)}catch(t){new DataView(e.buffer).setUint32(0,Math.trunc(4294967296*Math.random()),!0)}}t.wait=o,t.isIFramed=s,t.toLowerCasePropertyNames=a,t.getDefaultAssetSpec=l,t.getFormattedOffset=d,t.getRandomValues=c;class u extends Error{constructor(e,t,i){var r;super(null!=i?i:`${null!==(r=null==e?void 0:e.message)&&void 0!==r?r:e}`),this.error=e,this.suppressed=t}}function h(e,t){let i;if(e){for(let r of e)try{t(r)}catch(e){i=new u(e,i)}if(i)throw i}}t.SuppressedError=u,t.iterateEvery=h},4046:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(543)),o=r(i(2336));class s{static get sdkName(){return"amazon-chime-sdk-js"}static get sdkVersion(){return o.default.semverString}static get sdkVersionSemVer(){var e,t,i,r;let n=o.default.semverString.match(/^(?<major>[0-9]+)\.(?<minor>[0-9]+)((?:\.(?<patch>[0-9]+))(?:-(?<preRelease>[a-zA-Z]+(\.[0-9])*))?)?/);return{major:null===(e=null==n?void 0:n.groups)||void 0===e?void 0:e.major,minor:null===(t=null==n?void 0:n.groups)||void 0===t?void 0:t.minor,patch:null===(i=null==n?void 0:n.groups)||void 0===i?void 0:i.patch,preRelease:null===(r=null==n?void 0:n.groups)||void 0===r?void 0:r.preRelease}}static get buildSHA(){return o.default.hash.substring(1)}static get sdkUserAgentLowResolution(){let e=new n.default;return`${e.name()}-${e.majorVersion()}`}static urlWithVersion(e){let t=new URL(e);return t.searchParams.append(s.X_AMZN_VERSION,s.sdkVersion),t.searchParams.append(s.X_AMZN_USER_AGENT,s.sdkUserAgentLowResolution),t.toString()}}t.default=s,s.X_AMZN_VERSION="X-Amzn-Version",s.X_AMZN_USER_AGENT="X-Amzn-User-Agent"},2336:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={hash:"0b5a81b",raw:"v3.28.0",semverString:"3.28.0"}},1133:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,r,n,o=1,s=!1){this.cameraWidth=e,this.cameraHeight=t,this.cameraFrameRate=i,this.maxEncodeBitrateKbps=r,this.isSimulcast=n,this.scaleResolutionDownBy=o,this.isSVC=s}equal(e){let t=e.captureWidth()===this.cameraWidth&&e.captureHeight()===this.cameraHeight&&e.captureFrameRate()===this.cameraFrameRate&&e.encodeBitrates().length===this.encodeBitrates().length&&e.encodeScaleResolutionDownBy().length===this.encodeScaleResolutionDownBy().length&&e.encodeWidths().length===this.encodeWidths().length&&e.encodeHeights().length===this.encodeHeights().length&&e.isSVCEncoding()===this.isSVC;if(t){for(let i=0;i<e.encodeWidths().length;i++)if(e.encodeWidths()[i]!==this.encodeWidths()[i]||e.encodeHeights()[i]!==this.encodeHeights()[i]||e.encodeBitrates()[i]!==this.encodeBitrates()[i]||e.encodeScaleResolutionDownBy()[i]!==this.encodeScaleResolutionDownBy()[i]){t=!1;break}}return t}clone(){return new i(this.cameraWidth,this.cameraHeight,this.cameraFrameRate,this.maxEncodeBitrateKbps,this.isSimulcast,this.scaleResolutionDownBy,this.isSVC)}captureWidth(){return this.cameraWidth}captureHeight(){return this.cameraHeight}captureFrameRate(){return this.cameraFrameRate}encodeBitrates(){return[this.maxEncodeBitrateKbps]}encodeScaleResolutionDownBy(){return[this.scaleResolutionDownBy]}encodeWidths(){return[this.cameraWidth]}encodeHeights(){return[this.cameraHeight]}isSVCEncoding(){return this.isSVC}}t.default=i},5185:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(1508));class o{constructor(e){this.selfAttendeeId=e,this.reset()}reset(){this.optimalReceiveSet=new n.default,this.subscribedReceiveSet=new n.default,this.videoSources=void 0}updateIndex(e){this.videoIndex=e,this.optimalReceiveSet=this.calculateOptimalReceiveSet(e)}updateMetrics(e){}wantsResubscribe(){return!this.subscribedReceiveSet.equal(this.optimalReceiveSet)}chooseSubscriptions(){return this.subscribedReceiveSet=this.optimalReceiveSet.clone(),this.subscribedReceiveSet.clone()}chooseRemoteVideoSources(e){this.videoSources=e,this.optimalReceiveSet=this.calculateOptimalReceiveSet(this.videoIndex).clone()}calculateOptimalReceiveSet(e){let t=new n.default;if(!this.videoIndex||this.videoIndex.allStreams().empty())return t;let i=e.highestQualityStreamFromEachGroupExcludingSelf(this.selfAttendeeId),r=this.videoSources?this.videoSources:this.videoIndex.allVideoSendingSourcesExcludingSelf(this.selfAttendeeId),s=this.videoIndex.remoteStreamDescriptions(),a=new Map;for(let e of s)i.contain(e.streamId)&&a.set(e.attendeeId,e);let l=0;for(let e of r){let i=e.attendee.attendeeId;if(a.has(i)){let e=a.get(i);if(l+e.maxBitrateKbps<=o.maxReceiveBitrateKbps)t.add(e.streamId),l+=e.maxBitrateKbps;else{console.warn("total bitrate "+(l+e.maxBitrateKbps)+" exceeds maximum limit (15000). Use chooseRemoteVideoSources to select a subset of participants to avoid this.");break}}}return t}}t.default=o,o.maxReceiveBitrateKbps=15e3},5319:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(1508));class o{reset(){}updateIndex(e){}updateMetrics(e){}wantsResubscribe(){return!1}chooseSubscriptions(){return new n.default}}t.default=o},2721:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.TargetDisplaySize=void 0,function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High",e[e.Maximum=3]="Maximum"}(i=t.TargetDisplaySize||(t.TargetDisplaySize={})),t.default=i},2880:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(8890)),o=r(i(7103)),s=r(i(1754)),a=i(1819),l=r(i(4992)),d=r(i(1034));class c extends l.default{constructor(e){super(e,c.createConfig()),this.logger=e,super.shouldPauseTiles=!1,this.videoPreferences=void 0}static createConfig(){let e=new d.default;return e.serverSideNetworkAdaption=o.default.None,e}reset(){super.reset(),super.shouldPauseTiles=!1,this.videoPreferences=void 0}updateIndex(e){super.updateIndex(e);let t=a.VideoPreferences.prepare(),i=!1;for(let r of e.remoteStreamDescriptions())t.some(e=>e.attendeeId===r.attendeeId)||(r.attendeeId.endsWith(n.default.Modality)?(t.add(new s.default(r.attendeeId,1)),i=!0):t.add(new s.default(r.attendeeId,2)));i?(this.videoPreferences=t.build(),this.videoPreferencesUpdated=!0):this.videoPreferences=void 0}chooseRemoteVideoSources(e){this.logger.error("chooseRemoteVideoSources should not be called by VideoAdaptiveProbePolicy")}}t.default=c},1754:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(2721)),o=r(i(5992));class s{constructor(e,t,i,r){this.attendeeId=e,this.priority=t,this.targetSize=void 0!==i?i:n.default.Maximum,this.degradationPreference=void 0!==r?r:o.default.Balanced}partialCompare(e){return this.priority-e.priority}equals(e){return this.attendeeId===e.attendeeId&&this.targetSize===e.targetSize&&this.priority===e.priority&&this.degradationPreference===e.degradationPreference}clone(){return new s(this.attendeeId,this.priority,this.targetSize,this.degradationPreference)}targetSizeToBitrateKbps(e){switch(e){case n.default.Maximum:return s.MAXIMUM_BITRATE_KBPS;case n.default.High:return s.HIGH_BITRATE_KBPS;case n.default.Medium:return s.MID_BITRATE_KBPS;case n.default.Low:return s.LOW_BITRATE_KBPS}}}t.default=s,s.LOW_BITRATE_KBPS=300,s.MID_BITRATE_KBPS=600,s.HIGH_BITRATE_KBPS=1500,s.MAXIMUM_BITRATE_KBPS=1e4},1819:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoPreferences=t.MutableVideoPreferences=t.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration=void 0;let n=r(i(9101));function o(e,t,i){if(void 0===e.transceiverController.getMidForGroupId||void 0===e.videoStreamIndex.attendeeIdForGroupId||void 0===i)return[];let r=[],o=new Map,s=new Map;for(let i of t){let t=e.transceiverController.getMidForGroupId(i);if(void 0===t)continue;let r=e.videoStreamIndex.attendeeIdForGroupId(i);o.set(r,t),s.set(r,i)}for(let e of i){let t=new n.default,i=o.get(e.attendeeId);void 0!==i&&(t.mid=i,t.attendeeId=e.attendeeId,t.groupId=s.get(e.attendeeId),t.priority=Number.MAX_SAFE_INTEGER-e.priority,t.targetBitrateKbps=e.targetSizeToBitrateKbps(e.targetSize),t.qualityAdaptationPreference=e.degradationPreference,r.push(t))}return r}t.convertVideoPreferencesToSignalingClientVideoSubscriptionConfiguration=o;class s{constructor(e=[]){this.items=e}static default(){return new s([])}[Symbol.iterator](){let e=0,t=this.items;return{next:()=>e<t.length?{done:!1,value:t[e++]}:{done:!0,value:null}}}first(){return this.items[0]}add(e){this.items.push(e)}replaceFirst(e,t){let i=this.items.findIndex(t);-1===i?this.items.push(e):this.has(e)?this.items.splice(i,1):this.items[i]=e}remove(e){this.items=this.items.filter(t=>!t.equals(e))}clear(){this.items=[]}isEmpty(){return 0===this.items.length}equals(e){if(e===this)return!0;if(e.items.length!==this.items.length)return!1;for(let t of this.items)if(!e.items.some(e=>e.equals(t)))return!1;return!0}has(e){return this.items.some(t=>t.equals(e))}some(e){return this.items.some(e)}clone(){return new s([...this.items])}sort(){this.items.sort((e,t)=>e.partialCompare(t))}modify(){return new a(this)}}class a{constructor(e=new s){this.items=e,this.copied=!1}cow(){this.copied||(this.items=this.items.clone(),this.copied=!0)}add(e){this.items.has(e)||(this.cow(),this.items.add(e))}replaceFirst(e,t){(!this.items.has(e)||this.items.some(t))&&(this.cow(),this.items.replaceFirst(e,t))}remove(e){this.items.has(e)&&(this.cow(),this.items.remove(e))}some(e){return this.items.some(e)}clear(){this.items.isEmpty()||(this.cow(),this.items.clear())}build(){return this.copied&&this.items.sort(),this.copied=!1,this.items}}class l{constructor(e){this.builder=e}add(e){this.builder.add(e)}replaceFirst(e,t){this.builder.replaceFirst(e,t)}remove(e){this.builder.remove(e)}some(e){return this.builder.some(e)}clear(){this.builder.clear()}build(){return new d(this.builder.build())}}t.MutableVideoPreferences=l;class d{constructor(e){this.items=e}static prepare(){return new l(new a)}static default(){return new d(s.default())}[Symbol.iterator](){return this.items[Symbol.iterator]()}highestPriority(){var e;return null===(e=this.items.first())||void 0===e?void 0:e.priority}sorted(){return this.items[Symbol.iterator]()}equals(e){return e===this||this.items.equals(e.items)}modify(){return new l(this.items.modify())}some(e){return this.items.some(e)}isEmpty(){return this.items.isEmpty()}clone(){let e=d.prepare();for(let t of this.items)e.add(t.clone());return e.build()}}t.VideoPreferences=d,t.default=d},4992:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let a=s(i(7602)),l=s(i(6196)),d=s(i(9496)),c=s(i(8890)),u=i(813),h=o(i(7103)),f=s(i(60)),p=s(i(1508)),m=s(i(5185)),g=s(i(2721)),v=s(i(1754)),b=i(1819),y=s(i(1034)),S=s(i(5992));class w{constructor(){this.bandwidthEstimateKbps=0,this.usedBandwidthKbps=0,this.packetsLost=0,this.nackCount=0,this.rttMs=0}}class C{constructor(e,t=y.default.Default){this.logger=e,this.videoPriorityBasedPolicyConfig=t,this.shouldPauseTiles=!0,this.observerQueue=new Set,this.pausedBwAttendeeIds=new Set,this.wantsResubscribeObserver=void 0,this.videoPriorityBasedPolicyConfig.serverSideNetworkAdaption===h.default.Default&&(this.videoPriorityBasedPolicyConfig.serverSideNetworkAdaption=h.default.BandwidthProbingAndRemoteVideoQualityAdaption),this.reset()}reset(){this.allHighestPolicy=new m.default(""),this.optimalReceiveSet=new p.default,this.optimalReceiveStreams=[],this.optimalNonPausedReceiveStreams=[],this.subscribedReceiveSet=new p.default,this.subscribedReceiveStreams=[],this.videoPreferences=void 0,this.defaultVideoPreferences=void 0,this.shouldPauseTiles=!0,this.pausedStreamIds=new p.default,this.pausedBwAttendeeIds=new Set,this.videoPreferencesUpdated=!1,this.logCount=0,this.startupPeriod=!0,this.usingPrevTargetRate=!1,this.rateProbeState="Not Probing",this.firstEstimateTimestamp=0,this.lastUpgradeRateKbps=0,this.timeBeforeAllowSubscribeMs=C.MIN_TIME_BETWEEN_SUBSCRIBE_MS,this.lastProbeTimestamp=Date.now(),this.timeBeforeAllowProbeMs=C.MIN_TIME_BETWEEN_PROBE_MS,this.downlinkStats=new w,this.prevDownlinkStats=new w,this.probeFailed=!1,this.serverSideNetworkAdaption=this.videoPriorityBasedPolicyConfig.serverSideNetworkAdaption,this.pendingActionAfterUpdatedPreferences=!1}bindToTileController(e){this.tileController=e,this.logger.info("tileController bound")}setWantsResubscribeObserver(e){this.wantsResubscribeObserver=e}chooseRemoteVideoSources(e){var t;if(null===(t=this.videoPreferences)||void 0===t||!t.equals(e)){if(this.videoPreferences=null==e?void 0:e.clone(),!h.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)&&(this.pendingActionAfterUpdatedPreferences=!0,void 0!==this.wantsResubscribeObserver&&(this.wantsResubscribeObserver(),this.pendingActionAfterUpdatedPreferences=!1),this.serverSideNetworkAdaption===h.default.BandwidthProbingAndRemoteVideoQualityAdaption)){let e=[];for(let t of this.videoPreferences){let i=new f.default;i.attendee=new a.default,i.attendee.attendeeId=t.attendeeId,e.push(i)}this.allHighestPolicy.chooseRemoteVideoSources(e);return}this.videoPreferencesUpdated=!0,this.logger.info(`bwe: setVideoPreferences bwe: new preferences: ${JSON.stringify(e)}`)}}updateIndex(e){this.videoIndex=e,this.serverSideNetworkAdaption===h.default.BandwidthProbingAndRemoteVideoQualityAdaption&&this.allHighestPolicy.updateIndex(e),this.videoPreferences||this.updateDefaultVideoPreferences()}updateDefaultVideoPreferences(){let e=new Set;for(let t of this.videoIndex.remoteStreamDescriptions())e.add(t.attendeeId);let t=b.VideoPreferences.prepare(),i=e.size,r=g.default.Maximum;for(let n of(i>8?r=g.default.Low:i>4&&(r=g.default.Medium),e))t.add(new v.default(n,1,r));this.defaultVideoPreferences=t.build()}updateMetrics(e){if(!this.videoIndex||this.videoIndex.allStreams().empty())return;this.prevDownlinkStats=this.downlinkStats,this.downlinkStats=new w;let t=e.getObservableMetrics();for(let i in this.downlinkStats.bandwidthEstimateKbps=t.availableIncomingBitrate/1e3,e.streamMetricReports){let t=Number.parseInt(i,10),r=e.streamMetricReports[t];r.direction===l.default.DOWNSTREAM&&r.mediaType===d.default.VIDEO&&(r.currentMetrics.hasOwnProperty("nackCount")&&(this.downlinkStats.nackCount+=e.countPerSecond("nackCount",t)),r.currentMetrics.hasOwnProperty("packetsLost")&&(this.downlinkStats.packetsLost+=e.countPerSecond("packetsLost",t)),r.currentMetrics.hasOwnProperty("bytesReceived")&&(this.downlinkStats.usedBandwidthKbps+=e.bitsPerSecond("bytesReceived",t)/1e3))}}wantsResubscribe(){let e=!1;return h.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)||(e||(e=this.pendingActionAfterUpdatedPreferences),this.serverSideNetworkAdaption!==h.default.BandwidthProbingAndRemoteVideoQualityAdaption)?(this.calculateOptimalReceiveSet(),e||(e=!this.subscribedReceiveSet.equal(this.optimalReceiveSet)),e):e||this.allHighestPolicy.wantsResubscribe()}chooseSubscriptions(){return h.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption)||(this.pendingActionAfterUpdatedPreferences=!1,this.serverSideNetworkAdaption!==h.default.BandwidthProbingAndRemoteVideoQualityAdaption)?(this.subscribedReceiveSet.equal(this.optimalReceiveSet)||(this.lastSubscribeTimestamp=Date.now()),this.subscribedReceiveSet=this.optimalReceiveSet.clone(),this.subscribedReceiveStreams=this.optimalReceiveStreams.slice(),this.subscribedReceiveSet.clone()):this.allHighestPolicy.chooseSubscriptions()}addObserver(e){this.observerQueue.add(e)}removeObserver(e){this.observerQueue.delete(e)}forEachObserver(e){for(let t of this.observerQueue)e(t)}setVideoPriorityBasedPolicyConfigs(e){this.videoPriorityBasedPolicyConfig=e}calculateOptimalReceiveStreams(){var e;let t=[],i=this.videoIndex.remoteStreamDescriptions();if(0===i.length||(null===(e=this.videoPreferences)||void 0===e?void 0:e.isEmpty())){this.optimalReceiveStreams=[];return}let r=this.rateProbeState;this.cleanBwPausedTiles(i),this.handleAppPausedStreams(t,i);let n=new Map;for(let e of this.getCurrentVideoPreferences())n.set(e.attendeeId,e);let o=i.filter(e=>n.has(e.attendeeId)),s=!this.streamsWithPreferenceDidChange(o),a=!this.startupPeriod&&s;if(a&&Date.now()-this.lastSubscribeTimestamp<this.timeBeforeAllowSubscribeMs)return;for(let e of(o.sort((e,t)=>e.maxBitrateKbps===t.maxBitrateKbps?e.streamId-t.streamId:e.maxBitrateKbps-t.maxBitrateKbps),o))(0===e.avgBitrateKbps||e.avgBitrateKbps>e.maxBitrateKbps)&&(e.attendeeId.endsWith(c.default.Modality)&&e.maxBitrateKbps<100?e.maxBitrateKbps=e.avgBitrateKbps:e.avgBitrateKbps=e.maxBitrateKbps);let l=new Set;for(let e of this.getCurrentVideoPreferences()){let t;let i=o.filter(t=>t.attendeeId===e.attendeeId);if(i.length<3)continue;let r=15,n=153600;for(let o of(i.forEach(e=>{r=Math.max(r,e.maxFrameRate),n=Math.max(n,e.totalPixels())}),i.sort((t,i)=>{if(e.degradationPreference===S.default.MaintainResolution)return 2>Math.abs(t.maxFrameRate-i.maxFrameRate)?t.totalPixels()-i.totalPixels():t.maxFrameRate-i.maxFrameRate;if(e.degradationPreference===S.default.MaintainFramerate)return t.totalPixels()===i.totalPixels()?t.maxFrameRate-i.maxFrameRate:t.totalPixels()-i.totalPixels();{let e=5,o=2,s=t=>t.avgBitrateKbps*Math.pow(2,e*t.maxFrameRate/r*Math.pow(2*o,t.totalPixels()/n));return s(t)-s(i)}}),i)){if(void 0!==t&&(o.maxFrameRate<t.maxFrameRate&&Math.abs(t.maxFrameRate-o.maxFrameRate)>2||o.totalPixels()<t.totalPixels())){l.add(o.streamId);continue}t=o}}let d=o.filter(e=>!l.has(e.streamId));this.logger.info(`Filtered to ${JSON.stringify(d)}`);let f={targetDownlinkBitrate:0,chosenTotalBitrate:0,deltaToNextUpgrade:0};f.targetDownlinkBitrate=this.determineTargetRate();let p=this.subscribedReceiveSet.size(),m=this.downlinkStats.bandwidthEstimateKbps,g=!this.videoPriorityBasedPolicyConfig.allowSubscribe(p,m);if(this.probeFailed&&(this.probeFailed=!1,this.timeBeforeAllowSubscribeMs=C.MIN_TIME_BETWEEN_SUBSCRIBE_MS,a&&g))return;let v=this.priorityPolicy(f,d,t),b=!h.serverSideNetworkAdaptionIsNoneOrDefault(this.serverSideNetworkAdaption),y=0;if(b||this.startupPeriod||!s?(this.setProbeState("Not Probing"),this.lastUpgradeRateKbps=0):"Probing"===this.rateProbeState?y=this.handleProbe(t,f.targetDownlinkBitrate):0!==f.deltaToNextUpgrade&&(y=this.maybeOverrideOrProbe(t,f,v)),this.previousStreamsWithPreference=o,this.videoPreferencesUpdated=!1,1===y){this.logger.info(`bwe: keepSameSubscriptions stats:${JSON.stringify(this.downlinkStats)}`),this.prevTargetRateKbps=f.targetDownlinkBitrate;return}if(2===y){let e=this.calculateSubscribeRate(this.preProbeNonPausedReceiveStreams);this.optimalReceiveStreams=this.preProbeReceiveStreams.slice(),this.processBwPausedStreams(o,this.preProbeNonPausedReceiveStreams),this.logger.info("bwe: Use Pre-Probe subscription subscribedRate:"+e);return}this.optimalNonPausedReceiveStreams=t.slice();let w=this.pausedBwAttendeeIds.size;this.processBwPausedStreams(o,t),this.logger.getLogLevel()<=u.LogLevel.INFO&&(this.logCount%15==0||this.rateProbeState!==r||this.optimalReceiveStreams.length!==t.length||w!==this.pausedBwAttendeeIds.size)&&(this.logger.info(this.policyStateLogStr(i,f.targetDownlinkBitrate)),this.logCount=0),this.logCount++,this.prevTargetRateKbps=f.targetDownlinkBitrate,this.optimalReceiveStreams=t.slice()}calculateOptimalReceiveSet(){let e=new p.default;for(let t of(this.calculateOptimalReceiveStreams(),this.optimalReceiveStreams))e.add(t.streamId);if(!this.optimalReceiveSet.equal(e)){let t=this.calculateSubscribeRate(this.optimalReceiveStreams);this.logger.info(`bwe: new streamSelection: ${JSON.stringify(e)} subscribedRate:${t}`)}this.optimalReceiveSet=e}determineTargetRate(){let e=0,t=Date.now();return 0!==this.downlinkStats.bandwidthEstimateKbps?(0===this.firstEstimateTimestamp&&(this.firstEstimateTimestamp=t),this.startupPeriod&&(this.downlinkStats.bandwidthEstimateKbps>C.DEFAULT_BANDWIDTH_KBPS||this.downlinkStats.packetsLost>0||t-this.firstEstimateTimestamp>C.STARTUP_PERIOD_MS&&this.downlinkStats.bandwidthEstimateKbps<=this.prevDownlinkStats.bandwidthEstimateKbps)&&(this.startupPeriod=!1,this.prevTargetRateKbps=this.downlinkStats.bandwidthEstimateKbps),this.startupPeriod?e=C.DEFAULT_BANDWIDTH_KBPS:"Probing"===this.rateProbeState&&this.downlinkStats.usedBandwidthKbps>this.downlinkStats.bandwidthEstimateKbps&&this.downlinkStats.packetsLost<C.SPURIOUS_PACKET_LOST_THRESHOLD?(this.logger.info(`bwe: In probe state, overriding estimate ${this.downlinkStats.bandwidthEstimateKbps} with actual receive bitrate ${this.downlinkStats.usedBandwidthKbps}`),e=this.downlinkStats.usedBandwidthKbps+C.USED_BANDWIDTH_OVERRIDE_BUFFER_KBPS):e=this.downlinkStats.bandwidthEstimateKbps):e=0===this.firstEstimateTimestamp?C.DEFAULT_BANDWIDTH_KBPS:this.prevTargetRateKbps,!this.startupPeriod&&(this.usingPrevTargetRate&&this.downlinkStats.bandwidthEstimateKbps<this.prevTargetRateKbps||this.downlinkStats.bandwidthEstimateKbps<this.prevTargetRateKbps*(100-C.LARGE_RATE_CHANGE_TRIGGER_PERCENT)/100||this.downlinkStats.bandwidthEstimateKbps<this.downlinkStats.usedBandwidthKbps*C.LARGE_RATE_CHANGE_TRIGGER_PERCENT/100)&&0===this.downlinkStats.packetsLost?(this.logger.debug(()=>"bwe: ValidateRate: Using Previous rate "+this.prevTargetRateKbps),this.usingPrevTargetRate=!0,e=this.prevTargetRateKbps):this.usingPrevTargetRate=!1,e>15e3&&this.logger.warn("bwe: "+e+" exceeds maximum limit (15000). Limit TargetDisplaySize with VideoPreferences to avoid this."),Math.min(e,15e3)}setProbeState(e){if(this.rateProbeState===e)return!1;let t=Date.now();switch(e){case"Not Probing":this.probePendingStartTimestamp=0;break;case"Probe Pending":if(0!==this.lastProbeTimestamp&&!(t-this.lastProbeTimestamp>C.MIN_TIME_BETWEEN_PROBE_MS))return!1;this.probePendingStartTimestamp=t;break;case"Probing":if(!(t-this.probePendingStartTimestamp>this.timeBeforeAllowProbeMs))return!1;this.lastProbeTimestamp=t,this.preProbeReceiveStreams=this.subscribedReceiveStreams.slice(),this.preProbeNonPausedReceiveStreams=this.optimalNonPausedReceiveStreams,this.timeBeforeAllowProbeMs=Math.min(2*this.timeBeforeAllowProbeMs,C.MAX_HOLD_BEFORE_PROBE_MS)}return this.logger.info("bwe: setProbeState to "+e+" from "+this.rateProbeState),this.rateProbeState=e,!0}upgradeToStream(e,t){for(let i=0;i<e.length;i++)if(e[i].groupId===t.groupId){let r=t.avgBitrateKbps-e[i].avgBitrateKbps;return this.logger.info("bwe: upgradeStream from "+JSON.stringify(e[i])+" to "+t),this.lastUpgradeRateKbps=r,e[i]=t,r}return e.push(t),this.lastUpgradeRateKbps=t.avgBitrateKbps,this.lastUpgradeRateKbps}handleProbe(e,t){if(Date.now()-this.lastProbeTimestamp>C.MAX_ALLOWED_PROBE_TIME_MS)return this.logger.info("bwe: Canceling probe due to timeout"),this.setProbeState("Not Probing"),0;if(this.downlinkStats.packetsLost>0&&(this.logger.info(`bwe: Probe encountering packets lost:${this.downlinkStats.packetsLost}`),this.downlinkStats.packetsLost>C.SPURIOUS_PACKET_LOST_THRESHOLD))return this.setProbeState("Not Probing"),this.logger.info(`bwe: Canceling probe due to packets lost:${this.downlinkStats.packetsLost}`),this.probeFailed=!0,this.timeBeforeAllowSubscribeMs=3*Math.max(C.MIN_TIME_BETWEEN_SUBSCRIBE_MS,this.timeBeforeAllowSubscribeMs),2;let i=this.calculateSubscribeRate(this.optimalReceiveStreams);return this.chosenStreamsSameAsLast(e)||t>i?(this.logger.info("bwe: Probe successful"),this.setProbeState("Not Probing"),this.timeBeforeAllowProbeMs=C.MIN_TIME_BETWEEN_PROBE_MS,0):1}maybeOverrideOrProbe(e,t,i){let r=this.chosenStreamsSameAsLast(e),n=0,o=t.targetDownlinkBitrate>C.LOW_BITRATE_THRESHOLD_KBPS?C.TARGET_RATE_CHANGE_TRIGGER_PERCENT:2*C.TARGET_RATE_CHANGE_TRIGGER_PERCENT,s=t.targetDownlinkBitrate*o/100;if(this.targetRateBaselineForDeltaCheckKbps=void 0!==this.targetRateBaselineForDeltaCheckKbps?this.targetRateBaselineForDeltaCheckKbps:this.prevTargetRateKbps,!r&&Math.abs(t.targetDownlinkBitrate-this.targetRateBaselineForDeltaCheckKbps)<s?(this.logger.info("bwe: MaybeOverrideOrProbe: Reuse last decision based on delta rate. {"+JSON.stringify(this.subscribedReceiveSet)+"}"),n=1):this.targetRateBaselineForDeltaCheckKbps=t.targetDownlinkBitrate,this.downlinkStats.packetsLost>this.prevDownlinkStats.packetsLost)return this.setProbeState("Not Probing"),this.lastUpgradeRateKbps=0,n;if(r||1===n)switch(this.rateProbeState){case"Not Probing":this.setProbeState("Probe Pending");break;case"Probe Pending":this.setProbeState("Probing")&&(this.upgradeToStream(e,i),n=0)}else this.setProbeState("Not Probing");return n}calculateSubscribeRate(e){let t=0;for(let i of e)this.pausedStreamIds.contain(i.streamId)||this.pausedBwAttendeeIds.has(i.attendeeId)||(t+=i.maxBitrateKbps);return t}handleAppPausedStreams(e,t){if(!this.tileController){this.logger.warn("tileController not found!");return}for(let i of(this.pausedStreamIds=new p.default,this.tileController.getAllRemoteVideoTiles())){let r=i.state();if(r.paused&&!this.pausedBwAttendeeIds.has(r.boundAttendeeId)){let i=t.length;for(;i--;)t[i].attendeeId===r.boundAttendeeId&&(this.logger.info("bwe: removed paused attendee "+r.boundAttendeeId+" streamId: "+t[i].streamId),this.pausedStreamIds.add(t[i].streamId),this.subscribedReceiveSet.contain(t[i].streamId)&&e.push(t[i]),t.splice(i,1))}}}processBwPausedStreams(e,t){if(!this.tileController){this.logger.warn("tileController not found!");return}let i=this.getCurrentVideoPreferences();if(i&&this.shouldPauseTiles){let r=this.tileController.getAllVideoTiles();for(let n of i){let i=this.getVideoTileForAttendeeId(n.attendeeId,r),o=(null==i?void 0:i.state().paused)||!1;if(t.some(e=>e.attendeeId===n.attendeeId))o&&this.pausedBwAttendeeIds.has(n.attendeeId)&&(this.logger.info(`bwe: unpausing attendee ${n.attendeeId} due to bandwidth`),this.forEachObserver(e=>{e.tileWillBeUnpausedByDownlinkPolicy(i.id())}),this.tileController.unpauseVideoTile(i.id()),this.pausedBwAttendeeIds.delete(n.attendeeId));else{let r=e.some(e=>e.attendeeId===n.attendeeId);if(i&&r){let e=this.optimalReceiveStreams.find(e=>e.attendeeId===n.attendeeId);void 0!==e&&(o||(this.logger.info(`bwe: pausing streamId ${e.streamId} attendee ${n.attendeeId} due to bandwidth`),this.forEachObserver(e=>{e.tileWillBePausedByDownlinkPolicy(i.id())}),this.tileController.pauseVideoTile(i.id())),t.push(e)),this.pausedBwAttendeeIds.add(n.attendeeId)}else if(r){let e=this.tileController.addVideoTile();e.bindVideoStream(n.attendeeId,!1,null,0,0,0,null),this.forEachObserver(t=>{t.tileWillBePausedByDownlinkPolicy(e.id())}),e.pause(),this.logger.info(`bwe: Created video tile ${e.id()} for bw paused attendee ${n.attendeeId}`),this.pausedBwAttendeeIds.add(n.attendeeId)}}}}}cleanBwPausedTiles(e){if(!this.tileController){this.logger.warn("tileController not found!");return}let t=this.tileController.getAllRemoteVideoTiles(),i=this.getCurrentVideoPreferences();for(let r of t){let t=r.state();t.boundVideoStream||(e.some(e=>e.attendeeId===t.boundAttendeeId)?void 0===i||i.some(e=>e.attendeeId===t.boundAttendeeId)||this.tileController.removeVideoTile(t.tileId):(this.tileController.removeVideoTile(t.tileId),this.logger.info(`bwe: Removed video tile ${t.tileId} for bw paused attendee ${t.boundAttendeeId}`)))}}priorityPolicy(e,t,i){let r,n;let o=this.getCurrentVideoPreferences(),s=o.highestPriority(),a=s;for(;-1!==a;){for(let s of(n=-1,o))if(s.priority===a)for(let n of t)n.attendeeId!==s.attendeeId||i.some(e=>e.groupId===n.groupId)||(e.chosenTotalBitrate+n.avgBitrateKbps<=e.targetDownlinkBitrate?(i.push(n),e.chosenTotalBitrate+=n.avgBitrateKbps):0!==e.deltaToNextUpgrade||(e.deltaToNextUpgrade=n.avgBitrateKbps,r=n));else if(s.priority>a){n=s.priority;break}for(let n of o)if(n.priority===a){for(let o of t)if(o.attendeeId===n.attendeeId){let s=i.findIndex(e=>e.groupId===o.groupId&&e.maxBitrateKbps<=o.maxBitrateKbps&&e.avgBitrateKbps<o.avgBitrateKbps);if(-1!==s){let a=o.avgBitrateKbps-i[s].avgBitrateKbps;this.hasSimulcastStreams(t,o.attendeeId,o.groupId)&&this.canUpgrade(o.avgBitrateKbps,n.targetSize,n.targetSizeToBitrateKbps(n.targetSize),o.attendeeId.endsWith(c.default.Modality))?(this.logger.info(`bwe: attendee: ${o.attendeeId} group: ${o.groupId} has simulcast and can upgrade avgBitrate: ${o.avgBitrateKbps} target: ${n.targetSizeToBitrateKbps(n.targetSize)} targetTotalBitrate: ${e.targetDownlinkBitrate}`),e.chosenTotalBitrate+a<=e.targetDownlinkBitrate?(e.chosenTotalBitrate+=a,i[s]=o):0===e.deltaToNextUpgrade&&(e.deltaToNextUpgrade=a,r=o)):this.logger.info("bwe: cannot upgrade stream quality beyond target size")}}}else if(n.priority>a)break;if(a===s&&0!==e.deltaToNextUpgrade)break;a=n}return r}getVideoTileForAttendeeId(e,t){for(let i of t)if(i.state().boundAttendeeId===e)return i;return null}canUpgrade(e,t,i,r){let n=!1;return(t===g.default.High?n=!0:!r&&e<=i?n=!0:r&&t===g.default.Medium&&e<=i&&(n=!0),n)?(this.logger.info(`bwe: canUpgrade: bitrateKbps: ${e} targetBitrateKbps: ${i}`),!0):(this.logger.info(`bwe: cannot Upgrade: bitrateKbps: ${e} targetBitrateKbps: ${i}`),!1)}hasSimulcastStreams(e,t,i){let r=0;for(let n of e)n.attendeeId===t&&n.groupId===i&&r++;return this.logger.info(`bwe: attendeeId: ${t} groupId: ${i} hasSimulcastStreams: streamCount: ${r}`),r>1}streamsWithPreferenceDidChange(e){if(void 0===this.previousStreamsWithPreference||e.length!==this.previousStreamsWithPreference.length||!0===this.videoPreferencesUpdated)return!0;for(let t of e)if(void 0===this.previousStreamsWithPreference.find(e=>e.groupId===t.groupId&&e.streamId===t.streamId&&e.maxBitrateKbps===t.maxBitrateKbps))return!0;return!1}chosenStreamsSameAsLast(e){if(this.optimalNonPausedReceiveStreams.length!==e.length)return!1;for(let t of this.optimalNonPausedReceiveStreams)if(!e.some(e=>e.streamId===t.streamId))return!1;return!0}policyStateLogStr(e,t){let i={targetBitrate:t,subscribedRate:this.calculateSubscribeRate(this.optimalReceiveStreams),probeState:this.rateProbeState,startupPeriod:this.startupPeriod},r="remoteInfos: [";for(let t of e)r+=`{grpId:${t.groupId} strId:${t.streamId} maxBr:${t.maxBitrateKbps} avgBr:${t.avgBitrateKbps}}, `;r+="]";let n=`bwe: optimalReceiveSet ${JSON.stringify(i)}
bwe:   prev ${JSON.stringify(this.prevDownlinkStats)}
bwe:   now  ${JSON.stringify(this.downlinkStats)}
bwe:   ${r}
`;return(this.pausedStreamIds.size()>0||this.pausedBwAttendeeIds.size>0)&&(n+=`bwe:   paused: app stream ids ${JSON.stringify(this.pausedStreamIds)}  bw attendees { ${Array.from(this.pausedBwAttendeeIds).join(" ")} }
`),this.videoPreferences?n+=`bwe:   preferences: ${JSON.stringify(this.videoPreferences)}`:n+=`bwe:   default preferences: ${JSON.stringify(this.defaultVideoPreferences)}`,n}getCurrentVideoPreferences(){return this.videoPreferences||this.defaultVideoPreferences}getServerSideNetworkAdaption(){return this.serverSideNetworkAdaption}setServerSideNetworkAdaption(e){this.serverSideNetworkAdaption=e,this.setProbeState("Not Probing")}supportedServerSideNetworkAdaptions(){return[h.default.None,h.default.BandwidthProbing,h.default.BandwidthProbingAndRemoteVideoQualityAdaption]}getVideoPreferences(){let e=this.getCurrentVideoPreferences();return e||(e=b.VideoPreferences.prepare().build()),e}wantsAllTemporalLayersInIndex(){return!0}}t.default=C,C.DEFAULT_BANDWIDTH_KBPS=2800,C.STARTUP_PERIOD_MS=6e3,C.LARGE_RATE_CHANGE_TRIGGER_PERCENT=20,C.TARGET_RATE_CHANGE_TRIGGER_PERCENT=15,C.LOW_BITRATE_THRESHOLD_KBPS=300,C.MIN_TIME_BETWEEN_PROBE_MS=5e3,C.MIN_TIME_BETWEEN_SUBSCRIBE_MS=2e3,C.MAX_HOLD_BEFORE_PROBE_MS=3e4,C.MAX_ALLOWED_PROBE_TIME_MS=6e4,C.SPURIOUS_PACKET_LOST_THRESHOLD=2,C.USED_BANDWIDTH_OVERRIDE_BUFFER_KBPS=100},1034:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(7103));class o{constructor(e=0,t=0){this.networkIssueResponseDelayFactor=e,this.networkIssueRecoveryDelayFactor=t,this.currentNetworkEvent=0,this.bandwidthDecreaseTimestamp=0,this.referenceBitrate=0,this.serverSideNetworkAdaption=n.default.BandwidthProbingAndRemoteVideoQualityAdaption,e<0?e=0:e>1&&(e=1),this.networkIssueResponseDelayFactor=e,t<0?t=0:t>1&&(t=1),this.networkIssueRecoveryDelayFactor=t}allowSubscribe(e,t){let i=0,r=this.currentNetworkEvent;if(t>this.referenceBitrate)return this.currentNetworkEvent=2,this.referenceBitrate=t,!0;if(!(t<this.referenceBitrate))return this.currentNetworkEvent=0,!1;if(this.currentNetworkEvent=1,i=this.getSubscribeDelay(this.currentNetworkEvent,e),1!==r)this.bandwidthDecreaseTimestamp=Date.now();else if(Date.now()-this.bandwidthDecreaseTimestamp>i)return this.referenceBitrate=t,!0;return!1}getSubscribeDelay(e,t){let i=o.MINIMUM_DELAY_MS,r=o.MAXIMUM_DELAY_MS-o.MINIMUM_DELAY_MS,n=this.networkIssueResponseDelayFactor;return 1===e&&(i+=r*n*(1+t/10),i=Math.min(o.MAXIMUM_DELAY_MS,i)),i}}t.default=o,o.MINIMUM_DELAY_MS=2e3,o.MAXIMUM_DELAY_MS=8e3,o.Default=new o(0,0),o.UnstableNetworkPreset=new o(0,1),o.StableNetworkPreset=new o(1,0)},5992:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoQualityAdaptationPreference=void 0,function(e){e[e.Balanced=0]="Balanced",e[e.MaintainFramerate=1]="MaintainFramerate",e[e.MaintainResolution=2]="MaintainResolution"}(i=t.VideoQualityAdaptationPreference||(t.VideoQualityAdaptationPreference={})),t.default=i},3663:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{create(){let e={clientWidth:400,clientHeight:300,width:400,height:300,videoWidth:400,videoHeight:300,style:{transform:""},hasAttribute:()=>!1,removeAttribute:()=>{},setAttribute:()=>{},srcObject:!1,paused:!0,pause:()=>{e.paused=!0},play:()=>(e.paused=!1,Promise.resolve())};return e}}t.default=i},9807:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.canvas=e,this.destroyed=!1}destroy(){this.canvas=null,this.destroyed=!0}asCanvasImageSource(){return i(this,void 0,void 0,function*(){return this.destroyed?Promise.reject("canvas buffer is destroyed"):Promise.resolve(this.canvas)})}asCanvasElement(){return this.canvas}}t.default=r},8919:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(9807)),s=n(i(7989)),a=15;class l{constructor(e,t,i=new s.default){this.logger=e,this.stages=t,this.fr=a,this.outputMediaStream=new MediaStream,this.videoInput=document.createElement("video"),this.canvasOutput=document.createElement("canvas"),this.outputCtx=this.canvasOutput.getContext("2d"),this.canvasInput=document.createElement("canvas"),this.inputCtx=this.canvasInput.getContext("2d"),this.inputVideoStream=null,this.sourceBuffers=[],this.destBuffers=[],this.observers=new Set,this.hasStarted=!1,this.process=e=>r(this,void 0,void 0,function*(){let e;if(!this.inputVideoStream)return;let t=performance.now();this.videoInput.videoWidth&&(this.canvasInput.width!==this.videoInput.videoWidth&&(this.canvasInput.width=this.videoInput.videoWidth,this.canvasInput.height=this.videoInput.videoHeight,this.sourceBuffers[0].height=this.canvasInput.height,this.sourceBuffers[0].width=this.canvasInput.width,this.sourceBuffers[0].framerate=this.framerate),this.inputCtx.drawImage(this.videoInput,0,0));let i=[];i.push(this.sourceBuffers[0]);try{for(let e of this.processors)i=yield e.process(i)}catch(e){this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()});return}this.destBuffers=i;try{e=yield this.destBuffers[0].asCanvasImageSource()}catch(e){this.inputVideoStream&&(this.logger.info("buffers are destroyed and pipeline could not start"),this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()}));return}let r=e.width,n=e.height;0===r||0===n||(this.canvasOutput.width!==r&&this.canvasOutput.height!==n&&(this.canvasOutput.width=r,this.canvasOutput.height=n),this.outputCtx.drawImage(e,0,0,r,n,0,0,r,n),this.hasStarted||(this.hasStarted=!0,this.forEachObserver(e=>{e.processingDidStart&&e.processingDidStart()})));let o=performance.now()-t,s=2e3/this.framerate-o,a=Math.max(0,1e3/this.framerate-o);s<=0&&this.forEachObserver(e=>{e.processingLatencyTooHigh&&e.processingLatencyTooHigh(o)}),yield this.timer.start(a,this.process.bind(this))}),this.timer=i}destroy(){if(this.stop(),this.stages)for(let e of this.stages)e.destroy();this.timer.destroy()}get framerate(){return this.fr}set framerate(e){this.fr=e<0||void 0===e?a:e}stop(){if(this.videoInput.removeEventListener("loadedmetadata",this.process),this.videoInput.srcObject=null,this.destroyInputMediaStreamAndBuffers(),this.outputMediaStream)for(let e of this.outputMediaStream.getVideoTracks())e.stop();this.hasStarted&&(this.hasStarted=!1,this.forEachObserver(e=>{e.processingDidStop&&e.processingDidStop()}))}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}getInputMediaStream(){return r(this,void 0,void 0,function*(){return this.inputVideoStream})}getActiveOutputMediaStream(){return this.isOutputMediaStreamActive()||(this.outputMediaStream=this.canvasOutput.captureStream(this.framerate),this.cloneInputAudioTracksToOutput()),this.outputMediaStream}setInputMediaStream(e){return r(this,void 0,void 0,function*(){if(!e){this.stop();return}if(0===e.getVideoTracks().length){this.logger.error("No video tracks in input media stream, ignoring");return}this.inputVideoStream=e;let t=this.inputVideoStream.getVideoTracks()[0].getSettings();this.logger.info(`processing pipeline input stream settings ${JSON.stringify(t)}`),this.framerate=t.frameRate,this.canvasOutput.width=t.width,this.canvasOutput.height=t.height,this.videoInput.addEventListener("loadedmetadata",this.process),this.videoInput.srcObject=this.inputVideoStream,this.videoInput.setAttribute("playsinline","true");let i=new o.default(this.canvasInput);this.sourceBuffers.push(i),this.videoInput.load();try{yield this.videoInput.play()}catch(e){this.logger.warn("Video element play() overrided by another load().")}this.cloneInputAudioTracksToOutput()})}cloneInputAudioTracksToOutput(){if(!this.isOutputMediaStreamActive()||null===this.inputVideoStream){this.logger.info("Not cloning input audio tracks to output, do not have media streams ready");return}for(let e of this.outputMediaStream.getAudioTracks())this.logger.info(`Removing audio track ${e.id} from output stream`),this.outputMediaStream.removeTrack(e);for(let e of this.inputVideoStream.getAudioTracks())this.logger.info(`Adding audio track ${e.id} to output stream`),this.outputMediaStream.addTrack(e)}isOutputMediaStreamActive(){return this.outputMediaStream&&this.outputMediaStream.active}set processors(e){this.stages=e}get processors(){return this.stages}forEachObserver(e){for(let t of this.observers)setTimeout(()=>{e(t)},0)}destroyInputMediaStreamAndBuffers(){if(this.inputVideoStream)for(let e of this.inputVideoStream.getTracks())e.stop();for(let e of(this.inputVideoStream=null,this.sourceBuffers))e.destroy();this.sourceBuffers=[]}}t.default=l},7989:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.workerTimer=void 0,this.callback=void 0,this.workerTimer=this.createWorkerTimer()}createWorkerTimer(){try{let e=new Blob([`self.onmessage = async function(e){ 
            var timerID = null;
            const awaitTimeout = delay => new Promise( resolve => {
              timerID = setTimeout(resolve, delay);
            })
            await awaitTimeout(e.data);
            postMessage(timerID);
          }`],{type:"application/javascript"});return new Worker(window.URL.createObjectURL(e))}catch(e){}}start(e,t){return i(this,void 0,void 0,function*(){this.callback=t,this.workerTimer?(this.workerTimer.onmessage=e=>{this.lastTimeout=e.data,this.callback()},this.workerTimer.postMessage(e)):this.lastTimeout=setTimeout(()=>{this.callback()},e)})}destroy(){return i(this,void 0,void 0,function*(){this.callback=void 0,this.lastTimeout&&(clearTimeout(this.lastTimeout),this.lastTimeout=void 0),this.workerTimer&&(this.workerTimer.terminate(),this.workerTimer=void 0)})}}t.default=r},7673:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(543)),s=n(i(8919));class a{constructor(e,t,i,r=new o.default){this.logger=e,this.device=t,this.processors=i,this.browserBehavior=r,this.observers=new Set,this.pipe=new s.default(this.logger,this.processors),this.pipe.addObserver(this)}get outputMediaStream(){return this.pipe.outputMediaStream}passEventControllerToProcessors(e){if(this.pipe.processors)for(let t of this.pipe.processors)"function"==typeof t.setEventController&&t.setEventController(e)}chooseNewInnerDevice(e){let t=new a(this.logger,e,this.processors,this.browserBehavior);return t.pipe=this.pipe,t}getInnerDevice(){return this.device}intrinsicDevice(){return r(this,void 0,void 0,function*(){return this.device})}transformStream(e){return r(this,void 0,void 0,function*(){return yield this.pipe.setInputMediaStream(e),this.inputMediaStream=e,this.pipe.getActiveOutputMediaStream()})}onOutputStreamDisconnect(){this.logger.info("DefaultVideoTransformDevice: detach stopping input media stream");let e=this.device&&this.device.id;if(this.pipe.stop(),!e&&this.inputMediaStream)for(let e of this.inputMediaStream.getVideoTracks())e.stop()}stop(){return r(this,void 0,void 0,function*(){if(this.inputMediaStream)for(let e of this.inputMediaStream.getVideoTracks())e.stop();this.pipe.destroy(),this.inputMediaStream=null})}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}processingDidStart(){this.logger.info("video transform device processing started"),this.forEachObserver(e=>{e.processingDidStart&&e.processingDidStart()})}processingLatencyTooHigh(e){this.forEachObserver(t=>{t.processingLatencyTooHigh&&t.processingLatencyTooHigh(e)})}processingDidFailToStart(){this.logger.info("video transform device processing failed to start"),this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()})}processingDidStop(){this.logger.info("video transform device processing stopped"),this.forEachObserver(e=>{e.processingDidStop&&e.processingDidStop()})}forEachObserver(e){for(let t of this.observers)setTimeout(()=>{e(t)},0)}get framerate(){return this.pipe.framerate}set framerate(e){this.pipe.framerate=e}}t.default=a},2801:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});class r{process(e){return i(this,void 0,void 0,function*(){return e})}destroy(){return i(this,void 0,void 0,function*(){})}}t.default=r},2826:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeferredPromise=void 0;class i{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}getPromise(){return this.promise}resolvePromise(e){this.resolve(e)}resolveAndReplacePromise(e){this.resolve(e),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}rejectPromise(e){this.reject(e)}rejectAndReplacePromise(e){this.reject(e),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}t.DeferredPromise=i},8190:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoFxCanvasOpsManager=void 0;let n=i(8584);class o{constructor(e,t){this.streamParameters=e,this.outputCanvas=t,this.configureCanvasPipeline()}getInferenceInputData(e){return this.inferenceCtx.save(),this.inferenceCtx.scale(this.horizontalResizeScalar,this.verticalResizeScalar),this.inferenceCtx.drawImage(e,0,0),this.inferenceCtx.restore(),this.inferenceCtx.getImageData(0,0,n.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,n.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS)}configureForStreamParameters(e){return r(this,void 0,void 0,function*(){if(this.streamParameters=e,this.outputCanvas.width=this.streamParameters.width,this.outputCanvas.height=this.streamParameters.height,this.backgroundReplacementCanvas){let e=document.createElement("canvas");e.width=this.streamParameters.width,e.height=this.streamParameters.height,e.getContext("2d").drawImage(this.backgroundReplacementCanvas,0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=e}this.configureCanvasPipeline()})}configureCanvasPipeline(){this.inferenceCanvas=document.createElement("canvas"),this.inferenceCtx=this.inferenceCanvas.getContext("2d",{willReadFrequently:!0}),this.inferenceCanvas.width=n.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,this.inferenceCanvas.height=n.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS,this.horizontalResizeScalar=n.SEGMENTATION_MODEL.WIDTH_IN_PIXELS/this.streamParameters.width,this.verticalResizeScalar=n.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS/this.streamParameters.height}getBackgroundReplacementCanvas(){return this.backgroundReplacementCanvas}loadReplacementBackground(e){return r(this,void 0,void 0,function*(){let t=e.backgroundReplacement.backgroundImageURL,i=e.backgroundReplacement.defaultColor;if(t)try{let e=yield this.loadImage(t);this.backgroundReplacementImage=e,this.resizeAndSetReplacementImage(this.backgroundReplacementImage)}catch(e){throw this.logger.error(e),Error("Failed to set the replacement image.")}else this.resizeAndSetReplacementColor(i)})}resizeAndSetReplacementImage(e){let t=document.createElement("canvas"),i=t.getContext("2d");t.width=this.streamParameters.width,t.height=this.streamParameters.height,i.drawImage(e,0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=t}resizeAndSetReplacementColor(e){let t=document.createElement("canvas"),i=t.getContext("2d");t.width=this.streamParameters.width,t.height=this.streamParameters.height,i.fillStyle=e,i.fillRect(0,0,this.streamParameters.width,this.streamParameters.height),this.backgroundReplacementCanvas=t}loadImage(e){return r(this,void 0,void 0,function*(){let t=yield fetch(e).catch(e=>{throw this.logger.error(e.toString()),Error("Failed to fetch image.")}),i=yield t.blob(),r=new Image;return r.src=URL.createObjectURL(i),new Promise((e,t)=>{r.onload=()=>{e(r)},r.onerror=e=>{t(e)}})})}}t.VideoFxCanvasOpsManager=o},8584:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_VIDEO_FX_SPEC=t.FXLIB_PATH=t.WORKER_PATH=t.CDN_BASE_PATH=t.RESOURCE_CONSTRAINTS=t.SEGMENTATION_MODEL=t.DEFAULT_STREAM_PARAMETERS=t.WORKER_MSG=void 0,t.WORKER_MSG={BUILD_ENGINE_REQUEST:"BuildEngineRequest",BUILD_ENGINE_RESPONSE:"BuildEngineResponse",PERFORM_SEGMENTATION_REQUEST:"PerformSegmentationRequest",PERFORM_SEGMENTATION_RESPONSE:"PerformSegmentationResponse",PERFORM_SEGMENTATION_SAB_REQUEST:"PerformSegmentationSABRequest",PERFORM_SEGMENTATION_SAB_RESPONSE:"PerformSegmentationSABResponse",DESTROY_ASSETS_REQUEST:"DestroyAssetsRequest",DESTROY_ASSETS_RESPONSE:"DestroyAssetsResponse",CLOSE_WORKER_REQUEST:"CloseWorkerRequest"},t.DEFAULT_STREAM_PARAMETERS={FRAMES_PER_SECOND:15,WIDTH_IN_PIXEL:960,HEIGHT_IN_PIXEL:540,CHANNEL_COUNT:4},t.SEGMENTATION_MODEL={LOAD_SUCCESS:2,WIDTH_IN_PIXELS:176,HEIGHT_IN_PIXELS:160},t.RESOURCE_CONSTRAINTS={DEFAULT_PROCESSING_BUDGET_PER_FRAME:50,SEGMENTATION_DEFAULT_FRAMES_PER_SEGMENTATION:1,SEGMENTATION_SAMPLING_PERIOD_FRAME_COUNT:500,BLUR_DEFAULT_CYCLE_PERCENTAGE:10,BLUR_SAMPLING_PERIOD_FRAME_COUNT:1e3,MIN_PROCESSING_BUDGET:0,MAX_PROCESSING_BUDGET:100},t.CDN_BASE_PATH="https://static.sdkassets.chime.aws";let i="/ml_media_fx/otherassets";t.WORKER_PATH=`${i}/worker.js`,t.FXLIB_PATH=`${i}/fxlib.js`,t.DEFAULT_VIDEO_FX_SPEC={paths:{cdnBasePath:t.CDN_BASE_PATH,workerPath:t.WORKER_PATH,fxLibPath:t.FXLIB_PATH}}},7746:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=i(623),s=i(5021),a=i(9424),l=n(i(543)),d=n(i(7434)),c=i(8690),u=n(i(4046)),h=n(i(9807)),f=i(2826),p=i(8190),m=i(8584),g=i(9935);class v{constructor(e,t=m.RESOURCE_CONSTRAINTS.DEFAULT_PROCESSING_BUDGET_PER_FRAME,i){this.logger=e,this.outputCanvas=document.createElement("canvas"),this.canvasVideoFrameBuffer=new h.default(this.outputCanvas),this.videoFxSpec=m.DEFAULT_VIDEO_FX_SPEC;try{this.validateProcessingBudgetPerFrame(t)}catch(e){throw this.logger.error(e),Error(`Cannot instantiate VideoFxProcessor due to invalid processingBudgetPerFrame of ${t}`)}i&&(this.eventController=i),this.effectConfig={backgroundBlur:{isEnabled:!1,strength:"low"},backgroundReplacement:{isEnabled:!1,backgroundImageURL:null,defaultColor:"black"}},this.segmentationRequestPromise=new f.DeferredPromise,this.segmentationRateManager=new g.VideoFxSegmentationRateManager(this.logger,t),this.streamParameters={framerate:m.DEFAULT_STREAM_PARAMETERS.FRAMES_PER_SECOND,width:m.DEFAULT_STREAM_PARAMETERS.WIDTH_IN_PIXEL,height:m.DEFAULT_STREAM_PARAMETERS.HEIGHT_IN_PIXEL,channels:m.DEFAULT_STREAM_PARAMETERS.CHANNEL_COUNT},v.isSharedArrayBufferSupported&&(this.sharedImageBuffer=new SharedArrayBuffer(m.SEGMENTATION_MODEL.WIDTH_IN_PIXELS*m.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS*this.streamParameters.channels),this.sharedImageData=new Uint8ClampedArray(this.sharedImageBuffer)),this.logger.info(`VideoFx supports Shared Array Buffer: ${v.isSharedArrayBufferSupported}`),this.canvasOpsManager=new p.VideoFxCanvasOpsManager(this.streamParameters,this.outputCanvas),this.outputCanvas.width=this.streamParameters.width,this.outputCanvas.height=this.streamParameters.height,this.segmentationMask=new ImageData(this.streamParameters.width,this.streamParameters.height),this.logger.info(`VideoFxProcessor instantiated with a processingBudgetPerFrame of ${t}`)}process(e){return r(this,void 0,void 0,function*(){return e})}fxProcess(e){return r(this,void 0,void 0,function*(){let t=e[0].asCanvasElement();this.didStreamParametersChange(t)&&(yield this.adjustProcessorForNewStreamParameters(t));try{yield this.manageSegmentationMask(t)}catch(e){throw this.logger.error(e),Error("Video stream could not be processed")}return yield this.renderer.render(t,this.segmentationMask),e[0]=this.canvasVideoFrameBuffer,e})}noOpProcess(e){return r(this,void 0,void 0,function*(){return e})}didStreamParametersChange(e){return e.width!==this.streamParameters.width||e.height!==this.streamParameters.height}adjustProcessorForNewStreamParameters(e){return r(this,void 0,void 0,function*(){this.streamParameters.width=e.width,this.streamParameters.height=e.height,yield this.canvasOpsManager.configureForStreamParameters(this.streamParameters),yield this.renderer.configure(this.streamParameters.width,this.streamParameters.height,this.effectConfig)})}destroy(){return r(this,void 0,void 0,function*(){this.canvasVideoFrameBuffer.destroy(),this.fxLibScript&&this.fxLibScript.parentNode&&this.fxLibScript.parentNode.removeChild(this.fxLibScript),this.engineWorker&&(this.destroyedAssetsPromise=new f.DeferredPromise,this.engineWorker.postMessage({msg:m.WORKER_MSG.DESTROY_ASSETS_REQUEST}),yield this.destroyedAssetsPromise.getPromise(),this.engineWorker.postMessage({msg:m.WORKER_MSG.CLOSE_WORKER_REQUEST})),this.logger.info("VideoFxProcessor destroyed.")})}manageSegmentationMask(e){return r(this,void 0,void 0,function*(){try{if(this.segmentationRateManager.submitFrame(),this.segmentationRateManager.shouldApplySegmentation()){this.segmentationRateManager.startSegmentation();let t=this.canvasOpsManager.getInferenceInputData(e);this.segmentationMask=yield this.generateSegmentationMask(t),this.segmentationRateManager.completeSegmentation()}}catch(e){throw this.logger.error(e.toString()),Error("Can not properly manage the returned segmentation mask")}})}generateSegmentationMask(e){return r(this,void 0,void 0,function*(){v.isSharedArrayBufferSupported?(this.sharedImageData.set(e.data),this.engineWorker.postMessage({msg:m.WORKER_MSG.PERFORM_SEGMENTATION_SAB_REQUEST,payload:this.sharedImageBuffer})):this.engineWorker.postMessage({msg:m.WORKER_MSG.PERFORM_SEGMENTATION_REQUEST,payload:e},[e.data.buffer]);try{return yield this.segmentationRequestPromise.getPromise()}catch(e){throw this.logger.error(e.toString()),Error("Segmentation mask could not be generated")}})}cloneConfigFrom(e){return{backgroundBlur:{isEnabled:e.backgroundBlur.isEnabled,strength:e.backgroundBlur.strength},backgroundReplacement:{isEnabled:e.backgroundReplacement.isEnabled,backgroundImageURL:e.backgroundReplacement.backgroundImageURL,defaultColor:e.backgroundReplacement.defaultColor}}}setVideoFxSpec(e){e.paths&&(this.videoFxSpec.paths=e.paths)}setEffectConfig(e){return r(this,void 0,void 0,function*(){if(this.sameVideoFxConfig(e,this.effectConfig))return;let t=this.cloneConfigFrom(e);try{yield this.validateEffectConfig(t)}catch(e){throw this.logger.error(e.toString()),Error("Provided effect config is invalid, not updating VideoFxProcessor")}t.backgroundReplacement.isEnabled&&(yield this.canvasOpsManager.loadReplacementBackground(t),yield this.renderer.setBackgroundReplacementCanvas(this.canvasOpsManager.getBackgroundReplacementCanvas())),yield this.renderer.configure(this.streamParameters.width,this.streamParameters.height,t),this.effectConfig=t,this.effectConfig.backgroundBlur.isEnabled||this.effectConfig.backgroundReplacement.isEnabled?this.process=this.fxProcess:this.process=this.noOpProcess,this.logger.info(`VideoFxProcessor effect configuration updated to: ${JSON.stringify(this.effectConfig)}`),this.eventController&&this.publishVideoFxConfigEvent()})}validateEffectConfig(e){return r(this,void 0,void 0,function*(){if(e.backgroundBlur.isEnabled&&e.backgroundReplacement.isEnabled)throw Error("Invalid VideoFx configuration: Background Blur and Background Replacement can not both be enabled");e.backgroundReplacement.isEnabled&&(yield this.validateReplacementConfig(e))})}validateReplacementConfig(e){return r(this,void 0,void 0,function*(){if(e.backgroundReplacement.backgroundImageURL&&e.backgroundReplacement.defaultColor)throw Error("Invalid VideoFx configuration: Background Replacement can not have both an image URL and default color");if(!e.backgroundReplacement.backgroundImageURL&&!e.backgroundReplacement.defaultColor)throw Error("Invalid VideoFx configuration: Background Replacement image URL and default can not both be null/undefined");try{e.backgroundReplacement.backgroundImageURL&&(yield this.canvasOpsManager.loadImage(e.backgroundReplacement.backgroundImageURL))}catch(e){throw this.logger.error(e.toString()),Error("Invalid VideoFx configuration: backgroundImageURL failed to load")}let t=e.backgroundReplacement.defaultColor;if(t&&"black"!==t&&"#000000"!==t&&"#000"!==t){if(t.includes("#")&&!new RegExp(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/).test(t))throw Error(`Invalid hexadecimal color code for default replacement background: ${t}`);let e=document.createElement("canvas").getContext("2d"),i=e.fillStyle;if(e.fillStyle=t,e.fillStyle===i)throw Error(`Invalid color for default replacement background: ${t}`)}})}validateProcessingBudgetPerFrame(e){if(e<m.RESOURCE_CONSTRAINTS.MIN_PROCESSING_BUDGET||e>m.RESOURCE_CONSTRAINTS.MAX_PROCESSING_BUDGET)throw Error(`Invalid resource constraint: cycle percentage must be within range of ${m.RESOURCE_CONSTRAINTS.MIN_PROCESSING_BUDGET} and ${m.RESOURCE_CONSTRAINTS.MAX_PROCESSING_BUDGET}`)}loadAssets(){return r(this,void 0,void 0,function*(){this.logger.info("Loading required assets for the VideoFxProcessor");try{let e=this.getVideoFxAssetParams();yield this.loadEngineWorker(e),yield this.buildEngine(e),yield this.loadFxLib(e),this.renderer=constructRenderer(m.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,m.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS,this.effectConfig,this.outputCanvas)}catch(e){throw this.logger.error(e.toString()),Error("Failed to load necessary assets for the VideoFxProcessor")}this.logger.info("Finished loading of essential VideoFxProcessor assets.")})}getVideoFxAssetParams(){let e=c.getDefaultAssetSpec();return{assetGroup:e.assetGroup,revisionID:e.revisionID,sdk:encodeURIComponent(u.default.sdkVersion),ua:encodeURIComponent(u.default.sdkUserAgentLowResolution)}}getPathFromVideoFxAssetParams(e,t){let i=new URL(e);for(let[e,r]of Object.entries(t))if(void 0!==r){let t=encodeURIComponent(e),n=encodeURIComponent(r);i.searchParams.set(t,n)}return i.toString()}loadEngineWorker(e){return r(this,void 0,void 0,function*(){try{let t=this.getPathFromVideoFxAssetParams(this.videoFxSpec.paths.cdnBasePath+this.videoFxSpec.paths.workerPath,e);this.engineWorker=yield s.loadWorker(t,"VideoFxEngineWorker",{},null),this.logger.info("Successfully loaded the VideoFxProcessor's engine worker"),this.engineWorker.addEventListener("message",e=>this.engineWorkerReceiver(e))}catch(e){throw this.logger.error(e.toString()),Error("Failed to load the VideoFxProcessor's engine worker")}})}buildEngine(e){return r(this,void 0,void 0,function*(){this.buildEnginePromise=new f.DeferredPromise,this.engineWorker.postMessage({msg:m.WORKER_MSG.BUILD_ENGINE_REQUEST,payload:{cdnBasePath:this.videoFxSpec.paths.cdnBasePath,sdkVersioningParams:e}});try{yield this.buildEnginePromise.getPromise()}catch(e){throw this.logger.error(e.toString()),Error("Failed to instantiate the VideoFxEngine")}})}loadFxLib(e){return r(this,void 0,void 0,function*(){let t=this.getPathFromVideoFxAssetParams(this.videoFxSpec.paths.cdnBasePath+this.videoFxSpec.paths.fxLibPath,e),i={method:"GET",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"};try{let e=yield o.fetchWithBehavior(t,i,{});if(!e.ok)throw Error("Fetch failed.");let r=window.URL.createObjectURL((yield e.blob()));yield new Promise((e,t)=>{this.fxLibScript=document.createElement("script"),this.fxLibScript.setAttribute("src",r),this.fxLibScript.setAttribute("type","module"),this.fxLibScript.setAttribute("async","false"),this.fxLibScript.addEventListener("load",e),this.fxLibScript.addEventListener("error",t),document.body.appendChild(this.fxLibScript)})}catch(e){throw this.logger.error(e.toString()),Error("Failed to load the fxlib")}})}getEffectConfig(){return this.cloneConfigFrom(this.effectConfig)}engineWorkerReceiver(e){let t=e.data;switch(t.msg){case m.WORKER_MSG.BUILD_ENGINE_RESPONSE:this.settleEngineBuildPromise(t.payload);break;case m.WORKER_MSG.PERFORM_SEGMENTATION_RESPONSE:this.settleSegmentationPromise(t.payload.output);break;case m.WORKER_MSG.PERFORM_SEGMENTATION_SAB_RESPONSE:this.settleSegmentationPromiseSAB();break;case m.WORKER_MSG.DESTROY_ASSETS_RESPONSE:this.destroyedAssetsPromise.resolvePromise();break;default:this.logger.info(`VideoFx worker received unknown event msg: ${JSON.stringify(t)}`)}}settleEngineBuildPromise(e){e!==m.SEGMENTATION_MODEL.LOAD_SUCCESS?this.buildEnginePromise.rejectPromise(Error("Failed to build VideoFxProcessor's engine")):(this.logger.info("Successfully built the VideoFxEngine"),this.buildEnginePromise.resolvePromise())}settleSegmentationPromise(e){e?this.segmentationRequestPromise.resolveAndReplacePromise(e):this.segmentationRequestPromise.rejectAndReplacePromise(Error("Failed to perform a segmentation on the input image"))}settleSegmentationPromiseSAB(){try{let e=new ImageData(new Uint8ClampedArray(this.sharedImageData),m.SEGMENTATION_MODEL.WIDTH_IN_PIXELS,m.SEGMENTATION_MODEL.HEIGHT_IN_PIXELS);this.segmentationRequestPromise.resolveAndReplacePromise(e)}catch(e){this.segmentationRequestPromise.rejectAndReplacePromise(Error("Failed to perform a segmentation with a shared array buffer on the input image"))}}setToNoOpProcess(){this.process=this.noOpProcess}static isSupported(e=new d.default,t=!0){return r(this,void 0,void 0,function*(){let i=!0,n=(t,r)=>{t&&(e.info(r),i=!1)};n("undefined"==typeof globalThis,"Browser does not have globalThis."),n(!a.supportsWorker(globalThis,e),"Browser does not support web workers."),n(!a.supportsWASM(globalThis,e),"Browser does not support wasm."),n(!document.createElement("canvas").getContext("webgl2"),"Browser does not support webgl."),n(!new l.default().isVideoFxSupportedBrowser(),"Browser is unsupported for VideoFxProcessor");let o=()=>r(this,void 0,void 0,function*(){if(t)try{let t=new v(e);yield t.loadAssets(),yield t.destroy()}catch(t){return e.info("Browser environment is unable to access the required external assets."),Promise.resolve(!1)}return Promise.resolve(!0)});return Promise.resolve(!!i&&(yield o()))})}static create(e,t,i=m.RESOURCE_CONSTRAINTS.DEFAULT_PROCESSING_BUDGET_PER_FRAME,n){return r(this,void 0,void 0,function*(){let r=new v(e,i);n&&r.setVideoFxSpec(n);try{return yield r.loadAssets(),yield r.setEffectConfig(t),r}catch(t){throw e.error(t.toString()),r.setToNoOpProcess(),Error("VideoFxProcessor built with support for only NoOp processing")}})}setEventController(e){this.eventController?this.eventController=e:(this.eventController=e,this.publishVideoFxConfigEvent())}publishVideoFxConfigEvent(){let e={backgroundBlurEnabled:this.effectConfig.backgroundBlur.isEnabled.toString(),backgroundBlurStrength:this.effectConfig.backgroundBlur.strength,backgroundReplacementEnabled:this.effectConfig.backgroundReplacement.isEnabled.toString(),backgroundFilterVersion:2};this.eventController.publishEvent("backgroundFilterConfigSelected",e)}sameVideoFxConfig(e,t){return e.backgroundBlur.isEnabled===t.backgroundBlur.isEnabled&&e.backgroundBlur.strength===t.backgroundBlur.strength&&e.backgroundReplacement.backgroundImageURL===t.backgroundReplacement.backgroundImageURL&&e.backgroundReplacement.defaultColor===t.backgroundReplacement.defaultColor&&e.backgroundReplacement.isEnabled===t.backgroundReplacement.isEnabled}}t.default=v,v.isSharedArrayBufferSupported="undefined"!=typeof SharedArrayBuffer},9935:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoFxSegmentationRateManager=void 0;let r=i(8584);class n{constructor(e,t){this.logger=e,this.targetSegmentationCyclePercentage=t/100,this.frameCountOverSamplingPeriod=0,this.totalSegmentationDurationOverSamplingPeriod=0,this.samplingPeriodStartTime=performance.now(),this.framesPerSegmentation=r.RESOURCE_CONSTRAINTS.SEGMENTATION_DEFAULT_FRAMES_PER_SEGMENTATION}submitFrame(){this.frameCountOverSamplingPeriod++}shouldApplySegmentation(){return this.frameCountOverSamplingPeriod%this.framesPerSegmentation==0}startSegmentation(){this.frameSegmentationStartTime=performance.now()}completeSegmentation(){this.totalSegmentationDurationOverSamplingPeriod+=performance.now()-this.frameSegmentationStartTime,this.frameCountOverSamplingPeriod>=r.RESOURCE_CONSTRAINTS.SEGMENTATION_SAMPLING_PERIOD_FRAME_COUNT&&this.adjustFramesPerSegmentation(this.totalSegmentationDurationOverSamplingPeriod/(performance.now()-this.samplingPeriodStartTime))}adjustFramesPerSegmentation(e){e>this.targetSegmentationCyclePercentage?(this.framesPerSegmentation++,this.logger.info(`Segmentation cycle percentage above the configured maximal value. Decreasing segmentation rate to 1 segmentation per ${this.framesPerSegmentation} frames`)):this.framesPerSegmentation>1&&e<this.targetSegmentationCyclePercentage&&(this.framesPerSegmentation--,this.logger.info(`Segmentation cycle percentage below the configured maximal value. Increasing segmentation rate to 1 segmentation per ${this.framesPerSegmentation} frames`)),this.totalSegmentationDurationOverSamplingPeriod=0,this.frameCountOverSamplingPeriod=0,this.samplingPeriodStartTime=performance.now()}}t.VideoFxSegmentationRateManager=n},60:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},1508:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.ids=new Set(e)}add(e){this.ids.add(e)}array(){return Array.from(this.ids.values()).sort((e,t)=>e-t)}contain(e){return this.ids.has(e)}forEach(e){this.ids.forEach(e)}empty(){return 0===this.ids.size}size(){return this.ids.size}equal(e){if(!e)return 0===this.ids.size;let t=this.array(),i=e.array();if(t.length!==i.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==i[e])return!1;return!0}clone(){return new i(this.array())}remove(e){this.ids.delete(e)}toJSON(){return this.array()}truncate(e){return new i(this.array().splice(0,e))}}t.default=i},1318:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(289),o=r(i(1508)),s=r(i(6876));class a{constructor(e){this.logger=e,this.currentIndex=null,this.indexForSubscribe=null,this.indexForLastRemoteVideoUpdate=null,this.currentSubscribeAck=null,this.subscribeTrackToStreamMap=null,this.subscribeStreamToAttendeeMap=null,this.subscribeStreamToExternalUserIdMap=null,this.subscribeSsrcToStreamMap=null,this.subscribeSsrcToGroupMap=null,this.streamToAttendeeMap=null,this.groupIdToAttendeeMap=null,this.streamToExternalUserIdMap=null,this.videoStreamDescription=new s.default,this.sendVideoStreamId=0,this.videoStreamDescription.trackLabel="AmazonChimeExpressVideo",this.videoStreamDescription.streamId=2,this.videoStreamDescription.groupId=2}localStreamDescriptions(){return[this.videoStreamDescription.clone()]}convertBpsToKbps(e){return e>0&&e<1e3?1:Math.trunc(e/1e3)}remoteStreamDescriptions(){if(!this.currentIndex||!this.currentIndex.sources)return[];let e=[];return this.currentIndex.sources.forEach(t=>{let i=new s.default;i.attendeeId=t.attendeeId,i.groupId=t.groupId,i.streamId=t.streamId,i.maxBitrateKbps=t.maxBitrateKbps,i.avgBitrateKbps=this.convertBpsToKbps(t.avgBitrateBps),i.width=t.width,i.height=t.height,i.maxFrameRate=t.framerate,e.push(i)}),e}integrateUplinkPolicyDecision(e){if(e&&e.length){let t=e[0];this.videoStreamDescription.maxBitrateKbps=t.maxBitrate/1e3,this.videoStreamDescription.maxFrameRate=t.maxFramerate}}integrateIndexFrame(e){if(this.currentIndex=e,!e)return;let t=new Map,i=!1;for(let r of e.sources){if(!t.has(r.attendeeId)){t.set(r.attendeeId,r.groupId);continue}let e=t.get(r.attendeeId);e<r.groupId&&(this.logger.warn(`Old group ID ${e} found for attendee ID ${r.attendeeId}, replacing with newer group ID ${r.groupId}`),t.set(r.attendeeId,r.groupId)),i=!0}i&&(this.currentIndex.sources=this.currentIndex.sources.filter(e=>t.get(e.attendeeId)===e.groupId)),this.streamToAttendeeMap=null,this.groupIdToAttendeeMap=null,this.streamToExternalUserIdMap=null}subscribeFrameSent(){this.indexForSubscribe=this.currentIndex}remoteVideoUpdateSent(){this.indexForLastRemoteVideoUpdate=this.currentIndex}integrateSubscribeAckFrame(e){this.currentSubscribeAck=e,this.subscribeTrackToStreamMap=this.buildTrackToStreamMap(this.currentSubscribeAck),this.subscribeSsrcToStreamMap=this.buildSSRCToStreamMap(this.currentSubscribeAck),this.subscribeSsrcToGroupMap=this.buildSSRCToGroupMap(this.currentSubscribeAck),this.subscribeStreamToAttendeeMap=this.buildStreamToAttendeeMap(this.indexForSubscribe),this.subscribeStreamToExternalUserIdMap=this.buildStreamExternalUserIdMap(this.indexForSubscribe),this.sendVideoStreamId=0,e.allocations&&void 0!==e.allocations&&e.allocations.length>0&&(this.sendVideoStreamId=e.allocations[0].streamId)}integrateBitratesFrame(e){if(this.currentIndex)for(let t of e.bitrates){let e=this.currentIndex.sources.find(e=>e.streamId===t.sourceStreamId);void 0!==e&&(e.avgBitrateBps=t.avgBitrateBps)}}allStreams(){let e=new o.default;if(this.currentIndex)for(let t of this.currentIndex.sources)e.add(t.streamId);return e}allVideoSendingSourcesExcludingSelf(e){let t=[],i=new Set;if(this.currentIndex&&this.currentIndex.sources&&this.currentIndex.sources.length)for(let r of this.currentIndex.sources){let{attendeeId:o,externalUserId:s,mediaType:a}=r;o===e||a!==n.SdkStreamMediaType.VIDEO||i.has(o)||(t.push({attendee:{attendeeId:o,externalUserId:s}}),i.add(o))}return t}streamSelectionUnderBandwidthConstraint(e,t,i,r){let s=new Set;if(this.currentIndex)for(let r of this.currentIndex.sources)r.attendeeId!==e&&r.mediaType===n.SdkStreamMediaType.VIDEO&&(t.has(r.attendeeId)||i.has(r.attendeeId)||s.add(r.attendeeId));let a=this.buildAttendeeToSortedStreamDescriptorMapExcludingSelf(e),l=new Map,d=0;a.forEach((e,t)=>{l.set(t,e[0]),d+=e[0].maxBitrateKbps}),d=this.trySelectHighBitrateForAttendees(a,t,d,r,l),this.trySelectHighBitrateForAttendees(a,s,d,r,l);let c=new o.default;for(let e of l.values())c.add(e.streamId);return c}highestQualityStreamFromEachGroupExcludingSelf(e){let t=new o.default;if(this.currentIndex){let i=new Map;for(let t of this.currentIndex.sources)t.attendeeId!==e&&t.mediaType===n.SdkStreamMediaType.VIDEO&&(!i.has(t.groupId)||t.maxBitrateKbps>i.get(t.groupId).maxBitrateKbps)&&i.set(t.groupId,t);for(let e of i.values())t.add(e.streamId)}return t}numberOfVideoPublishingParticipantsExcludingSelf(e){return this.highestQualityStreamFromEachGroupExcludingSelf(e).array().length}numberOfParticipants(){return this.currentIndex.numParticipants?this.currentIndex.numParticipants:-1}attendeeIdForTrack(e){let t=this.streamIdForTrack(e);return void 0!==t&&this.subscribeStreamToAttendeeMap?this.subscribeStreamToAttendeeMap.get(t)||(this.logger.info(`track ${e} (stream ${t}) does not correspond to a known attendee`),""):(this.logger.warn(`no attendee found for track ${e}`),"")}externalUserIdForTrack(e){let t=this.streamIdForTrack(e);return void 0!==t&&this.subscribeStreamToExternalUserIdMap?this.subscribeStreamToExternalUserIdMap.get(t)||(this.logger.info(`track ${e} (stream ${t}) does not correspond to a known externalUserId`),""):(this.logger.warn(`no external user id found for track ${e}`),"")}attendeeIdForStreamId(e){if(!this.streamToAttendeeMap){if(!this.currentIndex)return"";this.streamToAttendeeMap=this.buildStreamToAttendeeMap(this.currentIndex)}return this.streamToAttendeeMap.get(e)||(this.logger.info(`stream ID ${e} does not correspond to a known attendee`),"")}attendeeIdForGroupId(e){if(!this.groupIdToAttendeeMap){if(!this.currentIndex)return"";this.groupIdToAttendeeMap=this.buildGroupIdToAttendeeMap(this.currentIndex)}return this.groupIdToAttendeeMap.get(e)||(this.logger.info(`group ID ${e} does not correspond to a known attendee`),"")}groupIdForStreamId(e){if(this.currentIndex&&this.currentIndex.sources){for(let t of this.currentIndex.sources)if(t.streamId===e)return t.groupId;if(this.indexForSubscribe){for(let t of this.indexForSubscribe.sources)if(t.streamId===e)return t.groupId}if(this.indexForLastRemoteVideoUpdate){for(let t of this.indexForLastRemoteVideoUpdate.sources)if(t.streamId===e)return t.groupId}}}StreamIdsInSameGroup(e,t){return this.groupIdForStreamId(e)===this.groupIdForStreamId(t)}streamIdForTrack(e){if(this.subscribeTrackToStreamMap)return this.subscribeTrackToStreamMap.get(e)}streamIdForSSRC(e){if(this.subscribeSsrcToStreamMap)return this.subscribeSsrcToStreamMap.get(e)}overrideStreamIdMappings(e,t){if(this.subscribeTrackToStreamMap){for(let[i,r]of this.subscribeTrackToStreamMap.entries())if(e===r){this.subscribeTrackToStreamMap.set(i,t);break}}if(this.subscribeSsrcToStreamMap){for(let[i,r]of this.subscribeSsrcToStreamMap.entries())if(e===r){this.subscribeSsrcToStreamMap.set(i,t);break}}}groupIdForSSRC(e){if(this.subscribeSsrcToGroupMap)return this.subscribeSsrcToGroupMap.get(e)}streamsPausedAtSource(){let e=new o.default;if(this.currentIndex)for(let t of this.currentIndex.pausedAtSourceIds)e.add(t);return e}sendVideoStreamIdFromRid(e){return this.sendVideoStreamId}buildTrackToStreamMap(e){let t=new Map;for(let i of(this.logger.debug(()=>`trackMap ${JSON.stringify(e.tracks)}`),e.tracks))i.trackLabel.length>0&&i.streamId>0&&t.set(i.trackLabel,i.streamId);return t}buildSSRCToStreamMap(e){let t=new Map;for(let i of(this.logger.debug(()=>`ssrcMap ${JSON.stringify(e.tracks)}`),e.tracks))i.trackLabel.length>0&&i.streamId>0&&t.set(i.ssrc,i.streamId);return t}buildSSRCToGroupMap(e){let t=new Map;for(let i of e.tracks)i.trackLabel.length>0&&i.streamId>0&&t.set(i.ssrc,this.groupIdForStreamId(i.streamId));return t}buildStreamToAttendeeMap(e){let t=new Map;if(e)for(let i of e.sources)t.set(i.streamId,i.attendeeId);return t}buildGroupIdToAttendeeMap(e){let t=new Map;for(let i of e.sources)t.set(i.groupId,i.attendeeId);return t}buildStreamExternalUserIdMap(e){let t=new Map;if(e)for(let i of e.sources)i.externalUserId&&t.set(i.streamId,i.externalUserId);return t}trySelectHighBitrateForAttendees(e,t,i,r,n){for(let o of t){if(i>=r)break;if(e.has(o)){for(let t of e.get(o).reverse())if(i-n.get(o).maxBitrateKbps+t.maxBitrateKbps<r){i=i-n.get(o).maxBitrateKbps+t.maxBitrateKbps,n.set(o,t);break}}}return i}buildAttendeeToSortedStreamDescriptorMapExcludingSelf(e){let t=new Map;if(this.currentIndex)for(let i of this.currentIndex.sources)i.attendeeId!==e&&i.mediaType===n.SdkStreamMediaType.VIDEO&&(t.has(i.attendeeId)?t.get(i.attendeeId).push(i):t.set(i.attendeeId,[i]));return t.forEach((e,t)=>{e.sort((e,t)=>e.maxBitrateKbps>t.maxBitrateKbps?1:e.maxBitrateKbps<t.maxBitrateKbps?-1:0)}),t}}t.default=a},4242:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(289),o=r(i(1318)),s=r(i(6876));class a extends o.default{constructor(){super(...arguments),this.streamIdToBitrateKbpsMap=new Map,this._localStreamInfos=[],this._sendRidToVideoStreamIdMap=new Map}localStreamDescriptions(){let e=[];return this._localStreamInfos.forEach(t=>{e.push(t.clone())}),e}integrateUplinkPolicyDecision(e){let t=!0,i=0;for(let r=0;r<e.length;r++){let n=e[r].maxBitrate/1e3,o=e[r].maxFramerate;if(!t||r===this._localStreamInfos.length){t=!1;let a=new s.default;a.maxBitrateKbps=n,a.maxFrameRate=o,a.disabledByUplinkPolicy=0===n,a.rid=e[r].rid,0!==n&&(a.timeEnabled=Date.now()),this._localStreamInfos.push(a),i++;continue}0===this._localStreamInfos[i].maxBitrateKbps&&n>0&&(this._localStreamInfos[i].timeEnabled=Date.now()),this._localStreamInfos[i].maxBitrateKbps=n,this._localStreamInfos[i].maxFrameRate=o,this._localStreamInfos[i].disabledByUplinkPolicy=0===n,i++}t&&this._localStreamInfos.splice(i)}integrateBitratesFrame(e){super.integrateBitratesFrame(e);let t=new Set,i=new Set(this.streamIdToBitrateKbpsMap.keys());for(let i of e.bitrates)t.add(i.sourceStreamId),this.streamIdToBitrateKbpsMap.set(i.sourceStreamId,this.convertBpsToKbps(i.avgBitrateBps));for(let e of i)t.has(e)||(this.streamIdToBitrateKbpsMap.get(e)===a.UNSEEN_STREAM_BITRATE?this.streamIdToBitrateKbpsMap.set(e,a.RECENTLY_INACTIVE_STREAM_BITRATE):this.streamIdToBitrateKbpsMap.set(e,a.NOT_SENDING_STREAM_BITRATE));this.logLocalStreamDescriptions()}logLocalStreamDescriptions(){let e="";for(let t of this._localStreamInfos)e+=`streamId=${t.streamId} maxBitrate=${t.maxBitrateKbps} disabledByUplink=${t.disabledByUplinkPolicy}
`;this.logger.debug(()=>e)}integrateIndexFrame(e){super.integrateIndexFrame(e);let t=new Set,i=new Set(this.streamIdToBitrateKbpsMap.keys());for(let e of this.currentIndex.sources)e.mediaType===n.SdkStreamMediaType.VIDEO&&(t.add(e.streamId),this.streamIdToBitrateKbpsMap.has(e.streamId)||this.streamIdToBitrateKbpsMap.set(e.streamId,a.UNSEEN_STREAM_BITRATE));for(let e of i)t.has(e)||this.streamIdToBitrateKbpsMap.delete(e)}integrateSubscribeAckFrame(e){if(super.integrateSubscribeAckFrame(e),!e.allocations||void 0===e.allocations)return;let t=0;for(let i of(this._sendRidToVideoStreamIdMap.clear(),e.allocations)){if(this._localStreamInfos.length<t+1){this.logger.info("simulcast: allocation has more than number of local streams");break}this._localStreamInfos[t].groupId=i.groupId,this._localStreamInfos[t].streamId=i.streamId,this.streamIdToBitrateKbpsMap.has(i.streamId)||this.streamIdToBitrateKbpsMap.set(i.streamId,a.UNSEEN_STREAM_BITRATE),this._sendRidToVideoStreamIdMap.set(this._localStreamInfos[t].rid,i.streamId),t++}}sendVideoStreamIdFromRid(e){let t=0;return this._sendRidToVideoStreamIdMap.has(e)&&(t=this._sendRidToVideoStreamIdMap.get(e)),t}}t.default=a,a.UNSEEN_STREAM_BITRATE=-2,a.RECENTLY_INACTIVE_STREAM_BITRATE=-1,a.NOT_SENDING_STREAM_BITRATE=0,a.BitratesMsgFrequencyMs=4e3},6876:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=i(289);class n{constructor(e,t,i,r,n){this.attendeeId="",this.groupId=0,this.streamId=0,this.ssrc=0,this.trackLabel="",this.maxBitrateKbps=0,this.avgBitrateKbps=0,this.maxFrameRate=0,this.width=0,this.height=0,this.timeEnabled=0,this.disabledByWebRTC=!1,this.disabledByUplinkPolicy=!1,this.rid="",this.attendeeId=e,this.groupId=t,this.streamId=i,this.maxBitrateKbps=r,this.avgBitrateKbps=n}clone(){let e=new n;return e.attendeeId=this.attendeeId,e.groupId=this.groupId,e.streamId=this.streamId,e.ssrc=this.ssrc,e.trackLabel=this.trackLabel,e.maxBitrateKbps=this.maxBitrateKbps,e.avgBitrateKbps=this.avgBitrateKbps,e.maxFrameRate=this.maxFrameRate,e.timeEnabled=this.timeEnabled,e.disabledByUplinkPolicy=this.disabledByUplinkPolicy,e.width=this.width,e.height=this.height,e}toStreamDescriptor(){let e=r.SdkStreamDescriptor.create();return e.mediaType=r.SdkStreamMediaType.VIDEO,e.trackLabel=this.trackLabel,e.attendeeId=this.attendeeId,e.streamId=this.streamId,e.groupId=this.groupId,e.framerate=this.maxFrameRate,e.maxBitrateKbps=this.disabledByUplinkPolicy?0:this.maxBitrateKbps,e.avgBitrateBps=this.avgBitrateKbps,e}totalPixels(){return this.width*this.height}}t.default=n},2447:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.observerQueue=new Set,this.element=null,this.resizeObserver=new ResizeObserver(e=>{for(let t of e){let{width:e,height:i}=t.contentRect;this.notifyObservers(e,i)}})}notifyObservers(e,t){for(let i of this.observerQueue)i.videoElementResolutionChanged(e,t)}registerObserver(e){this.observerQueue.add(e)}removeObserver(e){this.observerQueue.delete(e)}bindVideoElement(e){this.element!==e&&(this.element&&this.resizeObserver.unobserve(this.element),this.element=e,this.element&&this.resizeObserver.observe(this.element))}}t.default=i},3327:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(543)),o=r(i(214)),s=r(i(7804));class a{constructor(e,t,i,r,n){this.tileController=i,this.devicePixelRatioMonitor=r,this.resolutionMonitor=n,this.tileState=new s.default,this.tileState.tileId=e,this.tileState.localTile=t,this.devicePixelRatioMonitor.registerObserver(this)}static connectVideoStreamToVideoElement(e,t,i){let r=i&&"environment"!==e.getVideoTracks()[0].getSettings().facingMode?"rotateY(180deg)":"";if(a.setVideoElementFlag(t,"disablePictureInPicture",i),a.setVideoElementFlag(t,"disableRemotePlayback",i),t.style.transform!==r&&(t.style.transform=r),t.hasAttribute("controls")&&t.removeAttribute("controls"),t.hasAttribute("autoplay")||t.setAttribute("autoplay","true"),t.hasAttribute("playsinline")||t.setAttribute("playsinline","true"),t.hasAttribute("muted")||(t.setAttribute("muted","true"),t.muted=!0),t.srcObject!==e&&(t.srcObject=e,new n.default().requiresVideoPlayWorkaround()&&t.paused)){let e=t.play();void 0!==e&&e.catch(e=>{console.warn("Error playing video in Safari",e)}).then(()=>{console.debug("Video played successfully in Safari")})}}static disconnectVideoStreamFromVideoElement(e,t,i=!1){if(e){if(t)i||(e.srcObject=null,e.style.transform="");else{if(!e.srcObject)return;e.pause(),e.style.transform="",a.setVideoElementFlag(e,"disablePictureInPicture",!1),a.setVideoElementFlag(e,"disableRemotePlayback",!1),e.srcObject=null}}}destroy(){this.devicePixelRatioMonitor.removeObserver(this),this.tileState.boundVideoElement&&this.tileState.boundVideoElement.srcObject===this.tileState.boundVideoStream&&a.disconnectVideoStreamFromVideoElement(this.tileState.boundVideoElement,!1),this.tileState=new s.default}devicePixelRatioChanged(e){this.tileState.devicePixelRatio=e,this.sendTileStateUpdate()}id(){return this.tileState.tileId}state(){return this.tileState.clone()}stateRef(){return this.tileState}bindVideoStream(e,t,i,r,n,s,a,l){let d=!1;this.tileState.boundAttendeeId!==e&&(this.tileState.boundAttendeeId=e,new o.default(e).hasModality(o.default.MODALITY_CONTENT)&&(this.tileState.isContent=!0),d=!0),this.tileState.boundExternalUserId!==a&&(this.tileState.boundExternalUserId=a,d=!0),this.tileState.localTile!==t&&(this.tileState.localTile=t,d=!0),this.tileState.boundVideoStream!==i&&(this.tileState.boundVideoStream=i,d=!0),this.tileState.videoStreamContentWidth!==r&&(this.tileState.videoStreamContentWidth=r,d=!0),this.tileState.videoStreamContentHeight!==n&&(this.tileState.videoStreamContentHeight=n,d=!0),this.tileState.streamId!==s&&(this.tileState.streamId=s,d=!0),this.tileState.groupId!==l&&(this.tileState.groupId=l,d=!0),d&&this.sendTileStateUpdate()}bindVideoElement(e){var t;let i=!1;this.tileState.boundVideoElement!==e&&(this.tileState.boundVideoElement=e,null===(t=this.resolutionMonitor)||void 0===t||t.bindVideoElement(this.tileState.boundVideoElement),i=!0),null!==this.tileState.boundVideoElement?(this.tileState.videoElementCSSWidthPixels!==e.clientWidth&&(this.tileState.videoElementCSSWidthPixels=e.clientWidth,i=!0),this.tileState.videoElementCSSHeightPixels!==e.clientHeight&&(this.tileState.videoElementCSSHeightPixels=e.clientHeight,i=!0)):(this.tileState.videoElementCSSWidthPixels=null,this.tileState.videoElementCSSHeightPixels=null),i&&this.sendTileStateUpdate()}pause(){this.tileState.paused||(this.tileState.paused=!0,this.sendTileStateUpdate())}unpause(){this.tileState.paused&&(this.tileState.paused=!1,this.sendTileStateUpdate())}markPoorConnection(){return!this.tileState.poorConnection&&(this.tileState.poorConnection=!0,this.sendTileStateUpdate(),!0)}unmarkPoorConnection(){return!!this.tileState.poorConnection&&(this.tileState.poorConnection=!1,this.sendTileStateUpdate(),!0)}capture(){if(!this.tileState.active)return null;let e=document.createElement("canvas"),t=this.tileState.boundVideoElement;e.width=t.videoWidth||t.width,e.height=t.videoHeight||t.height;let i=e.getContext("2d");return i.drawImage(t,0,0,e.width,e.height),i.getImageData(0,0,e.width,e.height)}setStreamId(e){this.tileState.streamId=e,this.tileController.sendTileStateUpdate(this.state())}sendTileStateUpdate(){this.updateActiveState(),this.updateVideoStreamOnVideoElement(),this.updateVideoElementPhysicalPixels(),this.tileController.sendTileStateUpdate(this.state())}updateActiveState(){this.tileState.active=!!(!this.tileState.paused&&!this.tileState.poorConnection&&this.tileState.boundAttendeeId&&this.tileState.boundVideoElement&&this.tileState.boundVideoStream)}updateVideoElementPhysicalPixels(){"number"==typeof this.tileState.videoElementCSSWidthPixels&&"number"==typeof this.tileState.videoElementCSSHeightPixels?(this.tileState.videoElementPhysicalWidthPixels=this.tileState.devicePixelRatio*this.tileState.videoElementCSSWidthPixels,this.tileState.videoElementPhysicalHeightPixels=this.tileState.devicePixelRatio*this.tileState.videoElementCSSHeightPixels):(this.tileState.videoElementPhysicalWidthPixels=null,this.tileState.videoElementPhysicalHeightPixels=null)}updateVideoStreamOnVideoElement(){this.tileState.active?a.connectVideoStreamToVideoElement(this.tileState.boundVideoStream,this.tileState.boundVideoElement,this.tileState.localTile):a.disconnectVideoStreamFromVideoElement(this.tileState.boundVideoElement,this.tileState.paused,this.tileController.keepLastFrameWhenPaused)}static setVideoElementFlag(e,t,i){t in e&&(e[t]=i)}}t.default=a},7804:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.tileId=null,this.localTile=!1,this.localTileStarted=!1,this.isContent=!1,this.active=!1,this.paused=!1,this.poorConnection=!1,this.boundAttendeeId=null,this.boundExternalUserId=null,this.boundVideoStream=null,this.boundVideoElement=null,this.nameplate=null,this.videoStreamContentWidth=null,this.videoStreamContentHeight=null,this.videoElementCSSWidthPixels=null,this.videoElementCSSHeightPixels=null,this.devicePixelRatio=0,this.videoElementPhysicalWidthPixels=null,this.videoElementPhysicalHeightPixels=null,this.streamId=null,this.groupId=null}clone(){let e=new i;return e.tileId=this.tileId,e.localTile=this.localTile,e.isContent=this.isContent,e.active=this.active,e.paused=this.paused,e.poorConnection=this.poorConnection,e.boundAttendeeId=this.boundAttendeeId,e.boundExternalUserId=this.boundExternalUserId,e.boundVideoStream=this.boundVideoStream,e.boundVideoElement=this.boundVideoElement,e.nameplate=this.nameplate,e.videoStreamContentWidth=this.videoStreamContentWidth,e.videoStreamContentHeight=this.videoStreamContentHeight,e.videoElementCSSWidthPixels=this.videoElementCSSWidthPixels,e.videoElementCSSHeightPixels=this.videoElementCSSHeightPixels,e.devicePixelRatio=this.devicePixelRatio,e.videoElementPhysicalWidthPixels=this.videoElementPhysicalWidthPixels,e.videoElementPhysicalHeightPixels=this.videoElementPhysicalHeightPixels,e.streamId=this.streamId,e.groupId=this.groupId,e}}t.default=i},2958:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(4500)),s=n(i(8236)),a=n(i(9190)),l=i(8660),d=n(i(2447)),c=n(i(3327));class u{constructor(e,t,i){this.tileFactory=e,this.audioVideoController=t,this.logger=i,this.tileMap=new Map,this.nextTileId=1,this.currentLocalTile=null,this.currentPausedTilesByIds=new Set,this.resolutionObservers=new Set,this.keepLastFrameWhenPaused=!1,this.keepLastFrameWhenPaused=t.configuration.keepLastFrameWhenPaused}createDevicePixelRatioMonitorIfNeeded(){this.devicePixelRatioMonitor||(this.devicePixelRatioMonitor=new s.default(new a.default,this.logger))}discardDevicePixelRatioMonitorIfNotNeeded(){return r(this,void 0,void 0,function*(){if(this.tileMap.size||!this.devicePixelRatioMonitor)return;let e=this.devicePixelRatioMonitor;return this.devicePixelRatioMonitor=void 0,e.destroy()})}bindVideoElement(e,t){let i=this.getVideoTile(e);if(null===i){this.logger.warn(`Ignoring video element binding for unknown tile id ${e}`);return}i.bindVideoElement(t)}unbindVideoElement(e,t=!0){let i=this.getVideoTile(e);if(null===i){this.logger.warn(`Ignoring video element unbinding for unknown tile id ${e}`);return}this.logger.info("Unbinding the video element"),this.notifyRemoteObserversOfUnbound(i.state().boundAttendeeId);let r=i.stateRef().boundVideoElement;i.bindVideoElement(null),t&&(this.logger.info("Cleaning up the video element"),c.default.disconnectVideoStreamFromVideoElement(r,!1))}startLocalVideoTile(){if(this.audioVideoController.configuration.meetingFeatures.videoMaxResolution===o.default.VideoDisabled)return this.logger.warn("Could not start camera video because max video resolution was set to None"),-1;let e=this.findOrCreateLocalVideoTile();return this.currentLocalTile.stateRef().localTileStarted=!0,this.audioVideoController.update({needsRenegotiation:!0}),e.id()}stopLocalVideoTile(){this.currentLocalTile&&(this.currentLocalTile.stateRef().localTileStarted=!1,this.currentLocalTile.bindVideoStream(this.audioVideoController.configuration.credentials.attendeeId,!0,null,null,null,null,this.audioVideoController.configuration.credentials.externalUserId),this.audioVideoController.update({needsRenegotiation:!0}))}hasStartedLocalVideoTile(){return!!(this.currentLocalTile&&this.currentLocalTile.stateRef().localTileStarted)}removeLocalVideoTile(){this.currentLocalTile&&this.removeVideoTile(this.currentLocalTile.id())}getLocalVideoTile(){return this.currentLocalTile}pauseVideoTile(e){let t=this.getVideoTile(e);t&&(this.currentPausedTilesByIds.has(e)||(this.audioVideoController.pauseReceivingStream(t.stateRef().streamId),this.currentPausedTilesByIds.add(e)),t.pause())}unpauseVideoTile(e){let t=this.getVideoTile(e);t&&(this.currentPausedTilesByIds.has(e)&&(this.audioVideoController.resumeReceivingStream(t.stateRef().streamId),this.currentPausedTilesByIds.delete(e)),t.unpause())}getVideoTile(e){return this.tileMap.has(e)?this.tileMap.get(e):null}getVideoTileArea(e){let t=e.state(),i=0,r=0;return t.boundVideoElement&&(i=t.boundVideoElement.clientHeight*t.devicePixelRatio,r=t.boundVideoElement.clientWidth*t.devicePixelRatio),i*r}getAllRemoteVideoTiles(){let e=[];return this.tileMap.forEach((t,i)=>{this.currentLocalTile&&i===this.currentLocalTile.id()||e.push(t)}),e}getAllVideoTiles(){return Array.from(this.tileMap.values())}addVideoTile(e=!1){let t=this.nextTileId;this.nextTileId+=1,this.createDevicePixelRatioMonitorIfNeeded();let i=this.tileFactory.makeTile(t,e,this,this.devicePixelRatioMonitor,this.createResolutionMonitor(t));return this.tileMap.set(t,i),i}removeVideoTile(e){if(!this.tileMap.has(e))return;let t=this.tileMap.get(e);this.currentLocalTile===t&&(this.currentLocalTile=null),t.destroy(),this.tileMap.delete(e),this.audioVideoController.forEachObserver(t=>{l.Maybe.of(t.videoTileWasRemoved).map(i=>i.bind(t)(e))}),this.discardDevicePixelRatioMonitorIfNotNeeded()}removeVideoTilesByAttendeeId(e){let t=[];for(let i of this.getAllVideoTiles()){let r=i.state();r.boundAttendeeId===e&&(this.removeVideoTile(r.tileId),t.push(r.tileId))}return t}removeAllVideoTiles(){for(let e of Array.from(this.tileMap.keys()))this.removeVideoTile(e)}sendTileStateUpdate(e){this.audioVideoController.forEachObserver(t=>{l.Maybe.of(t.videoTileDidUpdate).map(i=>i.bind(t)(e))})}haveVideoTilesWithStreams(){for(let e of this.getAllVideoTiles())if(e.state().boundVideoStream)return!0;return!1}haveVideoTileForAttendeeId(e){return!!this.getVideoTileForAttendeeId(e)}getVideoTileForAttendeeId(e){for(let t of this.getAllVideoTiles())if(t.state().boundAttendeeId===e)return t}captureVideoTile(e){let t=this.getVideoTile(e);return t?t.capture():null}registerVideoTileResolutionObserver(e){this.resolutionObservers.add(e)}removeVideoTileResolutionObserver(e){this.resolutionObservers.delete(e)}notifyResolutionObserversOfChange(e,t,i){for(let r of this.resolutionObservers)r.videoTileResolutionDidChange(e,t,i)}notifyRemoteObserversOfUnbound(e){for(let t of this.resolutionObservers)t.videoTileUnbound(e)}createResolutionMonitor(e){let t=new class{constructor(e,t){this.controller=e,this.tileId=t}videoElementResolutionChanged(e,t){let i=this.controller.getVideoTile(this.tileId);if(i){let r=i.state().boundAttendeeId;this.controller.notifyResolutionObserversOfChange(r,e,t)}}}(this,e),i=new d.default;return i.registerObserver(t),i}findOrCreateLocalVideoTile(){return this.currentLocalTile||(this.currentLocalTile=this.addVideoTile(!0),this.currentLocalTile.bindVideoStream(this.audioVideoController.configuration.credentials.attendeeId,!0,null,null,null,null,this.audioVideoController.configuration.credentials.externalUserId)),this.currentLocalTile}}t.default=u},4922:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(3327));class o{makeTile(e,t,i,r,o){return new n.default(e,t,i,r,o)}}t.default=o},9394:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}t.default=i},4450:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(7606)),o=r(i(5785)),s=i(8660),a=r(i(1133)),l=r(i(9394));class d{constructor(e,t){this.selfAttendeeId=e,this.logger=t,this.numSenders=0,this.shouldDisableSimulcast=!1,this.newQualityMap=new Map,this.currentQualityMap=new Map,this.newActiveStreams=1,this.videoIndex=null,this.observerQueue=new Set,this.hiTargetBitrateKbps=d.kHiTargetBitrateKbpsHd,this.midTargetBitrateKbps=d.kMidTargetBitrateKbpsHd,this.lowTargetBitrateKbps=d.kLowTargetBitrateKbpsHd,this.enableFhdVideo=!1,this.optimalParameters=new a.default(0,0,0,0,!0),this.parametersInEffect=new a.default(0,0,0,0,!0),this.currentQualityMap=this.fillEncodingParamWithBitrates([this.lowTargetBitrateKbps,0,this.hiTargetBitrateKbps]),this.newQualityMap=this.fillEncodingParamWithBitrates([this.lowTargetBitrateKbps,0,this.hiTargetBitrateKbps])}updateConnectionMetric(e){}calculateEncodingParameters(){let e=[new l.default,new l.default,new l.default];this.shouldDisableSimulcast?(this.newActiveStreams=0,e[0].maxBitrateKbps=0,e[1].maxBitrateKbps=this.hiTargetBitrateKbps,e[2].maxBitrateKbps=0):this.numSenders<=4?(this.newActiveStreams=1,e[0].maxBitrateKbps=this.lowTargetBitrateKbps,e[1].maxBitrateKbps=0,e[2].maxBitrateKbps=this.hiTargetBitrateKbps):(this.newActiveStreams=2,e[0].maxBitrateKbps=2*this.lowTargetBitrateKbps/3,e[1].maxBitrateKbps=this.numSenders<=6?this.midTargetBitrateKbps:.6*this.midTargetBitrateKbps,e[2].maxBitrateKbps=0);let t=e.map((e,t,i)=>e.maxBitrateKbps);return this.newQualityMap=this.fillEncodingParamWithBitrates(t),this.encodingParametersEqual()||this.logger.info(`simulcast: policy:calculateEncodingParameters numSources:${this.numSenders} shouldDisableSimulcast:${this.shouldDisableSimulcast} newQualityMap: ${this.getQualityMapString(this.newQualityMap)}`),this.newQualityMap}chooseMediaTrackConstraints(){}chooseEncodingParameters(){return this.currentQualityMap=this.newQualityMap,this.activeStreamsToPublish!==this.newActiveStreams&&(this.activeStreamsToPublish=this.newActiveStreams,this.publishEncodingSimulcastLayer()),this.currentQualityMap}updateIndex(e){let t=e.numberOfVideoPublishingParticipantsExcludingSelf(this.selfAttendeeId)+1,i=t!==this.numSenders,r=e.numberOfParticipants(),n=r>=0&&r<=2,o=this.shouldDisableSimulcast!==n;this.numSenders=t,this.shouldDisableSimulcast=n,this.optimalParameters=new a.default(this.captureWidth(),this.captureHeight(),this.captureFrameRate(),this.maxBandwidthKbps(),!1),this.videoIndex=e,(i||o)&&(this.newQualityMap=this.calculateEncodingParameters())}wantsResubscribe(){return!this.encodingParametersEqual()}compareEncodingParameter(e,t){return JSON.stringify(e)===JSON.stringify(t)}encodingParametersEqual(){let e=!1;for(let t of o.default.NAME_ARR_ASCENDING)if(e=e||!this.compareEncodingParameter(this.newQualityMap.get(t),this.currentQualityMap.get(t)))break;return!e}chooseCaptureAndEncodeParameters(){return this.parametersInEffect=this.optimalParameters.clone(),this.parametersInEffect.clone()}captureWidth(){return this.enableFhdVideo?1920:1280}captureHeight(){return this.enableFhdVideo?1080:768}captureFrameRate(){return 15}maxBandwidthKbps(){return this.enableFhdVideo?2500:1400}setIdealMaxBandwidthKbps(e){}setHasBandwidthPriority(e){}setHighResolutionFeatureEnabled(e){this.enableFhdVideo=e,this.hiTargetBitrateKbps=e?d.kHiTargetBitrateKbpsFhd:d.kHiTargetBitrateKbpsHd,this.midTargetBitrateKbps=e?d.kMidTargetBitrateKbpsFhd:d.kMidTargetBitrateKbpsHd,this.lowTargetBitrateKbps=e?d.kLowTargetBitrateKbpsFhd:d.kLowTargetBitrateKbpsHd}wantsVideoDependencyDescriptorRtpHeaderExtension(){return!0}fillEncodingParamWithBitrates(e){let t=new Map,i=1e3,r=o.default.NAME_ARR_ASCENDING,n=e,s=this.shouldDisableSimulcast?1:4;for(let e=0;e<r.length;e++){let o=r[e];t.set(o,{rid:o,active:n[e]>0,scaleResolutionDownBy:Math.max(s,1),maxBitrate:n[e]*i}),s/=2}return t}getQualityMapString(e){let t="";return 3===this.videoIndex.localStreamDescriptions().length&&e.forEach(e=>{t+=`{ rid: ${e.rid} active:${e.active} maxBitrate:${e.maxBitrate}}`}),t}getEncodingSimulcastLayer(e){switch(e){case 0:return n.default.High;case 1:return n.default.LowAndHigh;case 2:return n.default.LowAndMedium}}publishEncodingSimulcastLayer(){let e=this.getEncodingSimulcastLayer(this.activeStreamsToPublish);this.forEachObserver(t=>{s.Maybe.of(t.encodingSimulcastLayersDidChange).map(i=>i.bind(t)(e))})}addObserver(e){this.logger.info("adding simulcast uplink observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing simulcast uplink observer"),this.observerQueue.delete(e)}forEachObserver(e){for(let t of this.observerQueue)e(t)}}t.default=d,d.kHiTargetBitrateKbpsHd=1200,d.kMidTargetBitrateKbpsHd=600,d.kLowTargetBitrateKbpsHd=300,d.kHiTargetBitrateKbpsFhd=2e3,d.kMidTargetBitrateKbpsFhd=1e3,d.kLowTargetBitrateKbpsFhd=500},3879:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(7377));class o{constructor(e,t){this.encodingParams=t,this.enableUhdContent=!1,this.defaultHiTargetBitrateKbps=1200,this.defaultLowTargetBitrateKbps=300}updateConnectionMetric(e){}chooseMediaTrackConstraints(){}chooseEncodingParameters(){var e,t,i,r,o,s,a,l,d,c,u,h;let f=new Map,p=1e3,m=n.default.NAME_ARR_ASCENDING;return f.set(m[0],{rid:m[0],active:!0,scaleResolutionDownBy:(null===(t=null===(e=this.encodingParams)||void 0===e?void 0:e.low)||void 0===t?void 0:t.scaleResolutionDownBy)||2,maxBitrate:((null===(r=null===(i=this.encodingParams)||void 0===i?void 0:i.low)||void 0===r?void 0:r.maxBitrateKbps)||this.defaultLowTargetBitrateKbps)*p,maxFramerate:(null===(s=null===(o=this.encodingParams)||void 0===o?void 0:o.low)||void 0===s?void 0:s.maxFramerate)||5}),f.set(m[1],{rid:m[1],active:!0,scaleResolutionDownBy:(null===(l=null===(a=this.encodingParams)||void 0===a?void 0:a.high)||void 0===l?void 0:l.scaleResolutionDownBy)||1,maxBitrate:((null===(c=null===(d=this.encodingParams)||void 0===d?void 0:d.high)||void 0===c?void 0:c.maxBitrateKbps)||this.defaultHiTargetBitrateKbps)*p,maxFramerate:null===(h=null===(u=this.encodingParams)||void 0===u?void 0:u.high)||void 0===h?void 0:h.maxFramerate}),f}updateIndex(e){}wantsResubscribe(){return!1}chooseCaptureAndEncodeParameters(){}maxBandwidthKbps(){return this.enableUhdContent?2e3:1200}setIdealMaxBandwidthKbps(e){}setHasBandwidthPriority(e){}setHighResolutionFeatureEnabled(e){this.enableUhdContent=e,this.defaultHiTargetBitrateKbps=e?2e3:1200,this.defaultLowTargetBitrateKbps=e?500:300}addObserver(e){}removeObserver(e){}forEachObserver(e){}}t.default=o},4442:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(1133));class s{constructor(e,t=!0,i,r){this.selfAttendeeId=e,this.scaleResolution=t,this.logger=i,this.browserBehavior=r,this.numberOfPublishedVideoSources=void 0,this.idealMaxBandwidthKbps=1500,this.hasBandwidthPriority=!1,this.encodingParamMap=new Map,this.enableHighResolutionFeature=!1,this.enableSVC=!1,this.isUsingSVCCodec=!0,this.numParticipants=0,this.reset()}reset(){this.numberOfPublishedVideoSources=void 0,this.optimalParameters=new o.default(0,0,0,0,!1),this.parametersInEffect=new o.default(0,0,0,0,!1),this.encodingParamMap.set(s.encodingMapKey,{maxBitrate:0})}updateConnectionMetric(e){}chooseMediaTrackConstraints(){return{}}chooseEncodingParameters(){return new Map}updateIndex(e){var t;let i=!0;this.transceiverController&&(i=this.transceiverController.hasVideoInput());let r=e.numberOfVideoPublishingParticipantsExcludingSelf(this.selfAttendeeId)+(i?1:0),n=e.numberOfParticipants();if(this.numParticipants===n&&this.numberOfPublishedVideoSources===r){null===(t=this.logger)||void 0===t||t.debug("Skipping update index; Number of participants has not changed");return}this.numberOfPublishedVideoSources=r,this.numParticipants=n,this.updateOptimalParameters()}wantsResubscribe(){return!this.parametersInEffect.equal(this.optimalParameters)}chooseCaptureAndEncodeParameters(){return this.parametersInEffect=this.optimalParameters.clone(),this.parametersInEffect.clone()}updateOptimalParameters(){let e=1;if(this.transceiverController){let t=this.getStreamCaptureSetting();t&&(e=this.calculateEncodingParameters(t).scaleResolutionDownBy)}this.optimalParameters=new o.default(this.captureWidth(),this.captureHeight(),this.captureFrameRate(),this.maxBandwidthKbps(),!1,e,this.enableSVC&&this.numParticipants>2&&this.isUsingSVCCodec)}captureWidth(){let e=640;return this.getNumberOfPublishedVideoSources()>4&&(e=320),e}captureHeight(){let e=384;return this.getNumberOfPublishedVideoSources()>4&&(e=192),e}captureFrameRate(){return 15}maxBandwidthKbps(){if(this.hasBandwidthPriority)return Math.trunc(this.idealMaxBandwidthKbps);let e=0;return Math.trunc(e=2>=this.getNumberOfPublishedVideoSources()?this.idealMaxBandwidthKbps:4>=this.getNumberOfPublishedVideoSources()?2*this.idealMaxBandwidthKbps/3:(544/11+14880/(11*this.getNumberOfPublishedVideoSources()))/600*this.idealMaxBandwidthKbps)}setIdealMaxBandwidthKbps(e){this.idealMaxBandwidthKbps=e}setHasBandwidthPriority(e){this.hasBandwidthPriority=e}setTransceiverController(e){this.transceiverController=e}setSVCEnabled(e){var t;this.enableSVC=e,null===(t=this.logger)||void 0===t||t.info(`setSVCEnabled, enable: ${e}}`)}setHighResolutionFeatureEnabled(e){this.enableHighResolutionFeature=e}updateTransceiverController(){return r(this,void 0,void 0,function*(){let e=this.getStreamCaptureSetting();if(!e)return;let t=this.calculateEncodingParameters(e);this.shouldUpdateEndcodingParameters(t)&&(this.encodingParamMap.set(s.encodingMapKey,t),this.transceiverController.setEncodingParameters(this.encodingParamMap))})}shouldUpdateEndcodingParameters(e){var t,i;let r=null===(i=null===(t=this.transceiverController.localVideoTransceiver().sender.getParameters())||void 0===t?void 0:t.encodings)||void 0===i?void 0:i[0];return e.maxBitrate!==(null==r?void 0:r.maxBitrate)||e.scaleResolutionDownBy!==(null==r?void 0:r.scaleResolutionDownBy)||(null==e?void 0:e.scalabilityMode)!==(null==r?void 0:r.scalabilityMode)}calculateEncodingParameters(e){var t,i,r;let n=1e3*this.maxBandwidthKbps(),o=1,a=720;if(void 0!==e.height&&void 0!==e.width&&this.scaleResolution&&!this.hasBandwidthPriority&&this.getNumberOfPublishedVideoSources()>2&&(480===(a=s.targetHeightArray[Math.min(this.getNumberOfPublishedVideoSources(),s.targetHeightArray.length-1)][this.enableHighResolutionFeature?1:0])&&(null===(t=this.browserBehavior)||void 0===t?void 0:t.disable480pResolutionScaleDown())&&(a=360),o=Math.max(Math.min(e.height,e.width)/a,1),null===(i=this.logger)||void 0===i||i.info(`Resolution scale factor is ${o} for capture resolution ${e.width}x${e.height}. New dimension is ${e.width/o}x${e.height/o}`)),!this.enableSVC)return{scaleResolutionDownBy:o,maxBitrate:n};{let e;return e=this.numParticipants>=0&&this.numParticipants<3||!this.isUsingSVCCodec?"L1T1":"L3T3",null===(r=this.logger)||void 0===r||r.info(`calculateEncodingParameters: SVC: ${this.enableSVC}    participants: ${this.numParticipants}     publishers: ${this.getNumberOfPublishedVideoSources()}     bitrate: ${n}  targetHeight: ${a}  scalabilityMode: ${e}   isUsingSVCCodec: ${this.isUsingSVCCodec}`),{scaleResolutionDownBy:o,maxBitrate:n,scalabilityMode:e}}}getStreamCaptureSetting(){var e,t,i,r;return null===(r=null===(i=null===(t=null===(e=this.transceiverController)||void 0===e?void 0:e.localVideoTransceiver())||void 0===t?void 0:t.sender)||void 0===i?void 0:i.track)||void 0===r?void 0:r.getSettings()}getNumberOfPublishedVideoSources(){var e;return null!==(e=this.numberOfPublishedVideoSources)&&void 0!==e?e:0}wantsVideoDependencyDescriptorRtpHeaderExtension(){return this.enableSVC}setMeetingSupportedVideoSendCodecs(e,t){let i=null!=e?e:t,r=i.length>0&&s.SVCCodecNames.includes(i[0].codecName);r!==this.isUsingSVCCodec&&(this.isUsingSVCCodec=r,this.updateOptimalParameters())}}t.default=s,s.encodingMapKey="video",s.targetHeightArray=[[0,0],[0,0],[0,0],[540,720],[540,720],[480,540],[480,540],[480,540],[480,540],[360,480],[360,480],[360,480],[360,480],[270,360],[270,360],[270,360],[270,360],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270],[180,270]],s.SVCCodecNames=["VP9"]},657:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(1133));class o{constructor(){}updateConnectionMetric(e){}chooseMediaTrackConstraints(){return{}}chooseEncodingParameters(){return new Map}updateIndex(e){}wantsResubscribe(){return!1}chooseCaptureAndEncodeParameters(){return new n.default(0,0,0,0,!1)}maxBandwidthKbps(){return 0}setIdealMaxBandwidthKbps(e){}setHasBandwidthPriority(e){}setHighResolutionFeatureEnabled(e){}wantsVideoDependencyDescriptorRtpHeaderExtension(){return!1}}t.default=o},3928:function(e,t){"use strict";function i(e){return e.map(e=>"object"==typeof e?JSON.stringify(e):`${e}`).join(" ")}Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.base=e}debug(...e){this.base.debug(i(e))}info(...e){this.base.info(i(e))}warn(...e){this.base.warn(i(e))}error(...e){this.base.error(i(e))}}t.default=r},2497:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceFocusDeviceTransformer=void 0;let o=i(6035),s=i(8690),a=n(i(4046)),l=n(i(3928)),d=n(i(8878)),c=n(i(851));class u{constructor(e,{preload:t=!0,logger:i,fetchBehavior:r=u.defaultFetchBehavior()},n){this.spec=e,this.supported=!0,this.logger=i,this.vfLogger=i?new l.default(i):void 0,this.preload=t,this.fetchBehavior=r,this.spec=u.augmentSpec(this.spec),n&&(this.configuration=Promise.resolve(n))}static isSupported(e,t){var i,r;let n={fetchBehavior:u.defaultFetchBehavior(),logger:(null==t?void 0:t.logger)?new l.default(t.logger):void 0};if(s.isIFramed()){if((null==t?void 0:t.allowIFrame)===!1)return null===(i=null==t?void 0:t.logger)||void 0===i||i.error("Amazon Voice Focus support check inside iframe: not supported."),Promise.resolve(!1);null===(r=null==t?void 0:t.logger)||void 0===r||r.warn("Amazon Voice Focus support check inside iframe: not recommended.")}return o.VoiceFocus.isSupported(u.augmentSpec(e),n)}static create(e={},t={},i,n,o){var s,a,l;return r(this,void 0,void 0,function*(){n&&n.Meeting.Meeting&&(n=n.Meeting);let r=(null===(l=null===(a=null===(s=null==n?void 0:n.Meeting)||void 0===s?void 0:s.MeetingFeatures)||void 0===a?void 0:a.Audio)||void 0===l?void 0:l.EchoReduction)==="AVAILABLE",o=i&&!0===i.supported&&"ns_es"===i.model.name&&!r,d="ns_es"===e.name&&!r;if(o||d)throw Error("Echo Reduction requested but not enabled.");let c=new u(e,t,i);return yield c.init(),c})}static configure(e={},t={}){return r(this,void 0,void 0,function*(){return new u(e,t,void 0).configure(!0)})}getConfiguration(){return this.configuration}isSupported(){return this.supported}createTransformDevice(e,t){return r(this,void 0,void 0,function*(){if(this.supported)try{let i=!0,[r,n]=yield this.allocateVoiceFocus(i),o=Object.assign(Object.assign({},t),{es:"ns_es"===this.spec.name});return new d.default(e,r,n,o)}catch(e){return}})}static destroyVoiceFocus(e){var t;return r(this,void 0,void 0,function*(){null===(t=null==e?void 0:e.vf)||void 0===t||t.destroy()})}static augmentSpec(e){return e&&(e.assetGroup||e.revisionID)?e:Object.assign(Object.assign({},e),{assetGroup:u.currentSDKAssetGroup()})}configure(e=!1){return r(this,void 0,void 0,function*(){let t={fetchBehavior:this.fetchBehavior,preResolve:e,logger:this.vfLogger};return o.VoiceFocus.configure(this.spec,t)})}init(){var e;return r(this,void 0,void 0,function*(){this.configuration||(this.configuration=this.configure());let t=yield this.configuration;if(!t.supported){this.supported=!1;return}this.pendingVoiceFocus=this.createVoiceFocus(t,this.preload);try{yield this.pendingVoiceFocus}catch(t){null===(e=this.logger)||void 0===e||e.error(`Unable to initialize Amazon Voice Focus: ${t}`),this.supported=!1}})}createVoiceFocus(e,t){return r(this,void 0,void 0,function*(){let i=new c.default;return this.vf=yield o.VoiceFocus.init(e,{delegate:i,preload:t,logger:this.vfLogger}),[this.vf,i]})}allocateVoiceFocus(e){return r(this,void 0,void 0,function*(){if(!this.supported)throw Error("Not supported.");if(this.pendingVoiceFocus){let e=this.pendingVoiceFocus;return this.pendingVoiceFocus=void 0,e}return this.createVoiceFocus((yield this.configuration),e)})}static majorVersion(){return a.default.sdkVersion.match(/^[1-9][0-9]*\.(?:0|[1-9][0-9]*)/)[0]}static majorMinorVersion(){return a.default.sdkVersion.match(/^[1-9][0-9]*\.(?:0|(?:[1-9][0-9]*))\.(?:0|[1-9][0-9]*)/)[0]}static currentSDKAssetGroup(){let e=this.majorVersion();return e?`sdk-${e}`:"stable-v1"}static defaultFetchBehavior(){let e=u.majorMinorVersion()||"unknown",t=a.default.sdkUserAgentLowResolution;return{escapedQueryString:`sdk=${encodeURIComponent(e)}&ua=${encodeURIComponent(t)}`}}}t.VoiceFocusDeviceTransformer=u,t.default=u},8878:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(i(543));class s{constructor(e,t,i,r,n=!1,s,a=new o.default,l=new Map,d,c){this.device=e,this.voiceFocus=t,this.delegate=i,this.nodeOptions=r,this.failed=n,this.node=s,this.browserBehavior=a,this.farEndStreamToAudioSourceNode=l,this.mixDestNode=d,this.mixSourceNode=c}getInnerDevice(){return this.device}mute(e){return r(this,void 0,void 0,function*(){this.node&&(e?yield this.node.disable():yield this.node.enable())})}stop(){return r(this,void 0,void 0,function*(){this.node&&(this.node.disconnect(),yield this.node.stop())})}chooseNewInnerDevice(e){return r(this,void 0,void 0,function*(){return this.device!==e||a(e)?new s(e,this.voiceFocus,this.delegate,this.nodeOptions,this.failed,this.node,this.browserBehavior,this.farEndStreamToAudioSourceNode,this.mixDestNode,this.mixSourceNode):this})}intrinsicDevice(){return r(this,void 0,void 0,function*(){let e;if(this.failed)return this.device;let t=this.nodeOptions.es,i={echoCancellation:!t,googEchoCancellation:!t,googEchoCancellation2:!t,noiseSuppression:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googNoiseSuppression2:!1};return(e=!this.nodeOptions||void 0===this.nodeOptions.agc||this.nodeOptions.agc.useBuiltInAGC,i.autoGainControl=e,i.googAutoGainControl=e,i.googAutoGainControl2=e,this.device)?"string"==typeof this.device?(this.browserBehavior.requiresNoExactMediaStreamConstraints()?i.deviceId=this.device:i.deviceId={exact:this.device},i):this.device.id?this.device:Object.assign(Object.assign({},this.device),i):i})}createAudioNode(e){var t,i;return r(this,void 0,void 0,function*(){if((null===(t=this.node)||void 0===t?void 0:t.context)===e)return{start:this.node,end:this.node};let r=Object.assign({enabled:!0,agc:{useVoiceFocusAGC:!1}},this.nodeOptions);try{if(null===(i=this.node)||void 0===i||i.disconnect(),this.node=yield this.voiceFocus.createNode(e,r),this.nodeOptions.es){for(let t of(this.mixDestNode=new MediaStreamAudioDestinationNode(e,{channelCount:1,channelCountMode:"explicit"}),this.farEndStreamToAudioSourceNode.keys()))this.assignFarEndStreamToAudioSourceNode(t);this.createMixSourceNode()}let t=this.node,n=this.node;return{start:t,end:n}}catch(e){throw this.failed=!0,this.delegate.onFallback(this,e),e}})}observeMeetingAudio(e){return r(this,void 0,void 0,function*(){if(!this.nodeOptions.es)return;e.addAudioMixObserver(this);let t=yield e.getCurrentMeetingAudioStream();t&&this.addFarEndStream(t)})}unObserveMeetingAudio(e){return r(this,void 0,void 0,function*(){if(!this.nodeOptions.es)return;e.removeAudioMixObserver(this);let t=yield e.getCurrentMeetingAudioStream();t&&this.removeFarendStream(t)})}addObserver(e){this.delegate.addObserver(e)}removeObserver(e){this.delegate.removeObserver(e)}addFarEndStream(e){return r(this,void 0,void 0,function*(){!this.nodeOptions.es||!e||this.farEndStreamToAudioSourceNode.has(e)||(this.node?this.assignFarEndStreamToAudioSourceNode(e):this.farEndStreamToAudioSourceNode.set(e,null))})}removeFarendStream(e){var t;return r(this,void 0,void 0,function*(){null===(t=this.farEndStreamToAudioSourceNode.get(e))||void 0===t||t.disconnect(),this.farEndStreamToAudioSourceNode.delete(e)})}meetingAudioStreamBecameActive(e){return r(this,void 0,void 0,function*(){this.addFarEndStream(e)})}meetingAudioStreamBecameInactive(e){return r(this,void 0,void 0,function*(){this.removeFarendStream(e)})}assignFarEndStreamToAudioSourceNode(e){let t=this.node.context.createMediaStreamSource(e);t.channelCount=1,t.channelCountMode="explicit",this.farEndStreamToAudioSourceNode.set(e,t),t.connect(this.mixDestNode,0)}createMixSourceNode(){this.mixSourceNode=this.node.context.createMediaStreamSource(this.mixDestNode.stream),this.mixSourceNode.channelCount=1,this.mixSourceNode.channelCountMode="explicit",this.mixSourceNode.connect(this.node,0,1)}}function a(e){return"default"===e||!!e&&"object"==typeof e&&("deviceId"in e&&"default"===e.deviceId||"id"in e&&"default"===e.id)}t.default=s},851:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.observers=new Set}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}onFallback(e,t){var i;for(let r of this.observers)null===(i=r.voiceFocusFellBackToInnerStream)||void 0===i||i.call(r,e,t)}onCPUWarning(){var e;for(let t of this.observers)null===(e=t.voiceFocusInsufficientResources)||void 0===e||e.call(t)}}t.default=i},9751:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,i,r,n){this.logger=e,this.realtimeController=t,this.minVolumeDecibels=i,this.maxVolumeDecibels=r,this.selfAttendeeId=n,this.streamIdToAttendeeId={},this.streamIdToExternalUserId={},this.warnedAboutMissingStreamIdMapping={},this.attendeeIdToStreamId={},this.sessionReconnected=!1}onReconnect(){this.sessionReconnected=!0}sendRealtimeUpdatesForAudioStreamIdInfo(e){let t=0;for(let i of e.streams){let r=!!i.attendeeId,n=!!i.externalUserId,o=i.hasOwnProperty("muted"),s=!!i.dropped;if(r){this.attendeeIdToStreamId[i.attendeeId]&&this.attendeeIdToStreamId[i.attendeeId]<i.audioStreamId&&delete this.attendeeIdToStreamId[i.attendeeId],this.streamIdToAttendeeId[i.audioStreamId]=i.attendeeId;let r=n?i.externalUserId:i.attendeeId;this.streamIdToExternalUserId[i.audioStreamId]=r,this.attendeeIdToStreamId[i.attendeeId]=i.audioStreamId,this.realtimeController.realtimeSetAttendeeIdPresence(i.attendeeId,!0,r,!1,{attendeeIndex:t++,attendeesInFrame:e.streams.length})}if(o){let e=this.streamIdToAttendeeId[i.audioStreamId],t=this.streamIdToExternalUserId[i.audioStreamId];this.realtimeController.realtimeUpdateVolumeIndicator(e,null,i.muted,null,t)}if(!r&&!o){let r=this.streamIdToAttendeeId[i.audioStreamId];if(r){let n=this.streamIdToExternalUserId[i.audioStreamId];delete this.streamIdToAttendeeId[i.audioStreamId],delete this.streamIdToExternalUserId[i.audioStreamId],delete this.warnedAboutMissingStreamIdMapping[i.audioStreamId],this.attendeeIdToStreamId[r]===i.audioStreamId&&delete this.attendeeIdToStreamId[r];let o=!1;for(let e of Object.keys(this.streamIdToAttendeeId)){let t=parseInt(e);if(t>i.audioStreamId&&this.streamIdToAttendeeId[t]===r){o=!0;break}}o||this.realtimeController.realtimeSetAttendeeIdPresence(r,!1,n,s,{attendeeIndex:t++,attendeesInFrame:e.streams.length})}}}this.sessionReconnected&&(this.cleanUpState(e),this.sessionReconnected=!1)}cleanUpState(e){let t=Object.values(this.streamIdToAttendeeId),i=e.streams.map(e=>e.attendeeId);for(let[e,r]of t.filter(e=>!i.includes(e)).entries()){let t=this.attendeeIdToStreamId[r],i=this.streamIdToExternalUserId[t];if(delete this.streamIdToAttendeeId[t],delete this.streamIdToExternalUserId[t],delete this.warnedAboutMissingStreamIdMapping[t],delete this.attendeeIdToStreamId[r],r===this.selfAttendeeId){this.logger.warn("the volume indicator adapter cleans up the current attendee (presence = false) after reconnection");continue}this.realtimeController.realtimeSetAttendeeIdPresence(r,!1,i,!1,{attendeeIndex:e,attendeesInFrame:r.length})}}sendRealtimeUpdatesForAudioMetadata(e){let t=null,i=null;for(let r of e.attendeeStates){let e=this.attendeeIdForStreamId(r.audioStreamId);r.hasOwnProperty("volume")&&(null===t&&(t={}),null!==e&&(t[e]=this.normalizedVolume(r))),r.hasOwnProperty("signalStrength")&&(null===i&&(i={}),null!==e&&(i[e]=this.normalizedSignalStrength(r)))}this.applyRealtimeUpdatesForAudioMetadata(t,i)}normalizedVolume(e){return Math.min(Math.max(1-(-e.volume-this.maxVolumeDecibels)/(this.minVolumeDecibels-this.maxVolumeDecibels),0),1)}normalizedSignalStrength(e){return Math.min(Math.max(e.signalStrength/i.MAX_SIGNAL_STRENGTH_LEVELS,0),1)}applyRealtimeUpdatesForAudioMetadata(e,t){for(let r in this.streamIdToAttendeeId){let n=this.streamIdToAttendeeId[r],o=this.streamIdToExternalUserId[r],s=null,a=null;null!==e&&(s=e.hasOwnProperty(n)?e[n]:i.IMPLICIT_VOLUME),null!==t&&(a=t.hasOwnProperty(n)?t[n]:i.IMPLICIT_SIGNAL_STRENGTH),(null!==s||null!==a)&&this.realtimeController.realtimeUpdateVolumeIndicator(n,s,null,a,o)}}attendeeIdForStreamId(e){return 0===e?null:this.streamIdToAttendeeId[e]||(this.warnedAboutMissingStreamIdMapping[e]||(this.warnedAboutMissingStreamIdMapping[e]=!0,this.logger.warn(`volume indicator stream id ${e} seen before being defined`)),null)}}t.default=i,i.MAX_SIGNAL_STRENGTH_LEVELS=2,i.IMPLICIT_VOLUME=0,i.IMPLICIT_SIGNAL_STRENGTH=1},7631:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=r(i(4046)),o=r(i(7387));class s{constructor(e){this.logger=e}create(e,t,i){this.connection=new WebSocket(i?e:n.default.urlWithVersion(e),t),this.connection.binaryType="arraybuffer"}send(e){if(!this.connection)return this.logger.error("WebSocket not yet created or already destroyed."),!1;try{return e instanceof Uint8Array?this.connection.send(e.buffer):this.connection.send(e),!0}catch(e){return this.logger.debug(()=>`send error: ${e.message}, websocket state=${o.default[this.readyState()]}`),!1}}close(e,t){var i;null===(i=this.connection)||void 0===i||i.close(e,t)}destroy(){this.connection=void 0}addEventListener(e,t){if(!this.connection){this.logger.warn("Cannot add event listener with no WebSocket connection.");return}this.connection.addEventListener(e,t)}removeEventListener(e,t){var i;null===(i=this.connection)||void 0===i||i.removeEventListener(e,t)}readyState(){if(!this.connection)return o.default.None;switch(this.connection.readyState){case WebSocket.CONNECTING:return o.default.Connecting;case WebSocket.OPEN:return o.default.Open;case WebSocket.CLOSING:return o.default.Closing;case WebSocket.CLOSED:return o.default.Closed}}}t.default=s},7387:function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketReadyState=void 0,function(e){e[e.None=0]="None",e[e.Connecting=1]="Connecting",e[e.Open=2]="Open",e[e.Closing=3]="Closing",e[e.Closed=4]="Closed"}(i=t.WebSocketReadyState||(t.WebSocketReadyState={})),t.default=i},5995:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.decideModel=t.measureAndDecideExecutionApproach=void 0;let n=i(5021),o=i(9424),s=3,a=2.5,l=2.63,d=.6,c=.65,u=.5,h=.7,f={wasm:{noSupport:.07,inline:{c100:1,c50:.36,c20:.16,c10:.07},worker:{c100:.5,c50:.18,c20:.08,c10:.06}},simd:{noSupport:.1,inline:{c100:1,c50:.43,c20:.3,c10:.2},worker:{c100:.5,c50:.21,c20:.15,c10:.1}}};class p{constructor(e,t){this.fetchConfig=e,this.logger=t;let i=`${e.paths.workers}estimator-v1.js`;this.fetchBehavior={headers:e.headers,escapedQueryString:e.escapedQueryString},this.worker=(0,n.loadWorker)(i,"VoiceFocusEstimator",this.fetchBehavior,t)}roundtrip(e,t,i){return new Promise((r,n)=>{this.worker.then(n=>{let o;o=e=>{let{message:s,key:a}=e.data;s===t&&a===i&&(n.removeEventListener("message",o),r(e.data))},n.addEventListener("message",o),n.postMessage(e)}).catch(e=>{var t;null===(t=this.logger)||void 0===t||t.error("Failed to load worker.",e),n(e)})})}supportsSIMD(e){let t="simd",i=e||`${this.fetchConfig.paths.wasm}simd-v1.wasm`,r={message:"supports-simd",fetchBehavior:this.fetchBehavior,path:i,key:t};return this.roundtrip(r,"simd-support",t).then(e=>e.supports)}measure(e,t){let i=`${this.fetchConfig.paths.wasm}bench-v1.wasm`,r=`${this.fetchConfig.paths.wasm}bench-v1_simd.wasm`,n=e?r:i,o=`bench:${e}`,s={message:"measure",fetchBehavior:this.fetchBehavior,budget:t,path:n,key:o};return this.roundtrip(s,"measurement",o).then(e=>{if(e.measurement)return e.measurement;throw Error("Failed to measure.")})}stop(){this.worker.then(e=>{var t;null===(t=this.logger)||void 0===t||t.debug("Stopping estimator worker."),e.terminate()}).catch(e=>{})}}let m=(e,t)=>1===e?d:"quality"===t?c*e:u*e,g=({supportsSIMD:e,supportsSAB:t,duration:i,executionPreference:r="auto",simdPreference:n,variantPreference:d="auto",namePreference:c="default",usagePreference:u,executionQuantaPreference:p=s},g=f,v)=>{let b="force"===n||"disable"!==n&&e,y=-1!==i,S=y?(b?a:l)/i:0,w=b?g.simd:g.wasm,C=y?m(p,u)*S:0,k=y?h*S:0,T=c,I=e=>({supported:!1,reason:e});if(y){if(S<w.noSupport)return I(`Performance score ${S} worse than threshold ${w.noSupport}.`)}else if("auto"===r||"auto"===d)return I(`Missing explicit execution (${r}) or variant (${d}) preference, but no scoring performed.`);null==v||v.debug(`Bench duration ${i} yields inline score ${C} and worker score ${k}.`);let E=(e,t,i)=>({supported:!0,useSIMD:b,processor:e,executionApproach:t,variant:i,executionQuanta:"inline"===t?p:void 0,name:T}),A=(e,t,i)=>"auto"!==t?!y||e>i[t]?t:"failed":e>i.c100?"c100":e>i.c50?"c50":e>i.c20?"c20":e>i.c10?"c10":"failed",M=e=>{switch(e||"auto"){case"auto":{let e=M("inline"),t=M("worker");if(null==v||v.debug(`Reducing auto preference: ${JSON.stringify(e)} vs ${JSON.stringify(t)}`),!1===e.supported||!1===t.supported)return t;if(e.variant===t.variant||"c50"===e.variant)return e;return t}case"worker":if((0,o.supportsSharedArrayBuffer)(globalThis,window,v))return M("worker-sab");return M("worker-postMessage");case"inline":{let e=A(C,d,w.inline);if("failed"===e)return I(`Performance score ${C} not sufficient for inline use with variant preference ${d}.`);return E("voicefocus-inline-processor","inline",e)}case"worker-sab":{if(!t){let e="Requested worker-sab but no SharedArrayBuffer support.";return null==v||v.warn(e),{supported:!1,reason:e}}let e=A(k,d,w.worker);if("failed"===e)return I(`Performance score ${k} not sufficient for worker use with variant preference ${d}.`);return E("voicefocus-worker-sab-processor","worker-sab",e)}case"worker-postMessage":{let e=A(k,d,w.worker);if("failed"===e)return I(`Performance score ${k} not sufficient for worker use.`);if("ns_es"===T){let e="Requested echo suppression but postMessage executor does not support it.";return null==v||v.warn(e),{supported:!1,reason:e}}return E("voicefocus-worker-postMessage-processor","worker-postMessage",e)}}};return M(r)},v=(e,t,i,n)=>r(void 0,void 0,void 0,function*(){let r={supportsSIMD:e,supportsSAB:(0,o.supportsSharedArrayBuffer)(globalThis,window,i),duration:-1};if(e)return null==i||i.info("Supports SIMD: true (force)"),r;let s=!n,a=n||new p(t,i);try{let t=!(0,o.isOldChrome)(window,i)&&(yield a.supportsSIMD());return null==i||i.info(`Supports SIMD: ${t} (force: ${e})`),r.supportsSIMD=t,r}finally{s&&a.stop()}}),b=(e,t,i,n)=>r(void 0,void 0,void 0,function*(){let r=new p(t,n);try{let o=yield v(e,t,n,r);if(o.supportsSIMD)try{return o.duration=yield r.measure(!0,i),null==n||n.info("SIMD timing:",o.duration),o}catch(e){null==n||n.warn("Failed SIMD estimation; falling back to non-SIMD."),o.supportsSIMD=!1}return o.duration=yield r.measure(!1,i),null==n||n.info("No-SIMD timing:",o.duration),o}catch(e){throw null==n||n.error("Could not feature check.",e),e}finally{r.stop()}}),y=(e,t,i,n=f)=>r(void 0,void 0,void 0,function*(){let r,o=e.executionPreference,{usagePreference:s,variantPreference:a,namePreference:l,simdPreference:d,estimatorBudget:c,executionQuantaPreference:u}=e;"interactivity"===s&&"inline"!==o&&(null==i||i.debug(`Overriding execution preference ${o} to reflect interactivity preference.`),o="inline");let h="force"===d,f="auto"!==a,p="auto"!==o;try{r=f&&p?yield v(h,t,i):yield b(h,t,c,i)}catch(e){throw null==i||i.error("Could not load estimator.",e),Error("Could not load Voice Focus estimator.")}return g(Object.assign(Object.assign({},r),{simdPreference:d,executionPreference:o,variantPreference:a,namePreference:l,usagePreference:s,executionQuantaPreference:u}),n,i)});t.measureAndDecideExecutionApproach=y;let S=({category:e,name:t,variant:i,simd:r,url:n})=>`${e}-${t}-${i}-v1${r?"_simd":""}`;t.decideModel=S},623:function(e,t){"use strict";function i(e,t,i){return i?fetch(n(e,i),r(t,i)):fetch(e,t)}function r(e,t){return(null==t?void 0:t.headers)?e?Object.assign(Object.assign({},e),{headers:Object.assign(Object.assign({},e.headers||{}),t.headers)}):{headers:t.headers}:e}function n(e,t){if(!(null==t?void 0:t.escapedQueryString))return e;let i=-1!==e.lastIndexOf("?");return`${e}${i?"&":"?"}${t.escapedQueryString}`}function o(e,t){let i=Object.keys(t);if(!i.length)return e;let r=new URLSearchParams(null==e?void 0:e.escapedQueryString);for(let e of i)r.append(e,t[e]);return Object.assign(Object.assign({},e),{escapedQueryString:r.toString()})}Object.defineProperty(t,"__esModule",{value:!0}),t.isValidRevisionID=t.isValidAssetGroup=t.resolveURL=t.addQueryParams=t.withQueryString=t.withRequestHeaders=t.fetchWithBehavior=void 0,t.fetchWithBehavior=i,t.withRequestHeaders=r,t.withQueryString=n,t.addQueryParams=o;let s={method:"HEAD",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"origin"};function a(e,t){return i(e,s,t).then(t=>t.redirected?t.url:e)}function l(e){return!!e&&/^[-.a-zA-Z0-9]+$/.test(e)}function d(e){return!!e&&/^[123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ]{22}$/.test(e)}t.resolveURL=a,t.isValidAssetGroup=l,t.isValidRevisionID=d},5021:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadWorker=void 0;let r=i(623),n={method:"GET",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"},o=(e,t,i,o)=>{null==o||o.debug(`Loading ${t} worker from ${e}.`);let s=!1;try{s=self.origin===new URL(e).origin}catch(e){null==o||o.error("Could not compare origins.",e)}return s?Promise.resolve(new Worker((0,r.withQueryString)(e,i),{name:t})):(0,r.fetchWithBehavior)(e,n,i).then(e=>{if(e.ok)return e.blob().then(e=>new Worker(window.URL.createObjectURL(e)));throw Error("Fetch failed.")})};t.loadWorker=o},9424:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.isOldChrome=t.supportsWASMStreaming=t.supportsSharedArrayBuffer=t.supportsWASM=t.supportsAudioWorklet=t.supportsWorker=t.supportsVoiceFocusWorker=t.supportsWASMPostMessage=t.isSafari=void 0;let n=i(5021),o=(e=globalThis)=>!!e.navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)/),s=(e=globalThis)=>{let t=e.navigator.userAgent,i=t.match(/Safari\//),r=t.match(/Chrom(?:e|ium)\//);return!!(i&&!r)};t.isSafari=s;let a=(e=globalThis)=>!(0,t.isSafari)(e)&&(!o(e)||95>(m(e)||0));t.supportsWASMPostMessage=a;let l=(e=globalThis,i,o)=>r(void 0,void 0,void 0,function*(){if(!(0,t.supportsWorker)(e,o))return!1;let r=`${i.paths.workers}worker-v1.js`;try{let e=yield(0,n.loadWorker)(r,"VoiceFocusTestWorker",i,o);try{e.terminate()}catch(e){null==o||o.debug("Failed to terminate worker.",e)}return!0}catch(e){return null==o||o.info("Failed to fetch and instantiate test worker",e),!1}});t.supportsVoiceFocusWorker=l;let d=(e=globalThis,t)=>{try{return!!e.Worker}catch(e){return null==t||t.info("Does not support Worker",e),!1}};t.supportsWorker=d;let c=(e=globalThis,t)=>{try{return!!e.AudioWorklet&&!!e.AudioWorkletNode}catch(e){return null==t||t.info("Does not support Audio Worklet",e),!1}};t.supportsAudioWorklet=c;let u=(e=globalThis,t)=>{try{return!!e.WebAssembly&&(!!e.WebAssembly.compile||!!e.WebAssembly.compileStreaming)}catch(e){return null==t||t.info("Does not support WASM",e),!1}};t.supportsWASM=u;let h=(e=globalThis,t=globalThis,i)=>{try{return!!e.SharedArrayBuffer&&(!!t.chrome||!!e.crossOriginIsolated)}catch(e){return null==i||i.info("Does not support SharedArrayBuffer."),!1}};t.supportsSharedArrayBuffer=h;let f=(e=globalThis,t)=>{var i;try{return!!(null===(i=e.WebAssembly)||void 0===i?void 0:i.compileStreaming)}catch(e){return null==t||t.info("Does not support WASM streaming compilation",e),!1}};t.supportsWASMStreaming=f;let p=90,m=(e=globalThis)=>{try{if(!e.chrome)return}catch(e){}let t=e.navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)/);if(t)return parseInt(t[1],10)},g=(e=globalThis,t)=>{let i=m(e);return!!i&&i<p&&(null==t||t.debug(`Chrome ${i} has incomplete SIMD support.`),!0)};t.isOldChrome=g},103:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceFocusAudioWorkletNode=void 0;class i extends("undefined"!=typeof globalThis&&globalThis.AudioWorkletNode||class{}){}t.VoiceFocusAudioWorkletNode=i},6035:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.getAudioInput=t.createAudioContext=t.VoiceFocus=void 0;let n=i(5995),o=i(623),s=i(5021),a=i(9424),l=i(2633),d=i(1678),c=i(271),u={useVoiceFocusAGC:!1,useBuiltInAGC:!0},h="stable-v1",f="https://static.sdkassets.chime.aws",p={processors:`${f}/processors/`,workers:`${f}/workers/`,wasm:`${f}/wasm/`,models:`${f}/wasm/`},m={latencyHint:0},g={channelCount:1,echoCancellation:!0,googEchoCancellation:!0,noiseSuppression:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googTypingNoiseDetection:!1},v=Object.assign(Object.assign({},g),{autoGainControl:!0,googAutoGainControl:!0,googAutoGainControl2:!0}),b=Object.assign(Object.assign({},g),{autoGainControl:!1,googAutoGainControl:!1,googAutoGainControl2:!1}),y={"voicefocus-worker-sab-processor":{file:"worklet-worker-sab-processor-v1.js",node:d.default},"voicefocus-worker-postMessage-processor":{file:"worklet-worker-postMessage-processor-v1.js",node:c.default},"voicefocus-inline-processor":{file:"worklet-inline-processor-v1.js",node:l.default}},S=(e,t)=>{if(void 0!==e&&!(0,o.isValidAssetGroup)(e))throw Error(`Invalid asset group ${e}`);if(void 0!==t&&!(0,o.isValidRevisionID)(t))throw Error(`Invalid revision ID ${t}`)},w=(e,t)=>{let i;if(i=t.useBuiltInAGC?v:b,!e)return{audio:i};if(!e.audio)return e;if(e.video)throw Error("Not adding Voice Focus to multi-device getUserMedia call.");return Object.assign(Object.assign({},e),{audio:!0===e.audio?i:Object.assign(Object.assign({},e.audio),i)})},C=(e,t)=>`${t.models}${(0,n.decideModel)(e)}.wasm`;class k{constructor(e,t,i,r,n,o){this.processorURL=t,this.nodeConstructor=i,this.nodeOptions=r,this.executionQuanta=n,this.logger=o,this.internal={worker:e,isDestroyed:!1}}getModelMetrics(){var e;return null===(e=this.internal.voiceFocusNode)||void 0===e?void 0:e.getModelMetrics()}enable(){var e;null===(e=this.internal.voiceFocusNode)||void 0===e||e.enable()}disable(){var e;null===(e=this.internal.voiceFocusNode)||void 0===e||e.disable()}setMode(e){var t;null===(t=this.internal.voiceFocusNode)||void 0===t||t.setMode(e)}destroy(){var e,t,i,n,o;return r(this,void 0,void 0,function*(){let{worker:r,isDestroyed:s,voiceFocusNode:a,destinationNode:l,sourceNode:d,audioContext:c}=this.internal;if(s){null===(e=this.logger)||void 0===e||e.debug("Voice Focus is already destroyed");return}try{null==r||r.terminate(),null==d||d.disconnect(),null==l||l.disconnect(),yield Promise.all([null!==(t=null==c?void 0:c.close().catch(e=>e))&&void 0!==t?t:yield Promise.resolve(),null!==(i=null==a?void 0:a.stop().catch(e=>e))&&void 0!==i?i:yield Promise.resolve()]),this.internal.audioContext=void 0,this.internal.voiceFocusNode=void 0,this.internal.sourceNode=void 0,this.internal.destinationNode=void 0,null===(n=this.logger)||void 0===n||n.debug("Voice Focus destroyed successfully")}catch(e){throw null===(o=this.logger)||void 0===o||o.error("Error while destroying the Voice Focus instance: ",e),e}finally{this.internal.isDestroyed=!0}})}static isSupported(e,t){let{fetchBehavior:i,logger:r}=t||{};if("undefined"==typeof globalThis)return null==r||r.debug("Browser does not have globalThis."),Promise.resolve(!1);if(!(0,a.supportsAudioWorklet)(globalThis,r))return null==r||r.debug("Browser does not support Audio Worklet."),Promise.resolve(!1);if(!(0,a.supportsWASM)(globalThis,r))return null==r||r.debug("Browser does not support WASM."),Promise.resolve(!1);(0,a.supportsWASMStreaming)(globalThis,r)||null==r||r.debug("Browser does not support streaming WASM compilation.");let{assetGroup:n=h,revisionID:s,paths:l=p}=e||{};S(n,s);let d=s?{revisionID:s}:{assetGroup:n},c=Object.assign(Object.assign({},(0,o.addQueryParams)(i,d)),{paths:l});return(0,a.supportsVoiceFocusWorker)(globalThis,c,r)}static mungeExecutionPreference(e,t){let i=void 0===e||"auto"===e;if((0,a.isSafari)(globalThis)){if(i||"inline"===e)return"inline";if(!i)throw Error(`Unsupported execution preference ${e}`)}if("worker-sab"===e&&!(0,a.supportsSharedArrayBuffer)(globalThis,globalThis,t))throw Error(`Unsupported execution preference ${e}`);return e||"auto"}static configure(e,t){return r(this,void 0,void 0,function*(){let{fetchBehavior:i,preResolve:r,logger:s}=t||{},{category:a="voicefocus",name:l="default",variant:d="auto",assetGroup:c=h,revisionID:u,simd:f="detect",mode:m="ns",executionPreference:g="auto",executionQuantaPreference:v,usagePreference:b="interactivity",estimatorBudget:y=100,paths:w=p,thresholds:k}=e||{};if(null==s||s.debug("Configuring Voice Focus with spec",e),void 0!==a&&"voicefocus"!==a)throw Error(`Unrecognized category ${a}`);if(void 0!==l&&"default"!==l&&"ns_es"!==l)throw Error(`Unrecognized feature name ${l}`);if(void 0!==d&&!["auto","c100","c50","c20","c10"].includes(d))throw Error(`Unrecognized feature variant ${d}`);if(void 0!==v&&![1,2,3].includes(v))throw Error(`Unrecognized execution quanta preference ${v}`);if(S(c,u),void 0!==f&&!["detect","force","disable"].includes(f))throw Error(`Unrecognized SIMD option ${f}`);if(void 0!==g&&!["auto","inline","worker","worker-sab","worker-postMessage"].includes(g))throw Error(`Unrecognized execution preference ${g}`);if(void 0!==b&&!["quality","interactivity"].includes(b))throw Error(`Unrecognized usage preference ${b}`);let T={executionPreference:this.mungeExecutionPreference(g,s),usagePreference:b,executionQuantaPreference:v,variantPreference:d,namePreference:l,simdPreference:f,estimatorBudget:y},I=u?{revisionID:u}:{assetGroup:c},E=(0,o.addQueryParams)(i,I),A=Object.assign({paths:w},E),M=yield(0,n.measureAndDecideExecutionApproach)(T,A,s,k);if(!1===M.supported)return{supported:!1,reason:M.reason};null==s||s.info("Decided execution approach",M);let{useSIMD:O,processor:P,variant:_,executionQuanta:x}=M,R={category:a||"voicefocus",name:l||"default",mode:m,variant:_,simd:O};if(r){let e=C(R,w);R.url=yield(0,o.resolveURL)(e,E)}return{fetchConfig:A,model:R,processor:P,executionQuanta:x,supported:!0}})}static init(e,{delegate:t,preload:i=!0,logger:n}){return r(this,void 0,void 0,function*(){if(!1===e.supported)throw Error("Voice Focus not supported. Reason: "+e.reason);let{model:r,processor:o,fetchConfig:l,executionQuanta:d}=e,{simd:c,name:u,mode:h}=r,{paths:f}=l;if("voicefocus-inline-processor"!==o&&"voicefocus-worker-postMessage-processor"!==o&&"voicefocus-worker-sab-processor"!==o)throw Error(`Unknown processor ${o}`);let p=r.url||C(r,f);null==n||n.debug(`Using model URL ${p}.`);let m=`${f.wasm}audio_buffer-v1${c?"_simd":""}.wasm`,g=`${f.wasm}resampler-v1${c?"_simd":""}.wasm`,v=`${f.workers}worker-v1.js`,{file:b,node:S}=y[o],w=`${f.processors}${b}`,T=yield(0,s.loadWorker)(v,"VoiceFocusWorker",l,n);if(i){null==n||n.debug("Preloading",p);let e=(0,a.supportsWASMPostMessage)(globalThis)?"get-module":"get-module-buffer";T.postMessage({message:e,preload:!0,key:"model",fetchBehavior:l,path:p})}let I={processor:o,worker:T,audioBufferURL:m,resamplerURL:g,fetchBehavior:l,modelURL:p,delegate:t,logger:n,numberOfInputs:"ns_es"===u?2:1,mode:h};return Promise.resolve(new k(T,w,S,I,d,n))})}createNode(e,t){var i;if(this.internal.isDestroyed)throw Error("Unable to create node because VoiceFocus worker has been destroyed.");let{voiceFocusSampleRate:r=16e3===e.sampleRate?16e3:48e3,enabled:n=!0,agc:s=u}=t||{},a=null==t?void 0:t.es,l={voiceFocusSampleRate:r,enabled:n,sendBufferCount:10,prefill:6,agc:s,executionQuanta:this.executionQuanta,supportFarendStream:a,mode:this.nodeOptions.mode},d=(0,o.withQueryString)(this.processorURL,null===(i=this.nodeOptions)||void 0===i?void 0:i.fetchBehavior);return e.audioWorklet.addModule(d).then(()=>new this.nodeConstructor(e,Object.assign(Object.assign({},this.nodeOptions),{processorOptions:l})))}applyToStream(e,t,i){return r(this,void 0,void 0,function*(){if(this.internal.isDestroyed)throw Error("Unable to apply stream because VoiceFocus worker has been destroyed");let r=t.createMediaStreamSource(e),n=yield this.applyToSourceNode(r,t,i),o=t.createMediaStreamDestination();return n.connect(o),this.internal=Object.assign(Object.assign({},this.internal),{voiceFocusNode:n,sourceNode:r,destinationNode:o,audioContext:t}),{node:n,source:r,destination:o,stream:o.stream}})}applyToSourceNode(e,t,i){return r(this,void 0,void 0,function*(){let r=yield this.createNode(t,i);return e.connect(r),r})}}t.VoiceFocus=k;let T=(e=m)=>new(window.AudioContext||window.webkitAudioContext)(e);t.createAudioContext=T;let I=(e,t,i)=>r(void 0,void 0,void 0,function*(){var r,n;let{constraints:o,spec:s,delegate:a,preload:l=!0,options:d}=t,{logger:c}=i,h=yield k.configure(s,i);if(!h.supported)return null===(r=i.logger)||void 0===r||r.warn("Voice Focus not supported; returning standard stream."),window.navigator.mediaDevices.getUserMedia(o);let f=yield k.init(h,{delegate:a,preload:l,logger:c}),p=(null===(n=t.options)||void 0===n?void 0:n.agc)||u,m=yield window.navigator.mediaDevices.getUserMedia(w(o,p));return f.applyToStream(m,e,d).then(e=>e.stream)});t.getAudioInput=I},2633:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let n=i(9424),o=i(103),s=5e3,a=5e3;class l extends o.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t),this.cpuWarningCount=0,this.metrics={latencyMillisAverage:0,snr:{average:0,averageActive:0,variance:0,varianceActive:0},drr:{average:0,variance:0,averageActive:0,varianceActive:0},vad:{average:0},cpu:{lateInvoke:0,longInvoke:0}},this.channelCountMode="explicit",this.channelCount=1;let{modelURL:i,worker:r,fetchBehavior:o,logger:s,delegate:a}=t;this.logger=s,this.port.onmessage=this.onProcessorMessage.bind(this),this.delegate=a,s&&s.debug("VoiceFocusInlineNode:",i),this.worker=r,this.worker.onmessage=this.onWorkerMessage.bind(this);let l=(0,n.supportsWASMPostMessage)(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:l,key:"model",fetchBehavior:o,path:i})}onModuleBufferLoaded(e,t){this.port.postMessage({message:"module-buffer",buffer:e,key:t})}onModuleLoaded(e,t){this.port.postMessage({message:"module",module:e,key:t})}enable(){return r(this,void 0,void 0,function*(){this.port.postMessage({message:"enable"})})}disable(){return r(this,void 0,void 0,function*(){this.port.postMessage({message:"disable"})})}setMode(e){return r(this,void 0,void 0,function*(){this.port.postMessage({message:"set-mode",mode:e})})}stop(){var e;return r(this,void 0,void 0,function*(){this.port.postMessage({message:"stop"});try{null===(e=this.worker)||void 0===e||e.terminate()}catch(e){console.error("failed to terminate worker:",e)}this.disconnect()})}onProcessorMessage(e){var t,i,r,n,o,l;let{data:d}=e,{message:c}=d;switch(c){case"cpu":let{reason:u,count:h}=d;u&&h&&(this.metrics.cpu=Object.assign(Object.assign({},this.metrics.cpu),{[u]:h+this.metrics.cpu[u]})),this.cpuWarningCount++;let f=Date.now(),p=this.cpuWarningLastTriggered||f,m=Math.abs(f-p);(!this.cpuWarningLastTriggered||m>s)&&(null===(t=this.logger)||void 0===t||t.warn(`CPU warning (count: ${this.cpuWarningCount}):`,c),this.cpuWarningCount=0,this.cpuWarningLastTriggered=f),null===(i=this.delegate)||void 0===i||i.onCPUWarning();break;case"metrics":let{metrics:g}=d;if(!g){null===(r=this.logger)||void 0===r||r.warn("Got metrics message but no metrics payload");break}if(this.metrics=Object.assign(Object.assign({},this.metrics),g),this.logger){let e=Date.now();e-(null!==(n=this.metricsLastRecorded)&&void 0!==n?n:0)>a&&(null===(o=this.logger)||void 0===o||o.debug("Contact metrics:",this.metrics),this.metricsLastRecorded=e)}break;default:null===(l=this.logger)||void 0===l||l.debug("Ignoring processor message.")}}getModelMetrics(){return this.metrics}onWorkerMessage(e){let t=e.data;switch(t.message){case"module-buffer":if(!t.buffer||!t.key)return;this.onModuleBufferLoaded(t.buffer,t.key);break;case"module":if(!t.module||!t.key)return;this.onModuleLoaded(t.module,t.key);break;case"stopped":this.worker&&this.worker.terminate();break;default:return}}}t.default=l},271:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let n=i(9424),o=i(103);class s extends o.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t),this.channelCountMode="explicit",this.channelCount=1;let{modelURL:i,audioBufferURL:r,worker:o,fetchBehavior:s,delegate:a}=t;this.delegate=a,this.worker=o,this.worker.onmessage=this.onWorkerMessage.bind(this),this.port.onmessage=this.onProcessorMessage.bind(this);let{enabled:l,agc:d,supportFarendStream:c}=t.processorOptions;this.worker.postMessage({message:"init",approach:"postMessage",frames:16e3===e.sampleRate?160:480,enabled:l,agc:d,fetchBehavior:s,model:i,supportFarendStream:c});let u=(0,n.supportsWASMPostMessage)(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:u,key:"buffer",fetchBehavior:s,path:r})}enable(){return r(this,void 0,void 0,function*(){this.worker.postMessage({message:"enable"})})}disable(){return r(this,void 0,void 0,function*(){this.worker.postMessage({message:"disable"})})}setMode(e){return r(this,void 0,void 0,function*(){this.port.postMessage({message:"set-mode",mode:e})})}stop(){return r(this,void 0,void 0,function*(){try{this.worker.postMessage({message:"stop"})}catch(e){}this.disconnect()})}getModelMetrics(){}onWorkerMessage(e){var t;let i=e.data;switch(i.message){case"ready":this.port.postMessage({message:"ready",shared:i.shared},i.shared?Object.values(i.shared):[]);break;case"data":if(!i.buffer)return;this.port.postMessage({message:"data",buffer:i.buffer},[i.buffer]);break;case"stopped":this.worker.terminate();break;case"module-buffer":case"module":case"processing":this.port.postMessage(i);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;default:return}}onProcessorMessage(e){var t;let i=e.data;switch(i.message){case"data":if(!i.buffer)return;this.worker.postMessage({message:"data",buffer:i.buffer},[i.buffer]);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;case"prepare-for-frames":this.worker.postMessage(i);break;default:return}}}t.default=s},1678:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});let n=i(9424),o=i(103),s={ready:0,enabled:1},a={disabled:0,enabled:1,stopped:2};class l extends o.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t),this.channelCountMode="explicit",this.channelCount=1;let{modelURL:i,resamplerURL:r,worker:o,fetchBehavior:s,delegate:a}=t;this.delegate=a,this.worker=o,this.worker.onmessage=this.onWorkerMessage.bind(this),this.port.onmessage=this.onProcessorMessage.bind(this);let{enabled:l,supportFarendStream:d}=t.processorOptions;this.worker.postMessage({message:"init",approach:"sab",frames:16e3===e.sampleRate?160:480,enabled:l,model:i,supportFarendStream:d});let c=(0,n.supportsWASMPostMessage)(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:c,key:"resampler",fetchBehavior:s,path:r})}enable(){return r(this,void 0,void 0,function*(){this.state?(Atomics.store(this.state,s.enabled,a.enabled),Atomics.notify(this.state,s.ready,1)):this.worker.postMessage({message:"enable"})})}disable(){return r(this,void 0,void 0,function*(){this.state?(Atomics.store(this.state,s.enabled,a.disabled),Atomics.notify(this.state,s.ready,1)):this.worker.postMessage({message:"disable"})})}setMode(e){return r(this,void 0,void 0,function*(){this.port.postMessage({message:"set-mode",mode:e})})}stop(){return r(this,void 0,void 0,function*(){if(this.state)Atomics.store(this.state,s.enabled,a.stopped),Atomics.notify(this.state,s.ready,1);else try{this.worker.postMessage({message:"stop"})}catch(e){}this.disconnect()})}getModelMetrics(){}onWorkerMessage(e){var t;let i=e.data;switch(i.message){case"ready":if(!i.shared)throw Error("No shared state.");this.state=new Int32Array(i.shared.state),this.port.postMessage(i);break;case"stopped":this.worker.terminate();break;case"module-buffer":case"module":case"processing":this.port.postMessage(i);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;default:return}}onProcessorMessage(e){var t;let i=e.data;switch(i.message){case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;case"prepare-for-frames":this.worker.postMessage(i)}}}t.default=l},5334:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawSha256=void 0;var r=i(1216),n=function(){function e(){this.state=Int32Array.from(r.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw Error("Attempted to update an already finished hash.");var t=0,i=e.byteLength;if(this.bytesHashed+=i,8*this.bytesHashed>r.MAX_HASHABLE_LENGTH)throw Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=e[t++],i--,this.bufferLength===r.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(t.setUint8(this.bufferLength++,128),i%r.BLOCK_SIZE>=r.BLOCK_SIZE-8){for(var n=this.bufferLength;n<r.BLOCK_SIZE;n++)t.setUint8(n,0);this.hashBuffer(),this.bufferLength=0}for(var n=this.bufferLength;n<r.BLOCK_SIZE-8;n++)t.setUint8(n,0);t.setUint32(r.BLOCK_SIZE-8,Math.floor(e/4294967296),!0),t.setUint32(r.BLOCK_SIZE-4,e),this.hashBuffer(),this.finished=!0}for(var o=new Uint8Array(r.DIGEST_LENGTH),n=0;n<8;n++)o[4*n]=this.state[n]>>>24&255,o[4*n+1]=this.state[n]>>>16&255,o[4*n+2]=this.state[n]>>>8&255,o[4*n+3]=this.state[n]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,i=e.state,n=i[0],o=i[1],s=i[2],a=i[3],l=i[4],d=i[5],c=i[6],u=i[7],h=0;h<r.BLOCK_SIZE;h++){if(h<16)this.temp[h]=(255&t[4*h])<<24|(255&t[4*h+1])<<16|(255&t[4*h+2])<<8|255&t[4*h+3];else{var f=this.temp[h-2],p=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,m=((f=this.temp[h-15])>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[h]=(p+this.temp[h-7]|0)+(m+this.temp[h-16]|0)}var g=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&d^~l&c)|0)+(u+(r.KEY[h]+this.temp[h]|0)|0)|0,v=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&o^n&s^o&s)|0;u=c,c=d,d=l,l=a+g|0,a=s,s=o,o=n,n=g+v|0}i[0]+=n,i[1]+=o,i[2]+=s,i[3]+=a,i[4]+=l,i[5]+=d,i[6]+=c,i[7]+=u},e}();t.RawSha256=n},1216:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_HASHABLE_LENGTH=t.INIT=t.KEY=t.DIGEST_LENGTH=t.BLOCK_SIZE=void 0,t.BLOCK_SIZE=64,t.DIGEST_LENGTH=32,t.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),t.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t.MAX_HASHABLE_LENGTH=9007199254740991},3625:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(4459).__exportStar(i(1103),t)},1103:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sha256=void 0;var r=i(4459),n=i(1216),o=i(5334),s=i(6433),a=function(){function e(e){if(this.hash=new o.RawSha256,e){this.outer=new o.RawSha256;var t=l(e),i=new Uint8Array(n.BLOCK_SIZE);i.set(t);for(var r=0;r<n.BLOCK_SIZE;r++)t[r]^=54,i[r]^=92;this.hash.update(t),this.outer.update(i);for(var r=0;r<t.byteLength;r++)t[r]=0}}return e.prototype.update=function(e){if(!(0,s.isEmptyData)(e)&&!this.error)try{this.hash.update((0,s.convertToBuffer)(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return[2,this.digestSync()]})})},e}();function l(e){var t=(0,s.convertToBuffer)(e);if(t.byteLength>n.BLOCK_SIZE){var i=new o.RawSha256;i.update(t),t=i.digest()}var r=new Uint8Array(n.BLOCK_SIZE);return r.set(t),r}t.Sha256=a},5142:function(e,t,i){"use strict";var r=i(7224).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.convertToBuffer=void 0;var n=i(9193),o=void 0!==r&&r.from?function(e){return r.from(e,"utf8")}:n.fromUtf8;function s(e){return e instanceof Uint8Array?e:"string"==typeof e?o(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}t.convertToBuffer=s},6433:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var r=i(5142);Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return r.convertToBuffer}});var n=i(4766);Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return n.isEmptyData}});var o=i(5877);Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return o.numToUint8}});var s=i(1484);Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return s.uint32ArrayFrom}})},4766:function(e,t){"use strict";function i(e){return"string"==typeof e?0===e.length:0===e.byteLength}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyData=void 0,t.isEmptyData=i},5877:function(e,t){"use strict";function i(e){return new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])}Object.defineProperty(t,"__esModule",{value:!0}),t.numToUint8=void 0,t.numToUint8=i},1484:function(e,t){"use strict";function i(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),i=0;i<e.length;)t[i]=e[i],i+=1;return t}return Uint32Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=void 0,t.uint32ArrayFrom=i},4459:function(e,t,i){"use strict";i.r(t),i.d(t,{__assign:function(){return o},__asyncDelegator:function(){return S},__asyncGenerator:function(){return y},__asyncValues:function(){return w},__await:function(){return b},__awaiter:function(){return c},__classPrivateFieldGet:function(){return I},__classPrivateFieldSet:function(){return E},__createBinding:function(){return h},__decorate:function(){return a},__exportStar:function(){return f},__extends:function(){return n},__generator:function(){return u},__importDefault:function(){return T},__importStar:function(){return k},__makeTemplateObject:function(){return C},__metadata:function(){return d},__param:function(){return l},__read:function(){return m},__rest:function(){return s},__spread:function(){return g},__spreadArrays:function(){return v},__values:function(){return p}});var r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function n(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var o=function(){return(o=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function s(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)0>t.indexOf(r[n])&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]]);return i}function a(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}function l(e,t){return function(i,r){t(i,r,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,i,r){function n(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):n(e.value).then(s,a)}l((r=r.apply(e,t||[])).next())})}function u(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return l([e,t])}}function l(o){if(i)throw TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function h(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}function f(e,t){for(var i in e)"default"===i||t.hasOwnProperty(i)||(t[i]=e[i])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function v(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var r=Array(e),n=0,t=0;t<i;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,n++)r[n]=o[s];return r}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function y(e,t,i){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,n=i.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){n[e]&&(r[e]=function(t){return new Promise(function(i,r){o.push([e,t,i,r])>1||a(e,t)})})}function a(e,t){try{l(n[e](t))}catch(e){u(o[0][3],e)}}function l(e){e.value instanceof b?Promise.resolve(e.value.v).then(d,c):u(o[0][2],e)}function d(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function S(e){var t,i;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,n){t[r]=e[r]?function(t){return(i=!i)?{value:b(e[r](t)),done:"return"===r}:n?n(t):t}:n}}function w(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise(function(r,o){n(r,o,(t=e[i](t)).done,t.value)})}}function n(e,t,i,r){Promise.resolve(r).then(function(t){e({value:t,done:i})},t)}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function T(e){return e&&e.__esModule?e:{default:e}}function I(e,t){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return t.get(e)}function E(e,t,i){if(!t.has(e))throw TypeError("attempted to set private field on non-instance");return t.set(e,i),i}},1206:function(e){!function(t,i){e.exports=i()}(0,function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,(function(t){return e[t]}).bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=90)}({17:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r=i(18),n=function(){function e(){}return e.getFirstMatch=function(e,t){var i=t.match(e);return i&&i.length>0&&i[1]||""},e.getSecondMatch=function(e,t){var i=t.match(e);return i&&i.length>1&&i[2]||""},e.matchAndReturnConst=function(e,t,i){if(e.test(t))return i},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,i,r){void 0===r&&(r=!1);var n=e.getVersionPrecision(t),o=e.getVersionPrecision(i),s=Math.max(n,o),a=0,l=e.map([t,i],function(t){var i=s-e.getVersionPrecision(t),r=t+Array(i+1).join(".0");return e.map(r.split("."),function(e){return Array(20-e.length).join("0")+e}).reverse()});for(r&&(a=s-Math.min(n,o)),s-=1;s>=a;){if(l[0][s]>l[1][s])return 1;if(l[0][s]===l[1][s]){if(s===a)return 0;s-=1}else if(l[0][s]<l[1][s])return -1}},e.map=function(e,t){var i,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(i=0;i<e.length;i+=1)r.push(t(e[i]));return r},e.find=function(e,t){var i,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(i=0,r=e.length;i<r;i+=1){var n=e[i];if(t(n,i))return n}},e.assign=function(e){for(var t,i,r=e,n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var a=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach(function(t){r[t]=e[t]})};for(t=0,i=o.length;t<i;t+=1)a();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=n,e.exports=t.default},18:function(e,t,i){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast","Pale Moon":"pale_moon",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",pale_moon:"Pale Moon",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv",bot:"bot"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r,n=(r=i(91))&&r.__esModule?r:{default:r},o=i(18);function s(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){var e;function t(){}return t.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw Error("UserAgent should be a string");return new n.default(e,t)},t.parse=function(e){return new n.default(e).getResult()},e=null,s(t,[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}]),t}();t.default=a,e.exports=t.default},91:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r=l(i(92)),n=l(i(93)),o=l(i(94)),s=l(i(95)),a=l(i(17));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=a.default.find(r.default,function(t){if("function"==typeof t.test)return t.test(e);if(Array.isArray(t.test))return t.test.some(function(t){return e.test(t)});throw Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=a.default.find(n.default,function(t){if("function"==typeof t.test)return t.test(e);if(Array.isArray(t.test))return t.test.some(function(t){return e.test(t)});throw Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=a.default.find(o.default,function(t){if("function"==typeof t.test)return t.test(e);if(Array.isArray(t.test))return t.test.some(function(t){return e.test(t)});throw Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=a.default.find(s.default,function(t){if("function"==typeof t.test)return t.test(e);if(Array.isArray(t.test))return t.test.some(function(t){return e.test(t)});throw Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return a.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,i={},r=0,n={},o=0;if(Object.keys(e).forEach(function(t){var s=e[t];"string"==typeof s?(n[t]=s,o+=1):"object"==typeof s&&(i[t]=s,r+=1)}),r>0){var s=Object.keys(i),l=a.default.find(s,function(e){return t.isOS(e)});if(l){var d=this.satisfies(i[l]);if(void 0!==d)return d}var c=a.default.find(s,function(e){return t.isPlatform(e)});if(c){var u=this.satisfies(i[c]);if(void 0!==u)return u}}if(o>0){var h=Object.keys(n),f=a.default.find(h,function(e){return t.isBrowser(e,!0)});if(void 0!==f)return this.compareVersion(n[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var i=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),n=a.default.getBrowserTypeByAlias(r);return t&&n&&(r=n.toLowerCase()),r===i},t.compareVersion=function(e){var t=[0],i=e,r=!1,n=this.getBrowserVersion();if("string"==typeof n)return">"===e[0]||"<"===e[0]?(i=e.substr(1),"="===e[1]?(r=!0,i=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?i=e.substr(1):"~"===e[0]&&(r=!0,i=e.substr(1)),t.indexOf(a.default.compareVersions(n,i,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some(function(e){return t.is(e)})},e}();t.default=d,e.exports=t.default},92:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r,n=(r=i(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},i=n.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},i=n.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/PaleMoon/i],describe:function(e){var t={name:"Pale Moon"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:PaleMoon)[\s/](\d+(?:\.\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},i=n.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},i=n.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},i=n.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},i=n.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},i=n.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},i=n.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},i=n.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},i=n.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},i=n.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},i=n.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},i=n.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},i=n.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},i=n.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return i&&(t.version=i),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},i=n.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},i=n.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},i=n.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},i=n.default.getFirstMatch(o,e)||n.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},i=n.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},i=n.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},i=n.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},i=n.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},i=n.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},i=n.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},i=n.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},i=n.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},i=n.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){var t=!e.test(/like android/i),i=e.test(/android/i);return t&&i},describe:function(e){var t={name:"Android Browser"},i=n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},i=n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},i=n.default.getFirstMatch(o,e);return i&&(t.version=i),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:n.default.getFirstMatch(t,e),version:n.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r,n=(r=i(17))&&r.__esModule?r:{default:r},o=i(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=n.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=n.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=n.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),i=n.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:i}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},i=n.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return i&&(t.version=i),t}},{test:[/macintosh/i],describe:function(e){var t=n.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),i=n.default.getMacOSVersionName(t),r={name:o.OS_MAP.MacOS,version:t};return i&&(r.versionName=i),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=n.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),i=e.test(/android/i);return t&&i},describe:function(e){var t=n.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),i=n.default.getAndroidVersionName(t),r={name:o.OS_MAP.Android,version:t};return i&&(r.versionName=i),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=n.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),i={name:o.OS_MAP.WebOS};return t&&t.length&&(i.version=t),i}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=n.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||n.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||n.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=n.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=n.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=n.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r,n=(r=i(17))&&r.__esModule?r:{default:r},o=i(18),s=[{test:[/googlebot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=n.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",i={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(i.model=t),i}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),i=e.test(/like (ipod|iphone)/i);return t&&!i},describe:function(e){var t=n.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/Nokia/i],describe:function(e){var t=n.default.getFirstMatch(/Nokia\s+([0-9]+(\.[0-9]+)?)/i,e),i={type:o.PLATFORMS_MAP.mobile,vendor:"Nokia"};return t&&(i.model=t),i}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r,n=(r=i(17))&&r.__esModule?r:{default:r},o=i(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=n.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},i=n.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},i=n.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:function(e){var t=e.test(/gecko/i),i=e.test(/like gecko/i);return t&&!i},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},i=n.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},i=n.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return i&&(t.version=i),t}}];t.default=s,e.exports=t.default}})})},3631:function(e,t,i){"use strict";i.r(t),i.d(t,{BotInfo:function(){return l},BrowserInfo:function(){return o},NodeInfo:function(){return s},ReactNativeInfo:function(){return d},SearchBotDeviceInfo:function(){return a},browserName:function(){return g},detect:function(){return p},detectOS:function(){return b},getNodeVersion:function(){return y},parseUserAgent:function(){return v}});var r=i(3454),n=function(e,t,i){if(i||2==arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))},o=function(){return function(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}}(),s=function(){return function(e){this.version=e,this.type="node",this.name="node",this.os=r.platform}}(),a=function(){return function(e,t,i,r){this.name=e,this.version=t,this.os=i,this.bot=r,this.type="bot-device"}}(),l=function(){return function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}}(),d=function(){return function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}}(),c=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,u=3,h=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],f=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function p(e){return e?v(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new d:"undefined"!=typeof navigator?v(navigator.userAgent):y()}function m(e){return""!==e&&h.reduce(function(t,i){var r=i[0],n=i[1];if(t)return t;var o=n.exec(e);return!!o&&[r,o]},!1)}function g(e){var t=m(e);return t?t[0]:null}function v(e){var t=m(e);if(!t)return null;var i=t[0],r=t[1];if("searchbot"===i)return new l;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<u&&(s=n(n([],s,!0),S(u-s.length),!0)):s=[];var d=s.join("."),h=b(e),f=c.exec(e);return f&&f[1]?new a(i,d,h,f[1]):new o(i,d,h)}function b(e){for(var t=0,i=f.length;t<i;t++){var r=f[t],n=r[0];if(r[1].exec(e))return n}return null}function y(){return void 0!==r&&r.version?new s(r.version.slice(1)):null}function S(e){for(var t=[],i=0;i<e;i++)t.push("0");return t}},6086:function(e){"use strict";var t=Object.assign.bind(Object);e.exports=t,e.exports.default=e.exports},3454:function(e,t,i){"use strict";var r,n;e.exports=(null==(r=i.g.process)?void 0:r.env)&&"object"==typeof(null==(n=i.g.process)?void 0:n.env)?i.g.process:i(7663)},6840:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return i(9645)}])},9645:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return s}});var r=i(5893),n=i(1686),o=i(6730);function s(e){let{Component:t,pageProps:i}=e;return(0,r.jsxs)(n.f6,{theme:o.Wbj,children:[(0,r.jsx)(o.nz8,{}),(0,r.jsx)(o.JBA,{children:(0,r.jsx)(o.BAg,{children:(0,r.jsx)(o.o1U,{children:(0,r.jsx)(t,{...i})})})})]})}},7224:function(e){var t="/";!function(){var i={675:function(e,t){"use strict";t.byteLength=d,t.toByteArray=u,t.fromByteArray=p;for(var i=[],r=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)i[s]=o[s],r[o.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");-1===i&&(i=t);var r=i===t?0:4-i%4;return[i,r]}function d(e){var t=l(e),i=t[0],r=t[1];return(i+r)*3/4-r}function c(e,t,i){return(t+i)*3/4-i}function u(e){var t,i,o=l(e),s=o[0],a=o[1],d=new n(c(e,s,a)),u=0,h=a>0?s-4:s;for(i=0;i<h;i+=4)t=r[e.charCodeAt(i)]<<18|r[e.charCodeAt(i+1)]<<12|r[e.charCodeAt(i+2)]<<6|r[e.charCodeAt(i+3)],d[u++]=t>>16&255,d[u++]=t>>8&255,d[u++]=255&t;return 2===a&&(t=r[e.charCodeAt(i)]<<2|r[e.charCodeAt(i+1)]>>4,d[u++]=255&t),1===a&&(t=r[e.charCodeAt(i)]<<10|r[e.charCodeAt(i+1)]<<4|r[e.charCodeAt(i+2)]>>2,d[u++]=t>>8&255,d[u++]=255&t),d}function h(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function f(e,t,i){for(var r=[],n=t;n<i;n+=3)r.push(h((e[n]<<16&16711680)+(e[n+1]<<8&65280)+(255&e[n+2])));return r.join("")}function p(e){for(var t,r=e.length,n=r%3,o=[],s=16383,a=0,l=r-n;a<l;a+=s)o.push(f(e,a,a+s>l?l:a+s));return 1===n?o.push(i[(t=e[r-1])>>2]+i[t<<4&63]+"=="):2===n&&o.push(i[(t=(e[r-2]<<8)+e[r-1])>>10]+i[t>>4&63]+i[t<<2&63]+"="),o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},72:function(e,t,i){"use strict";var r=i(675),n=i(783),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=d,t.SlowBuffer=y,t.INSPECT_MAX_BYTES=50;var s=2147483647;function a(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}function l(e){if(e>s)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,d.prototype),t}function d(e,t,i){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return f(e)}return c(e,t,i)}function c(e,t,i){if("string"==typeof e)return p(e,t);if(ArrayBuffer.isView(e))return m(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Z(e,ArrayBuffer)||e&&Z(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(Z(e,SharedArrayBuffer)||e&&Z(e.buffer,SharedArrayBuffer)))return g(e,t,i);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return d.from(r,t,i);var n=v(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return d.from(e[Symbol.toPrimitive]("string"),t,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function h(e,t,i){return(u(e),e<=0)?l(e):void 0!==t?"string"==typeof i?l(e).fill(t,i):l(e).fill(t):l(e)}function f(e){return u(e),l(e<0?0:0|b(e))}function p(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!d.isEncoding(t))throw TypeError("Unknown encoding: "+t);var i=0|S(e,t),r=l(i),n=r.write(e,t);return n!==i&&(r=r.slice(0,n)),r}function m(e){for(var t=e.length<0?0:0|b(e.length),i=l(t),r=0;r<t;r+=1)i[r]=255&e[r];return i}function g(e,t,i){var r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),d.prototype),r}function v(e){if(d.isBuffer(e)){var t=0|b(e.length),i=l(t);return 0===i.length||e.copy(i,0,0,t),i}return void 0!==e.length?"number"!=typeof e.length||X(e.length)?l(0):m(e):"Buffer"===e.type&&Array.isArray(e.data)?m(e.data):void 0}function b(e){if(e>=s)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function y(e){return+e!=e&&(e=0),d.alloc(+e)}function S(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Z(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return J(e).length;default:if(n)return r?-1:G(e).length;t=(""+t).toLowerCase(),n=!0}}function w(e,t,i){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0||(i>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return F(this,t,i);case"utf8":case"utf-8":return x(this,t,i);case"ascii":return N(this,t,i);case"latin1":case"binary":return L(this,t,i);case"base64":return _(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,t,i);default:if(r)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function C(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function k(e,t,i,r,n){if(0===e.length)return -1;if("string"==typeof i?(r=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),X(i=+i)&&(i=n?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(n)return -1;i=e.length-1}else if(i<0){if(!n)return -1;i=0}if("string"==typeof t&&(t=d.from(t,r)),d.isBuffer(t))return 0===t.length?-1:T(e,t,i,r,n);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):T(e,[t],i,r,n);throw TypeError("val must be string, number or Buffer")}function T(e,t,i,r,n){var o,s=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;s=2,a/=2,l/=2,i/=2}function d(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n){var c=-1;for(o=i;o<a;o++)if(d(e,o)===d(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*s}else -1!==c&&(o-=o-c),c=-1}else for(i+l>a&&(i=a-l),o=i;o>=0;o--){for(var u=!0,h=0;h<l;h++)if(d(e,o+h)!==d(t,h)){u=!1;break}if(u)return o}return -1}function I(e,t,i,r){i=Number(i)||0;var n=e.length-i;r?(r=Number(r))>n&&(r=n):r=n;var o=t.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(X(a))break;e[i+s]=a}return s}function E(e,t,i,r){return Q(G(t,e.length-i),e,i,r)}function A(e,t,i,r){return Q(K(t),e,i,r)}function M(e,t,i,r){return A(e,t,i,r)}function O(e,t,i,r){return Q(J(t),e,i,r)}function P(e,t,i,r){return Q(q(t,e.length-i),e,i,r)}function _(e,t,i){return 0===t&&i===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,i))}function x(e,t,i){i=Math.min(e.length,i);for(var r=[],n=t;n<i;){var o,s,a,l,d=e[n],c=null,u=d>239?4:d>223?3:d>191?2:1;if(n+u<=i)switch(u){case 1:d<128&&(c=d);break;case 2:(192&(o=e[n+1]))==128&&(l=(31&d)<<6|63&o)>127&&(c=l);break;case 3:o=e[n+1],s=e[n+2],(192&o)==128&&(192&s)==128&&(l=(15&d)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[n+1],s=e[n+2],a=e[n+3],(192&o)==128&&(192&s)==128&&(192&a)==128&&(l=(15&d)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,u=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),n+=u}return D(r)}t.kMaxLength=s,d.TYPED_ARRAY_SUPPORT=a(),d.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),d.poolSize=8192,d.from=function(e,t,i){return c(e,t,i)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(e,t,i){return h(e,t,i)},d.allocUnsafe=function(e){return f(e)},d.allocUnsafeSlow=function(e){return f(e)},d.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==d.prototype},d.compare=function(e,t){if(Z(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),Z(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,r=t.length,n=0,o=Math.min(i,r);n<o;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:r<i?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);if(void 0===t)for(i=0,t=0;i<e.length;++i)t+=e[i].length;var i,r=d.allocUnsafe(t),n=0;for(i=0;i<e.length;++i){var o=e[i];if(Z(o,Uint8Array)&&(o=d.from(o)),!d.isBuffer(o))throw TypeError('"list" argument must be an Array of Buffers');o.copy(r,n),n+=o.length}return r},d.byteLength=S,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)C(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)C(this,t,t+3),C(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)C(this,t,t+7),C(this,t+1,t+6),C(this,t+2,t+5),C(this,t+3,t+4);return this},d.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?x(this,0,e):w.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(e){if(!d.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},o&&(d.prototype[o]=d.prototype.inspect),d.prototype.compare=function(e,t,i,r,n){if(Z(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||i>e.length||r<0||n>this.length)throw RangeError("out of range index");if(r>=n&&t>=i)return 0;if(r>=n)return -1;if(t>=i)return 1;if(t>>>=0,i>>>=0,r>>>=0,n>>>=0,this===e)return 0;for(var o=n-r,s=i-t,a=Math.min(o,s),l=this.slice(r,n),c=e.slice(t,i),u=0;u<a;++u)if(l[u]!==c[u]){o=l[u],s=c[u];break}return o<s?-1:s<o?1:0},d.prototype.includes=function(e,t,i){return -1!==this.indexOf(e,t,i)},d.prototype.indexOf=function(e,t,i){return k(this,e,t,i,!0)},d.prototype.lastIndexOf=function(e,t,i){return k(this,e,t,i,!1)},d.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var n=this.length-t;if((void 0===i||i>n)&&(i=n),e.length>0&&(i<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return I(this,e,t,i);case"utf8":case"utf-8":return E(this,e,t,i);case"ascii":return A(this,e,t,i);case"latin1":case"binary":return M(this,e,t,i);case"base64":return O(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,i);default:if(o)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R=4096;function D(e){var t=e.length;if(t<=R)return String.fromCharCode.apply(String,e);for(var i="",r=0;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=R));return i}function N(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(127&e[n]);return r}function L(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(e[n]);return r}function F(e,t,i){var r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);for(var n="",o=t;o<i;++o)n+=Y[e[o]];return n}function V(e,t,i){for(var r=e.slice(t,i),n="",o=0;o<r.length;o+=2)n+=String.fromCharCode(r[o]+256*r[o+1]);return n}function B(e,t,i){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>i)throw RangeError("Trying to access beyond buffer length")}function U(e,t,i,r,n,o){if(!d.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<o)throw RangeError('"value" argument is out of bounds');if(i+r>e.length)throw RangeError("Index out of range")}function j(e,t,i,r,n,o){if(i+r>e.length||i<0)throw RangeError("Index out of range")}function $(e,t,i,r,o){return t=+t,i>>>=0,o||j(e,t,i,4,34028234663852886e22,-34028234663852886e22),n.write(e,t,i,r,23,4),i+4}function z(e,t,i,r,o){return t=+t,i>>>=0,o||j(e,t,i,8,17976931348623157e292,-17976931348623157e292),n.write(e,t,i,r,52,8),i+8}d.prototype.slice=function(e,t){var i=this.length;e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,d.prototype),r},d.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||B(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return r},d.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||B(e,t,this.length);for(var r=this[e+--t],n=1;t>0&&(n*=256);)r+=this[e+--t]*n;return r},d.prototype.readUInt8=function(e,t){return e>>>=0,t||B(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||B(e,t,this.length);for(var r=this[e],n=1,o=0;++o<t&&(n*=256);)r+=this[e+o]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*t)),r},d.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||B(e,t,this.length);for(var r=t,n=1,o=this[e+--r];r>0&&(n*=256);)o+=this[e+--r]*n;return o>=(n*=128)&&(o-=Math.pow(2,8*t)),o},d.prototype.readInt8=function(e,t){return(e>>>=0,t||B(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||B(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},d.prototype.readInt16BE=function(e,t){e>>>=0,t||B(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return e>>>=0,t||B(e,4,this.length),n.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||B(e,4,this.length),n.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||B(e,8,this.length),n.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||B(e,8,this.length),n.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,i,r){if(e=+e,t>>>=0,i>>>=0,!r){var n=Math.pow(2,8*i)-1;U(this,e,t,i,n,0)}var o=1,s=0;for(this[t]=255&e;++s<i&&(o*=256);)this[t+s]=e/o&255;return t+i},d.prototype.writeUIntBE=function(e,t,i,r){if(e=+e,t>>>=0,i>>>=0,!r){var n=Math.pow(2,8*i)-1;U(this,e,t,i,n,0)}var o=i-1,s=1;for(this[t+o]=255&e;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+i},d.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeIntLE=function(e,t,i,r){if(e=+e,t>>>=0,!r){var n=Math.pow(2,8*i-1);U(this,e,t,i,n-1,-n)}var o=0,s=1,a=0;for(this[t]=255&e;++o<i&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+i},d.prototype.writeIntBE=function(e,t,i,r){if(e=+e,t>>>=0,!r){var n=Math.pow(2,8*i-1);U(this,e,t,i,n-1,-n)}var o=i-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+i},d.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||U(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeFloatLE=function(e,t,i){return $(this,e,t,!0,i)},d.prototype.writeFloatBE=function(e,t,i){return $(this,e,t,!1,i)},d.prototype.writeDoubleLE=function(e,t,i){return z(this,e,t,!0,i)},d.prototype.writeDoubleBE=function(e,t,i){return z(this,e,t,!1,i)},d.prototype.copy=function(e,t,i,r){if(!d.isBuffer(e))throw TypeError("argument should be a Buffer");if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);var n=r-i;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,i,r);else if(this===e&&i<t&&t<r)for(var o=n-1;o>=0;--o)e[o+t]=this[o+i];else Uint8Array.prototype.set.call(e,this.subarray(i,r),t);return n},d.prototype.fill=function(e,t,i,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!d.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){var n,o=e.charCodeAt(0);("utf8"===r&&o<128||"latin1"===r)&&(e=o)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw RangeError("Out of range index");if(i<=t)return this;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(n=t;n<i;++n)this[n]=e;else{var s=d.isBuffer(e)?e:d.from(e,r),a=s.length;if(0===a)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<i-t;++n)this[n+t]=s[n%a]}return this};var H=/[^+/0-9A-Za-z-_]/g;function W(e){if((e=(e=e.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function G(e,t){t=t||1/0;for(var i,r=e.length,n=null,o=[],s=0;s<r;++s){if((i=e.charCodeAt(s))>55295&&i<57344){if(!n){if(i>56319||s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}n=i;continue}if(i<56320){(t-=3)>-1&&o.push(239,191,189),n=i;continue}i=(n-55296<<10|i-56320)+65536}else n&&(t-=3)>-1&&o.push(239,191,189);if(n=null,i<128){if((t-=1)<0)break;o.push(i)}else if(i<2048){if((t-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else if(i<1114112){if((t-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else throw Error("Invalid code point")}return o}function K(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}function q(e,t){for(var i,r,n=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(i=e.charCodeAt(o))>>8,n.push(i%256),n.push(r);return n}function J(e){return r.toByteArray(W(e))}function Q(e,t,i,r){for(var n=0;n<r&&!(n+i>=t.length)&&!(n>=e.length);++n)t[n+i]=e[n];return n}function Z(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function X(e){return e!=e}var Y=function(){for(var e="0123456789abcdef",t=Array(256),i=0;i<16;++i)for(var r=16*i,n=0;n<16;++n)t[r+n]=e[i]+e[n];return t}()},783:function(e,t){t.read=function(e,t,i,r,n){var o,s,a=8*n-r-1,l=(1<<a)-1,d=l>>1,c=-7,u=i?n-1:0,h=i?-1:1,f=e[t+u];for(u+=h,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+e[t+u],u+=h,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+e[t+u],u+=h,c-=8);if(0===o)o=1-d;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=d}return(f?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,i,r,n,o){var s,a,l,d=8*o-n-1,c=(1<<d)-1,u=c>>1,h=23===n?5960464477539062e-23:0,f=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+u>=1?t+=h/l:t+=h*Math.pow(2,1-u),t*l>=2&&(s++,l/=2),s+u>=c?(a=0,s=c):s+u>=1?(a=(t*l-1)*Math.pow(2,n),s+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,n),s=0));n>=8;e[i+f]=255&a,f+=p,a/=256,n-=8);for(s=s<<n|a,d+=n;d>0;e[i+f]=255&s,f+=p,s/=256,d-=8);e[i+f-p]|=128*m}}},r={};function n(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}},s=!0;try{i[e](o,o.exports,n),s=!1}finally{s&&delete r[e]}return o.exports}n.ab=t+"/";var o=n(72);e.exports=o}()},7663:function(e){var t="/";!function(){var i={229:function(e){var t,i,r,n=e.exports={};function o(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}function l(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var d=[],c=!1,u=-1;function h(){c&&r&&(c=!1,r.length?d=r.concat(d):u=-1,d.length&&f())}function f(){if(!c){var e=a(h);c=!0;for(var t=d.length;t;){for(r=d,d=[];++u<t;)r&&r[u].run();u=-1,t=d.length}r=null,c=!1,l(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new p(e,t)),1!==d.length||c||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function n(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}},s=!0;try{i[e](o,o.exports,n),s=!1}finally{s&&delete r[e]}return o.exports}n.ab=t+"/";var o=n(229);e.exports=o}()},9591:function(e,t,i){"use strict";let{Deflate:r,deflate:n,deflateRaw:o,gzip:s}=i(4555),{Inflate:a,inflate:l,inflateRaw:d,ungzip:c}=i(8843),u=i(1619);e.exports.Deflate=r,e.exports.deflate=n,e.exports.deflateRaw=o,e.exports.gzip=s,e.exports.Inflate=a,e.exports.inflate=l,e.exports.inflateRaw=d,e.exports.ungzip=c,e.exports.constants=u},4555:function(e,t,i){"use strict";let r=i(405),n=i(6247),o=i(9373),s=i(8898),a=i(2292),l=Object.prototype.toString,{Z_NO_FLUSH:d,Z_SYNC_FLUSH:c,Z_FULL_FLUSH:u,Z_FINISH:h,Z_OK:f,Z_STREAM_END:p,Z_DEFAULT_COMPRESSION:m,Z_DEFAULT_STRATEGY:g,Z_DEFLATED:v}=i(1619);function b(e){this.options=n.assign({level:m,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let i=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==f)throw Error(s[i]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(i=r.deflateSetDictionary(this.strm,e))!==f)throw Error(s[i]);this._dict_set=!0}}function y(e,t){let i=new b(t);if(i.push(e,!0),i.err)throw i.msg||s[i.err];return i.result}function S(e,t){return(t=t||{}).raw=!0,y(e,t)}function w(e,t){return(t=t||{}).gzip=!0,y(e,t)}b.prototype.push=function(e,t){let i,n;let s=this.strm,a=this.options.chunkSize;if(this.ended)return!1;for(n=t===~~t?t:!0===t?h:d,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;;){if(0===s.avail_out&&(s.output=new Uint8Array(a),s.next_out=0,s.avail_out=a),(n===c||n===u)&&s.avail_out<=6){this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;continue}if((i=r.deflate(s,n))===p)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),i=r.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===f;if(0===s.avail_out){this.onData(s.output);continue}if(n>0&&s.next_out>0){this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;continue}if(0===s.avail_in)break}return!0},b.prototype.onData=function(e){this.chunks.push(e)},b.prototype.onEnd=function(e){e===f&&(this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=b,e.exports.deflate=y,e.exports.deflateRaw=S,e.exports.gzip=w,e.exports.constants=i(1619)},8843:function(e,t,i){"use strict";let r=i(6351),n=i(6247),o=i(9373),s=i(8898),a=i(2292),l=i(2401),d=Object.prototype.toString,{Z_NO_FLUSH:c,Z_FINISH:u,Z_OK:h,Z_STREAM_END:f,Z_NEED_DICT:p,Z_STREAM_ERROR:m,Z_DATA_ERROR:g,Z_MEM_ERROR:v}=i(1619);function b(e){this.options=n.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits)==0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;let i=r.inflateInit2(this.strm,t.windowBits);if(i!==h||(this.header=new l,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=r.inflateSetDictionary(this.strm,t.dictionary))!==h)))throw Error(s[i])}function y(e,t){let i=new b(t);if(i.push(e),i.err)throw i.msg||s[i.err];return i.result}function S(e,t){return(t=t||{}).raw=!0,y(e,t)}b.prototype.push=function(e,t){let i,n,s;let a=this.strm,l=this.options.chunkSize,b=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?u:c,"[object ArrayBuffer]"===d.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(l),a.next_out=0,a.avail_out=l),(i=r.inflate(a,n))===p&&b&&((i=r.inflateSetDictionary(a,b))===h?i=r.inflate(a,n):i===g&&(i=p));a.avail_in>0&&i===f&&a.state.wrap>0&&0!==e[a.next_in];)r.inflateReset(a),i=r.inflate(a,n);switch(i){case m:case g:case p:case v:return this.onEnd(i),this.ended=!0,!1}if(s=a.avail_out,a.next_out&&(0===a.avail_out||i===f)){if("string"===this.options.to){let e=o.utf8border(a.output,a.next_out),t=a.next_out-e,i=o.buf2string(a.output,e);a.next_out=t,a.avail_out=l-t,t&&a.output.set(a.output.subarray(e,e+t),0),this.onData(i)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out))}if(i!==h||0!==s){if(i===f)return i=r.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},b.prototype.onData=function(e){this.chunks.push(e)},b.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=b,e.exports.inflate=y,e.exports.inflateRaw=S,e.exports.ungzip=y,e.exports.constants=i(1619)},6247:function(e){"use strict";let t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){let i=Array.prototype.slice.call(arguments,1);for(;i.length;){let r=i.shift();if(r){if("object"!=typeof r)throw TypeError(r+"must be non-object");for(let i in r)t(r,i)&&(e[i]=r[i])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;let i=new Uint8Array(t);for(let t=0,r=0,n=e.length;t<n;t++){let n=e[t];i.set(n,r),r+=n.length}return i}},9373:function(e){"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}let i=new Uint8Array(256);for(let e=0;e<256;e++)i[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;i[254]=i[254]=1,e.exports.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,i,r,n,o,s=e.length,a=0;for(n=0;n<s;n++)(64512&(i=e.charCodeAt(n)))==55296&&n+1<s&&(64512&(r=e.charCodeAt(n+1)))==56320&&(i=65536+(i-55296<<10)+(r-56320),n++),a+=i<128?1:i<2048?2:i<65536?3:4;for(o=0,t=new Uint8Array(a),n=0;o<a;n++)(64512&(i=e.charCodeAt(n)))==55296&&n+1<s&&(64512&(r=e.charCodeAt(n+1)))==56320&&(i=65536+(i-55296<<10)+(r-56320),n++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t};let r=(e,i)=>{if(i<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let r="";for(let t=0;t<i;t++)r+=String.fromCharCode(e[t]);return r};e.exports.buf2string=(e,t)=>{let n,o;let s=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let a=Array(2*s);for(o=0,n=0;n<s;){let t=e[n++];if(t<128){a[o++]=t;continue}let r=i[t];if(r>4){a[o++]=65533,n+=r-1;continue}for(t&=2===r?31:3===r?15:7;r>1&&n<s;)t=t<<6|63&e[n++],r--;if(r>1){a[o++]=65533;continue}t<65536?a[o++]=t:(t-=65536,a[o++]=55296|t>>10&1023,a[o++]=56320|1023&t)}return r(a,o)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(192&e[r])==128;)r--;return r<0||0===r?t:r+i[e[r]]>t?r:t}},6069:function(e){"use strict";let t=(e,t,i,r)=>{let n=65535&e|0,o=e>>>16&65535|0,s=0;for(;0!==i;){s=i>2e3?2e3:i,i-=s;do o=o+(n=n+t[r++]|0)|0;while(--s);n%=65521,o%=65521}return n|o<<16|0};e.exports=t},1619:function(e){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2869:function(e){"use strict";let t=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})()),i=(e,i,r,n)=>{let o=t,s=n+r;e^=-1;for(let t=n;t<s;t++)e=e>>>8^o[(e^i[t])&255];return -1^e};e.exports=i},405:function(e,t,i){"use strict";let{_tr_init:r,_tr_stored_block:n,_tr_flush_block:o,_tr_tally:s,_tr_align:a}=i(342),l=i(6069),d=i(2869),c=i(8898),{Z_NO_FLUSH:u,Z_PARTIAL_FLUSH:h,Z_FULL_FLUSH:f,Z_FINISH:p,Z_BLOCK:m,Z_OK:g,Z_STREAM_END:v,Z_STREAM_ERROR:b,Z_DATA_ERROR:y,Z_BUF_ERROR:S,Z_DEFAULT_COMPRESSION:w,Z_FILTERED:C,Z_HUFFMAN_ONLY:k,Z_RLE:T,Z_FIXED:I,Z_DEFAULT_STRATEGY:E,Z_UNKNOWN:A,Z_DEFLATED:M}=i(1619),O=9,P=15,_=8,x=286,R=30,D=19,N=573,L=15,F=3,V=258,B=262,U=32,j=42,$=57,z=69,H=73,W=91,G=103,K=113,q=666,J=1,Q=2,Z=3,X=4,Y=3,ee=(e,t)=>(e.msg=c[t],t),et=e=>2*e-(e>4?9:0),ei=e=>{let t=e.length;for(;--t>=0;)e[t]=0},er=e=>{let t,i,r;let n=e.w_size;r=t=e.hash_size;do i=e.head[--r],e.head[r]=i>=n?i-n:0;while(--t);r=t=n;do i=e.prev[--r],e.prev[r]=i>=n?i-n:0;while(--t)},en=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask,eo=e=>{let t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},es=(e,t)=>{o(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,eo(e.strm)},ea=(e,t)=>{e.pending_buf[e.pending++]=t},el=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},ed=(e,t,i,r)=>{let n=e.avail_in;return(n>r&&(n=r),0===n)?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),i),1===e.state.wrap?e.adler=l(e.adler,t,n,i):2===e.state.wrap&&(e.adler=d(e.adler,t,n,i)),e.next_in+=n,e.total_in+=n,n)},ec=(e,t)=>{let i,r,n=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-B?e.strstart-(e.w_size-B):0,d=e.window,c=e.w_mask,u=e.prev,h=e.strstart+V,f=d[o+s-1],p=d[o+s];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do{if(d[(i=t)+s]!==p||d[i+s-1]!==f||d[i]!==d[o]||d[++i]!==d[o+1])continue;o+=2,i++;do;while(d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&o<h);if(r=V-(h-o),o=h-V,r>s){if(e.match_start=t,s=r,r>=a)break;f=d[o+s-1],p=d[o+s]}}while((t=u[t&c])>l&&0!=--n);return s<=e.lookahead?s:e.lookahead},eu=e=>{let t,i,r;let n=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-B)&&(e.window.set(e.window.subarray(n,n+n-i),0),e.match_start-=n,e.strstart-=n,e.block_start-=n,e.insert>e.strstart&&(e.insert=e.strstart),er(e),i+=n),0===e.strm.avail_in)break;if(t=ed(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=t,e.lookahead+e.insert>=F)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=en(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=en(e,e.ins_h,e.window[r+F-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<F)););}while(e.lookahead<B&&0!==e.strm.avail_in)},eh=(e,t)=>{let i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,o,s,a=0,l=e.strm.avail_in;do{if(r=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s||(s=e.strm.avail_out-s,r>(o=e.strstart-e.block_start)+e.strm.avail_in&&(r=o+e.strm.avail_in),r>s&&(r=s),r<i&&(0===r&&t!==p||t===u||r!==o+e.strm.avail_in)))break;a=t===p&&r===o+e.strm.avail_in?1:0,n(e,0,0,a),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,eo(e.strm),o&&(o>r&&(o=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+o),e.strm.next_out),e.strm.next_out+=o,e.strm.avail_out-=o,e.strm.total_out+=o,e.block_start+=o,r-=o),r&&(ed(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===a);return((l-=e.strm.avail_in)&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a)?X:t!==u&&t!==p&&0===e.strm.avail_in&&e.strstart===e.block_start?Q:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(ed(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,i=(s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s)>e.w_size?e.w_size:s,((o=e.strstart-e.block_start)>=i||(o||t===p)&&t!==u&&0===e.strm.avail_in&&o<=s)&&(r=o>s?s:o,a=t===p&&0===e.strm.avail_in&&r===o?1:0,n(e,e.block_start,r,a),e.block_start+=r,eo(e.strm)),a?Z:J)},ef=(e,t)=>{let i,r;for(;;){if(e.lookahead<B){if(eu(e),e.lookahead<B&&t===u)return J;if(0===e.lookahead)break}if(i=0,e.lookahead>=F&&(e.ins_h=en(e,e.ins_h,e.window[e.strstart+F-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-B&&(e.match_length=ec(e,i)),e.match_length>=F){if(r=s(e,e.strstart-e.match_start,e.match_length-F),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=F){e.match_length--;do e.strstart++,e.ins_h=en(e,e.ins_h,e.window[e.strstart+F-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=en(e,e.ins_h,e.window[e.strstart+1])}else r=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(es(e,!1),0===e.strm.avail_out))return J}return(e.insert=e.strstart<F-1?e.strstart:F-1,t===p)?(es(e,!0),0===e.strm.avail_out)?Z:X:e.sym_next&&(es(e,!1),0===e.strm.avail_out)?J:Q},ep=(e,t)=>{let i,r,n;for(;;){if(e.lookahead<B){if(eu(e),e.lookahead<B&&t===u)return J;if(0===e.lookahead)break}if(i=0,e.lookahead>=F&&(e.ins_h=en(e,e.ins_h,e.window[e.strstart+F-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=F-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-B&&(e.match_length=ec(e,i),e.match_length<=5&&(e.strategy===C||e.match_length===F&&e.strstart-e.match_start>4096)&&(e.match_length=F-1)),e.prev_length>=F&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-F,r=s(e,e.strstart-1-e.prev_match,e.prev_length-F),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=en(e,e.ins_h,e.window[e.strstart+F-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=F-1,e.strstart++,r&&(es(e,!1),0===e.strm.avail_out))return J}else if(e.match_available){if((r=s(e,0,e.window[e.strstart-1]))&&es(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return J}else e.match_available=1,e.strstart++,e.lookahead--}return(e.match_available&&(r=s(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<F-1?e.strstart:F-1,t===p)?(es(e,!0),0===e.strm.avail_out)?Z:X:e.sym_next&&(es(e,!1),0===e.strm.avail_out)?J:Q},em=(e,t)=>{let i,r,n,o;let a=e.window;for(;;){if(e.lookahead<=V){if(eu(e),e.lookahead<=V&&t===u)return J;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=F&&e.strstart>0&&(r=a[n=e.strstart-1])===a[++n]&&r===a[++n]&&r===a[++n]){o=e.strstart+V;do;while(r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&n<o);e.match_length=V-(o-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=F?(i=s(e,1,e.match_length-F),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(es(e,!1),0===e.strm.avail_out))return J}return(e.insert=0,t===p)?(es(e,!0),0===e.strm.avail_out)?Z:X:e.sym_next&&(es(e,!1),0===e.strm.avail_out)?J:Q},eg=(e,t)=>{let i;for(;;){if(0===e.lookahead&&(eu(e),0===e.lookahead)){if(t===u)return J;break}if(e.match_length=0,i=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(es(e,!1),0===e.strm.avail_out))return J}return(e.insert=0,t===p)?(es(e,!0),0===e.strm.avail_out)?Z:X:e.sym_next&&(es(e,!1),0===e.strm.avail_out)?J:Q};function ev(e,t,i,r,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=n}let eb=[new ev(0,0,0,0,eh),new ev(4,4,8,4,ef),new ev(4,5,16,8,ef),new ev(4,6,32,32,ef),new ev(4,4,16,16,ep),new ev(8,16,32,32,ep),new ev(8,16,128,128,ep),new ev(8,32,128,256,ep),new ev(32,128,258,1024,ep),new ev(32,258,258,4096,ep)],ey=e=>{e.window_size=2*e.w_size,ei(e.head),e.max_lazy_match=eb[e.level].max_lazy,e.good_match=eb[e.level].good_length,e.nice_match=eb[e.level].nice_length,e.max_chain_length=eb[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=F-1,e.match_available=0,e.ins_h=0};function eS(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=M,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*N),this.dyn_dtree=new Uint16Array((2*R+1)*2),this.bl_tree=new Uint16Array((2*D+1)*2),ei(this.dyn_ltree),ei(this.dyn_dtree),ei(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(L+1),this.heap=new Uint16Array(2*x+1),ei(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*x+1),ei(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}let ew=e=>{if(!e)return 1;let t=e.state;return t&&t.strm===e&&(t.status===j||t.status===$||t.status===z||t.status===H||t.status===W||t.status===G||t.status===K||t.status===q)?0:1},eC=e=>{if(ew(e))return ee(e,b);e.total_in=e.total_out=0,e.data_type=A;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?$:t.wrap?j:K,e.adler=2===t.wrap?0:1,t.last_flush=-2,r(t),g},ek=e=>{let t=eC(e);return t===g&&ey(e.state),t},eT=(e,t)=>ew(e)||2!==e.state.wrap?b:(e.state.gzhead=t,g),eI=(e,t,i,r,n,o)=>{if(!e)return b;let s=1;if(t===w&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),n<1||n>O||i!==M||r<8||r>15||t<0||t>9||o<0||o>I||8===r&&1!==s)return ee(e,b);8===r&&(r=9);let a=new eS;return e.state=a,a.strm=e,a.status=j,a.wrap=s,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+F-1)/F),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=t,a.strategy=o,a.method=i,ek(e)},eE=(e,t)=>eI(e,t,M,P,_,E),eA=(e,t)=>{if(ew(e)||t>m||t<0)return e?ee(e,b):b;let i=e.state;if(!e.output||0!==e.avail_in&&!e.input||i.status===q&&t!==p)return ee(e,0===e.avail_out?S:b);let r=i.last_flush;if(i.last_flush=t,0!==i.pending){if(eo(e),0===e.avail_out)return i.last_flush=-1,g}else if(0===e.avail_in&&et(t)<=et(r)&&t!==p)return ee(e,S);if(i.status===q&&0!==e.avail_in)return ee(e,S);if(i.status===j&&0===i.wrap&&(i.status=K),i.status===j){let t=M+(i.w_bits-8<<4)<<8,r=-1;if(t|=(r=i.strategy>=k||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(t|=U),el(i,t+=31-t%31),0!==i.strstart&&(el(i,e.adler>>>16),el(i,65535&e.adler)),e.adler=1,i.status=K,eo(e),0!==i.pending)return i.last_flush=-1,g}if(i.status===$){if(e.adler=0,ea(i,31),ea(i,139),ea(i,8),i.gzhead)ea(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ea(i,255&i.gzhead.time),ea(i,i.gzhead.time>>8&255),ea(i,i.gzhead.time>>16&255),ea(i,i.gzhead.time>>24&255),ea(i,9===i.level?2:i.strategy>=k||i.level<2?4:0),ea(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(ea(i,255&i.gzhead.extra.length),ea(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=d(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=z;else if(ea(i,0),ea(i,0),ea(i,0),ea(i,0),ea(i,0),ea(i,9===i.level?2:i.strategy>=k||i.level<2?4:0),ea(i,Y),i.status=K,eo(e),0!==i.pending)return i.last_flush=-1,g}if(i.status===z){if(i.gzhead.extra){let t=i.pending,r=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+r>i.pending_buf_size;){let n=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=d(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=n,eo(e),0!==i.pending)return i.last_flush=-1,g;t=0,r-=n}let n=new Uint8Array(i.gzhead.extra);i.pending_buf.set(n.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending+=r,i.gzhead.hcrc&&i.pending>t&&(e.adler=d(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=H}if(i.status===H){if(i.gzhead.name){let t,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(e.adler=d(e.adler,i.pending_buf,i.pending-r,r)),eo(e),0!==i.pending)return i.last_flush=-1,g;r=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,ea(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>r&&(e.adler=d(e.adler,i.pending_buf,i.pending-r,r)),i.gzindex=0}i.status=W}if(i.status===W){if(i.gzhead.comment){let t,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(e.adler=d(e.adler,i.pending_buf,i.pending-r,r)),eo(e),0!==i.pending)return i.last_flush=-1,g;r=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,ea(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>r&&(e.adler=d(e.adler,i.pending_buf,i.pending-r,r))}i.status=G}if(i.status===G){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(eo(e),0!==i.pending))return i.last_flush=-1,g;ea(i,255&e.adler),ea(i,e.adler>>8&255),e.adler=0}if(i.status=K,eo(e),0!==i.pending)return i.last_flush=-1,g}if(0!==e.avail_in||0!==i.lookahead||t!==u&&i.status!==q){let r=0===i.level?eh(i,t):i.strategy===k?eg(i,t):i.strategy===T?em(i,t):eb[i.level].func(i,t);if((r===Z||r===X)&&(i.status=q),r===J||r===Z)return 0===e.avail_out&&(i.last_flush=-1),g;if(r===Q&&(t===h?a(i):t!==m&&(n(i,0,0,!1),t===f&&(ei(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),eo(e),0===e.avail_out))return i.last_flush=-1,g}return t!==p?g:i.wrap<=0?v:(2===i.wrap?(ea(i,255&e.adler),ea(i,e.adler>>8&255),ea(i,e.adler>>16&255),ea(i,e.adler>>24&255),ea(i,255&e.total_in),ea(i,e.total_in>>8&255),ea(i,e.total_in>>16&255),ea(i,e.total_in>>24&255)):(el(i,e.adler>>>16),el(i,65535&e.adler)),eo(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?g:v)},eM=e=>{if(ew(e))return b;let t=e.state.status;return e.state=null,t===K?ee(e,y):g},eO=(e,t)=>{let i=t.length;if(ew(e))return b;let r=e.state,n=r.wrap;if(2===n||1===n&&r.status!==j||r.lookahead)return b;if(1===n&&(e.adler=l(e.adler,t,i,0)),r.wrap=0,i>=r.w_size){0===n&&(ei(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(i-r.w_size,i),0),t=e,i=r.w_size}let o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,eu(r);r.lookahead>=F;){let e=r.strstart,t=r.lookahead-(F-1);do r.ins_h=en(r,r.ins_h,r.window[e+F-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++;while(--t);r.strstart=e,r.lookahead=F-1,eu(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=F-1,r.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,r.wrap=n,g};e.exports.deflateInit=eE,e.exports.deflateInit2=eI,e.exports.deflateReset=ek,e.exports.deflateResetKeep=eC,e.exports.deflateSetHeader=eT,e.exports.deflate=eA,e.exports.deflateEnd=eM,e.exports.deflateSetDictionary=eO,e.exports.deflateInfo="pako deflate (from Nodeca project)"},2401:function(e){"use strict";function t(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=t},4264:function(e){"use strict";let t=16209,i=16191;e.exports=function(e,r){let n,o,s,a,l,d,c,u,h,f,p,m,g,v,b,y,S,w,C,k,T,I,E,A;let M=e.state;n=e.next_in,E=e.input,o=n+(e.avail_in-5),s=e.next_out,A=e.output,a=s-(r-e.avail_out),l=s+(e.avail_out-257),d=M.dmax,c=M.wsize,u=M.whave,h=M.wnext,f=M.window,p=M.hold,m=M.bits,g=M.lencode,v=M.distcode,b=(1<<M.lenbits)-1,y=(1<<M.distbits)-1;e:do for(m<15&&(p+=E[n++]<<m,m+=8,p+=E[n++]<<m,m+=8),S=g[p&b];;){if(p>>>=w=S>>>24,m-=w,0==(w=S>>>16&255))A[s++]=65535&S;else if(16&w)for(C=65535&S,(w&=15)&&(m<w&&(p+=E[n++]<<m,m+=8),C+=p&(1<<w)-1,p>>>=w,m-=w),m<15&&(p+=E[n++]<<m,m+=8,p+=E[n++]<<m,m+=8),S=v[p&y];;){if(p>>>=w=S>>>24,m-=w,16&(w=S>>>16&255)){if(k=65535&S,m<(w&=15)&&(p+=E[n++]<<m,(m+=8)<w&&(p+=E[n++]<<m,m+=8)),(k+=p&(1<<w)-1)>d){e.msg="invalid distance too far back",M.mode=t;break e}if(p>>>=w,m-=w,k>(w=s-a)){if((w=k-w)>u&&M.sane){e.msg="invalid distance too far back",M.mode=t;break e}if(T=0,I=f,0===h){if(T+=c-w,w<C){C-=w;do A[s++]=f[T++];while(--w);T=s-k,I=A}}else if(h<w){if(T+=c+h-w,(w-=h)<C){C-=w;do A[s++]=f[T++];while(--w);if(T=0,h<C){C-=w=h;do A[s++]=f[T++];while(--w);T=s-k,I=A}}}else if(T+=h-w,w<C){C-=w;do A[s++]=f[T++];while(--w);T=s-k,I=A}for(;C>2;)A[s++]=I[T++],A[s++]=I[T++],A[s++]=I[T++],C-=3;C&&(A[s++]=I[T++],C>1&&(A[s++]=I[T++]))}else{T=s-k;do A[s++]=A[T++],A[s++]=A[T++],A[s++]=A[T++],C-=3;while(C>2);C&&(A[s++]=A[T++],C>1&&(A[s++]=A[T++]))}}else if((64&w)==0){S=v[(65535&S)+(p&(1<<w)-1)];continue}else{e.msg="invalid distance code",M.mode=t;break e}break}else if((64&w)==0){S=g[(65535&S)+(p&(1<<w)-1)];continue}else if(32&w){M.mode=i;break e}else{e.msg="invalid literal/length code",M.mode=t;break e}break}while(n<o&&s<l);n-=C=m>>3,m-=C<<3,p&=(1<<m)-1,e.next_in=n,e.next_out=s,e.avail_in=n<o?5+(o-n):5-(n-o),e.avail_out=s<l?257+(l-s):257-(s-l),M.hold=p,M.bits=m}},6351:function(e,t,i){"use strict";let r,n;let o=i(6069),s=i(2869),a=i(4264),l=i(9241),d=0,c=1,u=2,{Z_FINISH:h,Z_BLOCK:f,Z_TREES:p,Z_OK:m,Z_STREAM_END:g,Z_NEED_DICT:v,Z_STREAM_ERROR:b,Z_DATA_ERROR:y,Z_MEM_ERROR:S,Z_BUF_ERROR:w,Z_DEFLATED:C}=i(1619),k=16180,T=16181,I=16182,E=16183,A=16184,M=16185,O=16186,P=16187,_=16188,x=16189,R=16190,D=16191,N=16192,L=16193,F=16194,V=16195,B=16196,U=16197,j=16198,$=16199,z=16200,H=16201,W=16202,G=16203,K=16204,q=16205,J=16206,Q=16207,Z=16208,X=16209,Y=16210,ee=16211,et=852,ei=592,er=15,en=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function eo(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let es=e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<k||t.mode>ee?1:0},ea=e=>{if(es(e))return b;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=k,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(et),t.distcode=t.distdyn=new Int32Array(ei),t.sane=1,t.back=-1,m},el=e=>{if(es(e))return b;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ea(e)},ed=(e,t)=>{let i;if(es(e))return b;let r=e.state;return(t<0?(i=0,t=-t):(i=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15))?b:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,el(e))},ec=(e,t)=>{if(!e)return b;let i=new eo;e.state=i,i.strm=e,i.window=null,i.mode=k;let r=ed(e,t);return r!==m&&(e.state=null),r},eu=e=>ec(e,er),eh=!0,ef=e=>{if(eh){r=new Int32Array(512),n=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(l(c,e.lens,0,288,r,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;l(u,e.lens,0,32,n,0,e.work,{bits:5}),eh=!1}e.lencode=r,e.lenbits=9,e.distcode=n,e.distbits=5},ep=(e,t,i,r)=>{let n;let o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(t.subarray(i-o.wsize,i),0),o.wnext=0,o.whave=o.wsize):((n=o.wsize-o.wnext)>r&&(n=r),o.window.set(t.subarray(i-r,i-r+n),o.wnext),(r-=n)?(o.window.set(t.subarray(i-r,i),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=n,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=n))),0},em=(e,t)=>{let i,r,n,ee,et,ei,er,eo,ea,el,ed,ec,eu,eh,em,eg,ev,eb,ey,eS,ew,eC,ek,eT;let eI=0,eE=new Uint8Array(4),eA=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(es(e)||!e.output||!e.input&&0!==e.avail_in)return b;(i=e.state).mode===D&&(i.mode=N),et=e.next_out,n=e.output,er=e.avail_out,ee=e.next_in,r=e.input,ei=e.avail_in,eo=i.hold,ea=i.bits,el=ei,ed=er,eC=m;t:for(;;)switch(i.mode){case k:if(0===i.wrap){i.mode=N;break}for(;ea<16;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if(2&i.wrap&&35615===eo){0===i.wbits&&(i.wbits=15),i.check=0,eE[0]=255&eo,eE[1]=eo>>>8&255,i.check=s(i.check,eE,2,0),eo=0,ea=0,i.mode=T;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&eo)<<8)+(eo>>8))%31){e.msg="incorrect header check",i.mode=X;break}if((15&eo)!==C){e.msg="unknown compression method",i.mode=X;break}if(eo>>>=4,ea-=4,ew=(15&eo)+8,0===i.wbits&&(i.wbits=ew),ew>15||ew>i.wbits){e.msg="invalid window size",i.mode=X;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&eo?x:D,eo=0,ea=0;break;case T:for(;ea<16;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if(i.flags=eo,(255&i.flags)!==C){e.msg="unknown compression method",i.mode=X;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=X;break}i.head&&(i.head.text=eo>>8&1),512&i.flags&&4&i.wrap&&(eE[0]=255&eo,eE[1]=eo>>>8&255,i.check=s(i.check,eE,2,0)),eo=0,ea=0,i.mode=I;case I:for(;ea<32;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}i.head&&(i.head.time=eo),512&i.flags&&4&i.wrap&&(eE[0]=255&eo,eE[1]=eo>>>8&255,eE[2]=eo>>>16&255,eE[3]=eo>>>24&255,i.check=s(i.check,eE,4,0)),eo=0,ea=0,i.mode=E;case E:for(;ea<16;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}i.head&&(i.head.xflags=255&eo,i.head.os=eo>>8),512&i.flags&&4&i.wrap&&(eE[0]=255&eo,eE[1]=eo>>>8&255,i.check=s(i.check,eE,2,0)),eo=0,ea=0,i.mode=A;case A:if(1024&i.flags){for(;ea<16;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}i.length=eo,i.head&&(i.head.extra_len=eo),512&i.flags&&4&i.wrap&&(eE[0]=255&eo,eE[1]=eo>>>8&255,i.check=s(i.check,eE,2,0)),eo=0,ea=0}else i.head&&(i.head.extra=null);i.mode=M;case M:if(1024&i.flags&&((ec=i.length)>ei&&(ec=ei),ec&&(i.head&&(ew=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(r.subarray(ee,ee+ec),ew)),512&i.flags&&4&i.wrap&&(i.check=s(i.check,r,ec,ee)),ei-=ec,ee+=ec,i.length-=ec),i.length))break t;i.length=0,i.mode=O;case O:if(2048&i.flags){if(0===ei)break t;ec=0;do ew=r[ee+ec++],i.head&&ew&&i.length<65536&&(i.head.name+=String.fromCharCode(ew));while(ew&&ec<ei);if(512&i.flags&&4&i.wrap&&(i.check=s(i.check,r,ec,ee)),ei-=ec,ee+=ec,ew)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=P;case P:if(4096&i.flags){if(0===ei)break t;ec=0;do ew=r[ee+ec++],i.head&&ew&&i.length<65536&&(i.head.comment+=String.fromCharCode(ew));while(ew&&ec<ei);if(512&i.flags&&4&i.wrap&&(i.check=s(i.check,r,ec,ee)),ei-=ec,ee+=ec,ew)break t}else i.head&&(i.head.comment=null);i.mode=_;case _:if(512&i.flags){for(;ea<16;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if(4&i.wrap&&eo!==(65535&i.check)){e.msg="header crc mismatch",i.mode=X;break}eo=0,ea=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=D;break;case x:for(;ea<32;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}e.adler=i.check=en(eo),eo=0,ea=0,i.mode=R;case R:if(0===i.havedict)return e.next_out=et,e.avail_out=er,e.next_in=ee,e.avail_in=ei,i.hold=eo,i.bits=ea,v;e.adler=i.check=1,i.mode=D;case D:if(t===f||t===p)break t;case N:if(i.last){eo>>>=7&ea,ea-=7&ea,i.mode=J;break}for(;ea<3;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}switch(i.last=1&eo,ea-=1,3&(eo>>>=1)){case 0:i.mode=L;break;case 1:if(ef(i),i.mode=$,t===p){eo>>>=2,ea-=2;break t}break;case 2:i.mode=B;break;case 3:e.msg="invalid block type",i.mode=X}eo>>>=2,ea-=2;break;case L:for(eo>>>=7&ea,ea-=7&ea;ea<32;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if((65535&eo)!=(eo>>>16^65535)){e.msg="invalid stored block lengths",i.mode=X;break}if(i.length=65535&eo,eo=0,ea=0,i.mode=F,t===p)break t;case F:i.mode=V;case V:if(ec=i.length){if(ec>ei&&(ec=ei),ec>er&&(ec=er),0===ec)break t;n.set(r.subarray(ee,ee+ec),et),ei-=ec,ee+=ec,er-=ec,et+=ec,i.length-=ec;break}i.mode=D;break;case B:for(;ea<14;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if(i.nlen=(31&eo)+257,eo>>>=5,ea-=5,i.ndist=(31&eo)+1,eo>>>=5,ea-=5,i.ncode=(15&eo)+4,eo>>>=4,ea-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=X;break}i.have=0,i.mode=U;case U:for(;i.have<i.ncode;){for(;ea<3;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}i.lens[eA[i.have++]]=7&eo,eo>>>=3,ea-=3}for(;i.have<19;)i.lens[eA[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,ek={bits:i.lenbits},eC=l(d,i.lens,0,19,i.lencode,0,i.work,ek),i.lenbits=ek.bits,eC){e.msg="invalid code lengths set",i.mode=X;break}i.have=0,i.mode=j;case j:for(;i.have<i.nlen+i.ndist;){for(;em=(eI=i.lencode[eo&(1<<i.lenbits)-1])>>>24,eg=eI>>>16&255,ev=65535&eI,!(em<=ea);){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if(ev<16)eo>>>=em,ea-=em,i.lens[i.have++]=ev;else{if(16===ev){for(eT=em+2;ea<eT;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if(eo>>>=em,ea-=em,0===i.have){e.msg="invalid bit length repeat",i.mode=X;break}ew=i.lens[i.have-1],ec=3+(3&eo),eo>>>=2,ea-=2}else if(17===ev){for(eT=em+3;ea<eT;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}eo>>>=em,ea-=em,ew=0,ec=3+(7&eo),eo>>>=3,ea-=3}else{for(eT=em+7;ea<eT;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}eo>>>=em,ea-=em,ew=0,ec=11+(127&eo),eo>>>=7,ea-=7}if(i.have+ec>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=X;break}for(;ec--;)i.lens[i.have++]=ew}}if(i.mode===X)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=X;break}if(i.lenbits=9,ek={bits:i.lenbits},eC=l(c,i.lens,0,i.nlen,i.lencode,0,i.work,ek),i.lenbits=ek.bits,eC){e.msg="invalid literal/lengths set",i.mode=X;break}if(i.distbits=6,i.distcode=i.distdyn,ek={bits:i.distbits},eC=l(u,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,ek),i.distbits=ek.bits,eC){e.msg="invalid distances set",i.mode=X;break}if(i.mode=$,t===p)break t;case $:i.mode=z;case z:if(ei>=6&&er>=258){e.next_out=et,e.avail_out=er,e.next_in=ee,e.avail_in=ei,i.hold=eo,i.bits=ea,a(e,ed),et=e.next_out,n=e.output,er=e.avail_out,ee=e.next_in,r=e.input,ei=e.avail_in,eo=i.hold,ea=i.bits,i.mode===D&&(i.back=-1);break}for(i.back=0;em=(eI=i.lencode[eo&(1<<i.lenbits)-1])>>>24,eg=eI>>>16&255,ev=65535&eI,!(em<=ea);){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if(eg&&(240&eg)==0){for(eb=em,ey=eg,eS=ev;em=(eI=i.lencode[eS+((eo&(1<<eb+ey)-1)>>eb)])>>>24,eg=eI>>>16&255,ev=65535&eI,!(eb+em<=ea);){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}eo>>>=eb,ea-=eb,i.back+=eb}if(eo>>>=em,ea-=em,i.back+=em,i.length=ev,0===eg){i.mode=q;break}if(32&eg){i.back=-1,i.mode=D;break}if(64&eg){e.msg="invalid literal/length code",i.mode=X;break}i.extra=15&eg,i.mode=H;case H:if(i.extra){for(eT=i.extra;ea<eT;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}i.length+=eo&(1<<i.extra)-1,eo>>>=i.extra,ea-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=W;case W:for(;em=(eI=i.distcode[eo&(1<<i.distbits)-1])>>>24,eg=eI>>>16&255,ev=65535&eI,!(em<=ea);){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if((240&eg)==0){for(eb=em,ey=eg,eS=ev;em=(eI=i.distcode[eS+((eo&(1<<eb+ey)-1)>>eb)])>>>24,eg=eI>>>16&255,ev=65535&eI,!(eb+em<=ea);){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}eo>>>=eb,ea-=eb,i.back+=eb}if(eo>>>=em,ea-=em,i.back+=em,64&eg){e.msg="invalid distance code",i.mode=X;break}i.offset=ev,i.extra=15&eg,i.mode=G;case G:if(i.extra){for(eT=i.extra;ea<eT;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}i.offset+=eo&(1<<i.extra)-1,eo>>>=i.extra,ea-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=X;break}i.mode=K;case K:if(0===er)break t;if(ec=ed-er,i.offset>ec){if((ec=i.offset-ec)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=X;break}ec>i.wnext?(ec-=i.wnext,eu=i.wsize-ec):eu=i.wnext-ec,ec>i.length&&(ec=i.length),eh=i.window}else eh=n,eu=et-i.offset,ec=i.length;ec>er&&(ec=er),er-=ec,i.length-=ec;do n[et++]=eh[eu++];while(--ec);0===i.length&&(i.mode=z);break;case q:if(0===er)break t;n[et++]=i.length,er--,i.mode=z;break;case J:if(i.wrap){for(;ea<32;){if(0===ei)break t;ei--,eo|=r[ee++]<<ea,ea+=8}if(ed-=er,e.total_out+=ed,i.total+=ed,4&i.wrap&&ed&&(e.adler=i.check=i.flags?s(i.check,n,ed,et-ed):o(i.check,n,ed,et-ed)),ed=er,4&i.wrap&&(i.flags?eo:en(eo))!==i.check){e.msg="incorrect data check",i.mode=X;break}eo=0,ea=0}i.mode=Q;case Q:if(i.wrap&&i.flags){for(;ea<32;){if(0===ei)break t;ei--,eo+=r[ee++]<<ea,ea+=8}if(4&i.wrap&&eo!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=X;break}eo=0,ea=0}i.mode=Z;case Z:eC=g;break t;case X:eC=y;break t;case Y:return S;default:return b}return(e.next_out=et,e.avail_out=er,e.next_in=ee,e.avail_in=ei,i.hold=eo,i.bits=ea,(i.wsize||ed!==e.avail_out&&i.mode<X&&(i.mode<J||t!==h))&&ep(e,e.output,e.next_out,ed-e.avail_out))?(i.mode=Y,S):(el-=e.avail_in,ed-=e.avail_out,e.total_in+=el,e.total_out+=ed,i.total+=ed,4&i.wrap&&ed&&(e.adler=i.check=i.flags?s(i.check,n,ed,e.next_out-ed):o(i.check,n,ed,e.next_out-ed)),e.data_type=i.bits+(i.last?64:0)+(i.mode===D?128:0)+(i.mode===$||i.mode===F?256:0),(0===el&&0===ed||t===h)&&eC===m&&(eC=w),eC)},eg=e=>{if(es(e))return b;let t=e.state;return t.window&&(t.window=null),e.state=null,m},ev=(e,t)=>{if(es(e))return b;let i=e.state;return(2&i.wrap)==0?b:(i.head=t,t.done=!1,m)},eb=(e,t)=>{let i,r;let n=t.length;return es(e)||0!==(i=e.state).wrap&&i.mode!==R?b:i.mode===R&&(r=o(r=1,t,n,0))!==i.check?y:ep(e,t,n,n)?(i.mode=Y,S):(i.havedict=1,m)};e.exports.inflateReset=el,e.exports.inflateReset2=ed,e.exports.inflateResetKeep=ea,e.exports.inflateInit=eu,e.exports.inflateInit2=ec,e.exports.inflate=em,e.exports.inflateEnd=eg,e.exports.inflateGetHeader=ev,e.exports.inflateSetDictionary=eb,e.exports.inflateInfo="pako inflate (from Nodeca project)"},9241:function(e){"use strict";let t=15,i=852,r=592,n=0,o=1,s=2,a=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),l=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),d=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),c=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),u=(e,u,h,f,p,m,g,v)=>{let b,y,S,w,C,k,T,I,E;let A=v.bits,M=0,O=0,P=0,_=0,x=0,R=0,D=0,N=0,L=0,F=0,V=null,B=new Uint16Array(t+1),U=new Uint16Array(t+1),j=null;for(M=0;M<=t;M++)B[M]=0;for(O=0;O<f;O++)B[u[h+O]]++;for(x=A,_=t;_>=1&&0===B[_];_--);if(x>_&&(x=_),0===_)return p[m++]=20971520,p[m++]=20971520,v.bits=1,0;for(P=1;P<_&&0===B[P];P++);for(x<P&&(x=P),N=1,M=1;M<=t;M++)if(N<<=1,(N-=B[M])<0)return -1;if(N>0&&(e===n||1!==_))return -1;for(M=1,U[1]=0;M<t;M++)U[M+1]=U[M]+B[M];for(O=0;O<f;O++)0!==u[h+O]&&(g[U[u[h+O]]++]=O);if(e===n?(V=j=g,k=20):e===o?(V=a,j=l,k=257):(V=d,j=c,k=0),F=0,O=0,M=P,C=m,R=x,D=0,S=-1,w=(L=1<<x)-1,e===o&&L>i||e===s&&L>r)return 1;for(;;){T=M-D,g[O]+1<k?(I=0,E=g[O]):g[O]>=k?(I=j[g[O]-k],E=V[g[O]-k]):(I=96,E=0),b=1<<M-D,P=y=1<<R;do p[C+(F>>D)+(y-=b)]=T<<24|I<<16|E|0;while(0!==y);for(b=1<<M-1;F&b;)b>>=1;if(0!==b?(F&=b-1,F+=b):F=0,O++,0==--B[M]){if(M===_)break;M=u[h+g[O]]}if(M>x&&(F&w)!==S){for(0===D&&(D=x),C+=P,N=1<<(R=M-D);R+D<_&&!((N-=B[R+D])<=0);)R++,N<<=1;if(L+=1<<R,e===o&&L>i||e===s&&L>r)return 1;p[S=F&w]=x<<24|R<<16|C-m|0}}return 0!==F&&(p[C+F]=M-D<<24|4194304),v.bits=x,0};e.exports=u},8898:function(e){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:function(e){"use strict";let t,i,r;let n=4,o=0,s=1,a=2;function l(e){let t=e.length;for(;--t>=0;)e[t]=0}let d=0,c=1,u=2,h=3,f=258,p=29,m=256,g=286,v=30,b=19,y=573,S=15,w=16,C=7,k=256,T=16,I=17,E=18,A=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),M=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),O=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_=512,x=Array((g+2)*2);l(x);let R=Array(2*v);l(R);let D=Array(_);l(D);let N=Array(f-h+1);l(N);let L=Array(p);l(L);let F=Array(v);function V(e,t,i,r,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}function B(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}l(F);let U=e=>e<256?D[e]:D[256+(e>>>7)],j=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},$=(e,t,i)=>{e.bi_valid>w-i?(e.bi_buf|=t<<e.bi_valid&65535,j(e,e.bi_buf),e.bi_buf=t>>w-e.bi_valid,e.bi_valid+=i-w):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},z=(e,t,i)=>{$(e,i[2*t],i[2*t+1])},H=(e,t)=>{let i=0;do i|=1&e,e>>>=1,i<<=1;while(--t>0);return i>>>1},W=e=>{16===e.bi_valid?(j(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},G=(e,t)=>{let i,r,n,o,s,a;let l=t.dyn_tree,d=t.max_code,c=t.stat_desc.static_tree,u=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(o=0;o<=S;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<y;i++)(o=l[2*l[2*(r=e.heap[i])+1]+1]+1)>p&&(o=p,m++),l[2*r+1]=o,!(r>d)&&(e.bl_count[o]++,s=0,r>=f&&(s=h[r-f]),a=l[2*r],e.opt_len+=a*(o+s),u&&(e.static_len+=a*(c[2*r+1]+s)));if(0!==m){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(r=e.bl_count[o];0!==r;)!((n=e.heap[--i])>d)&&(l[2*n+1]!==o&&(e.opt_len+=(o-l[2*n+1])*l[2*n],l[2*n+1]=o),r--)}},K=(e,t,i)=>{let r,n;let o=Array(S+1),s=0;for(r=1;r<=S;r++)s=s+i[r-1]<<1,o[r]=s;for(n=0;n<=t;n++){let t=e[2*n+1];0!==t&&(e[2*n]=H(o[t]++,t))}},q=()=>{let e,n,o,s,a;let l=Array(S+1);for(s=0,o=0;s<p-1;s++)for(e=0,L[s]=o;e<1<<A[s];e++)N[o++]=s;for(N[o-1]=s,a=0,s=0;s<16;s++)for(e=0,F[s]=a;e<1<<M[s];e++)D[a++]=s;for(a>>=7;s<v;s++)for(e=0,F[s]=a<<7;e<1<<M[s]-7;e++)D[256+a++]=s;for(n=0;n<=S;n++)l[n]=0;for(e=0;e<=143;)x[2*e+1]=8,e++,l[8]++;for(;e<=255;)x[2*e+1]=9,e++,l[9]++;for(;e<=279;)x[2*e+1]=7,e++,l[7]++;for(;e<=287;)x[2*e+1]=8,e++,l[8]++;for(K(x,g+1,l),e=0;e<v;e++)R[2*e+1]=5,R[2*e]=H(e,5);t=new V(x,A,m+1,g,S),i=new V(R,M,0,v,S),r=new V([],O,0,b,C)},J=e=>{let t;for(t=0;t<g;t++)e.dyn_ltree[2*t]=0;for(t=0;t<v;t++)e.dyn_dtree[2*t]=0;for(t=0;t<b;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*k]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Q=e=>{e.bi_valid>8?j(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Z=(e,t,i,r)=>{let n=2*t,o=2*i;return e[n]<e[o]||e[n]===e[o]&&r[t]<=r[i]},X=(e,t,i)=>{let r=e.heap[i],n=i<<1;for(;n<=e.heap_len&&(n<e.heap_len&&Z(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!Z(t,r,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=r},Y=(e,t,i)=>{let r,n,o,s;let a=0;if(0!==e.sym_next)do r=(255&e.pending_buf[e.sym_buf+a++])+((255&e.pending_buf[e.sym_buf+a++])<<8),n=e.pending_buf[e.sym_buf+a++],0===r?z(e,n,t):(z(e,(o=N[n])+m+1,t),0!==(s=A[o])&&$(e,n-=L[o],s),z(e,o=U(--r),i),0!==(s=M[o])&&$(e,r-=F[o],s));while(a<e.sym_next);z(e,k,t)},ee=(e,t)=>{let i,r,n;let o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,d=-1;for(i=0,e.heap_len=0,e.heap_max=y;i<l;i++)0!==o[2*i]?(e.heap[++e.heap_len]=d=i,e.depth[i]=0):o[2*i+1]=0;for(;e.heap_len<2;)o[2*(n=e.heap[++e.heap_len]=d<2?++d:0)]=1,e.depth[n]=0,e.opt_len--,a&&(e.static_len-=s[2*n+1]);for(t.max_code=d,i=e.heap_len>>1;i>=1;i--)X(e,o,i);n=l;do i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],X(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=r,o[2*n]=o[2*i]+o[2*r],e.depth[n]=(e.depth[i]>=e.depth[r]?e.depth[i]:e.depth[r])+1,o[2*i+1]=o[2*r+1]=n,e.heap[1]=n++,X(e,o,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],G(e,t),K(o,d,e.bl_count)},et=(e,t,i)=>{let r,n;let o=-1,s=t[1],a=0,l=7,d=4;for(0===s&&(l=138,d=3),t[(i+1)*2+1]=65535,r=0;r<=i;r++)n=s,s=t[(r+1)*2+1],++a<l&&n===s||(a<d?e.bl_tree[2*n]+=a:0!==n?(n!==o&&e.bl_tree[2*n]++,e.bl_tree[2*T]++):a<=10?e.bl_tree[2*I]++:e.bl_tree[2*E]++,a=0,o=n,0===s?(l=138,d=3):n===s?(l=6,d=3):(l=7,d=4))},ei=(e,t,i)=>{let r,n;let o=-1,s=t[1],a=0,l=7,d=4;for(0===s&&(l=138,d=3),r=0;r<=i;r++)if(n=s,s=t[(r+1)*2+1],!(++a<l)||n!==s){if(a<d)do z(e,n,e.bl_tree);while(0!=--a);else 0!==n?(n!==o&&(z(e,n,e.bl_tree),a--),z(e,T,e.bl_tree),$(e,a-3,2)):a<=10?(z(e,I,e.bl_tree),$(e,a-3,3)):(z(e,E,e.bl_tree),$(e,a-11,7));a=0,o=n,0===s?(l=138,d=3):n===s?(l=6,d=3):(l=7,d=4)}},er=e=>{let t;for(et(e,e.dyn_ltree,e.l_desc.max_code),et(e,e.dyn_dtree,e.d_desc.max_code),ee(e,e.bl_desc),t=b-1;t>=3&&0===e.bl_tree[2*P[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t},en=(e,t,i,r)=>{let n;for($(e,t-257,5),$(e,i-1,5),$(e,r-4,4),n=0;n<r;n++)$(e,e.bl_tree[2*P[n]+1],3);ei(e,e.dyn_ltree,t-1),ei(e,e.dyn_dtree,i-1)},eo=e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return o;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return s;for(t=32;t<m;t++)if(0!==e.dyn_ltree[2*t])return s;return o},es=!1,ea=e=>{es||(q(),es=!0),e.l_desc=new B(e.dyn_ltree,t),e.d_desc=new B(e.dyn_dtree,i),e.bl_desc=new B(e.bl_tree,r),e.bi_buf=0,e.bi_valid=0,J(e)},el=(e,t,i,r)=>{$(e,(d<<1)+(r?1:0),3),Q(e),j(e,i),j(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i},ed=e=>{$(e,c<<1,3),z(e,k,x),W(e)},ec=(e,t,i,r)=>{let o,s;let l=0;e.level>0?(e.strm.data_type===a&&(e.strm.data_type=eo(e)),ee(e,e.l_desc),ee(e,e.d_desc),l=er(e),o=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=o&&(o=s)):o=s=i+5,i+4<=o&&-1!==t?el(e,t,i,r):e.strategy===n||s===o?($(e,(c<<1)+(r?1:0),3),Y(e,x,R)):($(e,(u<<1)+(r?1:0),3),en(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),Y(e,e.dyn_ltree,e.dyn_dtree)),J(e),r&&Q(e)},eu=(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[(N[i]+m+1)*2]++,e.dyn_dtree[2*U(t)]++),e.sym_next===e.sym_end);e.exports._tr_init=ea,e.exports._tr_stored_block=el,e.exports._tr_flush_block=ec,e.exports._tr_tally=eu,e.exports._tr_align=ed},2292:function(e){"use strict";function t(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=t},2100:function(e,t,i){"use strict";e.exports=i(9482)},9482:function(e,t,i){"use strict";var r=t;function n(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=i(1173),r.BufferWriter=i(3155),r.Reader=i(1408),r.BufferReader=i(593),r.util=i(9693),r.rpc=i(5994),r.roots=i(5054),r.configure=n,n()},1408:function(e,t,i){"use strict";e.exports=l;var r,n=i(9693),o=n.LongBits,s=n.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var d="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},c=function(){return n.Buffer?function(e){return(l.create=function(e){return n.Buffer.isBuffer(e)?new r(e):d(e)})(e)}:d};function u(){var e=new o(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new o(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}l.create=c(),l.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,l.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return h(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|h(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw a(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,i);if(t===i){var r=n.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,i)},l.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do if(this.pos>=this.len)throw a(this);while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){r=e,l.create=c(),r._configure();var t=n.Long?"toLong":"toNumber";n.merge(l.prototype,{int64:function(){return u.call(this)[t](!1)},uint64:function(){return u.call(this)[t](!0)},sint64:function(){return u.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},593:function(e,t,i){"use strict";e.exports=o;var r=i(1408);(o.prototype=Object.create(r.prototype)).constructor=o;var n=i(9693);function o(e){r.call(this,e)}o._configure=function(){n.Buffer&&(o.prototype._slice=n.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},5054:function(e){"use strict";e.exports={}},5994:function(e,t,i){"use strict";t.Service=i(7948)},7948:function(e,t,i){"use strict";e.exports=n;var r=i(9693);function n(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!i}(n.prototype=Object.create(r.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,i,n,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,i,n,o);if(!a.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return a.rpcImpl(t,i[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(e,i){if(e)return a.emit("error",e,t),s(e);if(null===i){a.end(!0);return}if(!(i instanceof n))try{i=n[a.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",i,t),s(null,i)})}catch(e){a.emit("error",e,t),setTimeout(function(){s(e)},0);return}},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:function(e,t,i){"use strict";e.exports=n;var r=i(9693);function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=n.zero=new n(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var i=e>>>0,r=(e-i)/4294967296>>>0;return t&&(r=~r>>>0,i=~i>>>0,++i>4294967295&&(i=0,++r>4294967295&&(r=0))),new n(i,r)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(r.isString(e)){if(!r.Long)return n.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):o},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var a=String.prototype.charCodeAt;n.fromHash=function(e){return e===s?o:new n((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},9693:function(e,t,i){"use strict";var r=t;function n(e,t,i){for(var r=Object.keys(t),n=0;n<r.length;++n)void 0!==e[r[n]]&&i||(e[r[n]]=t[r[n]]);return e}function o(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:Error().stack||""}),i&&n(this,i)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}r.asPromise=i(4537),r.base64=i(7419),r.EventEmitter=i(9211),r.float=i(945),r.inquire=i(7199),r.utf8=i(4997),r.pool=i(6662),r.LongBits=i(1945),r.isNode=!!(void 0!==i.g&&i.g&&i.g.process&&i.g.process.versions&&i.g.process.versions.node),r.global=r.isNode&&i.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var i=e[t];return!!(null!=i&&e.hasOwnProperty(t))&&("object"!=typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var i=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(i.lo,i.hi,t):i.toNumber(!!t)},r.merge=n,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},r.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;if(!e){r._Buffer_from=r._Buffer_allocUnsafe=null;return}r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}}},1173:function(e,t,i){"use strict";e.exports=u;var r,n=i(9693),o=n.LongBits,s=n.base64,a=n.utf8;function l(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function d(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new l(d,0,0),this.tail=this.head,this.states=null}var h=function(){return n.Buffer?function(){return(u.create=function(){return new r})()}:function(){return new u}};function f(e,t,i){t[i]=255&e}function p(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e}function m(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function v(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}u.create=h(),u.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(u.alloc=n.pool(u.alloc,n.Array.prototype.subarray)),u.prototype._push=function(e,t,i){return this.tail=this.tail.next=new l(e,t,i),this.len+=t,this},m.prototype=Object.create(l.prototype),m.prototype.fn=p,u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new m((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(g,10,o.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=o.from(e);return this._push(g,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(g,t.length(),t)},u.prototype.bool=function(e){return this._push(f,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(v,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=o.from(e);return this._push(v,4,t.lo)._push(v,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var b=n.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var r=0;r<e.length;++r)t[i+r]=e[r]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(n.isString(e)){var i=u.alloc(t=s.length(e));s.decode(e,i,0),e=i}return this.uint32(t)._push(b,t,e)},u.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},u.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(d,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(d,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},u._configure=function(e){r=e,u.create=h(),r._configure()}},3155:function(e,t,i){"use strict";e.exports=o;var r=i(1173);(o.prototype=Object.create(r.prototype)).constructor=o;var n=i(9693);function o(){r.call(this)}function s(e,t,i){e.length<40?n.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}o._configure=function(){o.alloc=n._Buffer_allocUnsafe,o.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var r=0;r<e.length;)t[i++]=e[r++]}},o.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},6774:function(e){e.exports=function(e,t,i,r){var n=i?i.call(r,e,t):void 0;if(void 0!==n)return!!n;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),l=0;l<o.length;l++){var d=o[l];if(!a(d))return!1;var c=e[d],u=t[d];if(!1===(n=i?i.call(r,c,u,d):void 0)||void 0===n&&c!==u)return!1}return!0}},1686:function(e,t,i){"use strict";i.d(t,{f6:function(){return tB},vJ:function(){return tJ},iv:function(){return tH},ZP:function(){return tK},F4:function(){return tQ}});var r=function(){return(r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function n(e,t,i){if(i||2==arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var o=i(7294),s=i(6774),a=i.n(s),l="-ms-",d="-moz-",c="-webkit-",u="comm",h="rule",f="decl",p="@import",m="@keyframes",g="@layer",v=Math.abs,b=String.fromCharCode,y=Object.assign;function S(e,t){return 45^I(e,0)?(((t<<2^I(e,0))<<2^I(e,1))<<2^I(e,2))<<2^I(e,3):0}function w(e){return e.trim()}function C(e,t){return(e=t.exec(e))?e[0]:e}function k(e,t,i){return e.replace(t,i)}function T(e,t,i){return e.indexOf(t,i)}function I(e,t){return 0|e.charCodeAt(t)}function E(e,t,i){return e.slice(t,i)}function A(e){return e.length}function M(e){return e.length}function O(e,t){return t.push(e),e}function P(e,t){return e.map(t).join("")}function _(e,t){return e.filter(function(e){return!C(e,t)})}var x=1,R=1,D=0,N=0,L=0,F="";function V(e,t,i,r,n,o,s,a){return{value:e,root:t,parent:i,type:r,props:n,children:o,line:x,column:R,length:s,return:"",siblings:a}}function B(e,t){return y(V("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function U(e){for(;e.root;)e=B(e.root,{children:[e]});O(e,e.siblings)}function j(){return L}function $(){return L=N>0?I(F,--N):0,R--,10===L&&(R=1,x--),L}function z(){return L=N<D?I(F,N++):0,R++,10===L&&(R=1,x++),L}function H(){return I(F,N)}function W(){return N}function G(e,t){return E(F,e,t)}function K(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function q(e){return x=R=1,D=A(F=e),N=0,[]}function J(e){return F="",e}function Q(e){return w(G(N-1,Y(91===e?e+2:40===e?e+1:e)))}function Z(e){for(;L=H();)if(L<33)z();else break;return K(e)>2||K(L)>3?"":" "}function X(e,t){for(;--t&&z()&&!(L<48)&&!(L>102)&&(!(L>57)||!(L<65))&&(!(L>70)||!(L<97)););return G(e,W()+(t<6&&32==H()&&32==z()))}function Y(e){for(;z();)switch(L){case e:return N;case 34:case 39:34!==e&&39!==e&&Y(L);break;case 40:41===e&&Y(e);break;case 92:z()}return N}function ee(e,t){for(;z();)if(e+L===57)break;else if(e+L===84&&47===H())break;return"/*"+G(t,N-1)+"*"+b(47===e?e:z())}function et(e){for(;!K(H());)z();return G(e,N)}function ei(e,t){for(var i="",r=0;r<e.length;r++)i+=t(e[r],r,e,t)||"";return i}function er(e,t,i,r){switch(e.type){case g:if(e.children.length)break;case p:case f:return e.return=e.return||e.value;case u:return"";case m:return e.return=e.value+"{"+ei(e.children,r)+"}";case h:if(!A(e.value=e.props.join(",")))return""}return A(i=ei(e.children,r))?e.return=e.value+"{"+i+"}":""}function en(e,t,i){switch(S(e,t)){case 5103:return c+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return c+e+e;case 4789:return d+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return c+e+d+e+l+e+e;case 5936:switch(I(e,t+11)){case 114:return c+e+l+k(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return c+e+l+k(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return c+e+l+k(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return c+e+l+e+e;case 6165:return c+e+l+"flex-"+e+e;case 5187:return c+e+k(e,/(\w+).+(:[^]+)/,c+"box-$1$2"+l+"flex-$1$2")+e;case 5443:return c+e+l+"flex-item-"+k(e,/flex-|-self/g,"")+(C(e,/flex-|baseline/)?"":l+"grid-row-"+k(e,/flex-|-self/g,""))+e;case 4675:return c+e+l+"flex-line-pack"+k(e,/align-content|flex-|-self/g,"")+e;case 5548:return c+e+l+k(e,"shrink","negative")+e;case 5292:return c+e+l+k(e,"basis","preferred-size")+e;case 6060:return c+"box-"+k(e,"-grow","")+c+e+l+k(e,"grow","positive")+e;case 4554:return c+k(e,/([^-])(transform)/g,"$1"+c+"$2")+e;case 6187:return k(k(k(e,/(zoom-|grab)/,c+"$1"),/(image-set)/,c+"$1"),e,"")+e;case 5495:case 3959:return k(e,/(image-set\([^]*)/,c+"$1$`$1");case 4968:return k(k(e,/(.+:)(flex-)?(.*)/,c+"box-pack:$3"+l+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+c+e+e;case 4200:if(!C(e,/flex-|baseline/))return l+"grid-column-align"+E(e,t)+e;break;case 2592:case 3360:return l+k(e,"template-","")+e;case 4384:case 3616:if(i&&i.some(function(e,i){return t=i,C(e.props,/grid-\w+-end/)}))return~T(e+(i=i[t].value),"span",0)?e:l+k(e,"-start","")+e+l+"grid-row-span:"+(~T(i,"span",0)?C(i,/\d+/):+C(i,/\d+/)-+C(e,/\d+/))+";";return l+k(e,"-start","")+e;case 4896:case 4128:return i&&i.some(function(e){return C(e.props,/grid-\w+-start/)})?e:l+k(k(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return k(e,/(.+)-inline(.+)/,c+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(A(e)-1-t>6)switch(I(e,t+1)){case 109:if(45!==I(e,t+4))break;case 102:return k(e,/(.+:)(.+)-([^]+)/,"$1"+c+"$2-$3$1"+d+(108==I(e,t+3)?"$3":"$2-$3"))+e;case 115:return~T(e,"stretch",0)?en(k(e,"stretch","fill-available"),t,i)+e:e}break;case 5152:case 5920:return k(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(t,i,r,n,o,s,a){return l+i+":"+r+a+(n?l+i+"-span:"+(o?s:+s-+r)+a:"")+e});case 4949:if(121===I(e,t+6))return k(e,":",":"+c)+e;break;case 6444:switch(I(e,45===I(e,14)?18:11)){case 120:return k(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+c+(45===I(e,14)?"inline-":"")+"box$3$1"+c+"$2$3$1"+l+"$2box$3")+e;case 100:return k(e,":",":"+l)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return k(e,"scroll-","scroll-snap-")+e}return e}function eo(e){var t=M(e);return function(i,r,n,o){for(var s="",a=0;a<t;a++)s+=e[a](i,r,n,o)||"";return s}}function es(e){return function(t){!t.root&&(t=t.return)&&e(t)}}function ea(e,t,i,r){if(e.length>-1&&!e.return)switch(e.type){case f:e.return=en(e.value,e.length,i);return;case m:return ei([B(e,{value:k(e.value,"@","@"+c)})],r);case h:if(e.length)return P(i=e.props,function(t){switch(C(t,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":U(B(e,{props:[k(t,/:(read-\w+)/,":"+d+"$1")]})),U(B(e,{props:[t]})),y(e,{props:_(i,r)});break;case"::placeholder":U(B(e,{props:[k(t,/:(plac\w+)/,":"+c+"input-$1")]})),U(B(e,{props:[k(t,/:(plac\w+)/,":"+d+"$1")]})),U(B(e,{props:[k(t,/:(plac\w+)/,l+"input-$1")]})),U(B(e,{props:[t]})),y(e,{props:_(i,r)})}return""})}}function el(e){return J(ed("",null,null,null,[""],e=q(e),0,[0],e))}function ed(e,t,i,r,n,o,s,a,l){for(var d=0,c=0,u=s,h=0,f=0,p=0,m=1,g=1,y=1,S=0,w="",C=n,E=o,M=r,P=w;g;)switch(p=S,S=z()){case 40:if(108!=p&&58==I(P,u-1)){-1!=T(P+=k(Q(S),"&","&\f"),"&\f",v(d?a[d-1]:0))&&(y=-1);break}case 34:case 39:case 91:P+=Q(S);break;case 9:case 10:case 13:case 32:P+=Z(p);break;case 92:P+=X(W()-1,7);continue;case 47:switch(H()){case 42:case 47:O(eu(ee(z(),W()),t,i,l),l);break;default:P+="/"}break;case 123*m:a[d++]=A(P)*y;case 125*m:case 59:case 0:switch(S){case 0:case 125:g=0;case 59+c:-1==y&&(P=k(P,/\f/g,"")),f>0&&A(P)-u&&O(f>32?eh(P+";",r,i,u-1,l):eh(k(P," ","")+";",r,i,u-2,l),l);break;case 59:P+=";";default:if(O(M=ec(P,t,i,d,c,n,a,w,C=[],E=[],u,o),o),123===S){if(0===c)ed(P,t,M,M,C,o,u,a,E);else switch(99===h&&110===I(P,3)?100:h){case 100:case 108:case 109:case 115:ed(e,M,M,r&&O(ec(e,M,M,0,0,n,a,w,n,C=[],u,E),E),n,E,u,a,r?C:E);break;default:ed(P,M,M,M,[""],E,0,a,E)}}}d=c=f=0,m=y=1,w=P="",u=s;break;case 58:u=1+A(P),f=p;default:if(m<1){if(123==S)--m;else if(125==S&&0==m++&&125==$())continue}switch(P+=b(S),S*m){case 38:y=c>0?1:(P+="\f",-1);break;case 44:a[d++]=(A(P)-1)*y,y=1;break;case 64:45===H()&&(P+=Q(z())),h=H(),c=u=A(w=P+=et(W())),S++;break;case 45:45===p&&2==A(P)&&(m=0)}}return o}function ec(e,t,i,r,n,o,s,a,l,d,c,u){for(var f=n-1,p=0===n?o:[""],m=M(p),g=0,b=0,y=0;g<r;++g)for(var S=0,C=E(e,f+1,f=v(b=s[g])),T=e;S<m;++S)(T=w(b>0?p[S]+" "+C:k(C,/&\f/g,p[S])))&&(l[y++]=T);return V(e,t,i,0===n?h:a,l,d,c,u)}function eu(e,t,i,r){return V(e,t,i,u,b(j()),E(e,2,-2),0,r)}function eh(e,t,i,r,n){return V(e,t,i,f,E(e,0,r),E(e,r+1,-1),r,n)}var ef={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ep=i(3454),em=void 0!==ep&&void 0!==ep.env&&(ep.env.REACT_APP_SC_ATTR||ep.env.SC_ATTR)||"data-styled",eg="active",ev="data-styled-version",eb="6.1.19",ey="/*!sc*/\n",eS="undefined"!=typeof window&&"undefined"!=typeof document,ew=!!("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:void 0!==ep&&void 0!==ep.env&&void 0!==ep.env.REACT_APP_SC_DISABLE_SPEEDY&&""!==ep.env.REACT_APP_SC_DISABLE_SPEEDY?"false"!==ep.env.REACT_APP_SC_DISABLE_SPEEDY&&ep.env.REACT_APP_SC_DISABLE_SPEEDY:void 0!==ep&&void 0!==ep.env&&void 0!==ep.env.SC_DISABLE_SPEEDY&&""!==ep.env.SC_DISABLE_SPEEDY&&"false"!==ep.env.SC_DISABLE_SPEEDY&&ep.env.SC_DISABLE_SPEEDY),eC={},ek=Object.freeze([]),eT=Object.freeze({});function eI(e,t,i){return void 0===i&&(i=eT),e.theme!==i.theme&&e.theme||t||i.theme}var eE=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),eA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,eM=/(^-|-$)/g;function eO(e){return e.replace(eA,"-").replace(eM,"")}var eP=/(a)(d)/gi,e_=52,ex=function(e){return String.fromCharCode(e+(e>25?39:97))};function eR(e){var t,i="";for(t=Math.abs(e);t>e_;t=t/e_|0)i=ex(t%e_)+i;return(ex(t%e_)+i).replace(eP,"$1-$2")}var eD,eN=5381,eL=function(e,t){for(var i=t.length;i;)e=33*e^t.charCodeAt(--i);return e},eF=function(e){return eL(eN,e)};function eV(e){return eR(eF(e)>>>0)}function eB(e){return e.displayName||e.name||"Component"}function eU(e){return"string"==typeof e}var ej="function"==typeof Symbol&&Symbol.for,e$=ej?Symbol.for("react.memo"):60115,ez=ej?Symbol.for("react.forward_ref"):60112,eH={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},eW={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},eG={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},eK=((eD={})[ez]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},eD[e$]=eG,eD);function eq(e){var t;return("type"in(t=e)&&t.type.$$typeof)===e$?eG:"$$typeof"in e?eK[e.$$typeof]:eH}var eJ=Object.defineProperty,eQ=Object.getOwnPropertyNames,eZ=Object.getOwnPropertySymbols,eX=Object.getOwnPropertyDescriptor,eY=Object.getPrototypeOf,e0=Object.prototype;function e1(e,t,i){if("string"!=typeof t){if(e0){var r=eY(t);r&&r!==e0&&e1(e,r,i)}var n=eQ(t);eZ&&(n=n.concat(eZ(t)));for(var o=eq(e),s=eq(t),a=0;a<n.length;++a){var l=n[a];if(!(l in eW||i&&i[l]||s&&l in s||o&&l in o)){var d=eX(t,l);try{eJ(e,l,d)}catch(e){}}}}return e}function e2(e){return"function"==typeof e}function e3(e){return"object"==typeof e&&"styledComponentId"in e}function e5(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function e4(e,t){if(0===e.length)return"";for(var i=e[0],r=1;r<e.length;r++)i+=t?t+e[r]:e[r];return i}function e6(e){return null!==e&&"object"==typeof e&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function e8(e,t,i){if(void 0===i&&(i=!1),!i&&!e6(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)e[r]=e8(e[r],t[r]);else if(e6(t))for(var r in t)e[r]=e8(e[r],t[r]);return e}function e7(e,t){Object.defineProperty(e,"toString",{value:t})}function e9(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var te=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return e.prototype.indexOfGroup=function(e){for(var t=0,i=0;i<e;i++)t+=this.groupSizes[i];return t},e.prototype.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var i=this.groupSizes,r=i.length,n=r;e>=n;)if((n<<=1)<0)throw e9(16,"".concat(e));this.groupSizes=new Uint32Array(n),this.groupSizes.set(i),this.length=n;for(var o=r;o<n;o++)this.groupSizes[o]=0}for(var s=this.indexOfGroup(e+1),a=(o=0,t.length);o<a;o++)this.tag.insertRule(s,t[o])&&(this.groupSizes[e]++,s++)},e.prototype.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],i=this.indexOfGroup(e),r=i+t;this.groupSizes[e]=0;for(var n=i;n<r;n++)this.tag.deleteRule(i)}},e.prototype.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var i=this.groupSizes[e],r=this.indexOfGroup(e),n=r+i,o=r;o<n;o++)t+="".concat(this.tag.getRule(o)).concat(ey);return t},e}(),tt=new Map,ti=new Map,tr=1,tn=function(e){if(tt.has(e))return tt.get(e);for(;ti.has(tr);)tr++;var t=tr++;return tt.set(e,t),ti.set(t,e),t},to=function(e,t){tr=t+1,tt.set(e,t),ti.set(t,e)},ts="style[".concat(em,"][").concat(ev,'="').concat(eb,'"]'),ta=new RegExp("^".concat(em,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),tl=function(e,t,i){for(var r,n=i.split(","),o=0,s=n.length;o<s;o++)(r=n[o])&&e.registerName(t,r)},td=function(e,t){for(var i,r=(null!==(i=t.textContent)&&void 0!==i?i:"").split(ey),n=[],o=0,s=r.length;o<s;o++){var a=r[o].trim();if(a){var l=a.match(ta);if(l){var d=0|parseInt(l[1],10),c=l[2];0!==d&&(to(c,d),tl(e,c,l[3]),e.getTag().insertRules(d,n)),n.length=0}else n.push(a)}}},tc=function(e){for(var t=document.querySelectorAll(ts),i=0,r=t.length;i<r;i++){var n=t[i];n&&n.getAttribute(em)!==eg&&(td(e,n),n.parentNode&&n.parentNode.removeChild(n))}};function tu(){return i.nc}var th=function(e){var t=document.head,i=e||t,r=document.createElement("style"),n=function(e){var t=Array.from(e.querySelectorAll("style[".concat(em,"]")));return t[t.length-1]}(i),o=void 0!==n?n.nextSibling:null;r.setAttribute(em,eg),r.setAttribute(ev,eb);var s=tu();return s&&r.setAttribute("nonce",s),i.insertBefore(r,o),r},tf=function(){function e(e){this.element=th(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,i=0,r=t.length;i<r;i++){var n=t[i];if(n.ownerNode===e)return n}throw e9(17)}(this.element),this.length=0}return e.prototype.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},e.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},e.prototype.getRule=function(e){var t=this.sheet.cssRules[e];return t&&t.cssText?t.cssText:""},e}(),tp=function(){function e(e){this.element=th(e),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(e,t){if(e<=this.length&&e>=0){var i=document.createTextNode(t);return this.element.insertBefore(i,this.nodes[e]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},e.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),tm=function(){function e(e){this.rules=[],this.length=0}return e.prototype.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},e.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},e.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),tg=eS,tv={isServer:!eS,useCSSOMInjection:!ew},tb=function(){function e(e,t,i){void 0===e&&(e=eT),void 0===t&&(t={});var n=this;this.options=r(r({},tv),e),this.gs=t,this.names=new Map(i),this.server=!!e.isServer,!this.server&&eS&&tg&&(tg=!1,tc(this)),e7(this,function(){return function(e){for(var t=e.getTag(),i=t.length,r="",n=function(i){var n=function(e){return ti.get(e)}(i);if(void 0===n)return"continue";var o=e.names.get(n),s=t.getGroup(i);if(void 0===o||!o.size||0===s.length)return"continue";var a="".concat(em,".g").concat(i,'[id="').concat(n,'"]'),l="";void 0!==o&&o.forEach(function(e){e.length>0&&(l+="".concat(e,","))}),r+="".concat(s).concat(a,'{content:"').concat(l,'"}').concat(ey)},o=0;o<i;o++)n(o);return r}(n)})}return e.registerId=function(e){return tn(e)},e.prototype.rehydrate=function(){!this.server&&eS&&tc(this)},e.prototype.reconstructWithOptions=function(t,i){return void 0===i&&(i=!0),new e(r(r({},this.options),t),this.gs,i&&this.names||void 0)},e.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=new te(function(e){var t=e.useCSSOMInjection,i=e.target;return e.isServer?new tm(i):t?new tf(i):new tp(i)}(this.options)))},e.prototype.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},e.prototype.registerName=function(e,t){if(tn(e),this.names.has(e))this.names.get(e).add(t);else{var i=new Set;i.add(t),this.names.set(e,i)}},e.prototype.insertRules=function(e,t,i){this.registerName(e,t),this.getTag().insertRules(tn(e),i)},e.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},e.prototype.clearRules=function(e){this.getTag().clearGroup(tn(e)),this.clearNames(e)},e.prototype.clearTag=function(){this.tag=void 0},e}(),ty=/&/g,tS=/^\s*\/\/.*$/gm;function tw(e,t){return e.map(function(e){return"rule"===e.type&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map(function(e){return"".concat(t," ").concat(e)})),Array.isArray(e.children)&&"@keyframes"!==e.type&&(e.children=tw(e.children,t)),e})}function tC(e){var t,i,r,n=void 0===e?eT:e,o=n.options,s=void 0===o?eT:o,a=n.plugins,l=void 0===a?ek:a,d=function(e,r,n){return n.startsWith(i)&&n.endsWith(i)&&n.replaceAll(i,"").length>0?".".concat(t):e},c=l.slice();c.push(function(e){e.type===h&&e.value.includes("&")&&(e.props[0]=e.props[0].replace(ty,i).replace(r,d))}),s.prefix&&c.push(ea),c.push(er);var u=function(e,n,o,a){void 0===n&&(n=""),void 0===o&&(o=""),void 0===a&&(a="&"),t=a,i=n,r=RegExp("\\".concat(i,"\\b"),"g");var l=e.replace(tS,""),d=el(o||n?"".concat(o," ").concat(n," { ").concat(l," }"):l);s.namespace&&(d=tw(d,s.namespace));var u=[];return ei(d,eo(c.concat(es(function(e){return u.push(e)})))),u};return u.hash=l.length?l.reduce(function(e,t){return t.name||e9(15),eL(e,t.name)},eN).toString():"",u}var tk=new tb,tT=tC(),tI=o.createContext({shouldForwardProp:void 0,styleSheet:tk,stylis:tT}),tE=(tI.Consumer,o.createContext(void 0));function tA(){return(0,o.useContext)(tI)}function tM(e){var t=(0,o.useState)(e.stylisPlugins),i=t[0],r=t[1],n=tA().styleSheet,s=(0,o.useMemo)(function(){var t=n;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t},[e.disableCSSOMInjection,e.sheet,e.target,n]),l=(0,o.useMemo)(function(){return tC({options:{namespace:e.namespace,prefix:e.enableVendorPrefixes},plugins:i})},[e.enableVendorPrefixes,e.namespace,i]);(0,o.useEffect)(function(){a()(i,e.stylisPlugins)||r(e.stylisPlugins)},[e.stylisPlugins]);var d=(0,o.useMemo)(function(){return{shouldForwardProp:e.shouldForwardProp,styleSheet:s,stylis:l}},[e.shouldForwardProp,s,l]);return o.createElement(tI.Provider,{value:d},o.createElement(tE.Provider,{value:l},e.children))}var tO=function(){function e(e,t){var i=this;this.inject=function(e,t){void 0===t&&(t=tT);var r=i.name+t.hash;e.hasNameForId(i.id,r)||e.insertRules(i.id,r,t(i.rules,r,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=t,e7(this,function(){throw e9(12,String(i.name))})}return e.prototype.getName=function(e){return void 0===e&&(e=tT),this.name+e.hash},e}(),tP=function(e){return e>="A"&&e<="Z"};function t_(e){for(var t="",i=0;i<e.length;i++){var r=e[i];if(1===i&&"-"===r&&"-"===e[0])return e;tP(r)?t+="-"+r.toLowerCase():t+=r}return t.startsWith("ms-")?"-"+t:t}var tx=function(e){return null==e||!1===e||""===e},tR=function(e){var t,i,r=[];for(var o in e){var s=e[o];e.hasOwnProperty(o)&&!tx(s)&&(Array.isArray(s)&&s.isCss||e2(s)?r.push("".concat(t_(o),":"),s,";"):e6(s)?r.push.apply(r,n(n(["".concat(o," {")],tR(s),!1),["}"],!1)):r.push("".concat(t_(o),": ").concat((t=o,null==(i=s)||"boolean"==typeof i||""===i?"":"number"!=typeof i||0===i||t in ef||t.startsWith("--")?String(i).trim():"".concat(i,"px")),";")))}return r};function tD(e,t,i,r){if(tx(e))return[];if(e3(e))return[".".concat(e.styledComponentId)];if(e2(e)){var n;return!e2(n=e)||n.prototype&&n.prototype.isReactComponent||!t?[e]:tD(e(t),t,i,r)}return e instanceof tO?i?(e.inject(i,r),[e.getName(r)]):[e]:e6(e)?tR(e):Array.isArray(e)?Array.prototype.concat.apply(ek,e.map(function(e){return tD(e,t,i,r)})):[e.toString()]}function tN(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(e2(i)&&!e3(i))return!1}return!0}var tL=eF(eb),tF=function(){function e(e,t,i){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===i||i.isStatic)&&tN(e),this.componentId=t,this.baseHash=eL(tL,t),this.baseStyle=i,tb.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,i){var r=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,t,i):"";if(this.isStatic&&!i.hash){if(this.staticRulesId&&t.hasNameForId(this.componentId,this.staticRulesId))r=e5(r,this.staticRulesId);else{var n=e4(tD(this.rules,e,t,i)),o=eR(eL(this.baseHash,n)>>>0);if(!t.hasNameForId(this.componentId,o)){var s=i(n,".".concat(o),void 0,this.componentId);t.insertRules(this.componentId,o,s)}r=e5(r,o),this.staticRulesId=o}}else{for(var a=eL(this.baseHash,i.hash),l="",d=0;d<this.rules.length;d++){var c=this.rules[d];if("string"==typeof c)l+=c;else if(c){var u=e4(tD(c,e,t,i));a=eL(a,u+d),l+=u}}if(l){var h=eR(a>>>0);t.hasNameForId(this.componentId,h)||t.insertRules(this.componentId,h,i(l,".".concat(h),void 0,this.componentId)),r=e5(r,h)}}return r},e}(),tV=o.createContext(void 0);function tB(e){var t=o.useContext(tV),i=(0,o.useMemo)(function(){return function(e,t){if(!e)throw e9(14);if(e2(e))return e(t);if(Array.isArray(e)||"object"!=typeof e)throw e9(8);return t?r(r({},t),e):e}(e.theme,t)},[e.theme,t]);return e.children?o.createElement(tV.Provider,{value:i},e.children):null}tV.Consumer;var tU={};function tj(e,t,i){var n=e3(e),s=e,a=!eU(e),l=t.attrs,d=void 0===l?ek:l,c=t.componentId,u=void 0===c?function(e,t){var i="string"!=typeof e?"sc":eO(e);tU[i]=(tU[i]||0)+1;var r="".concat(i,"-").concat(eV(eb+i+tU[i]));return t?"".concat(t,"-").concat(r):r}(t.displayName,t.parentComponentId):c,h=t.displayName,f=void 0===h?function(e){return eU(e)?"styled.".concat(e):"Styled(".concat(eB(e),")")}(e):h,p=t.displayName&&t.componentId?"".concat(eO(t.displayName),"-").concat(t.componentId):t.componentId||u,m=n&&s.attrs?s.attrs.concat(d).filter(Boolean):d,g=t.shouldForwardProp;if(n&&s.shouldForwardProp){var v=s.shouldForwardProp;if(t.shouldForwardProp){var b=t.shouldForwardProp;g=function(e,t){return v(e,t)&&b(e,t)}}else g=v}var y=new tF(i,p,n?s.componentStyle:void 0);function S(e,t){return function(e,t,i){var n=e.attrs,s=e.componentStyle,a=e.defaultProps,l=e.foldedComponentIds,d=e.styledComponentId,c=e.target,u=o.useContext(tV),h=tA(),f=e.shouldForwardProp||h.shouldForwardProp,p=eI(t,u,a)||eT,m=function(e,t,i){for(var n,o=r(r({},t),{className:void 0,theme:i}),s=0;s<e.length;s+=1){var a=e2(n=e[s])?n(o):n;for(var l in a)o[l]="className"===l?e5(o[l],a[l]):"style"===l?r(r({},o[l]),a[l]):a[l]}return t.className&&(o.className=e5(o.className,t.className)),o}(n,t,p),g=m.as||c,v={};for(var b in m)void 0===m[b]||"$"===b[0]||"as"===b||"theme"===b&&m.theme===p||("forwardedAs"===b?v.as=m.forwardedAs:f&&!f(b,g)||(v[b]=m[b]));var y=function(e,t){var i=tA();return e.generateAndInjectStyles(t,i.styleSheet,i.stylis)}(s,m),S=e5(l,d);return y&&(S+=" "+y),m.className&&(S+=" "+m.className),v[eU(g)&&!eE.has(g)?"class":"className"]=S,i&&(v.ref=i),(0,o.createElement)(g,v)}(w,e,t)}S.displayName=f;var w=o.forwardRef(S);return w.attrs=m,w.componentStyle=y,w.displayName=f,w.shouldForwardProp=g,w.foldedComponentIds=n?e5(s.foldedComponentIds,s.styledComponentId):"",w.styledComponentId=p,w.target=n?s.target:e,Object.defineProperty(w,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(e){this._foldedDefaultProps=n?function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];for(var r=0,n=t;r<n.length;r++)e8(e,n[r],!0);return e}({},s.defaultProps,e):e}}),e7(w,function(){return".".concat(w.styledComponentId)}),a&&e1(w,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),w}function t$(e,t){for(var i=[e[0]],r=0,n=t.length;r<n;r+=1)i.push(t[r],e[r+1]);return i}var tz=function(e){return Object.assign(e,{isCss:!0})};function tH(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(e2(e)||e6(e))return tz(tD(t$(ek,n([e],t,!0))));var r=e;return 0===t.length&&1===r.length&&"string"==typeof r[0]?tD(r):tz(tD(t$(r,t)))}function tW(e,t,i){if(void 0===i&&(i=eT),!t)throw e9(1,t);var o=function(r){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];return e(t,i,tH.apply(void 0,n([r],o,!1)))};return o.attrs=function(n){return tW(e,t,r(r({},i),{attrs:Array.prototype.concat(i.attrs,n).filter(Boolean)}))},o.withConfig=function(n){return tW(e,t,r(r({},i),n))},o}var tG=function(e){return tW(tj,e)},tK=tG;eE.forEach(function(e){tK[e]=tG(e)});var tq=function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=tN(e),tb.registerId(this.componentId+1)}return e.prototype.createStyles=function(e,t,i,r){var n=r(e4(tD(this.rules,t,i,r)),""),o=this.componentId+e;i.insertRules(o,o,n)},e.prototype.removeStyles=function(e,t){t.clearRules(this.componentId+e)},e.prototype.renderStyles=function(e,t,i,r){e>2&&tb.registerId(this.componentId+e),this.removeStyles(e,i),this.createStyles(e,t,i,r)},e}();function tJ(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var s=tH.apply(void 0,n([e],t,!1)),a="sc-global-".concat(eV(JSON.stringify(s))),l=new tq(s,a),d=function(e){var t=tA(),i=o.useContext(tV),r=o.useRef(t.styleSheet.allocateGSInstance(a)).current;return t.styleSheet.server&&c(r,e,t.styleSheet,i,t.stylis),o.useLayoutEffect(function(){if(!t.styleSheet.server)return c(r,e,t.styleSheet,i,t.stylis),function(){return l.removeStyles(r,t.styleSheet)}},[r,e,t.styleSheet,i,t.stylis]),null};function c(e,t,i,n,o){if(l.isStatic)l.renderStyles(e,eC,i,o);else{var s=r(r({},t),{theme:eI(t,n,d.defaultProps)});l.renderStyles(e,s,i,o)}}return o.memo(d)}function tQ(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var r=e4(tH.apply(void 0,n([e],t,!1)));return new tO(eV(r),r)}!function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString();if(!t)return"";var i=tu(),r=e4([i&&'nonce="'.concat(i,'"'),"".concat(em,'="true"'),"".concat(ev,'="').concat(eb,'"')].filter(Boolean)," ");return"<style ".concat(r,">").concat(t,"</style>")},this.getStyleTags=function(){if(e.sealed)throw e9(2);return e._emitSheetCSS()},this.getStyleElement=function(){if(e.sealed)throw e9(2);var t,i=e.instance.toString();if(!i)return[];var n=((t={})[em]="",t[ev]=eb,t.dangerouslySetInnerHTML={__html:i},t),s=tu();return s&&(n.nonce=s),[o.createElement("style",r({},n,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new tb({isServer:!0}),this.sealed=!1}e.prototype.collectStyles=function(e){if(this.sealed)throw e9(2);return o.createElement(tM,{sheet:this.instance},e)},e.prototype.interleaveWithNodeStream=function(e){throw e9(3)}}()},2238:function(e,t,i){var r;!function(n,o){"use strict";var s="1.0.41",a="",l="?",d="function",c="undefined",u="object",h="string",f="major",p="model",m="name",g="type",v="vendor",b="version",y="architecture",S="console",w="mobile",C="tablet",k="smarttv",T="wearable",I="embedded",E=500,A="Amazon",M="Apple",O="ASUS",P="BlackBerry",_="Browser",x="Chrome",R="Firefox",D="Google",N="Honor",L="Huawei",F="LG",V="Microsoft",B="Motorola",U="Nvidia",j="OnePlus",$="Opera",z="OPPO",H="Samsung",W="Sharp",G="Sony",K="Xiaomi",q="Zebra",J="Facebook",Q="Chromium OS",Z="Mac OS",X=" Browser",Y=function(e,t){var i={};for(var r in e)t[r]&&t[r].length%2==0?i[r]=t[r].concat(e[r]):i[r]=e[r];return i},ee=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},et=function(e,t){return typeof e===h&&-1!==ei(t).indexOf(ei(e))},ei=function(e){return e.toLowerCase()},er=function(e){return typeof e===h?e.replace(/[^\d\.]/g,a).split(".")[0]:void 0},en=function(e,t){if(typeof e===h)return e=e.replace(/^\s\s*/,a),typeof t===c?e:e.substring(0,E)},eo=function(e,t){for(var i,r,n,s,a,l,c=0;c<t.length&&!a;){var h=t[c],f=t[c+1];for(i=r=0;i<h.length&&!a&&h[i];)if(a=h[i++].exec(e))for(n=0;n<f.length;n++)l=a[++r],typeof(s=f[n])===u&&s.length>0?2===s.length?typeof s[1]==d?this[s[0]]=s[1].call(this,l):this[s[0]]=s[1]:3===s.length?typeof s[1]!==d||s[1].exec&&s[1].test?this[s[0]]=l?l.replace(s[1],s[2]):void 0:this[s[0]]=l?s[1].call(this,l,s[2]):void 0:4===s.length&&(this[s[0]]=l?s[3].call(this,l.replace(s[1],s[2])):o):this[s]=l||o;c+=2}},es=function(e,t){for(var i in t)if(typeof t[i]===u&&t[i].length>0){for(var r=0;r<t[i].length;r++)if(et(t[i][r],e))return i===l?o:i}else if(et(t[i],e))return i===l?o:i;return t.hasOwnProperty("*")?t["*"]:e},ea={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},el={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[b,[m,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[b,[m,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[m,b],[/opios[\/ ]+([\w\.]+)/i],[b,[m,$+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[b,[m,$+" GX"]],[/\bopr\/([\w\.]+)/i],[b,[m,$]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[b,[m,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[b,[m,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[m,b],[/quark(?:pc)?\/([-\w\.]+)/i],[b,[m,"Quark"]],[/\bddg\/([\w\.]+)/i],[b,[m,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[b,[m,"UC"+_]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[b,[m,"WeChat"]],[/konqueror\/([\w\.]+)/i],[b,[m,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[b,[m,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[b,[m,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[b,[m,"Smart Lenovo "+_]],[/(avast|avg)\/([\w\.]+)/i],[[m,/(.+)/,"$1 Secure "+_],b],[/\bfocus\/([\w\.]+)/i],[b,[m,R+" Focus"]],[/\bopt\/([\w\.]+)/i],[b,[m,$+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[b,[m,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[b,[m,"Dolphin"]],[/coast\/([\w\.]+)/i],[b,[m,$+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[b,[m,"MIUI"+X]],[/fxios\/([\w\.-]+)/i],[b,[m,R]],[/\bqihoobrowser\/?([\w\.]*)/i],[b,[m,"360"]],[/\b(qq)\/([\w\.]+)/i],[[m,/(.+)/,"$1Browser"],b],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[m,/(.+)/,"$1"+X],b],[/samsungbrowser\/([\w\.]+)/i],[b,[m,H+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[b,[m,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[m,"Sogou Mobile"],b],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[m,b],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[m],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[b,m],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[m,J],b],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[m,b],[/\bgsa\/([\w\.]+) .*safari\//i],[b,[m,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[b,[m,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[b,[m,x+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[m,x+" WebView"],b],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[b,[m,"Android "+_]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[m,b],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[b,[m,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[b,m],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[m,[b,es,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[m,b],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[m,"Netscape"],b],[/(wolvic|librewolf)\/([\w\.]+)/i],[m,b],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[b,[m,R+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[m,[b,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[m,[b,/master.|lts./,""]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[y,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[y,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[y,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[y,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[y,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[y,/ower/,a,ei]],[/ sun4\w[;\)]/i],[[y,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[y,ei]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[p,[v,H],[g,C]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[p,[v,H],[g,w]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[p,[v,M],[g,w]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[p,[v,M],[g,C]],[/(macintosh);/i],[p,[v,M]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[p,[v,W],[g,w]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[p,[v,N],[g,C]],[/honor([-\w ]+)[;\)]/i],[p,[v,N],[g,w]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[p,[v,L],[g,C]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[p,[v,L],[g,w]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[p,/_/g," "],[v,K],[g,C]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[p,/_/g," "],[v,K],[g,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[p,[v,z],[g,w]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[p,[v,es,{OnePlus:["304","403","203"],"*":z}],[g,C]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[p,[v,"Vivo"],[g,w]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[p,[v,"Realme"],[g,w]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[p,[v,B],[g,w]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[p,[v,B],[g,C]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[p,[v,F],[g,C]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv|watch)\w+)/i,/\blg-?([\d\w]+) bui/i],[p,[v,F],[g,w]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[p,[v,"Lenovo"],[g,C]],[/(nokia) (t[12][01])/i],[v,p,[g,C]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[p,/_/g," "],[g,w],[v,"Nokia"]],[/(pixel (c|tablet))\b/i],[p,[v,D],[g,C]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[p,[v,D],[g,w]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[p,[v,G],[g,w]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[p,"Xperia Tablet"],[v,G],[g,C]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[p,[v,j],[g,w]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[p,[v,A],[g,C]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[p,/(.+)/g,"Fire Phone $1"],[v,A],[g,w]],[/(playbook);[-\w\),; ]+(rim)/i],[p,v,[g,C]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[p,[v,P],[g,w]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[p,[v,O],[g,C]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[p,[v,O],[g,w]],[/(nexus 9)/i],[p,[v,"HTC"],[g,C]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[v,[p,/_/g," "],[g,w]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[p,[v,"TCL"],[g,C]],[/(itel) ((\w+))/i],[[v,ei],p,[g,es,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[p,[v,"Acer"],[g,C]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[p,[v,"Meizu"],[g,w]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[p,[v,"Ulefone"],[g,w]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[p,[v,"Energizer"],[g,w]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[p,[v,"Cat"],[g,w]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[p,[v,"Smartfren"],[g,w]],[/droid.+; (a(?:015|06[35]|142p?))/i],[p,[v,"Nothing"],[g,w]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[p,[v,"Archos"],[g,C]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[p,[v,"Archos"],[g,w]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[v,p,[g,C]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (hmd|imo) ([\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[v,p,[g,w]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[v,p,[g,C]],[/(surface duo)/i],[p,[v,V],[g,C]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[p,[v,"Fairphone"],[g,w]],[/(u304aa)/i],[p,[v,"AT&T"],[g,w]],[/\bsie-(\w*)/i],[p,[v,"Siemens"],[g,w]],[/\b(rct\w+) b/i],[p,[v,"RCA"],[g,C]],[/\b(venue[\d ]{2,7}) b/i],[p,[v,"Dell"],[g,C]],[/\b(q(?:mv|ta)\w+) b/i],[p,[v,"Verizon"],[g,C]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[p,[v,"Barnes & Noble"],[g,C]],[/\b(tm\d{3}\w+) b/i],[p,[v,"NuVision"],[g,C]],[/\b(k88) b/i],[p,[v,"ZTE"],[g,C]],[/\b(nx\d{3}j) b/i],[p,[v,"ZTE"],[g,w]],[/\b(gen\d{3}) b.+49h/i],[p,[v,"Swiss"],[g,w]],[/\b(zur\d{3}) b/i],[p,[v,"Swiss"],[g,C]],[/\b((zeki)?tb.*\b) b/i],[p,[v,"Zeki"],[g,C]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[v,"Dragon Touch"],p,[g,C]],[/\b(ns-?\w{0,9}) b/i],[p,[v,"Insignia"],[g,C]],[/\b((nxa|next)-?\w{0,9}) b/i],[p,[v,"NextBook"],[g,C]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[v,"Voice"],p,[g,w]],[/\b(lvtel\-)?(v1[12]) b/i],[[v,"LvTel"],p,[g,w]],[/\b(ph-1) /i],[p,[v,"Essential"],[g,w]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[p,[v,"Envizen"],[g,C]],[/\b(trio[-\w\. ]+) b/i],[p,[v,"MachSpeed"],[g,C]],[/\btu_(1491) b/i],[p,[v,"Rotor"],[g,C]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[p,[v,U],[g,C]],[/(sprint) (\w+)/i],[v,p,[g,w]],[/(kin\.[onetw]{3})/i],[[p,/\./g," "],[v,V],[g,w]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[p,[v,q],[g,C]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[p,[v,q],[g,w]],[/smart-tv.+(samsung)/i],[v,[g,k]],[/hbbtv.+maple;(\d+)/i],[[p,/^/,"SmartTV"],[v,H],[g,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[v,F],[g,k]],[/(apple) ?tv/i],[v,[p,M+" TV"],[g,k]],[/crkey/i],[[p,x+"cast"],[v,D],[g,k]],[/droid.+aft(\w+)( bui|\))/i],[p,[v,A],[g,k]],[/(shield \w+ tv)/i],[p,[v,U],[g,k]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[p,[v,W],[g,k]],[/(bravia[\w ]+)( bui|\))/i],[p,[v,G],[g,k]],[/(mi(tv|box)-?\w+) bui/i],[p,[v,K],[g,k]],[/Hbbtv.*(technisat) (.*);/i],[v,p,[g,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[v,en],[p,en],[g,k]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[p,[g,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[g,k]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[v,p,[g,S]],[/droid.+; (shield)( bui|\))/i],[p,[v,U],[g,S]],[/(playstation \w+)/i],[p,[v,G],[g,S]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[p,[v,V],[g,S]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[p,[v,H],[g,T]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[v,p,[g,T]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[p,[v,z],[g,T]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[p,[v,M],[g,T]],[/(opwwe\d{3})/i],[p,[v,j],[g,T]],[/(moto 360)/i],[p,[v,B],[g,T]],[/(smartwatch 3)/i],[p,[v,G],[g,T]],[/(g watch r)/i],[p,[v,F],[g,T]],[/droid.+; (wt63?0{2,3})\)/i],[p,[v,q],[g,T]],[/droid.+; (glass) \d/i],[p,[v,D],[g,T]],[/(pico) (4|neo3(?: link|pro)?)/i],[v,p,[g,T]],[/; (quest( \d| pro)?)/i],[p,[v,J],[g,T]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[v,[g,I]],[/(aeobc)\b/i],[p,[v,A],[g,I]],[/(homepod).+mac os/i],[p,[v,M],[g,I]],[/windows iot/i],[[g,I]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[p,[g,w]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[p,[g,C]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[g,C]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[g,w]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[p,[v,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[b,[m,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[m,b],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[b,[m,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[m,b],[/ladybird\//i],[[m,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[b,m]],os:[[/microsoft (windows) (vista|xp)/i],[m,b],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[m,[b,es,ea]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[b,es,ea],[m,"Windows"]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[b,/_/g,"."],[m,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[m,Z],[b,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[b,m],[/(ubuntu) ([\w\.]+) like android/i],[[m,/(.+)/,"$1 Touch"],b],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/; ]?([\d\.]*)/i],[m,b],[/\(bb(10);/i],[b,[m,P]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[b,[m,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[b,[m,R+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[b,[m,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[b,[m,"watchOS"]],[/crkey\/([\d\.]+)/i],[b,[m,x+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[m,Q],b],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[m,b],[/(sunos) ?([\w\.\d]*)/i],[[m,"Solaris"],b],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[m,b]]},ed=function(e,t){if(typeof e===u&&(t=e,e=o),!(this instanceof ed))return new ed(e,t).getResult();var i=typeof n!==c&&n.navigator?n.navigator:o,r=e||(i&&i.userAgent?i.userAgent:a),s=i&&i.userAgentData?i.userAgentData:o,l=t?Y(el,t):el,S=i&&i.userAgent==r;return this.getBrowser=function(){var e={};return e[m]=o,e[b]=o,eo.call(e,r,l.browser),e[f]=er(e[b]),S&&i&&i.brave&&typeof i.brave.isBrave==d&&(e[m]="Brave"),e},this.getCPU=function(){var e={};return e[y]=o,eo.call(e,r,l.cpu),e},this.getDevice=function(){var e={};return e[v]=o,e[p]=o,e[g]=o,eo.call(e,r,l.device),S&&!e[g]&&s&&s.mobile&&(e[g]=w),S&&"Macintosh"==e[p]&&i&&typeof i.standalone!==c&&i.maxTouchPoints&&i.maxTouchPoints>2&&(e[p]="iPad",e[g]=C),e},this.getEngine=function(){var e={};return e[m]=o,e[b]=o,eo.call(e,r,l.engine),e},this.getOS=function(){var e={};return e[m]=o,e[b]=o,eo.call(e,r,l.os),S&&!e[m]&&s&&s.platform&&"Unknown"!=s.platform&&(e[m]=s.platform.replace(/chrome os/i,Q).replace(/macos/i,Z)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===h&&e.length>E?en(e,E):e,this},this.setUA(r),this};ed.VERSION=s,ed.BROWSER=ee([m,b,f]),ed.CPU=ee([y]),ed.DEVICE=ee([p,v,g,S,w,k,C,T,I]),ed.ENGINE=ed.OS=ee([m,b]),typeof t!==c?("object"!==c&&e.exports&&(t=e.exports=ed),t.UAParser=ed):"function"===d&&i.amdO?o!==(r=(function(){return ed}).call(t,i,t,e))&&(e.exports=r):typeof n!==c&&(n.UAParser=ed);var ec=typeof n!==c&&(n.jQuery||n.Zepto);if(ec&&!ec.ua){var eu=new ed;ec.ua=eu.getResult(),ec.ua.get=function(){return eu.getUA()},ec.ua.set=function(e){eu.setUA(e);var t=eu.getResult();for(var i in t)ec.ua[i]=t[i]}}}("object"==typeof window?window:this)}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(6840),t(3079)}),_N_E=e.O()}]);